import{b as J,d as K,i as W,k as Z,q as ee,r as te,s as ie,x as ne}from"./chunk-QA5A7GBQ.js";import{a as H}from"./chunk-ZGVWU7EJ.js";import{Ac as I,Gb as i,Ha as N,Hb as u,Hc as j,Ib as b,Jb as Y,Jc as G,Ma as o,O as z,Rb as X,T as E,Xa as D,Xb as L,Y as S,Z as y,_b as s,ac as p,ea as B,hb as v,ib as h,ja as g,lb as A,mb as F,nb as w,ob as e,pb as t,qb as c,ub as k,uc as Q,wb as _,wc as q,yb as f,zc as T}from"./chunk-6JS7X5LE.js";var M=class r{http=E(G);apiUrl=`${H.url}admin/tax-breakdown`;getSalesBreakdown(l,n,a,d=1,m=20,C){let x=new j;return l&&(x=x.set("month",l)),n&&(x=x.set("year",n)),a&&(x=x.set("instructor_search",a)),x=x.set("page",d),x=x.set("limit",m),C&&C!=="all"&&(x=x.set("status",C)),this.http.get(`${this.apiUrl}/sales`,{params:x})}generateCFDI(l){return this.http.post(`${this.apiUrl}/generate-cfdi`,{retention_id:l})}resendCFDIToTelegram(l){return this.http.post(`${this.apiUrl}/resend-cfdi`,{retention_id:l})}exportRetentions(l,n,a,d){let m=new j().set("month",l).set("year",n);return a&&(m=m.set("instructor_search",a)),d&&d!=="all"&&(m=m.set("status",d)),this.http.get(`${this.apiUrl}/export`,{params:m,responseType:"blob"})}getPendingCount(){return this.http.get(`${this.apiUrl}/pending-count`)}static \u0275fac=function(n){return new(n||r)};static \u0275prov=z({token:r,factory:r.\u0275fac,providedIn:"root"})};var de=(r,l,n)=>({"bg-green-500/20 text-green-500 border border-green-500/30":r,"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30":l,"bg-purple-500/20 text-purple-500 border border-purple-500/30":n});function se(r,l){r&1&&(c(0,"i",47),i(1," Procesando... "))}function pe(r,l){r&1&&(c(0,"i",48),i(1," Declarar Ahora "))}function me(r,l){if(r&1){let n=k();e(0,"button",46),_("click",function(){S(n);let d=f();return y(d.onDeclare())}),v(1,se,2,0)(2,pe,2,0),t()}if(r&2){let n=f();w("disabled",n.isDeclaring()),o(),h(n.isDeclaring()?1:2)}}function ce(r,l){if(r&1&&(e(0,"a",49),c(1,"i",50),i(2," XML "),t()),r&2){let n=f(2);w("href",X(n.retention.cfdi_xml_url),N)}}function ue(r,l){if(r&1&&(e(0,"a",49),c(1,"i",51),i(2," PDF "),t()),r&2){let n=f(2);w("href",X(n.retention.cfdi_pdf_url),N)}}function xe(r,l){if(r&1&&(e(0,"div",9),v(1,ce,3,2,"a",49),v(2,ue,3,2,"a",49),t()),r&2){let n=f();o(),h(n.retention.cfdi_xml_url?1:-1),o(),h(n.retention.cfdi_pdf_url?2:-1)}}function be(r,l){r&1&&i(0," \u2713 PAGADO ")}function fe(r,l){r&1&&i(0," \u2713 DECLARADO ")}function ge(r,l){r&1&&i(0," \u23F3 PENDIENTE ")}function _e(r,l){if(r&1&&(e(0,"div",45)(1,"div",52),c(2,"i",53),e(3,"span",54),i(4,"UUID del CFDI"),t()(),e(5,"code",55),i(6),t()()),r&2){let n=f();o(6),u(n.retention.cfdi_uuid)}}function ve(r,l){if(r&1&&(e(0,"div")(1,"h3",36),c(2,"i",56),i(3," Ganancia de la Plataforma "),t(),e(4,"div",57)(5,"div",58)(6,"span",59),i(7,"Bruto (50%)"),t(),e(8,"span",42),i(9),s(10,"currency"),t()(),e(11,"div",60)(12,"span",40),c(13,"i",61),i(14," Costos PayPal "),t(),e(15,"span",62),i(16),s(17,"currency"),t()(),e(18,"div",60)(19,"span",40),c(20,"i",63),i(21," Impuestos (ISR+IVA) "),t(),e(22,"span",62),i(23),s(24,"currency"),t()(),e(25,"div",64)(26,"span",65),c(27,"i",66),i(28," Utilidad Neta "),t(),e(29,"span",67),i(30),s(31,"currency"),t()()()()),r&2){let n=f();o(9),u(p(10,4,n.retention.platform_breakdown.platform_share,"MXN")),o(7),b("-",p(17,7,n.retention.platform_breakdown.total_paypal_commissions,"MXN")),o(7),b("-",p(24,10,n.retention.platform_breakdown.platform_isr+n.retention.platform_breakdown.platform_iva,"MXN")),o(7),u(p(31,13,n.retention.platform_breakdown.platform_net_profit,"MXN"))}}var P=class r{retention;close=new B;declared=new B;taxService=E(M);isDeclaring=g(!1);isResending=g(!1);getClientTotal(){if(this.retention?.sale?.total_amount)return this.retention.sale.total_amount;let l=this.retention.gross_earning*2,n=this.getPayPalInCommission();return l+n}getPayPalInCommission(){return this.retention?.platform_breakdown?.paypal_receive_commission?this.retention.platform_breakdown.paypal_receive_commission:(this.retention?.sale?.total_amount||this.retention.gross_earning*2+8.4)*.04+4}onDeclare(){this.isDeclaring()||(this.isDeclaring.set(!0),this.taxService.generateCFDI(this.retention._id).subscribe({next:l=>{console.log("\u2705 Declaraci\xF3n exitosa",l),this.retention.status="declared",l?.urls&&(this.retention.cfdi_xml_url=l.urls.xml,this.retention.cfdi_pdf_url=l.urls.pdf),this.isDeclaring.set(!1),this.declared.emit()},error:l=>{console.error("\u274C Error declarando",l),alert("Error al declarar. Intenta de nuevo."),this.isDeclaring.set(!1)}}))}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=D({type:r,selectors:[["app-sale-detail-modal"]],inputs:{retention:"retention"},outputs:{close:"close",declared:"declared"},decls:93,vars:37,consts:[[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","p-4","bg-black/80","backdrop-blur-sm",3,"click"],[1,"bg-slate-900","border","border-slate-700","w-full","max-w-4xl","max-h-[90vh]","overflow-y-auto","rounded-2xl","shadow-2xl","relative",3,"click"],[1,"sticky","top-0","z-10","bg-slate-900/95","backdrop-blur","border-b","border-slate-800","p-6","flex","justify-between","items-center"],[1,"flex-1"],[1,"text-2xl","font-bold","text-white"],[1,"flex","items-center","gap-3","mt-1","flex-wrap"],[1,"text-slate-400","text-sm"],[1,"text-lime-400","font-mono"],[1,"bg-green-600","hover:bg-green-700","text-white","text-xs","font-bold","px-3","py-1","rounded-full","transition-all","flex","items-center","gap-2","shadow-lg","shadow-green-500/30",3,"disabled"],[1,"flex","items-center","gap-2"],[1,"p-2","rounded-full","hover:bg-slate-800","text-slate-400","hover:text-white","transition-colors",3,"click"],[1,"fas","fa-times","text-xl"],[1,"p-6","space-y-8"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-blue-500/30","relative","overflow-hidden","group"],[1,"absolute","-right-4","-top-4","w-24","h-24","bg-blue-500/10","rounded-full","blur-2xl","group-hover:bg-blue-500/20","transition-all"],[1,"text-xs","font-semibold","text-blue-400","uppercase","tracking-wider","mb-2"],[1,"text-2xl","font-bold","text-white","mb-1"],[1,"text-xs","text-slate-500"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-yellow-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-yellow-500","uppercase","tracking-wider","mb-2"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-white/20","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-slate-300","uppercase","tracking-wider","mb-2"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-purple-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-purple-400","uppercase","tracking-wider","mb-2"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-orange-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-orange-400","uppercase","tracking-wider","mb-2"],[1,"bg-gradient-to-r","from-lime-900/20","to-green-900/20","p-6","rounded-2xl","border","border-lime-500/30","flex","flex-col","md:flex-row","justify-between","items-center","gap-6"],[1,"flex","items-center","gap-4"],[1,"w-16","h-16","rounded-full","bg-lime-500/20","flex","items-center","justify-center","border","border-lime-500/50"],[1,"fas","fa-money-bill-wave","text-lime-400","text-3xl"],[1,"text-lime-400","font-bold","text-lg"],[1,"text-right"],[1,"text-4xl","font-bold","text-white","tracking-tight"],[1,"text-xs","text-lime-500","font-medium","bg-lime-500/10","px-2","py-1","rounded","inline-block","mt-1"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","border-t","border-slate-800","pt-6"],[1,"text-lg","font-bold","text-white","mb-4","flex","items-center","gap-2"],[1,"fas","fa-user-tie","text-purple-400"],[1,"space-y-3"],[1,"bg-slate-800/50","p-4","rounded-lg","border","border-slate-700/50","flex","justify-between","items-center"],[1,"text-slate-400","text-sm","flex","items-center","gap-2"],[1,"fas","fa-calendar","text-slate-500"],[1,"text-white","font-bold"],[1,"fas","fa-flag","text-slate-500"],[1,"uppercase","font-bold","text-xs","px-3","py-1","rounded-full",3,"ngClass"],[1,"bg-slate-800/50","p-4","rounded-lg","border","border-lime-500/30"],[1,"bg-green-600","hover:bg-green-700","text-white","text-xs","font-bold","px-3","py-1","rounded-full","transition-all","flex","items-center","gap-2","shadow-lg","shadow-green-500/30",3,"click","disabled"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-check-double"],["target","_blank",1,"bg-slate-700","hover:bg-slate-600","text-white","text-xs","font-bold","px-3","py-1","rounded-full","transition-all","flex","items-center","gap-2",3,"href"],[1,"fas","fa-download"],[1,"fas","fa-file-pdf"],[1,"flex","items-center","gap-2","mb-2"],[1,"fas","fa-barcode","text-lime-400"],[1,"text-slate-400","text-xs","font-semibold","uppercase"],[1,"text-lime-400","text-xs","font-mono","break-all","block","bg-slate-900/50","p-2","rounded"],[1,"fas","fa-building","text-purple-400"],[1,"bg-slate-800/50","rounded-lg","border","border-slate-700/50","overflow-hidden"],[1,"p-4","flex","justify-between","border-b","border-slate-700/50"],[1,"text-slate-300","text-sm","font-medium"],[1,"p-4","flex","justify-between","border-b","border-slate-700/50","bg-red-500/5"],[1,"fas","fa-credit-card","text-red-400","text-xs"],[1,"text-red-400","font-medium"],[1,"fas","fa-receipt","text-red-400","text-xs"],[1,"p-4","flex","justify-between","bg-emerald-500/10"],[1,"text-emerald-400","font-bold","flex","items-center","gap-2"],[1,"fas","fa-coins","text-emerald-400"],[1,"text-emerald-400","font-bold","text-lg"]],template:function(n,a){if(n&1&&(e(0,"div",0),_("click",function(){return a.close.emit()}),e(1,"div",1),_("click",function(m){return m.stopPropagation()}),e(2,"div",2)(3,"div",3)(4,"h2",4),i(5,"Desglose Fiscal Detallado"),t(),e(6,"div",5)(7,"p",6),i(8,"Venta "),e(9,"span",7),i(10),t()(),v(11,me,3,2,"button",8),v(12,xe,3,2,"div",9),t()(),e(13,"button",10),_("click",function(){return a.close.emit()}),c(14,"i",11),t()(),e(15,"div",12)(16,"div",13)(17,"div",14),c(18,"div",15),e(19,"p",16),i(20,"1. Cliente Paga"),t(),e(21,"p",17),i(22),s(23,"currency"),t(),e(24,"p",18),i(25,"Monto total de la venta"),t()(),e(26,"div",19)(27,"p",20),i(28,"2. Comisi\xF3n PayPal (In)"),t(),e(29,"p",17),i(30),s(31,"currency"),t(),e(32,"p",18),i(33,"4% + $4.00 MXN"),t()(),e(34,"div",21)(35,"p",22),i(36,"3. Neto a Repartir"),t(),e(37,"p",17),i(38),s(39,"currency"),t(),e(40,"p",18),i(41,"Base 100%"),t()(),e(42,"div",23)(43,"p",24),i(44,"4. Bruto Instructor (Est. 70-80%)"),t(),e(45,"p",17),i(46),s(47,"currency"),t()(),e(48,"div",25)(49,"p",26),i(50,"5. Comisi\xF3n PayPal (Out)"),t(),e(51,"p",17),i(52),s(53,"currency"),t(),e(54,"p",18),i(55,"Al transferir al instructor"),t()()(),e(56,"div",27)(57,"div",28)(58,"div",29),c(59,"i",30),t(),e(60,"div")(61,"p",31),i(62,"Pago Neto al Instructor"),t(),e(63,"p",6),i(64,"Monto final depositado en cuenta"),t()()(),e(65,"div",32)(66,"p",33),i(67),s(68,"currency"),t(),e(69,"p",34),i(70," Monto \xEDntegro a transferir "),t()()(),e(71,"div",35)(72,"div")(73,"h3",36),c(74,"i",37),i(75," Estatus Fiscal Instructor "),t(),e(76,"div",38)(77,"div",39)(78,"span",40),c(79,"i",41),i(80," Periodo Fiscal "),t(),e(81,"span",42),i(82),t()(),e(83,"div",39)(84,"span",40),c(85,"i",43),i(86," Estatus Declaraci\xF3n "),t(),e(87,"span",44),v(88,be,1,0)(89,fe,1,0)(90,ge,1,0),t()(),v(91,_e,7,1,"div",45),t()(),v(92,ve,32,16,"div"),t()()()()),n&2){let d;o(10),u(a.retention.sale==null?null:a.retention.sale.code),o(),h(a.retention.status==="pending"?11:-1),o(),h(a.retention.status==="declared"?12:-1),o(10),u(p(23,15,a.getClientTotal(),"MXN")),o(8),b("-",p(31,18,a.getPayPalInCommission(),"MXN")),o(8),u(p(39,21,(a.retention.platform_breakdown==null?null:a.retention.platform_breakdown.net_after_paypal_receive)||a.retention.gross_earning/.7,"MXN")),o(8),u(p(47,24,a.retention.gross_earning,"MXN")),o(6),b("-",p(53,27,a.retention.paypal_send_commission,"MXN")),o(15),u(p(68,30,a.retention.gross_earning,"MXN")),o(15),Y("",a.retention.month,"/",a.retention.year),o(5),w("ngClass",L(33,de,a.retention.status==="declared",a.retention.status==="pending",a.retention.status==="paid")),o(),h((d=a.retention.status)==="paid"?88:d==="declared"?89:90),o(3),h(a.retention.status==="declared"&&a.retention.cfdi_uuid?91:-1),o(),h(a.retention.platform_breakdown?92:-1)}},dependencies:[I,Q,T],encapsulation:2})};var he=(r,l)=>l.value,we=(r,l)=>l._id;function Se(r,l){if(r&1&&(e(0,"option",11),i(1),t()),r&2){let n=l.$implicit;w("value",n.value),o(),u(n.label)}}function ye(r,l){if(r&1&&(e(0,"tr",59)(1,"td",62)(2,"div",63)(3,"span",64),i(4),s(5,"date"),t()()(),e(6,"td",65)(7,"span",66),i(8),t()(),e(9,"td",67),i(10),s(11,"currency"),t(),e(12,"td",68),i(13),s(14,"currency"),t(),e(15,"td",68),i(16),s(17,"currency"),t(),e(18,"td",69),i(19),s(20,"currency"),t()()),r&2){let n=l.$implicit;o(4),u(p(5,6,n.sale==null?null:n.sale.createdAt,"mediumDate")),o(4),u((n.sale==null?null:n.sale.code)||(n.sale==null?null:n.sale._id)),o(2),b(" ",p(11,9,(n.platform_breakdown==null?null:n.platform_breakdown.platform_revenue)||0,"MXN")," "),o(3),b(" ",p(14,12,(n.platform_breakdown==null?null:n.platform_breakdown.platform_iva)||0,"MXN")," "),o(3),b(" ",p(17,15,(n.platform_breakdown==null?null:n.platform_breakdown.platform_isr)||0,"MXN")," "),o(3),b(" ",p(20,18,(n.platform_breakdown==null?null:n.platform_breakdown.platform_net_profit)||0,"MXN")," ")}}function Ce(r,l){r&1&&(e(0,"tr")(1,"td",70),c(2,"i",71),e(3,"p"),i(4,"No hay registros fiscales para este periodo."),t()()())}function Ee(r,l){if(r&1){let n=k();e(0,"div",60)(1,"p",72),i(2," Mostrando p\xE1gina "),e(3,"span",73),i(4),t(),i(5," de "),e(6,"span",73),i(7),t(),i(8),t(),e(9,"div",74)(10,"button",75),_("click",function(){S(n);let d=f();return y(d.changePage(d.pagination().page-1))}),i(11," Anterior "),t(),e(12,"button",75),_("click",function(){S(n);let d=f();return y(d.changePage(d.pagination().page+1))}),i(13," Siguiente "),t()()()}if(r&2){let n=f();o(4),u(n.pagination().page),o(3),u(n.pagination().totalPages),o(),b(" (Total: ",n.pagination().totalDocs," registros) "),o(2),w("disabled",n.pagination().page===1),o(2),w("disabled",n.pagination().page>=n.pagination().totalPages)}}function Me(r,l){if(r&1){let n=k();e(0,"app-sale-detail-modal",76),_("close",function(){S(n);let d=f();return y(d.selectedSale.set(null))})("declared",function(){S(n);let d=f();return y(d.loadData())}),t()}if(r&2){let n=f();w("retention",n.selectedSale())}}var le=class r{taxService=E(M);selectedMonth=g(new Date().getMonth()+1);selectedYear=g(new Date().getFullYear());selectedStatus=g("all");sales=g([]);totals=g(null);pagination=g(null);selectedSale=g(null);searchQuery=g("");currentPage=g(1);itemsPerPage=g(20);searchTimeout;months=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];ngOnInit(){this.loadData()}ngOnDestroy(){this.searchTimeout&&clearTimeout(this.searchTimeout)}loadData(){this.taxService.getSalesBreakdown(this.selectedMonth(),this.selectedYear(),this.searchQuery(),this.currentPage(),this.itemsPerPage(),this.selectedStatus()).subscribe({next:l=>{if(l.success){let n=new Map,a=[];for(let d of l.data){let m=d.sale?._id||d.sale;m&&!n.has(m)&&(n.set(m,!0),a.push(d))}this.sales.set(a),this.totals.set(l.totals),this.pagination.set(l.pagination)}},error:l=>{console.error("\u274C [TaxBreakdown] Error:",l)}})}onFilterChange(){this.currentPage.set(1),this.loadData()}onSearch(l){let n=l.target.value;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchQuery.set(n),this.currentPage.set(1),this.loadData()},500)}changePage(l){l<1||this.pagination()&&l>this.pagination().totalPages||(this.currentPage.set(l),this.loadData())}openDetail(l){this.selectedSale.set(l)}exportToExcel(){this.taxService.exportRetentions(this.selectedMonth(),this.selectedYear(),this.searchQuery(),this.selectedStatus()).subscribe({next:l=>{let n=window.URL.createObjectURL(l),a=document.createElement("a");a.href=n,a.download=`reporte_fiscal_${this.selectedMonth()}_${this.selectedYear()}.csv`,a.click(),window.URL.revokeObjectURL(n)},error:l=>{console.error("\u274C [TaxBreakdown] Error en exportaci\xF3n:",l)}})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=D({type:r,selectors:[["app-admin-tax-breakdown"]],decls:130,vars:39,consts:[[1,"p-6","space-y-6","animate-fade-in-down"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","gap-4"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-lime-400","to-green-500","bg-clip-text","text-transparent"],[1,"text-slate-400","mt-1"],[1,"flex","gap-3"],[1,"btn-secondary","flex","items-center","gap-2",3,"click"],[1,"fas","fa-file-excel","text-green-500"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","bg-slate-800/50","p-4","rounded-xl","border","border-slate-700/50","backdrop-blur-sm"],[1,"form-group"],[1,"text-xs","font-semibold","text-slate-400","uppercase","tracking-wider","mb-2","block"],[1,"w-full","bg-slate-900","border","border-slate-700","text-white","rounded-lg","p-2.5","focus:ring-lime-500","focus:border-lime-500","transition-all",3,"ngModelChange","ngModel"],[3,"value"],["type","number",1,"w-full","bg-slate-900","border","border-slate-700","text-white","rounded-lg","p-2.5","focus:ring-lime-500","focus:border-lime-500","transition-all",3,"ngModelChange","ngModel"],["value","all"],["value","pending"],["value","declared"],["value","paid"],[1,"form-group","md:col-span-2"],["type","text","placeholder","Nombre o email del instructor...",1,"w-full","bg-slate-900","border","border-slate-700","text-white","rounded-lg","p-2.5","focus:ring-lime-500","focus:border-lime-500","transition-all","placeholder-slate-500",3,"input"],[1,"space-y-8","mb-8","bg-slate-800/20","p-6","rounded-2xl","border","border-slate-700/30"],[1,"relative"],[1,"absolute","top-1/2","left-0","w-full","h-0.5","bg-slate-700/50","-z-10","hidden","md:block"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","text-center"],[1,"bg-slate-900","border-2","border-slate-700","p-5","rounded-2xl","relative","z-10","shadow-xl"],[1,"text-slate-400","text-xs","uppercase","tracking-wider","font-bold","mb-2"],[1,"text-3xl","font-bold","text-white"],[1,"text-xs","text-slate-500","mt-1"],[1,"bg-slate-900","border-2","border-red-500/30","p-5","rounded-2xl","relative","z-10","shadow-xl"],[1,"absolute","-top-3","left-1/2","-translate-x-1/2","bg-slate-900","px-3","text-slate-500","text-xs","font-bold","uppercase"],[1,"text-red-400","text-xs","uppercase","tracking-wider","font-bold","mb-2"],[1,"text-3xl","font-bold","text-red-500"],[1,"bg-slate-900","border-2","border-blue-500/30","p-5","rounded-2xl","relative","z-10","shadow-xl"],[1,"text-blue-400","text-xs","uppercase","tracking-wider","font-bold","mb-2"],[1,"text-3xl","font-bold","text-blue-500"],[1,"grid","grid-cols-1","md:grid-cols-1","gap-12","border-t","border-slate-700/50","pt-8"],[1,"space-y-4","max-w-3xl","mx-auto","w-full"],[1,"flex","justify-between","items-center","border-b","border-slate-700","pb-3"],[1,"text-white","text-xl","font-bold","flex","items-center","gap-3"],[1,"w-4","h-4","rounded-full","bg-purple-500","shadow-lg","shadow-purple-500/50"],[1,"text-2xl","font-bold","text-white"],[1,"space-y-3","text-sm"],[1,"flex","justify-between","text-slate-400"],[1,"text-white"],[1,"flex","justify-between","text-red-400","bg-red-500/5","p-2","rounded-lg"],[1,"flex","justify-between","text-amber-400","bg-amber-500/10","p-3","rounded-lg","border","border-amber-500/20"],[1,"font-bold"],[1,"bg-gradient-to-br","from-purple-500/10","to-transparent","border","border-purple-500/30","p-6","rounded-2xl","mt-6","relative","overflow-hidden"],[1,"absolute","right-0","top-0","p-4","opacity-10"],[1,"fas","fa-building","text-6xl","text-purple-500"],[1,"text-purple-500","text-sm","font-bold","uppercase","mb-1"],[1,"text-4xl","font-bold","text-white"],[1,"text-xs","text-slate-400","mt-2"],[1,"relative","overflow-x-auto","rounded-xl","border","border-slate-700/50","shadow-xl"],[1,"w-full","text-left","text-sm","text-slate-400"],[1,"bg-slate-900/80","text-xs","uppercase","text-slate-300"],[1,"px-6","py-4","font-semibold"],[1,"px-6","py-4","font-semibold","text-right"],[1,"px-6","py-4","font-semibold","text-right","text-red-400"],[1,"divide-y","divide-slate-700/50","bg-slate-800/30"],[1,"hover:bg-slate-700/30","transition-colors"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","gap-4","mt-6"],[3,"retention"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","flex-col"],[1,"text-white","font-medium"],[1,"px-6","py-4"],[1,"text-xs","text-slate-500","font-mono"],[1,"px-6","py-4","text-right","text-white","font-medium"],[1,"px-6","py-4","text-right","text-red-400"],[1,"px-6","py-4","text-right","text-lime-400","font-bold"],["colspan","6",1,"px-6","py-12","text-center","text-slate-500"],[1,"fas","fa-inbox","text-4xl","mb-4","text-slate-600"],[1,"text-sm","text-slate-400"],[1,"font-bold","text-white"],[1,"flex","gap-2"],[1,"px-4","py-2","rounded-lg","bg-slate-800","border","border-slate-700","text-slate-300","hover:bg-slate-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"click","disabled"],[3,"close","declared","retention"]],template:function(n,a){if(n&1&&(e(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),i(4," Desglose Fiscal y Retenciones "),t(),e(5,"p",3),i(6,"Gesti\xF3n de impuestos, comisiones y pagos a instructores"),t()(),e(7,"div",4)(8,"button",5),_("click",function(){return a.exportToExcel()}),c(9,"i",6),i(10," Exportar Reporte "),t()()(),e(11,"div",7)(12,"div",8)(13,"label",9),i(14,"Mes"),t(),e(15,"select",10),_("ngModelChange",function(m){return a.selectedMonth.set(m),a.onFilterChange()}),A(16,Se,2,2,"option",11,he),t()(),e(18,"div",8)(19,"label",9),i(20,"A\xF1o"),t(),e(21,"input",12),_("ngModelChange",function(m){return a.selectedYear.set(m),a.onFilterChange()}),t()(),e(22,"div",8)(23,"label",9),i(24,"Estado"),t(),e(25,"select",10),_("ngModelChange",function(m){return a.selectedStatus.set(m),a.onFilterChange()}),e(26,"option",13),i(27,"Todos"),t(),e(28,"option",14),i(29,"Pendiente"),t(),e(30,"option",15),i(31,"Declarado"),t(),e(32,"option",16),i(33,"Pagado"),t()()(),e(34,"div",17)(35,"label",9),i(36," \u{1F50D} Buscar Instructor "),t(),e(37,"input",18),_("input",function(m){return a.onSearch(m)}),t()()(),e(38,"div",19)(39,"div",20),c(40,"div",21),e(41,"div",22)(42,"div",23)(43,"p",24),i(44),t(),e(45,"h3",25),i(46),s(47,"currency"),t(),e(48,"p",26),i(49,"Ingreso Bruto Total"),t()(),e(50,"div",27)(51,"div",28),i(52," Menos"),t(),e(53,"p",29),i(54,"2. PayPal (Entrada)"),t(),e(55,"h3",30),i(56),s(57,"currency"),t(),e(58,"p",26),i(59,"Comisiones por recibir pagos"),t()(),e(60,"div",31)(61,"div",28),i(62," Igual a"),t(),e(63,"p",32),i(64,"3. A Repartir"),t(),e(65,"h3",33),i(66),s(67,"currency"),t(),e(68,"p",26),i(69,"Base repartible (100%)"),t()()()(),e(70,"div",34)(71,"div",35)(72,"div",36)(73,"h4",37),c(74,"div",38),i(75," Contabilidad Plataforma "),t(),e(76,"span",39),i(77),s(78,"currency"),t()(),e(79,"div",40)(80,"div",41)(81,"span"),i(82,"Participaci\xF3n Bruta (Est. 20-30%)"),t(),e(83,"span",42),i(84),s(85,"currency"),t()(),e(86,"div",43)(87,"span"),i(88,"Costos PayPal (Env\xEDo Masivo)"),t(),e(89,"span"),i(90),s(91,"currency"),t()(),e(92,"div",44)(93,"span",45),i(94,"Impuestos Propios (ISR+IVA)"),t(),e(95,"span",45),i(96),s(97,"currency"),t()()(),e(98,"div",46)(99,"div",47),c(100,"i",48),t(),e(101,"p",49),i(102,"Utilidad Neta Plataforma"),t(),e(103,"h3",50),i(104),s(105,"currency"),t(),e(106,"p",51),i(107,"Libre de polvo y paja"),t()()()()(),e(108,"div",52)(109,"table",53)(110,"thead",54)(111,"tr")(112,"th",55),i(113,"Fecha"),t(),e(114,"th",55),i(115,"Transacci\xF3n"),t(),e(116,"th",56),i(117,"Ingreso Base (Plat.)"),t(),e(118,"th",57),i(119,"IVA Trasladado"),t(),e(120,"th",57),i(121,"ISR Por Pagar"),t(),e(122,"th",56),i(123,"Utilidad Neta"),t()()(),e(124,"tbody",58),A(125,ye,21,21,"tr",59,we),v(127,Ce,5,0,"tr"),t()()(),v(128,Ee,14,5,"div",60),t(),v(129,Me,1,1,"app-sale-detail-modal",61)),n&2){let d,m,C,x,V,O,R,U,$;o(15),w("ngModel",a.selectedMonth()),o(),F(a.months),o(5),w("ngModel",a.selectedYear()),o(4),w("ngModel",a.selectedStatus()),o(19),b("1. Venta Total (",((d=a.totals())==null?null:d.sales_count)||0," Ventas)"),o(2),u(p(47,15,(m=a.totals())==null?null:m.total_sales_volume,"MXN")),o(10),b("-",p(57,18,(C=a.totals())==null?null:C.total_paypal_receive,"MXN")," "),o(10),b("",p(67,21,(x=a.totals())==null?null:x.total_distributable,"MXN")," "),o(11),u(p(78,24,(V=a.totals())==null?null:V.platform_share,"MXN")),o(7),u(p(85,27,(O=a.totals())==null?null:O.platform_share,"MXN")),o(6),b("-",p(91,30,(R=a.totals())==null?null:R.total_paypal_send,"MXN")),o(6),b("-",p(97,33,(U=a.totals())==null?null:U.platform_taxes,"MXN")),o(8),u(p(105,36,($=a.totals())==null?null:$.platform_net_profit,"MXN")),o(21),F(a.sales()),o(2),h(a.sales().length===0?127:-1),o(),h(a.pagination()?128:-1),o(),h(a.selectedSale()?129:-1)}},dependencies:[I,ne,te,ie,J,Z,ee,K,W,P,T,q],encapsulation:2})};export{M as a,le as b};
