import{b as te,d as ne,i as ie,k as le,p as ae,q as re,r as oe,w as de}from"./chunk-SDJWNAN2.js";import{a as ee}from"./chunk-J4IQXLML.js";import{Ac as B,Gb as n,Ha as A,Hb as c,Hc as j,Ib as u,Jb as T,Jc as Z,Ma as r,O as H,Rb as V,T as C,Xa as D,Xb as J,Y as w,Z as y,_b as s,ac as p,ea as P,hb as v,ib as h,ja as _,lb as F,mb as X,nb as S,ob as e,pb as t,qb as m,ub as M,uc as K,wb as f,wc as W,yb as g,zc as I}from"./chunk-6JS7X5LE.js";var k=class o{http=C(Z);apiUrl=`${ee.url}admin/tax-breakdown`;getSalesBreakdown(l,a,i,d=1,x=20,E){let b=new j;return l&&(b=b.set("month",l)),a&&(b=b.set("year",a)),i&&(b=b.set("instructor_search",i)),b=b.set("page",d),b=b.set("limit",x),E&&E!=="all"&&(b=b.set("status",E)),this.http.get(`${this.apiUrl}/sales`,{params:b})}generateCFDI(l){return this.http.post(`${this.apiUrl}/generate-cfdi`,{retention_id:l})}resendCFDIToTelegram(l){return this.http.post(`${this.apiUrl}/resend-cfdi`,{retention_id:l})}exportRetentions(l,a,i,d){let x=new j().set("month",l).set("year",a);return i&&(x=x.set("instructor_search",i)),d&&d!=="all"&&(x=x.set("status",d)),this.http.get(`${this.apiUrl}/export`,{params:x,responseType:"blob"})}getPendingCount(){return this.http.get(`${this.apiUrl}/pending-count`)}static \u0275fac=function(a){return new(a||o)};static \u0275prov=H({token:o,factory:o.\u0275fac,providedIn:"root"})};var xe=(o,l,a)=>({"bg-green-500/20 text-green-500 border border-green-500/30":o,"bg-yellow-500/20 text-yellow-500 border border-yellow-500/30":l,"bg-purple-500/20 text-purple-500 border border-purple-500/30":a});function ue(o,l){o&1&&(m(0,"i",56),n(1," Procesando... "))}function be(o,l){o&1&&(m(0,"i",57),n(1," Declarar Ahora "))}function ge(o,l){if(o&1){let a=M();e(0,"button",55),f("click",function(){w(a);let d=g();return y(d.onDeclare())}),v(1,ue,2,0)(2,be,2,0),t()}if(o&2){let a=g();S("disabled",a.isDeclaring()),r(),h(a.isDeclaring()?1:2)}}function fe(o,l){if(o&1&&(e(0,"a",58),m(1,"i",59),n(2," XML "),t()),o&2){let a=g(2);S("href",V(a.retention.cfdi_xml_url),A)}}function _e(o,l){if(o&1&&(e(0,"a",58),m(1,"i",60),n(2," PDF "),t()),o&2){let a=g(2);S("href",V(a.retention.cfdi_pdf_url),A)}}function ve(o,l){if(o&1&&(e(0,"div",9),v(1,fe,3,2,"a",58),v(2,_e,3,2,"a",58),t()),o&2){let a=g();r(),h(a.retention.cfdi_xml_url?1:-1),r(),h(a.retention.cfdi_pdf_url?2:-1)}}function he(o,l){o&1&&n(0," \u2713 PAGADO ")}function Se(o,l){o&1&&n(0," \u2713 DECLARADO ")}function we(o,l){o&1&&n(0," \u23F3 PENDIENTE ")}function ye(o,l){if(o&1&&(e(0,"div",54)(1,"div",61),m(2,"i",62),e(3,"span",63),n(4,"UUID del CFDI"),t()(),e(5,"code",64),n(6),t()()),o&2){let a=g();r(6),c(a.retention.cfdi_uuid)}}function Ee(o,l){if(o&1&&(e(0,"div")(1,"h3",45),m(2,"i",65),n(3," Ganancia de la Plataforma "),t(),e(4,"div",66)(5,"div",67)(6,"span",68),n(7,"Bruto (50%)"),t(),e(8,"span",51),n(9),s(10,"currency"),t()(),e(11,"div",69)(12,"span",49),m(13,"i",70),n(14," Costos PayPal "),t(),e(15,"span",71),n(16),s(17,"currency"),t()(),e(18,"div",69)(19,"span",49),m(20,"i",72),n(21," Impuestos (ISR+IVA) "),t(),e(22,"span",71),n(23),s(24,"currency"),t()(),e(25,"div",73)(26,"span",74),m(27,"i",75),n(28," Utilidad Neta "),t(),e(29,"span",76),n(30),s(31,"currency"),t()()()()),o&2){let a=g();r(9),c(p(10,4,a.retention.platform_breakdown.platform_share,"MXN")),r(7),u("-",p(17,7,a.retention.platform_breakdown.total_paypal_commissions,"MXN")),r(7),u("-",p(24,10,a.retention.platform_breakdown.platform_isr+a.retention.platform_breakdown.platform_iva,"MXN")),r(7),c(p(31,13,a.retention.platform_breakdown.platform_net_profit,"MXN"))}}var N=class o{retention;close=new P;declared=new P;taxService=C(k);isDeclaring=_(!1);isResending=_(!1);getClientTotal(){if(this.retention?.sale?.total_amount)return this.retention.sale.total_amount;let l=this.retention.gross_earning*2,a=this.getPayPalInCommission();return l+a}getPayPalInCommission(){return this.retention?.platform_breakdown?.paypal_receive_commission?this.retention.platform_breakdown.paypal_receive_commission:(this.retention?.sale?.total_amount||this.retention.gross_earning*2+8.4)*.04+4}onDeclare(){this.isDeclaring()||(this.isDeclaring.set(!0),this.taxService.generateCFDI(this.retention._id).subscribe({next:l=>{console.log("\u2705 Declaraci\xF3n exitosa",l),this.retention.status="declared",l?.urls&&(this.retention.cfdi_xml_url=l.urls.xml,this.retention.cfdi_pdf_url=l.urls.pdf),this.isDeclaring.set(!1),this.declared.emit()},error:l=>{console.error("\u274C Error declarando",l),alert("Error al declarar. Intenta de nuevo."),this.isDeclaring.set(!1)}}))}static \u0275fac=function(a){return new(a||o)};static \u0275cmp=D({type:o,selectors:[["app-sale-detail-modal"]],inputs:{retention:"retention"},outputs:{close:"close",declared:"declared"},decls:114,vars:49,consts:[[1,"fixed","inset-0","z-[9999]","flex","items-center","justify-center","p-4","bg-black/80","backdrop-blur-sm",3,"click"],[1,"bg-slate-900","border","border-slate-700","w-full","max-w-4xl","max-h-[90vh]","overflow-y-auto","rounded-2xl","shadow-2xl","relative",3,"click"],[1,"sticky","top-0","z-10","bg-slate-900/95","backdrop-blur","border-b","border-slate-800","p-6","flex","justify-between","items-center"],[1,"flex-1"],[1,"text-2xl","font-bold","text-white"],[1,"flex","items-center","gap-3","mt-1","flex-wrap"],[1,"text-slate-400","text-sm"],[1,"text-lime-400","font-mono"],[1,"bg-green-600","hover:bg-green-700","text-white","text-xs","font-bold","px-3","py-1","rounded-full","transition-all","flex","items-center","gap-2","shadow-lg","shadow-green-500/30",3,"disabled"],[1,"flex","items-center","gap-2"],[1,"p-2","rounded-full","hover:bg-slate-800","text-slate-400","hover:text-white","transition-colors",3,"click"],[1,"fas","fa-times","text-xl"],[1,"p-6","space-y-8"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-blue-500/30","relative","overflow-hidden","group"],[1,"absolute","-right-4","-top-4","w-24","h-24","bg-blue-500/10","rounded-full","blur-2xl","group-hover:bg-blue-500/20","transition-all"],[1,"text-xs","font-semibold","text-blue-400","uppercase","tracking-wider","mb-2"],[1,"text-2xl","font-bold","text-white","mb-1"],[1,"text-xs","text-slate-500"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-yellow-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-yellow-500","uppercase","tracking-wider","mb-2"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-white/20","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-slate-300","uppercase","tracking-wider","mb-2"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-purple-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-purple-400","uppercase","tracking-wider","mb-2"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-red-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-red-400","uppercase","tracking-wider","mb-2"],[1,"flex","justify-between","items-center","mb-1"],[1,"text-slate-400","text-xs"],[1,"text-red-300","font-mono","text-sm"],[1,"flex","justify-between","items-center"],[1,"mt-2","pt-2","border-t","border-slate-700","flex","justify-between"],[1,"text-white","text-xs","font-bold"],[1,"text-red-400","font-bold"],[1,"bg-slate-800/50","p-4","rounded-xl","border","border-orange-500/30","relative","overflow-hidden","group"],[1,"text-xs","font-semibold","text-orange-400","uppercase","tracking-wider","mb-2"],[1,"bg-gradient-to-r","from-lime-900/20","to-green-900/20","p-6","rounded-2xl","border","border-lime-500/30","flex","flex-col","md:flex-row","justify-between","items-center","gap-6"],[1,"flex","items-center","gap-4"],[1,"w-16","h-16","rounded-full","bg-lime-500/20","flex","items-center","justify-center","border","border-lime-500/50"],[1,"fas","fa-money-bill-wave","text-lime-400","text-3xl"],[1,"text-lime-400","font-bold","text-lg"],[1,"text-right"],[1,"text-4xl","font-bold","text-white","tracking-tight"],[1,"text-xs","text-lime-500","font-medium","bg-lime-500/10","px-2","py-1","rounded","inline-block","mt-1"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-8","border-t","border-slate-800","pt-6"],[1,"text-lg","font-bold","text-white","mb-4","flex","items-center","gap-2"],[1,"fas","fa-user-tie","text-purple-400"],[1,"space-y-3"],[1,"bg-slate-800/50","p-4","rounded-lg","border","border-slate-700/50","flex","justify-between","items-center"],[1,"text-slate-400","text-sm","flex","items-center","gap-2"],[1,"fas","fa-calendar","text-slate-500"],[1,"text-white","font-bold"],[1,"fas","fa-flag","text-slate-500"],[1,"uppercase","font-bold","text-xs","px-3","py-1","rounded-full",3,"ngClass"],[1,"bg-slate-800/50","p-4","rounded-lg","border","border-lime-500/30"],[1,"bg-green-600","hover:bg-green-700","text-white","text-xs","font-bold","px-3","py-1","rounded-full","transition-all","flex","items-center","gap-2","shadow-lg","shadow-green-500/30",3,"click","disabled"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-check-double"],["target","_blank",1,"bg-slate-700","hover:bg-slate-600","text-white","text-xs","font-bold","px-3","py-1","rounded-full","transition-all","flex","items-center","gap-2",3,"href"],[1,"fas","fa-download"],[1,"fas","fa-file-pdf"],[1,"flex","items-center","gap-2","mb-2"],[1,"fas","fa-barcode","text-lime-400"],[1,"text-slate-400","text-xs","font-semibold","uppercase"],[1,"text-lime-400","text-xs","font-mono","break-all","block","bg-slate-900/50","p-2","rounded"],[1,"fas","fa-building","text-purple-400"],[1,"bg-slate-800/50","rounded-lg","border","border-slate-700/50","overflow-hidden"],[1,"p-4","flex","justify-between","border-b","border-slate-700/50"],[1,"text-slate-300","text-sm","font-medium"],[1,"p-4","flex","justify-between","border-b","border-slate-700/50","bg-red-500/5"],[1,"fas","fa-credit-card","text-red-400","text-xs"],[1,"text-red-400","font-medium"],[1,"fas","fa-receipt","text-red-400","text-xs"],[1,"p-4","flex","justify-between","bg-emerald-500/10"],[1,"text-emerald-400","font-bold","flex","items-center","gap-2"],[1,"fas","fa-coins","text-emerald-400"],[1,"text-emerald-400","font-bold","text-lg"]],template:function(a,i){if(a&1&&(e(0,"div",0),f("click",function(){return i.close.emit()}),e(1,"div",1),f("click",function(x){return x.stopPropagation()}),e(2,"div",2)(3,"div",3)(4,"h2",4),n(5,"Desglose Fiscal Detallado"),t(),e(6,"div",5)(7,"p",6),n(8,"Venta "),e(9,"span",7),n(10),t()(),v(11,ge,3,2,"button",8),v(12,ve,3,2,"div",9),t()(),e(13,"button",10),f("click",function(){return i.close.emit()}),m(14,"i",11),t()(),e(15,"div",12)(16,"div",13)(17,"div",14),m(18,"div",15),e(19,"p",16),n(20,"1. Cliente Paga"),t(),e(21,"p",17),n(22),s(23,"currency"),t(),e(24,"p",18),n(25,"Monto total de la venta"),t()(),e(26,"div",19)(27,"p",20),n(28,"2. Comisi\xF3n PayPal (In)"),t(),e(29,"p",17),n(30),s(31,"currency"),t(),e(32,"p",18),n(33,"4% + $4.00 MXN"),t()(),e(34,"div",21)(35,"p",22),n(36,"3. Neto a Repartir"),t(),e(37,"p",17),n(38),s(39,"currency"),t(),e(40,"p",18),n(41,"Divisi\xF3n 50/50"),t()(),e(42,"div",23)(43,"p",24),n(44,"4. Bruto Instructor (50%)"),t(),e(45,"p",17),n(46),s(47,"currency"),t()(),e(48,"div",25)(49,"p",26),n(50,"5. Retenciones SAT"),t(),e(51,"div",27)(52,"span",28),n(53,"ISR (10%)"),t(),e(54,"span",29),n(55),s(56,"currency"),t()(),e(57,"div",30)(58,"span",28),n(59,"IVA (10.6%)"),t(),e(60,"span",29),n(61),s(62,"currency"),t()(),e(63,"div",31)(64,"span",32),n(65,"Total"),t(),e(66,"span",33),n(67),s(68,"currency"),t()()(),e(69,"div",34)(70,"p",35),n(71,"6. Comisi\xF3n PayPal (Out)"),t(),e(72,"p",17),n(73),s(74,"currency"),t(),e(75,"p",18),n(76,"Al transferir al instructor"),t()()(),e(77,"div",36)(78,"div",37)(79,"div",38),m(80,"i",39),t(),e(81,"div")(82,"p",40),n(83,"Pago Neto al Instructor"),t(),e(84,"p",6),n(85,"Monto final depositado en cuenta"),t()()(),e(86,"div",41)(87,"p",42),n(88),s(89,"currency"),t(),e(90,"p",43),n(91," Ya descontado impuestos y comisiones "),t()()(),e(92,"div",44)(93,"div")(94,"h3",45),m(95,"i",46),n(96," Estatus Fiscal Instructor "),t(),e(97,"div",47)(98,"div",48)(99,"span",49),m(100,"i",50),n(101," Periodo Fiscal "),t(),e(102,"span",51),n(103),t()(),e(104,"div",48)(105,"span",49),m(106,"i",52),n(107," Estatus Declaraci\xF3n "),t(),e(108,"span",53),v(109,he,1,0)(110,Se,1,0)(111,we,1,0),t()(),v(112,ye,7,1,"div",54),t()(),v(113,Ee,32,16,"div"),t()()()()),a&2){let d;r(10),c(i.retention.sale==null?null:i.retention.sale.code),r(),h(i.retention.status==="pending"?11:-1),r(),h(i.retention.status==="declared"?12:-1),r(10),c(p(23,18,i.getClientTotal(),"MXN")),r(8),u("-",p(31,21,i.getPayPalInCommission(),"MXN")),r(8),c(p(39,24,i.retention.gross_earning*2,"MXN")),r(8),c(p(47,27,i.retention.gross_earning,"MXN")),r(9),u("-",p(56,30,i.retention.isr_retention,"MXN")),r(6),u("-",p(62,33,i.retention.iva_retention,"MXN")),r(6),u("-",p(68,36,i.retention.total_retention,"MXN")),r(6),u("-",p(74,39,i.retention.paypal_send_commission,"MXN")),r(15),c(p(89,42,i.retention.net_pay,"MXN")),r(15),T("",i.retention.month,"/",i.retention.year),r(5),S("ngClass",J(45,xe,i.retention.status==="declared",i.retention.status==="pending",i.retention.status==="paid")),r(),h((d=i.retention.status)==="paid"?109:d==="declared"?110:111),r(3),h(i.retention.status==="declared"&&i.retention.cfdi_uuid?112:-1),r(),h(i.retention.platform_breakdown?113:-1)}},dependencies:[B,K,I],encapsulation:2})};var Ce=(o,l)=>l.value,Me=(o,l)=>l._id;function ke(o,l){if(o&1&&(e(0,"option",11),n(1),t()),o&2){let a=l.$implicit;S("value",a.value),r(),c(a.label)}}function Te(o,l){o&1&&(e(0,"span",76),n(1," PAGADO "),t())}function De(o,l){o&1&&(e(0,"span",77),n(1," DECLARADO "),t())}function Ie(o,l){o&1&&(e(0,"span",78),n(1," PENDIENTE "),t())}function Be(o,l){if(o&1){let a=M();e(0,"tr",61)(1,"td",64)(2,"div",65)(3,"span",66),n(4),s(5,"date"),t(),e(6,"span",67),n(7),t()()(),e(8,"td",68)(9,"div",69)(10,"div",70),n(11),t(),e(12,"div")(13,"p",66),n(14),t(),e(15,"p",67),n(16),t()()()(),e(17,"td",71),n(18),s(19,"currency"),t(),e(20,"td",72),n(21),s(22,"currency"),t(),e(23,"td",73)(24,"span",74),n(25),s(26,"currency"),t()(),e(27,"td",75),v(28,Te,2,0,"span",76)(29,De,2,0,"span",77)(30,Ie,2,0,"span",78),t(),e(31,"td",75)(32,"button",79),f("click",function(){let d=w(a).$implicit,x=g();return y(x.openDetail(d))}),m(33,"i",80),t()()()}if(o&2){let a,i=l.$implicit;r(4),c(p(5,11,i.sale==null?null:i.sale.createdAt,"mediumDate")),r(3),c(i.sale==null?null:i.sale.code),r(4),T(" ",i.instructor==null||i.instructor.name==null?null:i.instructor.name.charAt(0),"",i.instructor==null||i.instructor.surname==null?null:i.instructor.surname.charAt(0)," "),r(3),T("",i.instructor==null?null:i.instructor.name," ",i.instructor==null?null:i.instructor.surname),r(2),c(i.instructor==null?null:i.instructor.email),r(2),u(" ",p(19,14,i.gross_earning,"MXN")," "),r(3),u(" -",p(22,17,i.total_retention,"MXN")," "),r(4),u(" ",p(26,20,i.net_pay,"MXN")," "),r(3),h((a=i.status)==="paid"?28:a==="declared"?29:30)}}function Ne(o,l){o&1&&(e(0,"tr")(1,"td",81),m(2,"i",82),e(3,"p"),n(4,"No hay registros fiscales para este periodo."),t()()())}function Pe(o,l){if(o&1){let a=M();e(0,"div",62)(1,"p",83),n(2," Mostrando p\xE1gina "),e(3,"span",84),n(4),t(),n(5," de "),e(6,"span",84),n(7),t(),n(8),t(),e(9,"div",85)(10,"button",86),f("click",function(){w(a);let d=g();return y(d.changePage(d.pagination().page-1))}),n(11," Anterior "),t(),e(12,"button",86),f("click",function(){w(a);let d=g();return y(d.changePage(d.pagination().page+1))}),n(13," Siguiente "),t()()()}if(o&2){let a=g();r(4),c(a.pagination().page),r(3),c(a.pagination().totalPages),r(),u(" (Total: ",a.pagination().totalDocs," registros) "),r(2),S("disabled",a.pagination().page===1),r(2),S("disabled",a.pagination().page>=a.pagination().totalPages)}}function Ae(o,l){if(o&1){let a=M();e(0,"app-sale-detail-modal",87),f("close",function(){w(a);let d=g();return y(d.selectedSale.set(null))})("declared",function(){w(a);let d=g();return y(d.loadData())}),t()}if(o&2){let a=g();S("retention",a.selectedSale())}}var pe=class o{taxService=C(k);selectedMonth=_(new Date().getMonth()+1);selectedYear=_(new Date().getFullYear());selectedStatus=_("all");sales=_([]);totals=_(null);pagination=_(null);selectedSale=_(null);searchQuery=_("");currentPage=_(1);itemsPerPage=_(20);searchTimeout;months=[{value:1,label:"Enero"},{value:2,label:"Febrero"},{value:3,label:"Marzo"},{value:4,label:"Abril"},{value:5,label:"Mayo"},{value:6,label:"Junio"},{value:7,label:"Julio"},{value:8,label:"Agosto"},{value:9,label:"Septiembre"},{value:10,label:"Octubre"},{value:11,label:"Noviembre"},{value:12,label:"Diciembre"}];ngOnInit(){this.loadData()}ngOnDestroy(){this.searchTimeout&&clearTimeout(this.searchTimeout)}loadData(){console.log("\u{1F504} [TaxBreakdown] Cargando datos...",{month:this.selectedMonth(),year:this.selectedYear(),status:this.selectedStatus(),search:this.searchQuery(),page:this.currentPage()}),this.taxService.getSalesBreakdown(this.selectedMonth(),this.selectedYear(),this.searchQuery(),this.currentPage(),this.itemsPerPage(),this.selectedStatus()).subscribe({next:l=>{l.success&&(this.sales.set(l.data),this.totals.set(l.totals),this.pagination.set(l.pagination),console.log("\u2705 [TaxBreakdown] Datos cargados:",l.data.length,"registros"))},error:l=>{console.error("\u274C [TaxBreakdown] Error:",l)}})}onFilterChange(){console.log("\u{1F50D} [TaxBreakdown] Filtro cambiado"),this.currentPage.set(1),this.loadData()}onSearch(l){let a=l.target.value;this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{console.log("\u{1F50D} [TaxBreakdown] B\xFAsqueda:",a),this.searchQuery.set(a),this.currentPage.set(1),this.loadData()},500)}changePage(l){l<1||this.pagination()&&l>this.pagination().totalPages||(console.log("\u{1F4C4} [TaxBreakdown] Cambio de p\xE1gina:",l),this.currentPage.set(l),this.loadData())}openDetail(l){console.log("\u{1F441}\uFE0F [TaxBreakdown] Abriendo detalle:",l),this.selectedSale.set(l)}exportToExcel(){console.log("\u{1F4CA} [TaxBreakdown] Exportando..."),this.taxService.exportRetentions(this.selectedMonth(),this.selectedYear(),this.searchQuery(),this.selectedStatus()).subscribe({next:l=>{let a=window.URL.createObjectURL(l),i=document.createElement("a");i.href=a,i.download=`reporte_fiscal_${this.selectedMonth()}_${this.selectedYear()}.csv`,i.click(),window.URL.revokeObjectURL(a),console.log("\u2705 [TaxBreakdown] Exportado exitosamente")},error:l=>{console.error("\u274C [TaxBreakdown] Error en exportaci\xF3n:",l)}})}static \u0275fac=function(a){return new(a||o)};static \u0275cmp=D({type:o,selectors:[["app-admin-tax-breakdown"]],decls:169,vars:59,consts:[[1,"p-6","space-y-6","animate-fade-in-down"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","gap-4"],[1,"text-3xl","font-bold","bg-gradient-to-r","from-lime-400","to-green-500","bg-clip-text","text-transparent"],[1,"text-slate-400","mt-1"],[1,"flex","gap-3"],[1,"btn-secondary","flex","items-center","gap-2",3,"click"],[1,"fas","fa-file-excel","text-green-500"],[1,"grid","grid-cols-1","md:grid-cols-5","gap-4","bg-slate-800/50","p-4","rounded-xl","border","border-slate-700/50","backdrop-blur-sm"],[1,"form-group"],[1,"text-xs","font-semibold","text-slate-400","uppercase","tracking-wider","mb-2","block"],[1,"w-full","bg-slate-900","border","border-slate-700","text-white","rounded-lg","p-2.5","focus:ring-lime-500","focus:border-lime-500","transition-all",3,"ngModelChange","ngModel"],[3,"value"],["type","number",1,"w-full","bg-slate-900","border","border-slate-700","text-white","rounded-lg","p-2.5","focus:ring-lime-500","focus:border-lime-500","transition-all",3,"ngModelChange","ngModel"],["value","all"],["value","pending"],["value","declared"],["value","paid"],[1,"form-group","md:col-span-2"],["type","text","placeholder","Nombre o email del instructor...",1,"w-full","bg-slate-900","border","border-slate-700","text-white","rounded-lg","p-2.5","focus:ring-lime-500","focus:border-lime-500","transition-all","placeholder-slate-500",3,"input"],[1,"space-y-8","mb-8","bg-slate-800/20","p-6","rounded-2xl","border","border-slate-700/30"],[1,"relative"],[1,"absolute","top-1/2","left-0","w-full","h-0.5","bg-slate-700/50","-z-10","hidden","md:block"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6","text-center"],[1,"bg-slate-900","border-2","border-slate-700","p-5","rounded-2xl","relative","z-10","shadow-xl"],[1,"text-slate-400","text-xs","uppercase","tracking-wider","font-bold","mb-2"],[1,"text-3xl","font-bold","text-white"],[1,"text-xs","text-slate-500","mt-1"],[1,"bg-slate-900","border-2","border-red-500/30","p-5","rounded-2xl","relative","z-10","shadow-xl"],[1,"absolute","-top-3","left-1/2","-translate-x-1/2","bg-slate-900","px-3","text-slate-500","text-xs","font-bold","uppercase"],[1,"text-red-400","text-xs","uppercase","tracking-wider","font-bold","mb-2"],[1,"text-3xl","font-bold","text-red-500"],[1,"bg-slate-900","border-2","border-blue-500/30","p-5","rounded-2xl","relative","z-10","shadow-xl"],[1,"text-blue-400","text-xs","uppercase","tracking-wider","font-bold","mb-2"],[1,"text-3xl","font-bold","text-blue-500"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-12","border-t","border-slate-700/50","pt-8"],[1,"space-y-4"],[1,"flex","justify-between","items-center","border-b","border-slate-700","pb-3"],[1,"text-white","text-xl","font-bold","flex","items-center","gap-3"],[1,"w-4","h-4","rounded-full","bg-lime-500","shadow-lg","shadow-lime-500/50"],[1,"text-2xl","font-bold","text-white"],[1,"space-y-3","text-sm"],[1,"flex","justify-between","text-slate-400"],[1,"text-white"],[1,"flex","justify-between","text-red-400","bg-red-500/5","p-2","rounded-lg"],[1,"bg-gradient-to-br","from-lime-500/10","to-transparent","border","border-lime-500/30","p-6","rounded-2xl","mt-6","relative","overflow-hidden"],[1,"absolute","right-0","top-0","p-4","opacity-10"],[1,"fas","fa-users","text-6xl","text-lime-500"],[1,"text-lime-500","text-sm","font-bold","uppercase","mb-1"],[1,"text-4xl","font-bold","text-white"],[1,"text-xs","text-slate-400","mt-2"],[1,"w-4","h-4","rounded-full","bg-purple-500","shadow-lg","shadow-purple-500/50"],[1,"bg-gradient-to-br","from-purple-500/10","to-transparent","border","border-purple-500/30","p-6","rounded-2xl","mt-6","relative","overflow-hidden"],[1,"fas","fa-building","text-6xl","text-purple-500"],[1,"text-purple-500","text-sm","font-bold","uppercase","mb-1"],[1,"relative","overflow-x-auto","rounded-xl","border","border-slate-700/50","shadow-xl"],[1,"w-full","text-left","text-sm","text-slate-400"],[1,"bg-slate-900/80","text-xs","uppercase","text-slate-300"],[1,"px-6","py-4","font-semibold"],[1,"px-6","py-4","font-semibold","text-right"],[1,"px-6","py-4","font-semibold","text-center"],[1,"divide-y","divide-slate-700/50","bg-slate-800/30"],[1,"hover:bg-slate-700/30","transition-colors"],[1,"flex","flex-col","md:flex-row","justify-between","items-center","gap-4","mt-6"],[3,"retention"],[1,"px-6","py-4","whitespace-nowrap"],[1,"flex","flex-col"],[1,"text-white","font-medium"],[1,"text-xs","text-slate-500"],[1,"px-6","py-4"],[1,"flex","items-center","gap-3"],[1,"w-8","h-8","rounded-full","bg-slate-700","flex","items-center","justify-center","text-xs","font-bold","text-white"],[1,"px-6","py-4","text-right","text-white","font-medium"],[1,"px-6","py-4","text-right","text-red-400","font-medium"],[1,"px-6","py-4","text-right"],[1,"text-lime-400","font-bold","bg-lime-400/10","px-2","py-1","rounded-lg"],[1,"px-6","py-4","text-center"],[1,"px-3","py-1","rounded-full","text-xs","font-bold","bg-green-500/10","text-green-500","border","border-green-500/20"],[1,"px-3","py-1","rounded-full","text-xs","font-bold","bg-purple-500/10","text-purple-500","border","border-purple-500/20"],[1,"px-3","py-1","rounded-full","text-xs","font-bold","bg-yellow-500/10","text-yellow-500","border","border-yellow-500/20"],["title","Ver Desglose Completo",1,"p-2","rounded-lg","hover:bg-slate-700","text-slate-400","hover:text-white","transition-all","z-50","relative",3,"click"],[1,"fas","fa-calculator"],["colspan","7",1,"px-6","py-12","text-center","text-slate-500"],[1,"fas","fa-inbox","text-4xl","mb-4","text-slate-600"],[1,"text-sm","text-slate-400"],[1,"font-bold","text-white"],[1,"flex","gap-2"],[1,"px-4","py-2","rounded-lg","bg-slate-800","border","border-slate-700","text-slate-300","hover:bg-slate-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-all",3,"click","disabled"],[3,"close","declared","retention"]],template:function(a,i){if(a&1&&(e(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),n(4," Desglose Fiscal y Retenciones "),t(),e(5,"p",3),n(6,"Gesti\xF3n de impuestos, comisiones y pagos a instructores"),t()(),e(7,"div",4)(8,"button",5),f("click",function(){return i.exportToExcel()}),m(9,"i",6),n(10," Exportar Reporte "),t()()(),e(11,"div",7)(12,"div",8)(13,"label",9),n(14,"Mes"),t(),e(15,"select",10),f("ngModelChange",function(x){return i.selectedMonth.set(x),i.onFilterChange()}),F(16,ke,2,2,"option",11,Ce),t()(),e(18,"div",8)(19,"label",9),n(20,"A\xF1o"),t(),e(21,"input",12),f("ngModelChange",function(x){return i.selectedYear.set(x),i.onFilterChange()}),t()(),e(22,"div",8)(23,"label",9),n(24,"Estado"),t(),e(25,"select",10),f("ngModelChange",function(x){return i.selectedStatus.set(x),i.onFilterChange()}),e(26,"option",13),n(27,"Todos"),t(),e(28,"option",14),n(29,"Pendiente"),t(),e(30,"option",15),n(31,"Declarado"),t(),e(32,"option",16),n(33,"Pagado"),t()()(),e(34,"div",17)(35,"label",9),n(36," \u{1F50D} Buscar Instructor "),t(),e(37,"input",18),f("input",function(x){return i.onSearch(x)}),t()()(),e(38,"div",19)(39,"div",20),m(40,"div",21),e(41,"div",22)(42,"div",23)(43,"p",24),n(44),t(),e(45,"h3",25),n(46),s(47,"currency"),t(),e(48,"p",26),n(49,"Ingreso Bruto Total"),t()(),e(50,"div",27)(51,"div",28),n(52,"Menos"),t(),e(53,"p",29),n(54,"2. PayPal (Entrada)"),t(),e(55,"h3",30),n(56),s(57,"currency"),t(),e(58,"p",26),n(59,"Comisiones por recibir pagos"),t()(),e(60,"div",31)(61,"div",28),n(62,"Igual a"),t(),e(63,"p",32),n(64,"3. A Repartir"),t(),e(65,"h3",33),n(66),s(67,"currency"),t(),e(68,"p",26),n(69,"Base repartible (100%)"),t()()()(),e(70,"div",34)(71,"div",35)(72,"div",36)(73,"h4",37),m(74,"div",38),n(75," Instructores (50%) "),t(),e(76,"span",39),n(77),s(78,"currency"),t()(),e(79,"div",40)(80,"div",41)(81,"span"),n(82,"Participaci\xF3n Bruta"),t(),e(83,"span",42),n(84),s(85,"currency"),t()(),e(86,"div",43)(87,"span"),n(88,"Retenciones ISR Global"),t(),e(89,"span"),n(90),s(91,"currency"),t()(),e(92,"div",43)(93,"span"),n(94,"Retenciones IVA Global"),t(),e(95,"span"),n(96),s(97,"currency"),t()()(),e(98,"div",44)(99,"div",45),m(100,"i",46),t(),e(101,"p",47),n(102,"Total a Pagar a Instructores"),t(),e(103,"h3",48),n(104),s(105,"currency"),t(),e(106,"p",49),n(107,"Ya descontado impuestos"),t()()(),e(108,"div",35)(109,"div",36)(110,"h4",37),m(111,"div",50),n(112," Plataforma (50%) "),t(),e(113,"span",39),n(114),s(115,"currency"),t()(),e(116,"div",40)(117,"div",41)(118,"span"),n(119,"Participaci\xF3n Bruta"),t(),e(120,"span",42),n(121),s(122,"currency"),t()(),e(123,"div",43)(124,"span"),n(125,"Costos PayPal (Env\xEDo Masivo)"),t(),e(126,"span"),n(127),s(128,"currency"),t()(),e(129,"div",43)(130,"span"),n(131,"Impuestos Propios (ISR+IVA)"),t(),e(132,"span"),n(133),s(134,"currency"),t()()(),e(135,"div",51)(136,"div",45),m(137,"i",52),t(),e(138,"p",53),n(139,"Utilidad Neta Plataforma"),t(),e(140,"h3",48),n(141),s(142,"currency"),t(),e(143,"p",49),n(144,"Libre de polvo y paja"),t()()()()(),e(145,"div",54)(146,"table",55)(147,"thead",56)(148,"tr")(149,"th",57),n(150,"Fecha"),t(),e(151,"th",57),n(152,"Instructor"),t(),e(153,"th",58),n(154,"Bruto (50%)"),t(),e(155,"th",58),n(156,"Retenciones"),t(),e(157,"th",58),n(158,"Neto A Pagar"),t(),e(159,"th",59),n(160,"Estado"),t(),e(161,"th",59),n(162,"Acciones"),t()()(),e(163,"tbody",60),F(164,Be,34,23,"tr",61,Me),v(166,Ne,5,0,"tr"),t()()(),v(167,Pe,14,5,"div",62),t(),v(168,Ae,1,1,"app-sale-detail-modal",63)),a&2){let d,x,E,b,O,R,U,$,Y,z,L,G,Q,q;r(15),S("ngModel",i.selectedMonth()),r(),X(i.months),r(5),S("ngModel",i.selectedYear()),r(4),S("ngModel",i.selectedStatus()),r(19),u("1. Venta Total (",((d=i.totals())==null?null:d.sales_count)||0," Ventas)"),r(2),c(p(47,20,(x=i.totals())==null?null:x.total_sales_volume,"MXN")),r(10),u("-",p(57,23,(E=i.totals())==null?null:E.total_paypal_receive,"MXN")),r(10),c(p(67,26,(b=i.totals())==null?null:b.total_distributable,"MXN")),r(11),c(p(78,29,(O=i.totals())==null?null:O.total_gross,"MXN")),r(7),c(p(85,32,(R=i.totals())==null?null:R.total_gross,"MXN")),r(6),u("-",p(91,35,(U=i.totals())==null?null:U.total_instructor_isr,"MXN")),r(6),u("-",p(97,38,($=i.totals())==null?null:$.total_instructor_iva,"MXN")),r(8),c(p(105,41,(Y=i.totals())==null?null:Y.total_net_pay,"MXN")),r(10),c(p(115,44,(z=i.totals())==null?null:z.platform_share,"MXN")),r(7),c(p(122,47,(L=i.totals())==null?null:L.platform_share,"MXN")),r(6),u("-",p(128,50,(G=i.totals())==null?null:G.total_paypal_send,"MXN")),r(6),u("-",p(134,53,(Q=i.totals())==null?null:Q.platform_taxes,"MXN")),r(8),c(p(142,56,(q=i.totals())==null?null:q.platform_net_profit,"MXN")),r(23),X(i.sales()),r(2),h(i.sales().length===0?166:-1),r(),h(i.pagination()?167:-1),r(),h(i.selectedSale()?168:-1)}},dependencies:[B,de,re,oe,te,le,ae,ne,ie,N,I,W],encapsulation:2})};export{k as a,pe as b};
