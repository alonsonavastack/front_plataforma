import{a as m}from"./chunk-HN3U4OFT.js";import{Hc as a,Jc as c,K as i,O as g,T as u,ja as e}from"./chunk-6JS7X5LE.js";var l=class o{http=u(c);apiUrl=`${m.url}admin`;instructors=e([]);instructorsSummary=e(null);isLoadingInstructors=e(!1);instructorsError=e(null);earnings=e([]);instructor=e(null);paymentConfig=e(null);earningsTotals=e(null);isLoadingEarnings=e(!1);earningsError=e(null);paymentsHistory=e([]);paymentsPagination=e(null);isLoadingPaymentsHistory=e(!1);paymentsHistoryError=e(null);commissionSettings=e(null);isLoadingCommission=e(!1);commissionError=e(null);loadInstructors(t={}){this.isLoadingInstructors.set(!0),this.instructorsError.set(null);let s=new a().set("status",t.status||"all").set("minAmount",(t.minAmount||0).toString());return t.paymentMethod&&t.paymentMethod!=="all"&&(s=s.set("paymentMethod",t.paymentMethod)),t.startDate&&(s=s.set("startDate",t.startDate)),t.endDate&&(s=s.set("endDate",t.endDate)),this.http.get(`${this.apiUrl}/instructors/payments`,{params:s}).pipe(i({next:n=>{console.log("\u2705 [AdminPaymentService] Instructores cargados:",n.instructors.length),this.instructors.set(n.instructors),this.instructorsSummary.set(n.summary),this.isLoadingInstructors.set(!1)},error:n=>{console.error("\u274C [AdminPaymentService] Error al cargar instructores:",n),this.instructorsError.set(n),this.isLoadingInstructors.set(!1)}}))}loadInstructorEarnings(t,s={}){this.isLoadingEarnings.set(!0),this.earningsError.set(null);let n=new a;return s.status&&(n=n.set("status",s.status)),s.startDate&&(n=n.set("startDate",s.startDate)),s.endDate&&(n=n.set("endDate",s.endDate)),this.http.get(`${this.apiUrl}/instructors/${t}/earnings`,{params:n}).pipe(i({next:r=>{console.log("\u2705 [AdminPaymentService] Ganancias cargadas:",{count:r.earnings.length,totals:r.totals}),this.earnings.set(r.earnings),this.instructor.set(r.instructor),this.paymentConfig.set(r.paymentConfig),this.earningsTotals.set(r.totals),this.isLoadingEarnings.set(!1)},error:r=>{console.error("\u274C [AdminPaymentService] Error al cargar ganancias:",r),this.earningsError.set(r),this.isLoadingEarnings.set(!1)}}))}loadPaymentsHistory(t={}){this.isLoadingPaymentsHistory.set(!0),this.paymentsHistoryError.set(null);let s=new a;return t.status&&(s=s.set("status",t.status)),t.instructor&&(s=s.set("instructor",t.instructor)),s=s.set("page",(t.page||1).toString()),s=s.set("limit",(t.limit||10).toString()),this.http.get(`${this.apiUrl}/payments`,{params:s}).pipe(i({next:n=>{this.paymentsHistory.set(n.payments),this.paymentsPagination.set(n.pagination),this.isLoadingPaymentsHistory.set(!1)},error:n=>{this.paymentsHistoryError.set(n),this.isLoadingPaymentsHistory.set(!1)}}))}loadCommissionSettings(){return this.isLoadingCommission.set(!0),this.commissionError.set(null),this.http.get(`${this.apiUrl}/commission-settings`).pipe(i({next:t=>{this.commissionSettings.set(t.settings),this.isLoadingCommission.set(!1)},error:t=>{this.commissionError.set(t),this.isLoadingCommission.set(!1)}}))}reloadCommissionSettings(){this.loadCommissionSettings().subscribe({next:()=>{},error:()=>{}})}createPayment(t,s){return this.http.post(`${this.apiUrl}/instructors/${t}/payment`,s)}processPayment(t,s){return this.http.put(`${this.apiUrl}/payments/${t}/process`,s)}completePayment(t){return this.http.put(`${this.apiUrl}/payments/${t}/complete`,{})}updateCommissionSettings(t){return this.http.put(`${this.apiUrl}/commission-settings`,t)}setCustomCommission(t){return this.http.post(`${this.apiUrl}/commission-settings/custom`,t)}removeCustomCommission(t){return this.http.delete(`${this.apiUrl}/commission-settings/custom/${t}`)}getEarningsReport(t={}){let s=new a;return t.period&&(s=s.set("period",t.period)),t.startDate&&(s=s.set("startDate",t.startDate)),t.endDate&&(s=s.set("endDate",t.endDate)),this.http.get(`${this.apiUrl}/earnings/report`,{params:s})}getInstructorPaymentMethodFull(t){return this.http.get(`${this.apiUrl}/instructors/${t}/payment-method-full`)}processExistingSales(){return this.http.post(`${m.url}sales/process-existing-sales`,{})}static \u0275fac=function(s){return new(s||o)};static \u0275prov=g({token:o,factory:o.\u0275fac,providedIn:"root"})};export{l as a};
