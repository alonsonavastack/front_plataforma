import{a as i_}from"./chunk-CLFC5WXD.js";import{a as n_}from"./chunk-46K2XGCN.js";import{a as Gi}from"./chunk-FK6H3RFT.js";import{a as Xv}from"./chunk-ZBE3WPAK.js";import{a as Yv}from"./chunk-4PZZPEWR.js";import{a as Kv}from"./chunk-DCNNRG7A.js";import{a as Zv}from"./chunk-GYSWFE3Q.js";import{a as Jv}from"./chunk-27AZ2KFX.js";import{a as Qv}from"./chunk-JBZEKW65.js";import{a as e_}from"./chunk-BJQ54AD6.js";import"./chunk-L7F5BNF7.js";import{a as t_}from"./chunk-SJMDVRKM.js";import{a as qv,b as Gv}from"./chunk-LQTOGFGK.js";import{a as $v}from"./chunk-7BWI4IZO.js";import{a as Ov,b as Vv}from"./chunk-5TNT62OS.js";import"./chunk-4T3EWW2O.js";import"./chunk-4KUF7IXL.js";import{a as Af}from"./chunk-K7WP7JBI.js";import{a as Ff}from"./chunk-KBA3WCNC.js";import"./chunk-RHIE2QCX.js";import{b as tl,c as z0}from"./chunk-3T36YCHW.js";import{b as Nv,c as Pv,d as Mv,e as Lv}from"./chunk-R5HHEV5R.js";import{a as Df,b as Iv,c as Rv}from"./chunk-UD4Q7ATB.js";import{a as Ns}from"./chunk-337JWICE.js";import"./chunk-DR63PX3D.js";import{b as pn}from"./chunk-2RMWUCMB.js";import{a as zv}from"./chunk-SELBDG3F.js";import{a as Uv}from"./chunk-NOVASSOE.js";import{c as Fv,e as el,f as Dv}from"./chunk-UKUKXRH6.js";import{a as Hv}from"./chunk-QAUPV5TE.js";import{a as Wv}from"./chunk-3YSSQHNS.js";import{a as ua}from"./chunk-TCGJFX72.js";import"./chunk-BFW6RN7Z.js";import{a as Nf,b as ki,c as bi,d as wi,e as dr,f as Ps,h as ui,i as zn,j as Wa,k as Pf,l as Bv,n as Ur,o as fr,p as hr,q as Hn,r as Wn,t as jv,u as Mf,v as Lf,w as mn,x as pr}from"./chunk-SDJWNAN2.js";import{a as $t}from"./chunk-J4IQXLML.js";import{$ as xt,$b as Ef,Ab as Sf,Ac as yn,B as pv,Bb as Cf,Cb as Sv,D as mv,Db as uo,Eb as oi,Fb as Li,Gb as x,Gc as Av,Ha as Ui,Hb as Ve,Hc as Un,I as gv,Ib as Re,Ic as Qo,Jb as hi,Jc as ur,K as lr,Ka as vv,Kb as Ha,La as _v,Lb as tr,Ma as S,Mb as ir,Nb as nr,O as cr,Rb as Cv,S as Qp,Sa as bv,T as lt,Ta as _f,Ub as Ev,Wb as Fs,Xa as Bt,Y as be,Z as we,Za as wv,_ as st,_b as Jr,ab as Vr,ac as us,bc as em,d as V0,ea as mu,ec as Ge,fb as yv,fc as kv,gb as bf,hb as xe,hc as Ta,ib as ve,ic as Qr,ja as Ae,jb as Zl,k as os,ka as gu,kb as wf,lb as zt,mb as Ht,nb as Ce,ob as f,pa as xv,pb as p,qb as ce,rb as Ue,sb as je,tb as ln,ub as nt,uc as Ds,v as fv,vb as cs,vc as kf,wb as ue,wc as U0,x as hv,xb as Mn,yb as q,yc as Tf,z as ls,zb as yf,zc as Tv}from"./chunk-6JS7X5LE.js";import{a as At,b as It,d as HC}from"./chunk-I4MTPUBM.js";var If=class i{http=lt(ur);base=$t.url;state=Ae({kpis:[],monthlyIncome:[],distribution:null,recentActivity:[],executiveMetrics:null,isLoadingKpis:!1,isLoadingMonthlyIncome:!1,isLoadingDistribution:!1,isLoadingRecentActivity:!1,isLoadingExecutiveMetrics:!1,error:null});kpis=Ge(()=>this.state().kpis);monthlyIncome=Ge(()=>this.state().monthlyIncome);distribution=Ge(()=>this.state().distribution);recentActivity=Ge(()=>this.state().recentActivity);executiveMetrics=Ge(()=>this.state().executiveMetrics);isLoadingKpis=Ge(()=>this.state().isLoadingKpis);isLoadingMonthlyIncome=Ge(()=>this.state().isLoadingMonthlyIncome);isLoadingDistribution=Ge(()=>this.state().isLoadingDistribution);isLoadingRecentActivity=Ge(()=>this.state().isLoadingRecentActivity);isLoadingExecutiveMetrics=Ge(()=>this.state().isLoadingExecutiveMetrics);error=Ge(()=>this.state().error);excludeTestData=Ae(!1);reloadKpis(){this.state.update(t=>It(At({},t),{isLoadingKpis:!0})),this.http.get(`${this.base}dashboard/kpis`).pipe(lr(t=>this.state.update(e=>It(At({},e),{kpis:t,isLoadingKpis:!1}))),ls(t=>(this.state.update(e=>It(At({},e),{error:t,isLoadingKpis:!1})),os(()=>t)))).subscribe()}loadMonthlyIncome(){this.state.update(t=>It(At({},t),{isLoadingMonthlyIncome:!0})),this.http.get(`${this.base}dashboard/monthlyIncome`).pipe(lr(t=>this.state.update(e=>It(At({},e),{monthlyIncome:t,isLoadingMonthlyIncome:!1}))),ls(t=>(this.state.update(e=>It(At({},e),{error:t,isLoadingMonthlyIncome:!1})),os(()=>t)))).subscribe()}loadDistribution(){this.state.update(t=>It(At({},t),{isLoadingDistribution:!0})),this.http.get(`${this.base}dashboard/distribution`).pipe(lr(t=>this.state.update(e=>It(At({},e),{distribution:t,isLoadingDistribution:!1}))),ls(t=>(this.state.update(e=>It(At({},e),{error:t,isLoadingDistribution:!1})),os(()=>t)))).subscribe()}loadRecentActivity(){this.state.update(t=>It(At({},t),{isLoadingRecentActivity:!0})),this.http.get(`${this.base}dashboard/recentActivity`).pipe(lr(t=>this.state.update(e=>It(At({},e),{recentActivity:t,isLoadingRecentActivity:!1}))),ls(t=>(this.state.update(e=>It(At({},e),{error:t,isLoadingRecentActivity:!1})),os(()=>t)))).subscribe()}loadExecutiveMetrics(){this.state.update(e=>It(At({},e),{isLoadingExecutiveMetrics:!0}));let t=this.excludeTestData()?"?excludeTests=true":"";this.http.get(`${this.base}dashboard/executive-metrics${t}`).pipe(lr(e=>{this.state.update(n=>It(At({},n),{executiveMetrics:e,isLoadingExecutiveMetrics:!1}))}),ls(e=>(this.state.update(n=>It(At({},n),{error:e,isLoadingExecutiveMetrics:!1})),os(()=>e)))).subscribe()}toggleTestDataFilter(){this.excludeTestData.update(t=>!t),this.loadExecutiveMetrics()}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var ds=Object.create(null);ds.open="0";ds.close="1";ds.ping="2";ds.pong="3";ds.message="4";ds.upgrade="5";ds.noop="6";var xu=Object.create(null);Object.keys(ds).forEach(i=>{xu[ds[i]]=i});var vu={type:"error",data:"parser error"};var s_=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",o_=typeof ArrayBuffer=="function",l_=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,_u=({type:i,data:t},e,n)=>s_&&t instanceof Blob?e?n(t):r_(t,n):o_&&(t instanceof ArrayBuffer||l_(t))?e?n(t):r_(new Blob([t]),n):n(ds[i]+(t||"")),r_=(i,t)=>{let e=new FileReader;return e.onload=function(){let n=e.result.split(",")[1];t("b"+(n||""))},e.readAsDataURL(i)};function a_(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}var tm;function c_(i,t){if(s_&&i.data instanceof Blob)return i.data.arrayBuffer().then(a_).then(t);if(o_&&(i.data instanceof ArrayBuffer||l_(i.data)))return t(a_(i.data));_u(i,!1,e=>{tm||(tm=new TextEncoder),t(tm.encode(e))})}var u_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<u_.length;i++)bu[u_.charCodeAt(i)]=i;var d_=i=>{let t=i.length*.75,e=i.length,n,r=0,a,s,o,l;i[i.length-1]==="="&&(t--,i[i.length-2]==="="&&t--);let c=new ArrayBuffer(t),u=new Uint8Array(c);for(n=0;n<e;n+=4)a=bu[i.charCodeAt(n)],s=bu[i.charCodeAt(n+1)],o=bu[i.charCodeAt(n+2)],l=bu[i.charCodeAt(n+3)],u[r++]=a<<2|s>>4,u[r++]=(s&15)<<4|o>>2,u[r++]=(o&3)<<6|l&63;return c};var WC=typeof ArrayBuffer=="function",wu=(i,t)=>{if(typeof i!="string")return{type:"message",data:f_(i,t)};let e=i.charAt(0);return e==="b"?{type:"message",data:qC(i.substring(1),t)}:xu[e]?i.length>1?{type:xu[e],data:i.substring(1)}:{type:xu[e]}:vu},qC=(i,t)=>{if(WC){let e=d_(i);return f_(e,t)}else return{base64:!0,data:i}},f_=(i,t)=>{switch(t){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}};var h_="",p_=(i,t)=>{let e=i.length,n=new Array(e),r=0;i.forEach((a,s)=>{_u(a,!1,o=>{n[s]=o,++r===e&&t(n.join(h_))})})},m_=(i,t)=>{let e=i.split(h_),n=[];for(let r=0;r<e.length;r++){let a=wu(e[r],t);if(n.push(a),a.type==="error")break}return n};function g_(){return new TransformStream({transform(i,t){c_(i,e=>{let n=e.length,r;if(n<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,n);else if(n<65536){r=new Uint8Array(3);let a=new DataView(r.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{r=new Uint8Array(9);let a=new DataView(r.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}i.data&&typeof i.data!="string"&&(r[0]|=128),t.enqueue(r),t.enqueue(e)})}})}var im;function Rf(i){return i.reduce((t,e)=>t+e.length,0)}function Of(i,t){if(i[0].length===t)return i.shift();let e=new Uint8Array(t),n=0;for(let r=0;r<t;r++)e[r]=i[0][n++],n===i[0].length&&(i.shift(),n=0);return i.length&&n<i[0].length&&(i[0]=i[0].slice(n)),e}function x_(i,t){im||(im=new TextDecoder);let e=[],n=0,r=-1,a=!1;return new TransformStream({transform(s,o){for(e.push(s);;){if(n===0){if(Rf(e)<1)break;let l=Of(e,1);a=(l[0]&128)===128,r=l[0]&127,r<126?n=3:r===126?n=1:n=2}else if(n===1){if(Rf(e)<2)break;let l=Of(e,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(n===2){if(Rf(e)<8)break;let l=Of(e,8),c=new DataView(l.buffer,l.byteOffset,l.length),u=c.getUint32(0);if(u>Math.pow(2,21)-1){o.enqueue(vu);break}r=u*Math.pow(2,32)+c.getUint32(4),n=3}else{if(Rf(e)<r)break;let l=Of(e,r);o.enqueue(wu(a?l:im.decode(l),t)),n=0}if(r===0||r>i){o.enqueue(vu);break}}}})}var nm=4;function rn(i){if(i)return GC(i)}function GC(i){for(var t in rn.prototype)i[t]=rn.prototype[t];return i}rn.prototype.on=rn.prototype.addEventListener=function(i,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(t),this};rn.prototype.once=function(i,t){function e(){this.off(i,e),t.apply(this,arguments)}return e.fn=t,this.on(i,e),this};rn.prototype.off=rn.prototype.removeListener=rn.prototype.removeAllListeners=rn.prototype.removeEventListener=function(i,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+i];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var n,r=0;r<e.length;r++)if(n=e[r],n===t||n.fn===t){e.splice(r,1);break}return e.length===0&&delete this._callbacks["$"+i],this};rn.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+i],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e){e=e.slice(0);for(var n=0,r=e.length;n<r;++n)e[n].apply(this,t)}return this};rn.prototype.emitReserved=rn.prototype.emit;rn.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};rn.prototype.hasListeners=function(i){return!!this.listeners(i).length};var fo=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0),ea=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),v_="arraybuffer";function Bf(i,...t){return t.reduce((e,n)=>(i.hasOwnProperty(n)&&(e[n]=i[n]),e),{})}var $C=ea.setTimeout,XC=ea.clearTimeout;function ho(i,t){t.useNativeTimers?(i.setTimeoutFn=$C.bind(ea),i.clearTimeoutFn=XC.bind(ea)):(i.setTimeoutFn=ea.setTimeout.bind(ea),i.clearTimeoutFn=ea.clearTimeout.bind(ea))}var YC=1.33;function __(i){return typeof i=="string"?KC(i):Math.ceil((i.byteLength||i.size)*YC)}function KC(i){let t=0,e=0;for(let n=0,r=i.length;n<r;n++)t=i.charCodeAt(n),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(n++,e+=4);return e}function jf(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function b_(i){let t="";for(let e in i)i.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(i[e]));return t}function w_(i){let t={},e=i.split("&");for(let n=0,r=e.length;n<r;n++){let a=e[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}var Vf=class extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}},po=class extends rn{constructor(t){super(),this.writable=!1,ho(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,e,n){return super.emitReserved("error",new Vf(t,e,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let e=wu(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,e={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){let t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){let e=b_(t);return e.length?"?"+e:""}};var yu=class extends po{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";let e=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||e()})),this.writable||(n++,this.once("drain",function(){--n||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){let e=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};m_(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){let t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,p_(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=jf()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(t,e)}};var y_=!1;try{y_=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var S_=y_;function ZC(){}var rm=class extends yu{constructor(t){if(super(t),typeof location<"u"){let e=location.protocol==="https:",n=location.port;n||(n=e?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,e){let n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",(r,a)=>{this.onError("xhr post error",r,a)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,n)=>{this.onError("xhr poll error",e,n)}),this.pollXhr=t}},Uf=(()=>{class i extends rn{constructor(e,n,r){super(),this.createRequest=e,ho(this,r),this._opts=r,this._method=r.method||"GET",this._uri=n,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;let n=Bf(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(n);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var a;r.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=i.requestsCount++,i.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=ZC,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete i.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}return i.requestsCount=0,i.requests={},i})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",C_);else if(typeof addEventListener=="function"){let i="onpagehide"in ea?"pagehide":"unload";addEventListener(i,C_,!1)}}function C_(){for(let i in Uf.requests)Uf.requests.hasOwnProperty(i)&&Uf.requests[i].abort()}var JC=(function(){let i=E_({xdomain:!1});return i&&i.responseType!==null})(),il=class extends rm{constructor(t){super(t);let e=t&&t.forceBase64;this.supportsBinary=JC&&!e}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Uf(E_,this.uri(),t)}};function E_(i){let t=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||S_))return new XMLHttpRequest}catch{}if(!t)try{return new ea[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var k_=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",sm=class extends po{get name(){return"websocket"}doOpen(){let t=this.uri(),e=this.opts.protocols,n=k_?{}:Bf(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,e,n)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let n=t[e],r=e===t.length-1;_u(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}r&&fo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let t=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=jf()),this.supportsBinary||(e.b64=1),this.createUri(t,e)}},am=ea.WebSocket||ea.MozWebSocket,nl=class extends sm{createSocket(t,e,n){return k_?new am(t,e,n):e?new am(t,e):new am(t)}doWrite(t,e){this.ws.send(e)}};var H0=class extends po{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{let e=x_(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(e).getReader(),r=g_();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();let a=()=>{n.read().then(({done:o,value:l})=>{o||(this.onPacket(l),a())}).catch(o=>{})};a();let s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let e=0;e<t.length;e++){let n=t[e],r=e===t.length-1;this._writer.write(n).then(()=>{r&&fo(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}};var om={websocket:nl,webtransport:H0,polling:il};var QC=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e6=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function W0(i){if(i.length>8e3)throw"URI too long";let t=i,e=i.indexOf("["),n=i.indexOf("]");e!=-1&&n!=-1&&(i=i.substring(0,e)+i.substring(e,n).replace(/:/g,";")+i.substring(n,i.length));let r=QC.exec(i||""),a={},s=14;for(;s--;)a[e6[s]]=r[s]||"";return e!=-1&&n!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=t6(a,a.path),a.queryKey=i6(a,a.query),a}function t6(i,t){let e=/\/{2,9}/g,n=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function i6(i,t){let e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,r,a){r&&(e[r]=a)}),e}var lm=typeof addEventListener=="function"&&typeof removeEventListener=="function",zf=[];lm&&addEventListener("offline",()=>{zf.forEach(i=>i())},!1);var Hf=(()=>{class i extends rn{constructor(e,n){if(super(),this.binaryType=v_,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){let r=W0(e);n.hostname=r.host,n.secure=r.protocol==="https"||r.protocol==="wss",n.port=r.port,r.query&&(n.query=r.query)}else n.host&&(n.hostname=W0(n.host).host);ho(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(r=>{let a=r.prototype.name;this.transports.push(a),this._transportsByName[a]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=w_(this.opts.query)),lm&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},zf.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let n=Object.assign({},this.opts.query);n.EIO=nm,n.transport=e,this.id&&(n.sid=this.id);let r=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&i.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",i.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let r=0;r<this.writeBuffer.length;r++){let a=this.writeBuffer[r].data;if(a&&(n+=__(a)),r>0&&n>this._maxPayload)return this.writeBuffer.slice(0,r);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,fo(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,r){return this._sendPacket("message",e,n,r),this}send(e,n,r){return this._sendPacket("message",e,n,r),this}_sendPacket(e,n,r,a){if(typeof n=="function"&&(a=n,n=void 0),typeof r=="function"&&(a=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let s={type:e,data:n,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),a&&this.once("flush",a),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},r=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(i.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),lm&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let r=zf.indexOf(this._offlineEventListener);r!==-1&&zf.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}return i.protocol=nm,i})(),Wf=class extends Hf{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let e=this.createTransport(t),n=!1;Hf.priorWebsocketSuccess=!1;let r=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",h=>{if(!n)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Hf.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{let g=new Error("probe error");g.transport=e.name,this.emitReserved("upgradeError",g)}}))};function a(){n||(n=!0,u(),e.close(),e=null)}let s=h=>{let g=new Error("probe error: "+h);g.transport=e.name,a(),this.emitReserved("upgradeError",g)};function o(){s("transport closed")}function l(){s("socket closed")}function c(h){e&&h.name!==e.name&&a()}let u=()=>{e.removeListener("open",r),e.removeListener("error",s),e.removeListener("close",o),this.off("close",l),this.off("upgrading",c)};e.once("open",r),e.once("error",s),e.once("close",o),this.once("close",l),this.once("upgrading",c),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||e.open()},200):e.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){let e=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}},q0=class extends Wf{constructor(t,e={}){let n=typeof t=="object"?t:e;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(r=>om[r]).filter(r=>!!r)),super(t,n)}};var jq=q0.protocol;function T_(i,t="",e){let n=i;e=e||typeof location<"u"&&location,i==null&&(i=e.protocol+"//"+e.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=e.protocol+i:i=e.host+i),/^(https?|wss?):\/\//.test(i)||(typeof e<"u"?i=e.protocol+"//"+i:i="https://"+i),n=W0(i)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+t,n.href=n.protocol+"://"+a+(e&&e.port===n.port?"":":"+n.port),n}var pm={};HC(pm,{Decoder:()=>fm,Encoder:()=>dm,PacketType:()=>gi,protocol:()=>P_});var r6=typeof ArrayBuffer=="function",a6=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,A_=Object.prototype.toString,s6=typeof Blob=="function"||typeof Blob<"u"&&A_.call(Blob)==="[object BlobConstructor]",o6=typeof File=="function"||typeof File<"u"&&A_.call(File)==="[object FileConstructor]";function Cu(i){return r6&&(i instanceof ArrayBuffer||a6(i))||s6&&i instanceof Blob||o6&&i instanceof File}function Su(i,t){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let e=0,n=i.length;e<n;e++)if(Su(i[e]))return!0;return!1}if(Cu(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return Su(i.toJSON(),!0);for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&Su(i[e]))return!0;return!1}function F_(i){let t=[],e=i.data,n=i;return n.data=cm(e,t),n.attachments=t.length,{packet:n,buffers:t}}function cm(i,t){if(!i)return i;if(Cu(i)){let e={_placeholder:!0,num:t.length};return t.push(i),e}else if(Array.isArray(i)){let e=new Array(i.length);for(let n=0;n<i.length;n++)e[n]=cm(i[n],t);return e}else if(typeof i=="object"&&!(i instanceof Date)){let e={};for(let n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=cm(i[n],t));return e}return i}function D_(i,t){return i.data=um(i.data,t),delete i.attachments,i}function um(i,t){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<t.length)return t[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=um(i[e],t);else if(typeof i=="object")for(let e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=um(i[e],t));return i}var l6=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],P_=5,gi=(function(i){return i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK",i})(gi||{}),dm=class{constructor(t){this.replacer=t}encode(t){return(t.type===gi.EVENT||t.type===gi.ACK)&&Su(t)?this.encodeAsBinary({type:t.type===gi.EVENT?gi.BINARY_EVENT:gi.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===gi.BINARY_EVENT||t.type===gi.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){let e=F_(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r}};function N_(i){return Object.prototype.toString.call(i)==="[object Object]"}var fm=class i extends rn{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);let n=e.type===gi.BINARY_EVENT;n||e.type===gi.BINARY_ACK?(e.type=n?gi.EVENT:gi.ACK,this.reconstructor=new hm(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Cu(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0,n={type:Number(t.charAt(0))};if(gi[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===gi.BINARY_EVENT||n.type===gi.BINARY_ACK){let a=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);let s=t.substring(a,e);if(s!=Number(s)||t.charAt(e)!=="-")throw new Error("Illegal attachments");n.attachments=Number(s)}if(t.charAt(e+1)==="/"){let a=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););n.nsp=t.substring(a,e)}else n.nsp="/";let r=t.charAt(e+1);if(r!==""&&Number(r)==r){let a=e+1;for(;++e;){let s=t.charAt(e);if(s==null||Number(s)!=s){--e;break}if(e===t.length)break}n.id=Number(t.substring(a,e+1))}if(t.charAt(++e)){let a=this.tryParse(t.substr(e));if(i.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case gi.CONNECT:return N_(e);case gi.DISCONNECT:return e===void 0;case gi.CONNECT_ERROR:return typeof e=="string"||N_(e);case gi.EVENT:case gi.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&l6.indexOf(e[0])===-1);case gi.ACK:case gi.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},hm=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let e=D_(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Aa(i,t,e){return i.on(t,e),function(){i.off(t,e)}}var c6=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),G0=class extends rn{constructor(t,e,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[Aa(t,"open",this.onopen.bind(this)),Aa(t,"packet",this.onpacket.bind(this)),Aa(t,"error",this.onerror.bind(this)),Aa(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){var n,r,a;if(c6.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;let s={type:gi.EVENT,data:e};if(s.options={},s.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let u=this.ids++,h=e.pop();this._registerAckCallback(u,h),s.id=u}let o=(r=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||r===void 0?void 0:r.writable,l=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(t,e){var n;let r=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(r===void 0){this.acks[t]=e;return}let a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);e.call(this,new Error("operation has timed out"))},r),s=(...o)=>{this.io.clearTimeoutFn(a),e.apply(this,o)};s.withError=!0,this.acks[t]=s}emitWithAck(t,...e){return new Promise((n,r)=>{let a=(s,o)=>s?r(s):n(o);a.withError=!0,e.push(a),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());let n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((r,...a)=>n!==this._queue[0]?void 0:(r!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(r)):(this._queue.shift(),e&&e(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;let e=this._queue[0];e.pending&&!t||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:gi.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){let n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case gi.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case gi.EVENT:case gi.BINARY_EVENT:this.onevent(t);break;case gi.ACK:case gi.BINARY_ACK:this.onack(t);break;case gi.DISCONNECT:this.ondisconnect();break;case gi.CONNECT_ERROR:this.destroy();let n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){let e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let n of e)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){let e=this,n=!1;return function(...r){n||(n=!0,e.packet({type:gi.ACK,id:t,data:r}))}}onack(t){let e=this.acks[t.id];typeof e=="function"&&(delete this.acks[t.id],e.withError&&t.data.unshift(null),e.apply(this,t.data))}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:gi.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let e=this._anyOutgoingListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let n of e)n.apply(this,t.data)}}};function Jl(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}Jl.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*i);i=(Math.floor(t*10)&1)==0?i-e:i+e}return Math.min(i,this.max)|0};Jl.prototype.reset=function(){this.attempts=0};Jl.prototype.setMin=function(i){this.ms=i};Jl.prototype.setMax=function(i){this.max=i};Jl.prototype.setJitter=function(i){this.jitter=i};var $0=class extends rn{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,ho(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((n=e.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Jl({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;let r=e.parser||pm;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new q0(this.uri,this.opts);let e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let r=Aa(e,"open",function(){n.onopen(),t&&t()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},s=Aa(e,"error",a);if(this._timeout!==!1){let o=this._timeout,l=this.setTimeoutFn(()=>{r(),a(new Error("timeout")),e.close()},o);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(Aa(t,"ping",this.onping.bind(this)),Aa(t,"data",this.ondata.bind(this)),Aa(t,"error",this.onerror.bind(this)),Aa(t,"close",this.onclose.bind(this)),Aa(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){fo(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new G0(this,t,e),this.nsps[t]=n),n}_destroy(t){let e=Object.keys(this.nsps);for(let n of e)if(this.nsps[n].active)return;this._close()}_packet(t){let e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,e){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();this._reconnecting=!0;let n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(r=>{r?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):t.onreconnect()}))},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};var Eu={};function ku(i,t){typeof i=="object"&&(t=i,i=void 0),t=t||{};let e=T_(i,t.path||"/socket.io"),n=e.source,r=e.id,a=e.path,s=Eu[r]&&a in Eu[r].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||s,l;return o?l=new $0(n,t):(Eu[r]||(Eu[r]=new $0(n,t)),l=Eu[r]),e.query&&!t.query&&(t.query=e.queryKey),l.socket(e.path,t)}Object.assign(ku,{Manager:$0,Socket:G0,io:ku,connect:ku});var rl=class i{socket=null;connected=!1;newSaleSubject=new V0;saleStatusUpdateSubject=new V0;newRefundRequestSubject=new V0;restoreProgressSubject=new V0;connectionSubject=new V0;newSale$=this.newSaleSubject.asObservable();saleStatusUpdate$=this.saleStatusUpdateSubject.asObservable();newRefundRequest$=this.newRefundRequestSubject.asObservable();restoreProgress$=this.restoreProgressSubject.asObservable();connection$=this.connectionSubject.asObservable();constructor(){}connect(t,e){if(this.socket&&this.connected)return;let n=$t.url.replace("/api/","");this.socket=ku(n,{transports:["websocket","polling"],reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5}),this.setupListeners(t,e)}setupListeners(t,e){this.socket&&(this.socket.on("connect",()=>{this.connected=!0,this.connectionSubject.next(!0),this.socket?.emit("authenticate",{userId:t,role:e})}),this.socket.on("authenticated",n=>{}),this.socket.on("new_sale",n=>{this.newSaleSubject.next(n)}),this.socket.on("sale_status_updated",n=>{this.saleStatusUpdateSubject.next(n)}),this.socket.on("new_refund_request",n=>{this.newRefundRequestSubject.next(n)}),this.socket.on("restore_progress",n=>{this.restoreProgressSubject.next(n)}),this.socket.on("disconnect",n=>{this.connected=!1,this.connectionSubject.next(!1)}),this.socket.on("connect_error",n=>{this.connected=!1,this.connectionSubject.next(!1)}),this.socket.on("error",n=>{}),this.socket.on("reconnect",n=>{this.connected=!0,this.connectionSubject.next(!0)}),this.socket.on("reconnect_attempt",n=>{}))}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.connected=!1,this.connectionSubject.next(!1))}isConnected(){return this.connected}emit(t,e){this.socket&&this.connected&&this.socket.emit(t,e)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var qf=class i{http=lt(ur);websocketService=lt(rl);recentSales=Ae([]);unreadCount=Ae(0);lastCheckedTimestamp=Ae(new Date().toISOString());sales=Ge(()=>this.recentSales());count=Ge(()=>this.unreadCount());constructor(){this.websocketService.newSale$.subscribe(t=>{this.addNewSale(t)}),this.websocketService.saleStatusUpdate$.subscribe(t=>{this.updateSaleStatus(t)})}startWebSocket(t,e){this.websocketService.connect(t,e)}stopWebSocket(){this.websocketService.disconnect()}loadNotifications(){let t=`${$t.url}sales/recent-notifications`;return this.http.get(t).pipe(lr(e=>{this.recentSales.set(e.recent_sales||[]),this.unreadCount.set(e.unread_count||0)}))}addNewSale(t){let e=this.recentSales();if(e.some(a=>a._id===t._id))return;let r=[t,...e];this.recentSales.set(r),(t.status==="Pendiente"||t.status==="En Revisi\xF3n")&&this.unreadCount.update(a=>a+1)}updateSaleStatus(t){let e=this.recentSales(),n=e.findIndex(r=>r._id===t._id);if(n!==-1){let r=[...e],a=r[n].status;r[n]=At(At({},r[n]),t),this.recentSales.set(r);let s=a==="Pendiente"||a==="En Revisi\xF3n",o=t.status==="Pendiente"||t.status==="En Revisi\xF3n";s&&!o?this.unreadCount.update(l=>Math.max(0,l-1)):!s&&o&&this.unreadCount.update(l=>l+1)}else this.addNewSale(t)}markAllAsRead(){this.unreadCount.set(0),this.lastCheckedTimestamp.set(new Date().toISOString());let t=`${$t.url}sales/mark-notifications-read`;this.http.post(t,{timestamp:this.lastCheckedTimestamp()}).subscribe()}clearNotifications(){this.recentSales.set([]),this.unreadCount.set(0)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var Gf=class i{http=lt(ur);websocketService=lt(rl);toastService=lt(ua);apiUrl=`${$t.url}refunds`;notifications=Ae([]);isLoading=Ae(!1);lastCheck=Ae(null);unreadCount=Ge(()=>this.notifications().filter(t=>t.status==="pending").length);pendingRefunds=Ge(()=>this.notifications().filter(t=>t.status==="pending"));processingRefunds=Ge(()=>this.notifications().filter(t=>t.status==="processing"));pollingInterval=null;POLLING_INTERVAL=3e4;constructor(){this.websocketService.newRefundRequest$.subscribe(t=>{this.addNewRefund(t)})}addNewRefund(t){let e=this.notifications();if(!e.some(r=>r._id===t._id)&&(t.status==="pending"||t.status==="processing")){let r=[t,...e];this.notifications.set(r)}}loadNotifications(){this.isLoading.set(!0),this.http.get(`${this.apiUrl}/list`).subscribe({next:t=>{let e=t.filter(n=>n.status==="pending"||n.status==="processing");this.notifications.set(e),this.lastCheck.set(new Date),this.isLoading.set(!1)},error:t=>{t.status===403||t.status===401||(t.status===0?this.toastService.networkError():t.status>=500?this.toastService.serverError():t.status!==403&&t.status!==401&&this.toastService.error("Error al cargar notificaciones","No se pudieron cargar las notificaciones de reembolsos")),this.isLoading.set(!1)}})}startPolling(){this.loadNotifications(),this.pollingInterval=setInterval(()=>{this.loadNotifications()},this.POLLING_INTERVAL)}stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)}clearNotifications(){this.notifications.set([]),this.lastCheck.set(null)}getRefundUrl(t){return`/dashboard?section=refunds&refundId=${t._id}`}getStatusColor(t){let e={pending:"bg-yellow-500/10 text-yellow-300 border-yellow-500/20",approved:"bg-blue-500/10 text-blue-300 border-blue-500/20",processing:"bg-purple-500/10 text-purple-300 border-purple-500/20",completed:"bg-green-500/10 text-green-300 border-green-500/20",rejected:"bg-red-500/10 text-red-300 border-red-500/20",failed:"bg-gray-500/10 text-gray-300 border-gray-500/20"};return e[t]||e.pending}getStatusText(t){return{pending:"\u23F3 Pendiente",approved:"\u2705 Aprobado",processing:"\u2699\uFE0F Procesando",completed:"\u2714\uFE0F Completado",rejected:"\u274C Rechazado",failed:"\u26A0\uFE0F Fallido"}[t]||t}getRelativeTime(t){let e=new Date(t),r=new Date().getTime()-e.getTime(),a=Math.floor(r/6e4),s=Math.floor(r/36e5),o=Math.floor(r/864e5);return a<1?"Hace un momento":a<60?`Hace ${a} min`:s<24?`Hace ${s}h`:o<7?`Hace ${o}d`:e.toLocaleDateString("es-ES",{day:"numeric",month:"short"})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var $f=class i{taxService=lt(qv);pendingCount=Ae(0);pollingSubscription=null;loadNotifications(){this.taxService.getPendingCount().subscribe({next:t=>{t.success&&this.pendingCount.set(t.count)},error:t=>console.error("Error loading tax notifications",t)})}startPolling(){this.loadNotifications(),this.pollingSubscription=fv(6e5).subscribe(()=>{this.loadNotifications()})}stopPolling(){this.pollingSubscription&&(this.pollingSubscription.unsubscribe(),this.pollingSubscription=null)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var Xf=class i{constructor(t){this.elementRef=t}clickOutside=new mu;onClick(t){let e=t.target,n=this.elementRef.nativeElement.contains(e),r=e.closest("app-conversion-bar")!==null;!n&&!r&&this.clickOutside.emit()}static \u0275fac=function(e){return new(e||i)(_f(xv))};static \u0275dir=wv({type:i,selectors:[["","clickOutside",""]],hostBindings:function(e,n){e&1&&ue("click",function(a){return n.onClick(a)},_v)},outputs:{clickOutside:"clickOutside"}})};var u6=(i,t)=>({"bg-green-500/10 text-green-400 border-green-500/30":i,"bg-yellow-500/10 text-yellow-400 border-yellow-500/30":t}),M_=(i,t)=>t._id;function d6(i,t){if(i&1){let e=nt();f(0,"img",20),ue("error",function(r){return be(e),we(r.target.style.display="none")}),p()}if(i&2){let e,n,r=q();Ce("src","https://api.devhubsharks.com/api/system-config/logo/"+((e=r.systemConfigService.config())==null?null:e.logo),Ui)("alt",(((n=r.systemConfigService.config())==null?null:n.siteName)||"Dev-Sharks")+" logo")}}function f6(i,t){if(i&1&&(f(0,"div",12),x(1),p()),i&2){let e,n=q();S(),Re(" ",(((e=n.systemConfigService.config())==null?null:e.siteName)||"Dev-Sharks").charAt(0).toUpperCase()," ")}}function h6(i,t){if(i&1&&(f(0,"span",23),x(1),p()),i&2){let e=q(2);S(),Re(" ",e.notificationsService.count()>9?"9+":e.notificationsService.count()," ")}}function p6(i,t){if(i&1){let e=nt();f(0,"button",35),ue("click",function(){be(e);let r=q(3);return r.router.navigate(["/dashboard"]),we(r.toggleNotificationsMenu())}),x(1," Ver todas "),p()}}function m6(i,t){i&1&&(f(0,"div",34),st(),f(1,"svg",36),ce(2,"path",37),p(),xt(),f(3,"p",38),x(4,"No hay nuevas notificaciones"),p()())}function g6(i,t){if(i&1){let e=nt();f(0,"div",40),ue("click",function(){let r=be(e).$implicit,a=q(4);return we(a.goToSalesWithStatus(r.status,r._id))}),f(1,"div",41)(2,"div",42),st(),f(3,"svg",43),ce(4,"path",44),p()(),xt(),f(5,"div",45)(6,"p",46),x(7," Nueva compra de "),f(8,"span",47),x(9),p()(),f(10,"p",48),x(11," Total: "),f(12,"span",49),x(13),Jr(14,"currency"),p()(),f(15,"p",50),x(16),Jr(17,"date"),p()(),f(18,"div",51)(19,"span",52),x(20),p()()()()}if(i&2){let e=t.$implicit;S(9),hi("",e.user.name," ",e.user.surname),S(4),Ve(em(14,6,e.total,e.currency_total,"symbol","1.2-2")),S(3),Re(" ",us(17,11,e.createdAt,"dd/MM/yyyy HH:mm")," "),S(3),Ce("ngClass",Fs(14,u6,e.status==="Pagado",e.status==="Pendiente")),S(),Re(" ",e.status," ")}}function x6(i,t){if(i&1&&zt(0,g6,21,17,"div",39,M_),i&2){let e=q(3);Ht(e.notificationsService.sales())}}function v6(i,t){if(i&1){let e=nt();f(0,"div",25),ue("clickOutside",function(){be(e);let r=q(2);return we(r.isNotificationsMenuOpen.set(!1))}),f(1,"div",26)(2,"div",27)(3,"h3",28),x(4,"Notificaciones"),p(),f(5,"div",14)(6,"button",29),ue("click",function(){be(e);let r=q(2);return we(r.reloadNotifications())}),st(),f(7,"svg",30),ce(8,"path",31),p()(),xe(9,p6,2,0,"button",32),p()()(),xt(),f(10,"div",33),xe(11,m6,5,0,"div",34)(12,x6,2,0),p()()}if(i&2){let e=q(2);S(9),ve(e.notificationsService.sales().length>0?9:-1),S(2),ve(e.notificationsService.sales().length===0?11:12)}}function _6(i,t){if(i&1){let e=nt();f(0,"div",15)(1,"button",21),ue("click",function(){be(e);let r=q();return we(r.toggleNotificationsMenu())}),st(),f(2,"svg",8),ce(3,"path",22),p(),xe(4,h6,2,1,"span",23),p(),xe(5,v6,13,2,"div",24),p()}if(i&2){let e=q();S(4),ve(e.notificationsService.count()>0?4:-1),S(),ve(e.isNotificationsMenuOpen()?5:-1)}}function b6(i,t){}function w6(i,t){if(i&1&&(f(0,"span",56),x(1),p()),i&2){let e=q(2);S(),Re(" ",e.refundNotificationsService.unreadCount()>9?"9+":e.refundNotificationsService.unreadCount()," ")}}function y6(i,t){if(i&1){let e=nt();f(0,"button",58),ue("click",function(){be(e);let r=q(3);return we(r.goToRefunds())}),x(1," Ver todas "),p()}}function S6(i,t){i&1&&(f(0,"div",34),st(),f(1,"svg",36),ce(2,"path",59),p(),xt(),f(3,"p",38),x(4,"No hay solicitudes de reembolso pendientes"),p()())}function C6(i,t){if(i&1){let e=nt();f(0,"div",40),ue("click",function(){let r=be(e).$implicit,a=q(4);return we(a.goToRefunds(r._id))}),f(1,"div",41)(2,"div",60),st(),f(3,"svg",61),ce(4,"path",62),p()(),xt(),f(5,"div",45)(6,"p",46),x(7," Nueva solicitud de "),f(8,"span",63),x(9),p()(),f(10,"p",48),x(11," Monto: "),f(12,"span",64),x(13),Jr(14,"currency"),p()(),f(15,"p",50),x(16),p()(),f(17,"div",51)(18,"span"),x(19),p()()()()}if(i&2){let e=t.$implicit,n=q(4);S(9),hi("",e.user.name," ",e.user.surname),S(4),Ve(em(14,7,e.originalAmount,"MXN","symbol","1.2-2")),S(3),Ve(n.refundNotificationsService.getRelativeTime(e.requestedAt)),S(2),Li(n.refundNotificationsService.getStatusColor(e.status)+" inline-block px-2 py-1 text-xs font-semibold rounded-full border"),S(),Re(" ",n.refundNotificationsService.getStatusText(e.status)," ")}}function E6(i,t){if(i&1&&zt(0,C6,20,12,"div",39,M_),i&2){let e=q(3);Ht(e.refundNotificationsService.pendingRefunds())}}function k6(i,t){if(i&1){let e=nt();f(0,"div",25),ue("clickOutside",function(){be(e);let r=q(2);return we(r.isRefundNotificationsMenuOpen.set(!1))}),f(1,"div",26)(2,"div",27)(3,"h3",28),x(4,"Notificaciones de Reembolsos"),p(),f(5,"div",14)(6,"button",29),ue("click",function(){be(e);let r=q(2);return we(r.refundNotificationsService.loadNotifications())}),st(),f(7,"svg",30),ce(8,"path",31),p()(),xe(9,y6,2,0,"button",57),p()()(),xt(),f(10,"div",33),xe(11,S6,5,0,"div",34)(12,E6,2,0),p()()}if(i&2){let e=q(2);S(9),ve(e.refundNotificationsService.pendingRefunds().length>0?9:-1),S(2),ve(e.refundNotificationsService.pendingRefunds().length===0?11:12)}}function T6(i,t){if(i&1){let e=nt();f(0,"div",15)(1,"button",53),ue("click",function(){be(e);let r=q();return we(r.toggleRefundNotificationsMenu())}),st(),f(2,"svg",8),ce(3,"path",54)(4,"path",55),p(),xe(5,w6,2,1,"span",56),p(),xe(6,k6,13,2,"div",24),p()}if(i&2){let e=q();S(5),ve(e.refundNotificationsService.unreadCount()>0?5:-1),S(),ve(e.isRefundNotificationsMenuOpen()?6:-1)}}function A6(i,t){if(i&1){let e=nt();f(0,"div",65),ue("clickOutside",function(){be(e);let r=q();return we(r.isProfileMenuOpen.set(!1))}),f(1,"div",66)(2,"span",67),x(3),p(),f(4,"span",68),x(5),p()(),f(6,"a",69),ue("click",function(){be(e);let r=q();return we(r.toggleProfileMenu())}),x(7,"Mi Panel"),p(),f(8,"a",70),ue("click",function(){be(e);let r=q();return we(r.toggleProfileMenu())}),x(9,"Ver Sitio"),p(),ce(10,"div",71),f(11,"button",72),ue("click",function(){be(e);let r=q();return we(r.logout())}),x(12,"Cerrar Sesi\xF3n"),p()()}if(i&2){let e,n,r=q();S(3),hi("",(e=r.authService.user())==null?null:e.name," ",(e=r.authService.user())==null?null:e.surname),S(2),Ve((n=r.authService.user())==null?null:n.email),S(),Ce("routerLink",r.getProfileLink())}}var Yf=class i{authService=lt(pn);toast=lt(ua);router=lt(el);animate=lt(Df);notificationsService=lt(qf);reviewNotificationsService=lt($v);refundNotificationsService=lt(Gf);systemConfigService=lt(Ns);taxNotificationsService=lt($f);isSidebarCollapsed=Qr.required();toggleSidebar=Ta();isProfileMenuOpen=Ae(!1);isNotificationsMenuOpen=Ae(!1);isReviewNotificationsMenuOpen=Ae(!1);isRefundNotificationsMenuOpen=Ae(!1);toggleProfileMenu(){this.isProfileMenuOpen.update(t=>!t),this.isNotificationsMenuOpen()&&this.isNotificationsMenuOpen.set(!1)}toggleNotificationsMenu(){this.isNotificationsMenuOpen.update(t=>!t),this.isProfileMenuOpen()&&this.isProfileMenuOpen.set(!1),this.isNotificationsMenuOpen()&&(this.notificationsService.loadNotifications().subscribe({error:t=>this.toast.error("\u274C Error al cargar notificaciones:",t)}),this.notificationsService.markAllAsRead())}toggleReviewNotificationsMenu(){this.isReviewNotificationsMenuOpen.update(t=>!t),this.isProfileMenuOpen()&&this.isProfileMenuOpen.set(!1),this.isNotificationsMenuOpen()&&this.isNotificationsMenuOpen.set(!1),this.isRefundNotificationsMenuOpen()&&this.isRefundNotificationsMenuOpen.set(!1),this.isReviewNotificationsMenuOpen()&&this.reviewNotificationsService.loadNotifications()}toggleRefundNotificationsMenu(){this.isRefundNotificationsMenuOpen.update(t=>!t),this.isProfileMenuOpen()&&this.isProfileMenuOpen.set(!1),this.isNotificationsMenuOpen()&&this.isNotificationsMenuOpen.set(!1),this.isReviewNotificationsMenuOpen()&&this.isReviewNotificationsMenuOpen.set(!1),this.isRefundNotificationsMenuOpen()&&this.refundNotificationsService.loadNotifications()}goToRefunds(t){console.log("\u{1F4CD} [Topbar] Navegando a reembolsos:",t),this.isRefundNotificationsMenuOpen.set(!1),this.router.navigate(["/dashboard"],{queryParams:At({section:"refunds"},t&&{refundId:t})})}reloadNotifications(){this.notificationsService.loadNotifications().subscribe({})}markAllReviewsAsRead(){confirm("\xBFEst\xE1s seguro de marcar todas las reviews como le\xEDdas? Esta acci\xF3n no se puede deshacer.")&&this.reviewNotificationsService.markAllAsRead()}goToSalesWithStatus(t,e){this.isNotificationsMenuOpen.set(!1),this.router.navigate(["/dashboard"],{queryParams:{section:"sales",status:t,saleId:e}})}buildAvatarUrl(t,e,n){return t?t.startsWith("http://")||t.startsWith("https://")?t:`${$t.images.user}${t}`:`https://ui-avatars.com/api/?name=${`${e||"U"}+${n||"U"}`}&background=random&color=fff`}ngOnInit(){let t=this.authService.user();t?.rol==="admin"&&(this.notificationsService.startWebSocket(t._id,t.rol),this.notificationsService.loadNotifications().subscribe()),t?.rol==="instructor"&&(this.reviewNotificationsService.startPolling(),this.refundNotificationsService.startPolling()),t?.rol==="admin"&&(this.refundNotificationsService.startPolling(),this.taxNotificationsService.startPolling())}ngOnDestroy(){this.notificationsService.stopWebSocket(),this.notificationsService.clearNotifications(),this.reviewNotificationsService.stopPolling(),this.refundNotificationsService.stopPolling()}logout(){this.authService.logout()}getProfileLink(){let t=this.authService.user()?.rol;return t==="admin"?"/profile-admin":t==="instructor"?"/profile-instructor":"/profile-student"}ngAfterViewInit(){}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-topbar"]],inputs:{isSidebarCollapsed:[1,"isSidebarCollapsed"]},outputs:{toggleSidebar:"toggleSidebar"},decls:28,vars:10,consts:[[1,"sticky","top-0","z-20","w-full","backdrop-blur-xl","supports-[backdrop-filter]:bg-slate-950/90","bg-slate-950/80","border-b","border-white/5","shadow-lg","shadow-black/10"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","h-16","flex","items-center","justify-between"],[1,"flex","items-center","gap-3"],["type","button","aria-label","Abrir men\xFA lateral",1,"p-2.5","rounded-xl","border","border-white/10","hover:border-lime-400/50","hover:bg-lime-400/5","text-slate-400","hover:text-lime-300","transition-all","duration-200","lg:hidden",3,"click"],["viewBox","0 0 24 24","fill","none","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h12M4 18h8"],[1,"sr-only"],[1,"hidden","lg:flex","items-center","justify-center","p-2.5","rounded-xl","border","border-white/10","hover:border-lime-400/50","hover:bg-lime-400/5","text-slate-400","hover:text-lime-300","transition-all","duration-200","group",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","group-hover:scale-110","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16M4 18h16"],["routerLink","/",1,"inline-flex","items-center","gap-3","group"],[1,"h-9","w-9","rounded-xl","object-cover","ring-2","ring-lime-400/30","group-hover:ring-lime-400/60","transition-all","duration-200","shadow-lg","shadow-lime-500/20",3,"src","alt"],[1,"h-9","w-9","rounded-xl","bg-gradient-to-br","from-lime-400","via-emerald-400","to-cyan-400","ring-2","ring-lime-400/30","group-hover:ring-lime-400/60","grid","place-items-center","text-slate-900","font-black","transition-all","duration-200","shadow-lg","shadow-lime-500/30"],[1,"font-bold","tracking-tight","text-white","group-hover:text-lime-300","transition-colors","duration-200"],[1,"flex","items-center","gap-2"],[1,"relative"],[1,"flex","items-center","gap-3",3,"click"],[1,"text-sm","font-medium","hidden","sm:inline","text-slate-200"],["alt","Avatar",1,"w-9","h-9","rounded-full","object-cover","border-2","border-lime-400/50",3,"src"],[1,"fixed","sm:absolute","top-16","sm:top-full","right-0","sm:mt-3","w-full","sm:w-64","bg-slate-800/95","backdrop-blur","rounded-none","sm:rounded-md","shadow-lg","ring-1","ring-white/10","py-1","z-50"],[1,"h-9","w-9","rounded-xl","object-cover","ring-2","ring-lime-400/30","group-hover:ring-lime-400/60","transition-all","duration-200","shadow-lg","shadow-lime-500/20",3,"error","src","alt"],[1,"relative","p-2.5","rounded-xl","border","border-white/10","hover:border-lime-400/50","hover:bg-lime-400/5","text-slate-400","hover:text-lime-300","transition-all","duration-200","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"],[1,"absolute","-top-1","-right-1","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-red-500","text-white","text-xs","font-bold","animate-pulse","ring-2","ring-slate-950"],[1,"fixed","sm:absolute","top-16","sm:top-full","left-0","right-0","sm:left-auto","sm:right-0","sm:mt-3","w-full","sm:w-96","max-h-[calc(100vh-5rem)]","sm:max-h-[32rem]","overflow-y-auto","bg-slate-800/95","backdrop-blur","rounded-none","sm:rounded-xl","shadow-2xl","ring-1","ring-white/10","z-50"],[1,"fixed","sm:absolute","top-16","sm:top-full","left-0","right-0","sm:left-auto","sm:right-0","sm:mt-3","w-full","sm:w-96","max-h-[calc(100vh-5rem)]","sm:max-h-[32rem]","overflow-y-auto","bg-slate-800/95","backdrop-blur","rounded-none","sm:rounded-xl","shadow-2xl","ring-1","ring-white/10","z-50",3,"clickOutside"],[1,"sticky","top-0","bg-slate-800","px-4","py-3","border-b","border-white/10"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-semibold","text-white"],["title","Recargar notificaciones",1,"p-1.5","rounded-md","hover:bg-slate-700","text-slate-400","hover:text-lime-400","transition",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],[1,"text-xs","text-lime-400","hover:text-lime-300","font-medium"],[1,"py-2"],[1,"px-4","py-8","text-center"],[1,"text-xs","text-lime-400","hover:text-lime-300","font-medium",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-slate-600","mx-auto","mb-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"text-sm","text-slate-400"],[1,"px-4","py-3","hover:bg-slate-700/50","transition-colors","cursor-pointer","border-b","border-slate-700/50","last:border-0"],[1,"px-4","py-3","hover:bg-slate-700/50","transition-colors","cursor-pointer","border-b","border-slate-700/50","last:border-0",3,"click"],[1,"flex","items-start","gap-3"],[1,"flex-shrink-0","w-10","h-10","rounded-full","bg-lime-400/10","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-white"],[1,"text-lime-400"],[1,"text-xs","text-slate-400","mt-1"],[1,"font-semibold","text-lime-300"],[1,"text-xs","text-slate-500","mt-1"],[1,"flex-shrink-0"],[1,"inline-block","px-2","py-1","text-xs","font-semibold","rounded-full","border",3,"ngClass"],["title","Notificaciones de Reembolsos",1,"relative","p-2.5","rounded-xl","border","border-white/10","hover:border-lime-400/50","hover:bg-lime-400/5","text-slate-400","hover:text-lime-300","transition-all","duration-200","group",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 12v6a2 2 0 01-2 2H5a2 2 0 01-2-2V6a2 2 0 012-2h6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7l5 5m0 0l5-5m-5 5V3"],[1,"absolute","-top-1","-right-1","flex","h-5","w-5","items-center","justify-center","rounded-full","bg-amber-500","text-white","text-xs","font-bold","animate-pulse","ring-2","ring-slate-950"],[1,"text-xs","text-amber-400","hover:text-amber-300","font-medium"],[1,"text-xs","text-amber-400","hover:text-amber-300","font-medium",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"],[1,"flex-shrink-0","w-10","h-10","rounded-full","bg-amber-400/10","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-amber-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v8m0 0l-3-3m3 3l3-3"],[1,"text-amber-400"],[1,"font-semibold","text-amber-300"],[1,"fixed","sm:absolute","top-16","sm:top-full","right-0","sm:mt-3","w-full","sm:w-64","bg-slate-800/95","backdrop-blur","rounded-none","sm:rounded-md","shadow-lg","ring-1","ring-white/10","py-1","z-50",3,"clickOutside"],[1,"px-4","py-3","border-b","border-white/10"],[1,"block","text-sm","text-white"],[1,"block","text-xs","text-white/60","truncate"],[1,"block","px-4","py-2","text-sm","text-slate-300","hover:bg-slate-700/80","hover:text-lime-300",3,"click","routerLink"],["routerLink","/",1,"block","px-4","py-2","text-sm","text-slate-300","hover:bg-slate-700/80","hover:text-lime-300",3,"click"],[1,"border-t","border-white/10","my-1"],[1,"w-full","text-left","block","px-4","py-2","text-sm","text-red-400","font-medium","hover:bg-slate-700/80",3,"click"]],template:function(e,n){if(e&1&&(f(0,"header",0),bf(function(a){return n.animate.animateFadeInDashboard(a)}),f(1,"div",1)(2,"div",2)(3,"button",3),ue("click",function(){return n.toggleSidebar.emit()}),st(),f(4,"svg",4),ce(5,"path",5),p(),xt(),f(6,"span",6),x(7,"Abrir men\xFA lateral"),p()(),f(8,"button",7),ue("click",function(){return n.toggleSidebar.emit()}),st(),f(9,"svg",8),ce(10,"path",9),p(),xt(),f(11,"span",6),x(12,"Alternar men\xFA lateral"),p()(),f(13,"a",10),xe(14,d6,1,2,"img",11)(15,f6,2,1,"div",12),f(16,"span",13),x(17),p()()(),f(18,"div",14),xe(19,_6,6,2,"div",15),xe(20,b6,0,0),xe(21,T6,7,2,"div",15),f(22,"div",15)(23,"button",16),ue("click",function(){return n.toggleProfileMenu()}),f(24,"span",17),x(25),p(),ce(26,"img",18),p(),xe(27,A6,13,4,"div",19),p()()()()),e&2){let r,a,s,o,l,c;S(13),oi("lg:hidden",!n.isSidebarCollapsed()),S(),ve((r=n.systemConfigService.config())!=null&&r.logo?14:15),S(3),Re(" ",((a=n.systemConfigService.config())==null?null:a.siteName)||"Dev-Sharks"," "),S(2),ve(((s=n.authService.user())==null?null:s.rol)==="admin"?19:-1),S(),ve(((o=n.authService.user())==null?null:o.rol)==="instructor"?20:-1),S(),ve(((l=n.authService.user())==null?null:l.rol)==="admin"||((l=n.authService.user())==null?null:l.rol)==="instructor"?21:-1),S(4),Re("Hola, ",(c=n.authService.user())==null?null:c.name),S(),Ce("src",n.authService.currentUserAvatar(),Ui),S(),ve(n.isProfileMenuOpen()?27:-1)}},dependencies:[yn,Ds,Dv,Xf,Tv,U0],encapsulation:2})};var F6=(i,t)=>t.id;function D6(i,t){i&1&&ln(0,"div",5)}function N6(i,t){i&1&&ln(0,"div",9)}function P6(i,t){if(i&1&&(Ue(0,"div",10),x(1),ln(2,"div",11),je()),i&2){let e=q().$implicit;S(),Re(" ",e.label," ")}}function M6(i,t){if(i&1){let e=nt();Ue(0,"li")(1,"button",4),Mn("click",function(){let r=be(e).$implicit,a=q();return we(a.navigate.emit(r.id))}),xe(2,D6,1,0,"div",5),st(),Ue(3,"svg",6),ln(4,"path",7),je(),xt(),Ue(5,"span",8),x(6),je(),xe(7,N6,1,0,"div",9),xe(8,P6,3,1,"div",10),je()()}if(i&2){let e=t.$implicit,n=q();S(),oi("justify-center",n.isCollapsed())("bg-lime-500/10",n.selected()===e.id)("text-lime-400",n.selected()===e.id)("ring-1",n.selected()===e.id)("ring-lime-500/30",n.selected()===e.id)("shadow-lg",n.selected()===e.id)("shadow-lime-500/20",n.selected()===e.id),S(),ve(n.selected()===e.id?2:-1),S(),oi("group-hover:scale-110",n.selected()!==e.id),S(),yv("d",e.icon),S(),oi("lg:hidden",n.isCollapsed())("font-semibold",n.selected()===e.id),S(),Re(" ",e.label," "),S(),ve(n.selected()===e.id&&!n.isCollapsed()?7:-1),S(),ve(n.isCollapsed()?8:-1)}}var Kf=class i{selected=Qr("sales");isCollapsed=Qr.required();navigate=Ta();items=Qr.required();static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-sidebar"]],inputs:{selected:[1,"selected"],isCollapsed:[1,"isCollapsed"],items:[1,"items"]},outputs:{navigate:"navigate"},decls:6,vars:0,consts:[[1,"h-full","overflow-y-auto","overflow-x-hidden"],[1,"space-y-1","font-medium","px-3","py-4"],[1,"mt-6","px-3","pb-4"],[1,"h-px","bg-gradient-to-r","from-transparent","via-white/10","to-transparent"],["type","button",1,"w-full","flex","items-center","gap-3","px-3","py-2.5","text-sm","font-medium","text-slate-300","rounded-lg","hover:bg-white/5","hover:text-white","transition-all","duration-200","group","relative","overflow-hidden",3,"click"],[1,"absolute","inset-0","bg-gradient-to-r","from-lime-500/5","to-transparent","opacity-50"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","shrink-0","relative","z-10","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"flex-1","whitespace-nowrap","text-left","relative","z-10","transition-all","duration-200"],[1,"w-1","h-6","bg-lime-400","rounded-full","absolute","right-0","top-1/2","-translate-y-1/2"],[1,"hidden","lg:block","absolute","left-full","ml-2","px-3","py-2","bg-slate-900","text-white","text-sm","rounded-lg","shadow-xl","border","border-white/10","whitespace-nowrap","opacity-0","group-hover:opacity-100","transition-opacity","duration-200","pointer-events-none","z-50"],[1,"absolute","right-full","top-1/2","-translate-y-1/2","w-0","h-0","border-4","border-transparent","border-r-slate-900"]],template:function(e,n){e&1&&(Ue(0,"nav",0)(1,"ul",1),zt(2,M6,9,25,"li",null,F6),je(),Ue(4,"div",2),ln(5,"div",3),je()()),e&2&&(S(2),Ht(n.items()))},styles:["[_nghost-%COMP%]{display:block;height:100%;overflow:hidden}"]})};var L6=(i,t)=>t._id;function I6(i,t){if(i&1){let e=nt();f(0,"button",43),ue("click",function(){be(e);let r=q();return we(r.clearSearch())}),st(),f(1,"svg",44),ce(2,"path",45),p(),x(3," Limpiar "),p()}}function R6(i,t){if(i&1&&(f(0,"div",12)(1,"span",46),x(2,"B\xFAsqueda activa:"),p(),f(3,"span",47),x(4),p()()),i&2){let e=q();S(4),Re(' "',e.searchTerm(),'" ')}}function O6(i,t){if(i&1){let e=nt();f(0,"div",13)(1,"div",48),x(2),p(),f(3,"div",49)(4,"label",50),x(5,"Mostrar:"),p(),f(6,"select",51),ue("change",function(r){be(e);let a=q();return we(a.changePerPage(+r.target.value))}),f(7,"option",52),x(8,"5"),p(),f(9,"option",52),x(10,"10"),p(),f(11,"option",52),x(12,"15"),p(),f(13,"option",52),x(14,"20"),p()()()()}if(i&2){let e=q();S(2),Ha(" Mostrando ",(e.currentPage()-1)*e.itemsPerPage()+1," - ",e.Math.min(e.currentPage()*e.itemsPerPage(),e.filteredCategories().length)," de ",e.filteredCategories().length," categor\xEDas "),S(4),Ce("value",e.itemsPerPage()),S(),Ce("value",5),S(2),Ce("value",10),S(2),Ce("value",15),S(2),Ce("value",20)}}function B6(i,t){i&1&&(f(0,"tr",19)(1,"td",53)(2,"div",42),st(),f(3,"svg",54),ce(4,"circle",55)(5,"path",56),p(),xt(),f(6,"span"),x(7,"Cargando categor\xEDas..."),p()()()())}function j6(i,t){if(i&1&&(f(0,"tr",19)(1,"td",57),x(2),p()()),i&2){let e=q();S(2),Re(' No se encontraron categor\xEDas con el t\xE9rmino "',e.searchTerm(),'" ')}}function V6(i,t){i&1&&(f(0,"tr",19)(1,"td",58)(2,"div",59),st(),f(3,"svg",60),ce(4,"path",61),p(),xt(),f(5,"p"),x(6,"No hay categor\xEDas registradas"),p(),f(7,"p",62),x(8,"Crea la primera categor\xEDa para comenzar"),p()()()())}function U6(i,t){if(i&1){let e=nt();f(0,"div",69)(1,"button",71),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.openEditModal(r))}),x(2," Editar "),p(),f(3,"button",72),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.deleteCategory(r._id))}),x(4," Eliminar "),p()()}}function z6(i,t){i&1&&(f(0,"span",70),x(1,"Sin permisos"),p())}function H6(i,t){if(i&1){let e=nt();f(0,"tr",63)(1,"td",64)(2,"div",65)(3,"img",66),ue("error",function(r){let a=be(e).$implicit;return we(r.target.src="https://i.pravatar.cc/80?u="+a._id)}),p()()(),f(4,"th",67),x(5),p(),f(6,"td",68),xe(7,U6,5,0,"div",69)(8,z6,2,0,"span",70),p()()}if(i&2){let e,n=t.$implicit,r=q(2);S(3),Ce("src",r.buildImageUrl(n.imagen),Ui)("alt",n.title),S(2),Re(" ",n.title," "),S(2),ve(((e=r.authService.user())==null?null:e.rol)==="admin"?7:8)}}function W6(i,t){if(i&1&&zt(0,H6,9,4,"tr",63,L6),i&2){let e=q();Ht(e.paginatedCategories())}}function q6(i,t){if(i&1){let e=nt();f(0,"button",80),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.changePage(r))}),x(1),p()}if(i&2){let e=q().$implicit,n=q(2);oi("bg-lime-400",e===n.currentPage())("text-slate-900",e===n.currentPage())("bg-slate-800",e!==n.currentPage())("text-white",e!==n.currentPage()),S(),Re(" ",e," ")}}function G6(i,t){i&1&&(f(0,"span",79),x(1,"\u2026"),p())}function $6(i,t){if(i&1&&xe(0,q6,2,9,"button",78)(1,G6,2,0,"span",79),i&2){let e=t.$implicit;ve(typeof e=="number"?0:1)}}function X6(i,t){if(i&1){let e=nt();f(0,"div",20)(1,"button",73),ue("click",function(){be(e);let r=q();return we(r.previousPage())}),st(),f(2,"svg",74),ce(3,"path",75),p(),xt(),f(4,"span"),x(5,"Anterior"),p()(),f(6,"div",76),zt(7,$6,2,1,null,null,wf),p(),f(9,"button",73),ue("click",function(){be(e);let r=q();return we(r.nextPage())}),f(10,"span"),x(11,"Siguiente"),p(),st(),f(12,"svg",74),ce(13,"path",77),p()()()}if(i&2){let e=q();S(),Ce("disabled",e.currentPage()===1),S(6),Ht(e.pageNumbers()),S(2),Ce("disabled",e.currentPage()===e.totalPages())}}function Y6(i,t){i&1&&(f(0,"p",35),x(1,"El t\xEDtulo es obligatorio"),p())}function K6(i,t){if(i&1&&(f(0,"div",39)(1,"p",81),x(2,"Vista previa:"),p(),f(3,"div",82),ce(4,"img",83),f(5,"div",84)(6,"span",85),x(7," \u2713 Imagen cargada "),p()()()()),i&2){let e=q();S(4),Ce("src",e.imagePreview(),Ui)}}function Z6(i,t){i&1&&(f(0,"div",40)(1,"p",86),x(2," \u2139\uFE0F No hay imagen de preview. Si no seleccionas una nueva imagen, se mantendr\xE1 la actual. "),p()())}function J6(i,t){i&1&&(f(0,"span",42),st(),f(1,"svg",87),ce(2,"circle",55)(3,"path",56),p(),x(4," Guardando... "),p())}function Q6(i,t){if(i&1&&x(0),i&2){let e=q();Re(" ",e.isEditing()?"Guardar Cambios":"Crear Categor\xEDa"," ")}}var Zf=class i{categoriesService=lt(Ov);authService=lt(pn);Math=Math;isModalOpen=Ae(!1);isEditing=Ae(!1);currentCategoryId=Ae(null);imagePreview=Ae(null);isSaving=Ae(!1);categoryForm=new Ps({title:new ui("",[bi.required]),imagen:new ui(null)});searchTerm=Ae("");normalizeText(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}filteredCategories=Ge(()=>{let t=this.categoriesService.categories(),e=this.normalizeText(this.searchTerm());return e?t.filter(n=>this.normalizeText(n.title).includes(e)):t});onSearch(t){this.searchTerm.set(t.target.value),this.currentPage.set(1)}clearSearch(){this.searchTerm.set(""),this.currentPage.set(1)}currentPage=Ae(1);itemsPerPage=Ae(10);paginatedCategories=Ge(()=>{let t=this.filteredCategories()||[],e=this.currentPage(),n=this.itemsPerPage(),r=(e-1)*n,a=r+n;return t.slice(r,a)});totalPages=Ge(()=>{let t=this.filteredCategories()?.length||0;return Math.ceil(t/this.itemsPerPage())});pageNumbers=Ge(()=>{let t=this.totalPages();if(t<=7)return Array.from({length:t},(r,a)=>a+1);let e=this.currentPage(),n=[1];e>3&&n.push("...");for(let r=Math.max(2,e-1);r<=Math.min(t-1,e+1);r++)n.push(r);return e<t-2&&n.push("..."),n.push(t),n});changePage(t){t<1||t>this.totalPages()||this.currentPage.set(t)}previousPage(){this.changePage(this.currentPage()-1)}nextPage(){this.changePage(this.currentPage()+1)}changePerPage(t){this.itemsPerPage.set(t),this.currentPage.set(1)}ngOnInit(){this.categoriesService.reload()}openCreateModal(){this.isEditing.set(!1),this.currentCategoryId.set(null),this.categoryForm.reset(),this.imagePreview.set(null),this.isModalOpen.set(!0)}openEditModal(t){if(this.isEditing.set(!0),this.currentCategoryId.set(t._id),this.categoryForm.patchValue({title:t.title,imagen:null}),t.imagen){let e=this.buildImageUrl(t.imagen);this.imagePreview.set(e)}else this.imagePreview.set(null);this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.categoryForm.reset(),this.imagePreview.set(null)}onFileSelected(t){let e=t.target;if(e.files&&e.files[0]){let n=e.files[0];if(!n.type.startsWith("image/")){alert("Por favor selecciona un archivo de imagen v\xE1lido");return}if(n.size>5*1024*1024){alert("La imagen no debe superar los 5MB");return}this.categoryForm.patchValue({imagen:n});let r=new FileReader;r.onload=()=>{this.imagePreview.set(r.result)},r.onerror=()=>{alert("Error al cargar la imagen")},r.readAsDataURL(n)}}onSubmit(){if(this.categoryForm.invalid)return;this.isSaving.set(!0);let t=new FormData,e=this.categoryForm.getRawValue();e.title&&t.append("title",e.title),this.isEditing()&&this.currentCategoryId()&&t.append("_id",this.currentCategoryId()),e.imagen instanceof File?t.append("imagen",e.imagen):this.isEditing(),(this.isEditing()?this.categoriesService.update(t):this.categoriesService.register(t)).subscribe({next:r=>{this.categoriesService.reload(),this.closeModal(),this.isSaving.set(!1);let a=this.isEditing()?"actualizada":"creada";alert(`\u2705 Categor\xEDa ${a} exitosamente`)},error:r=>{alert(`Error: ${r.error?.message||"No se pudo guardar la categor\xEDa"}`),this.isSaving.set(!1)}})}deleteCategory(t){confirm("\xBFEst\xE1s seguro de que quieres eliminar esta categor\xEDa?")&&this.categoriesService.remove(t).subscribe({next:()=>{this.categoriesService.reload()},error:e=>{alert(`Error: ${e.error?.message||"No se pudo eliminar la categor\xEDa"}`)}})}buildImageUrl(t){if(!t)return"https://i.pravatar.cc/80?u=placeholder";let e=t.trim(),n=$t.images.cat,r=new Date().getTime();return`${n}${e}?t=${r}`}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-categories"]],decls:64,vars:17,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-white"],[1,"h-10","px-5","rounded-xl","bg-lime-400","text-slate-900","font-bold","hover:bg-lime-300","transition",3,"click"],[1,"bg-slate-800","p-4","rounded-lg","border","border-white/10"],[1,"flex","items-center","gap-4"],[1,"relative","flex-grow"],["for","search-category",1,"sr-only"],["type","text","id","search-category","placeholder","Buscar por t\xEDtulo...",1,"w-full","bg-slate-900","border","border-slate-700","rounded-lg","py-2","pl-10","pr-4","focus:outline-none","focus:ring-2","focus:ring-lime-400","text-white","placeholder-slate-500",3,"input","value"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5","text-slate-400","absolute","left-3","top-1/2","-translate-y-1/2"],["stroke-linecap","round","stroke-linejoin","round","d","M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors","flex","items-center","gap-2","border","border-slate-600"],[1,"mt-3","flex","flex-wrap","gap-2","text-sm"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-4"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg","border","border-white/10"],[1,"w-full","text-sm","text-left","text-gray-400"],[1,"text-xs","uppercase","bg-slate-900","text-gray-400"],["scope","col",1,"px-6","py-3"],["scope","col",1,"px-6","py-3","text-right"],[1,"border-b","bg-slate-800/50","border-gray-700"],[1,"flex","items-center","justify-center","gap-4","mt-6"],[1,"fixed","inset-0","z-40","bg-gray-900/50","backdrop-blur-sm","transition-opacity",3,"click"],["id","category-modal","tabindex","-1","aria-hidden","true",1,"fixed","top-0","right-0","left-0","z-50","justify-center","items-start","w-full","md:inset-0","h-modal","md:h-full","flex","pt-8"],[1,"relative","p-4","w-full","max-w-md","h-full","md:h-auto"],[1,"relative","rounded-lg","shadow-xl","bg-slate-800","border","border-white/10"],["type","button",1,"absolute","top-3","right-2.5","text-gray-400","bg-transparent","hover:bg-slate-700","rounded-lg","text-sm","p-1.5","ml-auto","inline-flex","items-center","transition-colors","z-10",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"sr-only"],[1,"py-6","px-6","lg:px-8"],[1,"mb-4","text-xl","font-medium","text-white"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","title",1,"block","mb-2","text-sm","font-medium","text-gray-300"],[1,"text-red-400"],["type","text","id","title","formControlName","title","placeholder","Ej: Programaci\xF3n Web","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-500","text-white","focus:ring-2","focus:ring-lime-500","focus:border-lime-500","transition-colors"],[1,"mt-1","text-xs","text-red-400"],["for","imagen",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","imagen","type","file","accept","image/png, image/jpeg, image/jpg, image/webp",1,"block","w-full","text-sm","border","rounded-lg","cursor-pointer","text-gray-400","focus:outline-none","bg-slate-700","border-slate-600","placeholder-gray-400","file:mr-4","file:py-2","file:px-4","file:rounded-l-lg","file:border-0","file:text-sm","file:font-semibold","file:bg-lime-500/10","file:text-lime-400","hover:file:bg-lime-500/20","transition-colors",3,"change"],[1,"mt-1","text-xs","text-gray-500"],[1,"mt-4","relative"],[1,"mt-4","p-3","bg-slate-900/50","border","border-slate-700","rounded-lg"],["type","submit",1,"w-full","text-slate-900","bg-lime-400","hover:bg-lime-500","focus:ring-4","focus:outline-none","focus:ring-lime-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","disabled:bg-slate-600","disabled:cursor-not-allowed","disabled:text-gray-400","transition-all",3,"disabled"],[1,"flex","items-center","justify-center","gap-2"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors","flex","items-center","gap-2","border","border-slate-600",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-slate-400"],[1,"px-2","py-1","bg-lime-400/10","text-lime-400","rounded","border","border-lime-400/20"],[1,"text-sm","text-slate-400"],[1,"flex","items-center","gap-2"],["for","items-per-page",1,"text-sm","text-slate-400"],["id","items-per-page",1,"bg-slate-800","border","border-slate-700","text-white","text-sm","rounded-lg","px-3","py-1.5","focus:ring-lime-400","focus:border-lime-400",3,"change","value"],[3,"value"],["colspan","3",1,"px-6","py-8","text-center","text-gray-500"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-lime-400"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["colspan","3",1,"px-6","py-8","text-center","text-slate-500"],["colspan","3",1,"px-6","py-8","text-center","text-slate-400"],[1,"flex","flex-col","items-center","gap-2"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-12","w-12","text-slate-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"text-xs","text-slate-500"],[1,"border-b","bg-slate-800/50","border-gray-700","hover:bg-slate-700/50","transition-colors"],[1,"px-6","py-4","align-middle"],[1,"relative","w-16","h-10","rounded-md","overflow-hidden","border","border-slate-600"],["loading","lazy",1,"w-full","h-full","object-cover",3,"error","src","alt"],["scope","row",1,"px-6","py-4","font-medium","whitespace-nowrap","text-white","align-middle"],[1,"px-6","py-4","text-right","align-middle"],[1,"space-x-2"],[1,"text-slate-500","text-xs"],[1,"font-medium","text-lime-400","hover:text-lime-300","hover:underline","transition-colors",3,"click"],[1,"font-medium","text-red-400","hover:text-red-300","hover:underline","transition-colors",3,"click"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","border","border-slate-700","bg-slate-800","text-white","hover:bg-slate-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"hidden","md:flex","items-center","gap-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"min-w-[40px]","px-3","py-2","rounded-lg","border","border-slate-700","hover:bg-slate-700","transition-colors","font-medium","text-sm",3,"bg-lime-400","text-slate-900","bg-slate-800","text-white"],[1,"px-2","text-slate-500"],[1,"min-w-[40px]","px-3","py-2","rounded-lg","border","border-slate-700","hover:bg-slate-700","transition-colors","font-medium","text-sm",3,"click"],[1,"text-xs","text-gray-400","mb-2"],[1,"relative","rounded-lg","overflow-hidden","border-2","border-slate-600","bg-slate-900"],["alt","Vista previa",1,"w-full","h-40","object-cover",3,"src"],[1,"absolute","top-2","right-2"],[1,"bg-lime-500/80","text-slate-900","text-xs","px-2","py-1","rounded-full","font-semibold"],[1,"text-xs","text-gray-400"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"]],template:function(e,n){if(e&1&&(f(0,"div",0)(1,"div",1)(2,"h2",2),x(3,"Gesti\xF3n de Categor\xEDas"),p(),f(4,"button",3),ue("click",function(){return n.openCreateModal()}),x(5," Crear Categor\xEDa "),p()(),f(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),x(10,"Buscar categor\xEDa"),p(),f(11,"input",8),ue("input",function(a){return n.onSearch(a)}),p(),st(),f(12,"svg",9),ce(13,"path",10),p()(),xe(14,I6,4,0,"button",11),p(),xe(15,R6,5,1,"div",12),p(),xe(16,O6,15,8,"div",13),xt(),f(17,"div",14)(18,"table",15)(19,"thead",16)(20,"tr")(21,"th",17),x(22,"Imagen"),p(),f(23,"th",17),x(24,"T\xEDtulo"),p(),f(25,"th",18),x(26,"Acciones"),p()()(),f(27,"tbody"),xe(28,B6,8,0,"tr",19)(29,j6,3,1,"tr",19)(30,V6,9,0,"tr",19)(31,W6,2,0),p()()(),xe(32,X6,14,2,"div",20),p(),f(33,"div",21),ue("click",function(){return n.closeModal()}),p(),f(34,"div",22)(35,"div",23)(36,"div",24)(37,"button",25),ue("click",function(){return n.closeModal()}),st(),f(38,"svg",26),ce(39,"path",27),p(),xt(),f(40,"span",28),x(41,"Cerrar modal"),p()(),f(42,"div",29)(43,"h3",30),x(44),p(),f(45,"form",31),ue("ngSubmit",function(){return n.onSubmit()}),f(46,"div")(47,"label",32),x(48," T\xEDtulo de la categor\xEDa "),f(49,"span",33),x(50,"*"),p()(),ce(51,"input",34),xe(52,Y6,2,0,"p",35),p(),f(53,"div")(54,"label",36),x(55),p(),f(56,"input",37),ue("change",function(a){return n.onFileSelected(a)}),p(),f(57,"p",38),x(58,"PNG, JPG o WEBP (MAX. 5MB)"),p(),xe(59,K6,8,1,"div",39)(60,Z6,3,0,"div",40),p(),f(61,"button",41),xe(62,J6,5,0,"span",42)(63,Q6,1,1),p()()()()()()),e&2){let r;S(11),Ce("value",n.searchTerm()),S(3),ve(n.searchTerm()?14:-1),S(),ve(n.searchTerm()?15:-1),S(),ve(n.filteredCategories().length>0?16:-1),S(12),ve(n.categoriesService.isLoading()?28:n.paginatedCategories().length===0&&n.searchTerm()?29:n.paginatedCategories().length===0?30:31),S(4),ve(n.totalPages()>1?32:-1),S(),oi("hidden",!n.isModalOpen()),S(),oi("hidden",!n.isModalOpen()),S(10),Re(" ",n.isEditing()?"Editar Categor\xEDa":"Nueva Categor\xEDa"," "),S(),Ce("formGroup",n.categoryForm),S(7),ve((r=n.categoryForm.get("title"))!=null&&r.invalid&&((r=n.categoryForm.get("title"))!=null&&r.touched)?52:-1),S(3),Re(" Imagen ",n.isEditing()?"(opcional - dejar vac\xEDo para mantener actual)":""," "),S(4),ve(n.imagePreview()?59:n.isEditing()?60:-1),S(2),Ce("disabled",n.categoryForm.invalid||n.isSaving()),S(),ve(n.isSaving()?62:63)}},dependencies:[pr,Wa,Hn,Wn,ki,wi,dr,Mf,fr,Ur],encapsulation:2})};var Ql=(i,t)=>t._id;function eE(i,t){if(i&1){let e=nt();f(0,"button",25),ue("click",function(){be(e);let r=q(2);return we(r.openCreateModal())}),x(1," Crear Curso "),p()}}function tE(i,t){if(i&1&&(f(0,"option",14),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),Ve(e.title)}}function iE(i,t){if(i&1&&(f(0,"option",14),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),hi("",e.name," ",e.surname)}}function nE(i,t){if(i&1){let e=nt();f(0,"div",11)(1,"select",12),ue("change",function(r){be(e);let a=q(2);return we(a.onInstructorFilter(r))}),f(2,"option",13),x(3,"Todos los instructores"),p(),zt(4,iE,2,3,"option",14,Ql),p()()}if(i&2){let e=q(2);S(),Ce("value",e.instructorFilter()),S(3),Ht(e.coursesService.config().users)}}function rE(i,t){if(i&1){let e=nt();f(0,"button",26),ue("click",function(){be(e);let r=q(2);return we(r.clearAllFilters())}),st(),f(1,"svg",27),ce(2,"path",28),p(),x(3," Limpiar Filtros "),p()}}function aE(i,t){if(i&1&&(f(0,"span",33),x(1),p()),i&2){let e=q(3);S(),Re(' \u{1F50D} "',e.searchTerm(),'" ')}}function sE(i,t){if(i&1&&(f(0,"span",34),x(1),p()),i&2){let e=q(3);S(),Re(" \u{1F4C2} Categor\xEDa: ",e.selectedCategoryName()," ")}}function oE(i,t){if(i&1&&(f(0,"span",35),x(1),p()),i&2){let e=q(3);S(),Re(" \u{1F468}\u200D\u{1F3EB} Instructor: ",e.selectedInstructorName()," ")}}function lE(i,t){if(i&1&&(f(0,"div",16)(1,"div",29),st(),f(2,"svg",30),ce(3,"path",31),p(),xt(),f(4,"span",32),x(5,"Filtrando por:"),p(),xe(6,aE,2,1,"span",33),xe(7,sE,2,1,"span",34),xe(8,oE,2,1,"span",35),f(9,"span",36),x(10),p()()()),i&2){let e,n=q(2);S(6),ve(n.searchTerm()?6:-1),S(),ve(n.categoryFilter()?7:-1),S(),ve(n.instructorFilter()&&((e=n.authService.user())==null?null:e.rol)==="admin"?8:-1),S(2),Re("\u2022 ",n.filteredCourses().length," resultado(s)")}}function cE(i,t){if(i&1){let e=nt();f(0,"div",17)(1,"div",37),x(2),p(),f(3,"div",38)(4,"label",39),x(5,"Mostrar:"),p(),f(6,"select",40),ue("change",function(r){be(e);let a=q(2);return we(a.changePerPage(+r.target.value))}),f(7,"option",14),x(8,"10"),p(),f(9,"option",14),x(10,"15"),p(),f(11,"option",14),x(12,"20"),p()()()()}if(i&2){let e=q(2);S(2),Ha(" Mostrando ",(e.currentPage()-1)*e.itemsPerPage()+1," - ",e.Math.min(e.currentPage()*e.itemsPerPage(),e.filteredCourses().length)," de ",e.filteredCourses().length," cursos "),S(4),Ce("value",e.itemsPerPage()),S(),Ce("value",10),S(2),Ce("value",15),S(2),Ce("value",20)}}function uE(i,t){i&1&&(f(0,"tr",23)(1,"td",41),x(2,"Cargando cursos..."),p()())}function dE(i,t){i&1&&(f(0,"tr",23)(1,"td",42),x(2,"No se encontraron cursos con los filtros aplicados."),p()())}function fE(i,t){i&1&&(f(0,"tr",23)(1,"td",42),x(2,"No se encontraron cursos."),p()())}function hE(i,t){i&1&&(f(0,"span",47),x(1," Borrador "),p())}function pE(i,t){i&1&&(f(0,"span",48),x(1," P\xFAblico "),p())}function mE(i,t){i&1&&(f(0,"span",49),x(1," Anulado "),p())}function gE(i,t){i&1&&(f(0,"span",51),x(1," \u{1F381} GRATUITO "),p())}function xE(i,t){if(i&1&&(f(0,"span",52),x(1),Jr(2,"mxnCurrency"),p()),i&2){let e=q().$implicit;S(),Ve(Ef(2,1,e.price_mxn))}}function vE(i,t){if(i&1){let e=nt();f(0,"button",57),ue("click",function(){be(e);let r=q().$implicit,a=q(3);return we(a.deleteCourse(r))}),x(1," Eliminar "),p()}}function _E(i,t){i&1&&(f(0,"button",58),x(1," \u23F3 Verificando... "),p())}function bE(i,t){i&1&&(f(0,"button",59),x(1," \u{1F512} Bloqueado (Ventas) "),p())}function wE(i,t){i&1&&(f(0,"button",60),x(1," \u{1F512} Bloqueado (Estudiantes) "),p())}function yE(i,t){i&1&&(f(0,"button",61),x(1," Sin permisos "),p())}function SE(i,t){if(i&1&&xe(0,_E,2,0,"button",58)(1,bE,2,0,"button",59)(2,wE,2,0,"button",60)(3,yE,2,0,"button",61),i&2){let e,n=q().$implicit,r=q(3);ve((e=r.courseSalesStatus().get(n._id))!=null&&e.isChecking?0:(e=r.courseSalesStatus().get(n._id))!=null&&e.hasSales?1:(e=r.courseSalesStatus().get(n._id))!=null&&e.hasStudents?2:3)}}function CE(i,t){if(i&1){let e=nt();f(0,"tr",43)(1,"td",44),ce(2,"img",45),p(),f(3,"th",46),x(4),p(),f(5,"td",44),x(6),p(),f(7,"td",44),x(8),p(),f(9,"td",44),xe(10,hE,2,0,"span",47)(11,pE,2,0,"span",48)(12,mE,2,0,"span",49),p(),f(13,"td",50),xe(14,gE,2,0,"span",51)(15,xE,3,3,"span",52),p(),f(16,"td",53)(17,"button",54),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.switchToContentView(r))}),x(18,"Contenido"),p(),f(19,"button",55),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.openEditModal(r))}),x(20,"Editar"),p(),xe(21,vE,2,0,"button",56)(22,SE,4,1),p()()}if(i&2){let e=t.$implicit,n=q(3);S(2),Ce("alt",Cv(e.title))("src",n.buildImageUrl(e.imagen),Ui),S(2),Re(" ",e.title," "),S(2),Ve(e.categorie.title),S(2),hi("",e.user.name," ",e.user.surname),S(2),ve(e.state===1?10:e.state===2?11:e.state===3?12:-1),S(4),ve(e.isFree?14:15),S(7),ve(n.canDeleteCourse(e)?21:22)}}function EE(i,t){if(i&1&&zt(0,CE,23,10,"tr",43,Ql),i&2){let e=q(2);Ht(e.paginatedCourses())}}function kE(i,t){if(i&1){let e=nt();f(0,"button",69),ue("click",function(){be(e);let r=q().$implicit,a=q(3);return we(a.changePage(r))}),x(1),p()}if(i&2){let e=q().$implicit,n=q(3);oi("bg-lime-400",e===n.currentPage())("text-slate-900",e===n.currentPage())("bg-slate-800",e!==n.currentPage())("text-white",e!==n.currentPage()),S(),Re(" ",e," ")}}function TE(i,t){i&1&&(f(0,"span",68),x(1,"\u2026"),p())}function AE(i,t){if(i&1&&xe(0,kE,2,9,"button",67)(1,TE,2,0,"span",68),i&2){let e=t.$implicit;ve(typeof e=="number"?0:1)}}function FE(i,t){if(i&1){let e=nt();f(0,"div",24)(1,"button",62),ue("click",function(){be(e);let r=q(2);return we(r.previousPage())}),st(),f(2,"svg",63),ce(3,"path",64),p(),xt(),f(4,"span"),x(5,"Anterior"),p()(),f(6,"div",65),zt(7,AE,2,1,null,null,wf),p(),f(9,"button",62),ue("click",function(){be(e);let r=q(2);return we(r.nextPage())}),f(10,"span"),x(11,"Siguiente"),p(),st(),f(12,"svg",63),ce(13,"path",66),p()()()}if(i&2){let e=q(2);S(),Ce("disabled",e.currentPage()===1),S(6),Ht(e.pageNumbers()),S(2),Ce("disabled",e.currentPage()===e.totalPages())}}function DE(i,t){if(i&1&&(f(0,"option",14),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),Ve(e.title)}}function NE(i,t){if(i&1&&(f(0,"option",14),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),hi("",e.name," ",e.surname)}}function PE(i,t){i&1&&(f(0,"div")(1,"label",117),x(2,"Estado del Curso"),p(),f(3,"select",118)(4,"option",119),x(5,"Borrador"),p(),f(6,"option",119),x(7,"P\xFAblico"),p(),f(8,"option",119),x(9,"Anulado"),p()()()),i&2&&(S(4),Ce("ngValue",1),S(2),Ce("ngValue",2),S(2),Ce("ngValue",3))}function ME(i,t){i&1&&(f(0,"div",108)(1,"p",120),x(2," \u2705 El precio se mostrar\xE1 como "),f(3,"strong"),x(4,"$0 MXN"),p(),x(5," o "),f(6,"strong"),x(7,"GRATUITO"),p()()())}function LE(i,t){if(i&1&&(f(0,"div",113),ce(1,"img",121),p()),i&2){let e=q(3);S(),Ce("src",e.imagePreview(),Ui)}}function IE(i,t){if(i&1){let e=nt();f(0,"div",70),ue("click",function(){be(e);let r=q(2);return we(r.closeModal())}),p(),f(1,"div",71)(2,"div",72),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(3,"div",73)(4,"h3",74),x(5),p(),f(6,"button",75),ue("click",function(){be(e);let r=q(2);return we(r.closeModal())}),st(),f(7,"svg",76),ce(8,"path",77),p(),xt(),f(9,"span",78),x(10,"Cerrar modal"),p()()(),f(11,"div",79)(12,"form",80),ue("ngSubmit",function(){be(e);let r=q(2);return we(r.onSubmit())}),f(13,"div",81)(14,"div")(15,"label",82),x(16,"T\xEDtulo del curso"),p(),ce(17,"input",83),p(),f(18,"div")(19,"label",84),x(20,"Subt\xEDtulo"),p(),ce(21,"input",85),p(),f(22,"div")(23,"label",86),x(24,"Categor\xEDa"),p(),f(25,"select",87)(26,"option",88),x(27,"Selecciona una categor\xEDa"),p(),zt(28,DE,2,2,"option",14,Ql),p()(),f(30,"div")(31,"label",89),x(32,"Instructor"),p(),f(33,"select",90)(34,"option",88),x(35,"Selecciona un instructor"),p(),zt(36,NE,2,3,"option",14,Ql),p()(),f(38,"div")(39,"label",91),x(40,"Nivel"),p(),f(41,"select",92)(42,"option",93),x(43,"B\xE1sico"),p(),f(44,"option",94),x(45,"Intermedio"),p(),f(46,"option",95),x(47,"Avanzado"),p()()(),f(48,"div")(49,"label",96),x(50,"Idioma"),p(),f(51,"select",97)(52,"option",98),x(53,"Espa\xF1ol"),p(),f(54,"option",99),x(55,"Ingl\xE9s"),p()()(),xe(56,PE,10,3,"div"),f(57,"div")(58,"label",100),x(59,"Precio (MXN)"),p(),f(60,"div",101),ue("click",function(){be(e);let r=q(2);return we(r.showFreeCourseMessage())}),ce(61,"input",102),p()(),f(62,"div",103)(63,"div",104),ue("click",function(){be(e);let r=q(2);return we(r.showFreeCourseMessage())}),ce(64,"input",105),f(65,"label",106),x(66," \u{1F381} Este curso es "),f(67,"span",107),x(68,"GRATUITO"),p()()(),xe(69,ME,8,0,"div",108),p(),f(70,"div",103)(71,"label",109),x(72,"Descripci\xF3n"),p(),ce(73,"textarea",110),p(),f(74,"div",103)(75,"label",111),x(76,"Imagen de Portada"),p(),f(77,"input",112),ue("change",function(r){be(e);let a=q(2);return we(a.onFileSelected(r))}),p(),xe(78,LE,2,1,"div",113),p()()()(),f(79,"div",114)(80,"button",115),ue("click",function(){be(e);let r=q(2);return we(r.closeModal())}),x(81,"Cancelar"),p(),f(82,"button",116),x(83),p()()()()}if(i&2){let e,n,r=q(2);S(5),Ve(r.isEditing()?"Editar Curso":"Nuevo Curso"),S(7),Ce("formGroup",r.courseForm),S(16),Ht(r.coursesService.config().categories),S(8),Ht(r.coursesService.config().users),S(20),ve(((e=r.authService.user())==null?null:e.rol)==="admin"?56:-1),S(13),ve((n=r.courseForm.get("isFree"))!=null&&n.value?69:-1),S(9),ve(r.imagePreview()?78:-1),S(4),Ce("disabled",r.courseForm.invalid),S(),Ve(r.isEditing()?"Guardar Cambios":"Crear Curso")}}function RE(i,t){if(i&1){let e=nt();f(0,"div",0)(1,"div",1)(2,"h2",2),x(3,"Gesti\xF3n de Cursos"),p(),xe(4,eE,2,0,"button",3),p(),f(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),x(9,"Buscar curso"),p(),f(10,"input",8),ue("input",function(r){be(e);let a=q();return we(a.onSearch(r))}),p(),st(),f(11,"svg",9),ce(12,"path",10),p()(),xt(),f(13,"div",11)(14,"select",12),ue("change",function(r){be(e);let a=q();return we(a.onCategoryFilter(r))}),f(15,"option",13),x(16,"Todas las categor\xEDas"),p(),zt(17,tE,2,2,"option",14,Ql),p()(),xe(19,nE,6,1,"div",11),xe(20,rE,4,0,"button",15),p(),xe(21,lE,11,4,"div",16),p(),xe(22,cE,13,7,"div",17),f(23,"div",18)(24,"table",19)(25,"thead",20)(26,"tr")(27,"th",21),x(28,"Portada"),p(),f(29,"th",21),x(30,"T\xEDtulo"),p(),f(31,"th",21),x(32,"Categor\xEDa"),p(),f(33,"th",21),x(34,"Instructor"),p(),f(35,"th",21),x(36,"Estado"),p(),f(37,"th",21),x(38,"Precio"),p(),f(39,"th",22),x(40,"Acciones"),p()()(),f(41,"tbody"),xe(42,uE,3,0,"tr",23)(43,dE,3,0,"tr",23)(44,fE,3,0,"tr",23)(45,EE,2,0),p()()(),xe(46,FE,14,2,"div",24),p(),xe(47,IE,84,7)}if(i&2){let e,n,r=q();S(4),ve(((e=r.authService.user())==null?null:e.rol)==="admin"||((e=r.authService.user())==null?null:e.rol)==="instructor"?4:-1),S(6),Ce("value",r.searchTerm()),S(4),Ce("value",r.categoryFilter()),S(3),Ht(r.coursesService.config().categories),S(2),ve(((n=r.authService.user())==null?null:n.rol)==="admin"?19:-1),S(),ve(r.searchTerm()||r.categoryFilter()||r.instructorFilter()?20:-1),S(),ve(r.searchTerm()||r.categoryFilter()||r.instructorFilter()?21:-1),S(),ve(r.filteredCourses().length>0?22:-1),S(20),ve(r.coursesService.isLoadingList()?42:r.paginatedCourses().length===0&&(r.searchTerm()||r.categoryFilter()||r.instructorFilter())?43:r.paginatedCourses().length===0?44:45),S(4),ve(r.totalPages()>1?46:-1),S(),ve(r.isModalOpen()?47:-1)}}function OE(i,t){i&1&&(f(0,"tr",23)(1,"td",138),x(2,"Cargando secciones..."),p()())}function BE(i,t){i&1&&(f(0,"tr",23)(1,"td",138),x(2,"No hay secciones en este curso. \xA1Crea la primera! "),p()())}function jE(i,t){if(i&1){let e=nt();f(0,"tr",139)(1,"td",140),st(),f(2,"svg",141),ce(3,"path",142),p()(),xt(),f(4,"th",46),x(5),p(),f(6,"td",44),x(7),p(),f(8,"td",53)(9,"button",54),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.switchToClassesView(r))}),x(10,"Gestionar Clases"),p(),f(11,"button",55),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.openEditSectionModal(r))}),x(12,"Editar"),p(),f(13,"button",57),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.deleteSection(r._id))}),x(14,"Eliminar"),p()()()}if(i&2){let e=t.$implicit;Ce("cdkDragData",e),S(5),Re("",e.title," "),S(2),Ve(e.num_clases)}}function VE(i,t){if(i&1&&zt(0,jE,15,3,"tr",139,Ql),i&2){let e=q(2);Ht(e.coursesService.sections())}}function UE(i,t){if(i&1){let e=nt();f(0,"div",0)(1,"div",1)(2,"div")(3,"button",122),ue("click",function(){be(e);let r=q();return we(r.switchToListView())}),x(4,"\u2190 Volver a Cursos"),p(),f(5,"h2",2),x(6,"Gestionar Contenido: "),f(7,"span",123),x(8),p()()(),f(9,"button",25),ue("click",function(){be(e);let r=q();return we(r.openCreateSectionModal())}),x(10," Crear Secci\xF3n "),p()(),f(11,"div",18)(12,"table",19)(13,"thead",20)(14,"tr"),ce(15,"th",124),f(16,"th",21),x(17,"T\xEDtulo de la Secci\xF3n"),p(),f(18,"th",21),x(19,"Clases"),p(),f(20,"th",22),x(21,"Acciones"),p()()(),f(22,"tbody",125),ue("cdkDropListDropped",function(r){be(e);let a=q();return we(a.dropSection(r))}),xe(23,OE,3,0,"tr",23)(24,BE,3,0,"tr",23)(25,VE,2,0),p()()()(),f(26,"div",126),ue("click",function(){be(e);let r=q();return we(r.closeSectionModal())}),p(),f(27,"div",127)(28,"div",128)(29,"div",129)(30,"div",130)(31,"h3",131),x(32),p(),f(33,"button",132),ue("click",function(){be(e);let r=q();return we(r.closeSectionModal())}),st(),f(34,"svg",76),ce(35,"path",77),p(),xt(),f(36,"span",78),x(37,"Cerrar modal"),p()()(),f(38,"div",133)(39,"form",134),ue("ngSubmit",function(){be(e);let r=q();return we(r.onSectionSubmit())}),f(40,"div")(41,"label",135),x(42,"T\xEDtulo de la secci\xF3n"),p(),ce(43,"input",136),p(),f(44,"button",137),x(45),p()()()()()()}if(i&2){let e,n=q();S(8),Ve((e=n.selectedCourse())==null?null:e.title),S(14),Ce("cdkDropListData",n.coursesService.sections()),S(),ve(n.coursesService.isLoadingSections()?23:n.coursesService.sections().length===0?24:25),S(3),oi("hidden",!n.isSectionModalOpen()),S(),oi("hidden",!n.isSectionModalOpen()),S(5),Ve(n.isEditingSection()?"Editar Secci\xF3n":"Nueva Secci\xF3n"),S(7),Ce("formGroup",n.sectionForm),S(5),Ce("disabled",n.sectionForm.invalid),S(),Re(" ",n.isEditingSection()?"Guardar Cambios":"Crear Secci\xF3n"," ")}}function zE(i,t){i&1&&(f(0,"tr",23)(1,"td",41),x(2,"Cargando clases..."),p()())}function HE(i,t){i&1&&(f(0,"tr",23)(1,"td",41),x(2,"No hay clases en esta secci\xF3n. \xA1Crea la primera! "),p()())}function WE(i,t){if(i&1&&(f(0,"a",147),st(),f(1,"svg",148),ce(2,"path",149),p(),x(3," YouTube "),p()),i&2){let e=q(2).$implicit;Ce("href","https://www.youtube.com/watch?v="+e.video_id,Ui)}}function qE(i,t){if(i&1&&(f(0,"a",144),st(),f(1,"svg",148),ce(2,"path",150),p(),x(3," Vimeo "),p()),i&2){let e=q(2).$implicit;Ce("href","https://player.vimeo.com/video/"+e.video_id,Ui)}}function GE(i,t){if(i&1&&xe(0,WE,4,1,"a",147)(1,qE,4,1,"a",144),i&2){let e=q().$implicit;ve(e.video_platform==="youtube"?0:1)}}function $E(i,t){if(i&1&&(f(0,"a",144),st(),f(1,"svg",148),ce(2,"path",150),p(),x(3," Vimeo "),p()),i&2){let e=q().$implicit;Ce("href","https://player.vimeo.com/video/"+e.vimeo_id,Ui)}}function XE(i,t){i&1&&(f(0,"span",145),x(1,"Sin video"),p())}function YE(i,t){if(i&1){let e=nt();f(0,"tr",139)(1,"td",140),st(),f(2,"svg",141),ce(3,"path",142),p()(),xt(),f(4,"th",46),x(5),p(),f(6,"td",143),x(7),p(),f(8,"td",44),xe(9,GE,2,1)(10,$E,4,1,"a",144)(11,XE,2,0,"span",145),p(),f(12,"td",146),x(13),p(),f(14,"td",53)(15,"button",55),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.openEditClassModal(r))}),x(16,"Editar"),p(),f(17,"button",57),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.deleteClass(r._id))}),x(18,"Eliminar"),p()()()}if(i&2){let e=t.$implicit,n=q(3);Ce("cdkDragData",e),S(5),Ve(e.title),S(2),Re("",e.description||"Sin descripci\xF3n"," "),S(2),ve(e.video_platform&&e.video_id?9:e.vimeo_id?10:11),S(4),Re(" ",n.formatDuration(e.time)," ")}}function KE(i,t){if(i&1&&zt(0,YE,19,5,"tr",139,Ql),i&2){let e=q(2);Ht(e.coursesService.classes())}}function ZE(i,t){i&1&&x(0," Acepta formatos: youtube.com/watch?v=..., youtu.be/..., youtube.com/embed/... ")}function JE(i,t){i&1&&x(0," Acepta formatos: vimeo.com/123456789, player.vimeo.com/video/... ")}function QE(i,t){if(i&1){let e=nt();f(0,"div",70),ue("click",function(){be(e);let r=q(2);return we(r.closeClassModal())}),p(),f(1,"div",71)(2,"div",72),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(3,"div",73)(4,"h3",74),x(5),p(),f(6,"button",75),ue("click",function(){be(e);let r=q(2);return we(r.closeClassModal())}),st(),f(7,"svg",76),ce(8,"path",77),p(),xt(),f(9,"span",78),x(10,"Cerrar modal"),p()()(),f(11,"div",79)(12,"form",151),ue("ngSubmit",function(){be(e);let r=q(2);return we(r.onClassSubmit())}),f(13,"div")(14,"label",152),x(15,"T\xEDtulo de la clase"),p(),ce(16,"input",153),p(),f(17,"div")(18,"label",154),x(19,"Descripci\xF3n (opcional)"),p(),ce(20,"textarea",155),p(),f(21,"div")(22,"label",156),x(23,"\u{1F3AC} Plataforma de Video"),p(),f(24,"select",157)(25,"option",158),x(26,"Vimeo"),p(),f(27,"option",159),x(28,"YouTube"),p()()(),f(29,"div")(30,"label",160),x(31),p(),ce(32,"input",161),f(33,"p",162),xe(34,ZE,1,0)(35,JE,1,0),p()(),f(36,"div")(37,"label",163),x(38,"\u23F1\uFE0F Duraci\xF3n (minutos)"),p(),f(39,"div",164),ce(40,"input",165),Jr(41,"number"),f(42,"span",166),x(43,"min"),p()(),f(44,"p",167),x(45," \u2728 La duraci\xF3n se obtiene autom\xE1ticamente al pegar el enlace del video "),p()()()(),f(46,"div",114)(47,"button",115),ue("click",function(){be(e);let r=q(2);return we(r.closeClassModal())}),x(48," Cancelar "),p(),f(49,"button",168),x(50),p()()()()}if(i&2){let e,n,r,a,s=q(2);S(5),Ve(s.isEditingClass()?"Editar Clase":"Nueva Clase"),S(7),Ce("formGroup",s.classForm),S(19),Re(" \u{1F517} Enlace del video (",((e=s.classForm.get("video_platform"))==null?null:e.value)==="youtube"?"YouTube":"Vimeo",") "),S(),Ce("placeholder",((n=s.classForm.get("video_platform"))==null?null:n.value)==="youtube"?"https://www.youtube.com/watch?v=dQw4w9WgXcQ":"https://vimeo.com/123456789"),S(2),ve(((r=s.classForm.get("video_platform"))==null?null:r.value)==="youtube"?34:35),S(6),Ce("value",us(41,8,(((a=s.classForm.get("time"))==null?null:a.value)||0)/60,"1.0-2")),S(9),Ce("disabled",s.classForm.invalid),S(),Re(" ",s.isEditingClass()?"Guardar Cambios":"Crear Clase"," ")}}function ek(i,t){if(i&1){let e=nt();f(0,"div",0)(1,"div",1)(2,"div")(3,"button",122),ue("click",function(){be(e);let r=q();return we(r.selectedCourse()&&r.switchToContentView(r.selectedCourse()))}),x(4,"\u2190 Volver a Secciones"),p(),f(5,"h2",2),x(6,"Gestionar Clases: "),f(7,"span",123),x(8),p()()(),f(9,"button",25),ue("click",function(){be(e);let r=q();return we(r.openCreateClassModal())}),x(10," Crear Clase "),p()(),f(11,"div",18)(12,"table",19)(13,"thead",20)(14,"tr"),ce(15,"th",124),f(16,"th",21),x(17,"T\xEDtulo de la Clase"),p(),f(18,"th",21),x(19,"Descripci\xF3n"),p(),f(20,"th",21),x(21,"Video"),p(),f(22,"th",21),x(23,"Duraci\xF3n"),p(),f(24,"th",22),x(25,"Acciones"),p()()(),f(26,"tbody",125),ue("cdkDropListDropped",function(r){be(e);let a=q();return we(a.dropClass(r))}),xe(27,zE,3,0,"tr",23)(28,HE,3,0,"tr",23)(29,KE,2,0),p()()()(),xe(30,QE,51,11)}if(i&2){let e,n=q();S(8),Ve((e=n.selectedSection())==null?null:e.title),S(18),Ce("cdkDropListData",n.coursesService.classes()),S(),ve(n.coursesService.isLoadingClasses()?27:n.coursesService.classes().length===0?28:29),S(3),ve(n.isClassModalOpen()?30:-1)}}function tk(i,t){if(i&1){let e=nt();f(0,"div",169),ue("click",function(){be(e);let r=q();return we(r.closeInfoModal())}),p(),f(1,"div",170)(2,"div",171),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(3,"div",172)(4,"div",173),st(),f(5,"svg",174),ce(6,"path",175),p()(),xt(),f(7,"h3",176),x(8,"Aviso Importante"),p(),f(9,"p",177),x(10," Por ahora, todos los cursos que utilizan videos de "),f(11,"strong"),x(12,"YouTube"),p(),x(13," y "),f(14,"strong"),x(15,"Vimeo"),p(),x(16," se registrar\xE1n como "),f(17,"strong"),x(18,"gratuitos"),p(),x(19,". "),ce(20,"br")(21,"br"),x(22," \xA1Tenga paciencia mientras trabajamos en la implementaci\xF3n de los cursos de paga! "),p(),f(23,"button",178),ue("click",function(){be(e);let r=q();return we(r.closeInfoModal())}),x(24," Entendido "),p()()()()}}var Jf=class i{coursesService=lt(tl);authService=lt(pn);Math=Math;courseSalesStatus=Ae(new Map);viewMode=Ae("list");selectedCourse=Ae(null);selectedSection=Ae(null);isModalOpen=Ae(!1);isEditing=Ae(!1);isInfoModalOpen=Ae(!1);currentCourseId=Ae(null);imagePreview=Ae(null);courseForm=new Ps({title:new ui("",[bi.required]),subtitle:new ui("",[bi.required]),description:new ui(""),price_mxn:new ui({value:0,disabled:!0},[bi.required,bi.min(0)]),isFree:new ui({value:!0,disabled:!0}),categorie:new ui("",[bi.required]),user:new ui("",[bi.required]),level:new ui("Basico",[bi.required]),idioma:new ui("Espa\xF1ol",[bi.required]),portada:new ui(null),state:new ui(1)});isSectionModalOpen=Ae(!1);isEditingSection=Ae(!1);currentSectionId=Ae(null);sectionForm=new Ps({title:new ui("",[bi.required])});isClassModalOpen=Ae(!1);isEditingClass=Ae(!1);currentClassId=Ae(null);classForm=new Ps({title:new ui("",[bi.required]),description:new ui(""),video_platform:new ui("vimeo",[bi.required]),video_link:new ui(""),time:new ui(0)});videoLinkSub=null;searchTerm=Ae("");categoryFilter=Ae("");instructorFilter=Ae("");selectedCategoryName=Ge(()=>{let t=this.categoryFilter();return t&&this.coursesService.config().categories.find(n=>n._id?.toString()===t)?.title||null});selectedInstructorName=Ge(()=>{let t=this.instructorFilter();return t&&this.coursesService.config().users.find(n=>n._id?.toString()===t)?.name||null});normalizeText(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}filteredCourses=Ge(()=>{let t=this.coursesService.courses(),e=this.normalizeText(this.searchTerm()),n=this.categoryFilter(),r=this.instructorFilter();return t.filter(a=>{let s=e?this.normalizeText(a.title).includes(e):!0,o=a.categorie?._id?.toString()||"",l=n?o===n:!0,c=a.user?._id?.toString()||"",u=r?c===r:!0;return t.indexOf(a),s&&l&&u})});onSearch(t){this.searchTerm.set(t.target.value),this.currentPage.set(1)}onCategoryFilter(t){let e=t.target.value;this.categoryFilter.set(e),this.currentPage.set(1)}onInstructorFilter(t){let e=t.target.value;this.instructorFilter.set(e),this.currentPage.set(1)}clearAllFilters(){this.searchTerm.set(""),this.categoryFilter.set(""),this.instructorFilter.set(""),this.currentPage.set(1)}currentPage=Ae(1);itemsPerPage=Ae(10);paginatedCourses=Ge(()=>{let t=this.filteredCourses()||[],e=this.currentPage(),n=this.itemsPerPage(),r=(e-1)*n,a=r+n;return t.slice(r,a)});totalPages=Ge(()=>{let t=this.filteredCourses()?.length||0;return Math.ceil(t/this.itemsPerPage())});pageNumbers=Ge(()=>{let t=this.totalPages();if(t<=7)return Array.from({length:t},(r,a)=>a+1);let e=this.currentPage(),n=[1];e>3&&n.push("...");for(let r=Math.max(2,e-1);r<=Math.min(t-1,e+1);r++)n.push(r);return e<t-2&&n.push("..."),n.push(t),n});changePage(t){t<1||t>this.totalPages()||this.currentPage.set(t)}previousPage(){this.changePage(this.currentPage()-1)}nextPage(){this.changePage(this.currentPage()+1)}changePerPage(t){this.itemsPerPage.set(t),this.currentPage.set(1)}constructor(){gu(()=>{let t=this.authService.user(),e=this.courseForm.get("user");t?.rol==="instructor"?(e?.setValue(t._id,{emitEvent:!1}),e?.disable(),this.instructorFilter.set(t._id)):e?.disabled&&e?.enable()}),gu(()=>{let t=this.coursesService.courses();t.length>0&&setTimeout(()=>this.checkCoursesSales(t),0)})}ngOnInit(){this.coursesService.reloadList(),this.coursesService.reloadConfig(),this.setupVideoListener()}ngOnDestroy(){this.videoLinkSub?.unsubscribe()}openCreateModal(){this.isEditing.set(!1),this.courseForm.reset({level:"Basico",idioma:"Espa\xF1ol",price_mxn:0,isFree:!0,state:1}),this.imagePreview.set(null),this.isModalOpen.set(!0),document.body.style.overflow="hidden"}openEditModal(t){this.isEditing.set(!0),this.currentCourseId.set(t._id),this.courseForm.patchValue(It(At({},t),{isFree:t.isFree||!0,categorie:t.categorie._id,user:t.user._id})),this.imagePreview.set(t.imagen?this.buildImageUrl(t.imagen):null),this.isModalOpen.set(!0),document.body.style.overflow="hidden"}closeModal(){this.isModalOpen.set(!1),document.body.style.overflow=""}closeInfoModal(){this.isInfoModalOpen.set(!1),document.body.style.overflow=""}onFileSelected(t){let e=t.target;if(e.files&&e.files[0]){let n=e.files[0];this.courseForm.patchValue({portada:n});let r=new FileReader;r.onload=()=>this.imagePreview.set(r.result),r.readAsDataURL(n)}}onSubmit(){if(this.courseForm.invalid)return;let t=new FormData,e=this.courseForm.getRawValue();Object.keys(e).forEach(n=>{let r=e[n];r!=null&&(n==="portada"&&r instanceof File?t.append(n,r):n==="isFree"?t.append(n,r?"true":"false"):n!=="portada"&&t.append(n,String(r)))}),this.isEditing()?(t.append("_id",this.currentCourseId()),this.coursesService.update(t).subscribe(()=>{this.coursesService.reloadList(),this.closeModal()})):this.coursesService.register(t).subscribe(()=>{this.coursesService.reloadList(),this.closeModal()})}deleteCourse(t){let e=this.courseSalesStatus().get(t._id);if(!e||e.isChecking){alert("\u23F3 Por favor espera, estamos verificando el estado del curso...");return}if(e.hasSales){alert(`\u{1F6AB} No se puede eliminar "${t.title}"

Este curso tiene estudiantes que ya lo compraron.
Ventas registradas: ${e.saleCount||0}
No se puede eliminar para proteger la integridad de los datos.`);return}if(e.hasStudents){alert(`\u{1F6AB} No se puede eliminar "${t.title}"

Este curso tiene estudiantes inscritos actualmente.
Estudiantes: ${e.studentCount||0}
No se puede eliminar para proteger el acceso de los estudiantes.`);return}confirm(`\u26A0\uFE0F \xBFEst\xE1s seguro de eliminar "${t.title}"?

Esta acci\xF3n eliminar\xE1:
- El curso y su portada
- Todas las secciones
- Todas las clases
- Todos los archivos asociados

Esta acci\xF3n es permanente y no se puede deshacer.`)&&this.coursesService.remove(t._id).subscribe({next:r=>{r.code===403?alert(`\u{1F6AB} ${r.message}`):r.code===200||r.message?.includes("ELIMIN\xD3")?(alert("\u2705 Curso eliminado exitosamente"),this.coursesService.reloadList()):(alert("\u2705 Curso eliminado"),this.coursesService.reloadList())},error:r=>{let a=r.error?.message||"Error al eliminar el curso";alert(`\u274C ${a}`)}})}canDeleteCourse(t){let e=this.authService.user();if(!e)return!1;let n=this.courseSalesStatus().get(t._id);return!n||n.isChecking||n.hasSales||n.hasStudents?!1:e.rol==="admin"?!0:e.rol==="instructor"?(typeof t.user=="object"?t.user._id:t.user)===e._id:!1}checkCoursesSales(t){if(t.length===0)return;let e=new Map;t.forEach(a=>{e.set(a._id,{hasSales:!1,hasStudents:!1,canDelete:!1,isChecking:!0})}),this.courseSalesStatus.set(new Map(e));let n=0,r=t.length;t.forEach((a,s)=>{this.coursesService.checkSales(a._id).subscribe({next:o=>{e.set(a._id,{hasSales:o.hasSales,hasStudents:o.hasStudents,canDelete:o.canDelete,isChecking:!1,saleCount:o.saleCount,studentCount:o.studentCount}),n++,this.courseSalesStatus.set(new Map(e)),n===r&&e.forEach((l,c)=>{let u=t.find(g=>g._id===c),h=l.canDelete?"\u2705 PUEDE ELIMINAR":"\u{1F6AB} NO PUEDE ELIMINAR"})},error:o=>{e.set(a._id,{hasSales:!0,hasStudents:!0,canDelete:!1,isChecking:!1}),n++,this.courseSalesStatus.set(new Map(e))}})})}buildImageUrl(t){return t?`${$t.images.course}${t}`:"https://i.pravatar.cc/150?u=placeholder"}switchToContentView(t){this.selectedCourse.set(t),this.coursesService.reloadSections(t._id),this.viewMode.set("content")}switchToListView(){this.selectedCourse.set(null),this.viewMode.set("list")}openCreateSectionModal(){this.isEditingSection.set(!1),this.sectionForm.reset(),this.isSectionModalOpen.set(!0),document.body.style.overflow="hidden"}openEditSectionModal(t){this.isEditingSection.set(!0),this.currentSectionId.set(t._id),this.sectionForm.patchValue({title:t.title}),this.isSectionModalOpen.set(!0),document.body.style.overflow="hidden"}closeSectionModal(){this.isSectionModalOpen.set(!1),document.body.style.overflow=""}onSectionSubmit(){if(this.sectionForm.invalid||!this.selectedCourse())return;let t=this.selectedCourse()._id,e=It(At({},this.sectionForm.value),{course:t});if(this.isEditingSection()){let n=this.currentSectionId();this.coursesService.updateSection(n,e).subscribe(()=>{this.coursesService.reloadSections(t),this.closeSectionModal()})}else this.coursesService.createSection(e).subscribe(()=>{this.coursesService.reloadSections(t),this.closeSectionModal()})}deleteSection(t){confirm("\xBFSeguro que quieres eliminar esta secci\xF3n?")&&this.coursesService.removeSection(t).subscribe(()=>{this.selectedCourse()&&this.coursesService.reloadSections(this.selectedCourse()._id)})}dropSection(t){if(!this.selectedCourse())return;this.coursesService.updateLocalSectionOrder(t.previousIndex,t.currentIndex);let e=this.coursesService.sections().map(n=>n._id);this.coursesService.reorderSections(e).subscribe()}switchToClassesView(t){this.selectedSection.set(t),this.coursesService.reloadClasses(t._id),this.viewMode.set("classes")}openCreateClassModal(){this.isEditingClass.set(!1),this.currentClassId.set(null),this.classForm.reset(),this.isClassModalOpen.set(!0),document.body.style.overflow="hidden"}openEditClassModal(t){this.isEditingClass.set(!0),this.currentClassId.set(t._id);let e="vimeo",n="";t.video_platform?(e=t.video_platform,t.video_id&&(n=e==="youtube"?`https://www.youtube.com/watch?v=${t.video_id}`:`https://vimeo.com/${t.video_id}`)):t.vimeo_id&&(e="vimeo",n=`https://vimeo.com/${t.vimeo_id}`),this.classForm.patchValue(It(At({},t),{video_platform:e,video_link:n,time:t.time||0})),this.isClassModalOpen.set(!0),document.body.style.overflow="hidden"}closeClassModal(){this.isClassModalOpen.set(!1),document.body.style.overflow=""}onClassSubmit(){if(this.classForm.invalid||!this.selectedSection())return;let t=this.selectedSection()._id,e=this.classForm.getRawValue(),n=e.video_platform,r;if(e.video_link)if(n==="youtube"){let a=e.video_link.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/|youtube\.com\/v\/)([^&?/]+)/);a&&(r=a[1])}else{let a=e.video_link.match(/(?:vimeo\.com\/|player\.vimeo\.com\/video\/)(\d+)/);a&&(r=a[1])}if(this.isEditingClass()){let a=this.currentClassId(),s={title:e.title,description:e.description,video_platform:n,video_id:r,time:e.time};this.coursesService.updateClass(a,s).subscribe(()=>{this.coursesService.reloadClasses(t),this.closeClassModal()})}else{let a={title:e.title,description:e.description,section:t,video_platform:n,video_id:r,time:e.time};this.coursesService.createClass(a).subscribe(()=>{this.coursesService.reloadSections(this.selectedCourse()._id),this.coursesService.reloadClasses(t),this.closeClassModal()})}}deleteClass(t){confirm("\xBFSeguro que quieres eliminar esta clase?")&&this.coursesService.removeClass(t).subscribe(()=>{this.coursesService.reloadSections(this.selectedCourse()._id),this.coursesService.reloadClasses(this.selectedSection()._id)})}dropClass(t){if(!this.selectedSection()?._id)return;this.coursesService.updateLocalClassOrder(t.previousIndex,t.currentIndex);let n=this.coursesService.classes().map(r=>r._id);this.coursesService.reorderClasses(n).subscribe()}setupVideoListener(){this.videoLinkSub=this.classForm.get("video_link").valueChanges.pipe(pv(700),mv(),hv(t=>t?this.classForm.get("video_platform").value==="youtube"?t.includes("youtube.com")||t.includes("youtu.be"):t.includes("vimeo.com"):!1),gv(t=>this.classForm.get("video_platform").value==="youtube"?this.coursesService.getYoutubeData(t):this.coursesService.getVimeoData(t)),lr(t=>{t&&t.duration&&this.classForm.patchValue({time:t.duration},{emitEvent:!1})})).subscribe({error:t=>{}})}formatDuration(t){if(!t||t<=0)return"-";let e=Math.floor(t/3600),n=Math.floor(t%3600/60);return e>0?`${e}h ${n}m`:`${n} min`}showFreeCourseMessage(){this.isInfoModalOpen.set(!0),document.body.style.overflow="hidden"}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-courses"]],decls:4,vars:2,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-white"],[1,"h-10","px-5","rounded-xl","bg-lime-400","text-slate-900","font-bold","hover:bg-lime-300","transition"],[1,"bg-slate-800","p-4","rounded-lg","my-6","border","border-white/10"],[1,"flex","flex-wrap","gap-4","items-center"],[1,"relative","flex-grow","min-w-[250px]"],["for","search-course",1,"sr-only"],["type","text","id","search-course","placeholder","Buscar por t\xEDtulo...",1,"w-full","bg-slate-900","border","border-slate-700","rounded-lg","py-2","pl-10","pr-4","focus:outline-none","focus:ring-2","focus:ring-lime-400","text-white","placeholder-slate-500",3,"input","value"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"w-5","h-5","text-slate-400","absolute","left-3","top-1/2","-translate-y-1/2"],["stroke-linecap","round","stroke-linejoin","round","d","M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"],[1,"min-w-[200px]"],[1,"w-full","bg-slate-900","border","border-slate-700","rounded-lg","py-2","px-3","focus:outline-none","focus:ring-2","focus:ring-lime-400","text-white",3,"change","value"],["value",""],[3,"value"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2","font-medium"],[1,"mt-4","p-3","bg-slate-900/50","rounded-lg","border","border-slate-700"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-4","my-6"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg","border","border-white/10"],[1,"w-full","text-sm","text-left","text-gray-400"],[1,"text-xs","uppercase","bg-slate-900","text-gray-400"],["scope","col",1,"px-6","py-3"],["scope","col",1,"px-6","py-3","text-right"],[1,"border-b","bg-slate-800/50","border-gray-700"],[1,"flex","items-center","justify-center","gap-4","mt-8"],[1,"h-10","px-5","rounded-xl","bg-lime-400","text-slate-900","font-bold","hover:bg-lime-300","transition",3,"click"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2","font-medium",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-4","w-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","flex-wrap","items-center","gap-2","text-sm"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"],[1,"text-slate-300","font-medium"],[1,"px-3","py-1.5","bg-lime-500/20","text-lime-300","rounded-full","border","border-lime-500/30","font-medium"],[1,"px-3","py-1.5","bg-cyan-500/20","text-cyan-300","rounded-full","border","border-cyan-500/30","font-medium"],[1,"px-3","py-1.5","bg-purple-500/20","text-purple-300","rounded-full","border","border-purple-500/30","font-medium"],[1,"text-slate-400","ml-2"],[1,"text-sm","text-slate-400"],[1,"flex","items-center","gap-2"],["for","items-per-page",1,"text-sm","text-slate-400"],["id","items-per-page",1,"bg-slate-800","border","border-slate-700","text-white","text-sm","rounded-lg","px-3","py-1.5","focus:ring-lime-400","focus:border-lime-400",3,"change","value"],["colspan","6",1,"px-6","py-8","text-center","text-gray-500"],["colspan","6",1,"px-6","py-8","text-center","text-slate-500"],[1,"border-b","bg-slate-800/50","border-gray-700","hover:bg-slate-700/50"],[1,"px-6","py-4","align-middle"],[1,"w-24","h-14","object-cover","rounded-md",3,"src","alt"],["scope","row",1,"px-6","py-4","font-medium","whitespace-nowrap","text-white","align-middle"],[1,"px-2","py-1","text-xs","font-bold","rounded","bg-yellow-500/20","text-yellow-500"],[1,"px-2","py-1","text-xs","font-bold","rounded","bg-green-500/20","text-green-500"],[1,"px-2","py-1","text-xs","font-bold","rounded","bg-red-500/20","text-red-500"],[1,"px-6","py-4","whitespace-nowrap","align-middle"],[1,"inline-flex","items-center","px-3","py-1","text-xs","font-medium","text-green-400","bg-green-500/10","border","border-green-500/30","rounded-full"],[1,"text-white","font-semibold"],[1,"px-6","py-4","text-right","space-x-2","align-middle"],[1,"font-medium","text-cyan-400","hover:underline",3,"click"],[1,"font-medium","text-lime-400","hover:underline",3,"click"],[1,"font-medium","text-red-400","hover:underline"],[1,"font-medium","text-red-400","hover:underline",3,"click"],["disabled","","title","Verificando ventas y estudiantes...",1,"font-medium","text-slate-500","cursor-wait"],["disabled","","title","No se puede eliminar: tiene ventas registradas",1,"font-medium","text-slate-500","cursor-not-allowed"],["disabled","","title","No se puede eliminar: tiene estudiantes inscritos",1,"font-medium","text-slate-500","cursor-not-allowed"],["disabled","","title","No tienes permisos para eliminar este curso",1,"font-medium","text-slate-500","cursor-not-allowed"],[1,"flex","items-center","gap-2","px-4","py-2","rounded-lg","border","border-slate-700","bg-slate-800","text-white","hover:bg-slate-700","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 19l-7-7 7-7"],[1,"hidden","md:flex","items-center","gap-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"min-w-[40px]","px-3","py-2","rounded-lg","border","border-slate-700","hover:bg-slate-700","transition-colors","font-medium","text-sm",3,"bg-lime-400","text-slate-900","bg-slate-800","text-white"],[1,"px-2","text-slate-500"],[1,"min-w-[40px]","px-3","py-2","rounded-lg","border","border-slate-700","hover:bg-slate-700","transition-colors","font-medium","text-sm",3,"click"],[1,"fixed","inset-0","z-[100]","bg-black/70","backdrop-blur-sm",3,"click"],[1,"fixed","inset-0","z-[101]","flex","items-center","justify-center","p-4","overflow-y-auto"],[1,"relative","w-full","max-w-2xl","my-8","bg-slate-800","rounded-xl","shadow-2xl","border","border-white/20",3,"click"],[1,"flex","justify-between","items-center","py-5","px-6","border-b","border-slate-700","bg-slate-800","rounded-t-xl"],[1,"text-xl","font-bold","text-white"],["type","button",1,"text-gray-400","bg-transparent","hover:bg-slate-700","hover:text-white","rounded-lg","text-sm","p-1.5","inline-flex","items-center","transition-colors",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"sr-only"],[1,"max-h-[60vh]","overflow-y-auto","p-6"],["id","course-form",1,"space-y-4",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","title",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","text","id","title","formControlName","title","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","subtitle",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","text","id","subtitle","formControlName","subtitle","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","categorie",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","categorie","formControlName","categorie","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500"],["value","","disabled",""],["for","user",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","user","formControlName","user","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500","disabled:bg-slate-900","disabled:text-gray-400"],["for","level",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","level","formControlName","level","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500"],["value","Basico"],["value","Intermedio"],["value","Avanzado"],["for","idioma",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","idioma","formControlName","idioma","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500"],["value","Espa\xF1ol"],["value","Ingl\xE9s"],["for","price_mxn",1,"block","mb-2","text-sm","font-medium","text-gray-300"],[3,"click"],["type","number","id","price_mxn","formControlName","price_mxn","readonly","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-900","border-slate-700","placeholder-gray-400","text-slate-500","cursor-not-allowed"],[1,"md:col-span-2"],[1,"flex","items-center","space-x-3","p-4","bg-lime-500/5","rounded-lg","border","border-lime-500/20","cursor-not-allowed",3,"click"],["type","checkbox","id","isFree","formControlName","isFree",1,"w-5","h-5","text-lime-500","bg-slate-700","border-slate-600","rounded","focus:ring-lime-500","focus:ring-2","cursor-not-allowed"],["for","isFree",1,"text-white","font-medium","cursor-pointer","select-none"],[1,"text-lime-400"],[1,"mt-3","p-3","bg-green-500/10","border","border-green-500/30","rounded-lg"],["for","description",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","description","formControlName","description","rows","3",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","portada",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","portada","type","file","accept","image/*",1,"block","w-full","text-sm","border","rounded-lg","cursor-pointer","text-gray-400","focus:outline-none","bg-slate-700","border-slate-600","placeholder-gray-400",3,"change"],[1,"mt-4"],[1,"p-4","border-t","border-slate-700","bg-slate-800","rounded-b-xl","flex","gap-3"],["type","button",1,"flex-1","px-5","py-3","rounded-lg","border-2","border-slate-600","text-white","font-medium","hover:bg-slate-700","transition-all",3,"click"],["type","submit","form","course-form",1,"flex-1","px-5","py-3","rounded-lg","bg-lime-400","hover:bg-lime-500","text-slate-900","font-bold","transition-all","disabled:bg-slate-600","disabled:text-slate-400","disabled:cursor-not-allowed","disabled:opacity-50",3,"disabled"],["for","state",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","state","formControlName","state",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500"],[3,"ngValue"],[1,"text-green-400","text-sm"],["alt","Vista previa",1,"w-full","h-40","object-cover","rounded-lg",3,"src"],[1,"text-sm","text-lime-400","hover:underline","mb-2",3,"click"],[1,"font-normal"],["scope","col",1,"px-4","py-3"],["cdkDropList","",3,"cdkDropListDropped","cdkDropListData"],[1,"fixed","inset-0","z-40","bg-gray-900/50","backdrop-blur-sm",3,"click"],["id","section-modal","tabindex","-1","aria-hidden","true",1,"overflow-y-auto","overflow-x-hidden","fixed","top-0","right-0","left-0","z-50","justify-center","items-center","w-full","md:inset-0","h-modal","md:h-full","flex"],[1,"relative","p-4","w-full","max-w-md","h-full","md:h-auto"],[1,"relative","rounded-lg","shadow-xl","bg-slate-800","border","border-white/10"],[1,"flex","justify-between","items-center","py-6","px-6","lg:px-8","border-b","border-slate-700"],[1,"text-xl","font-medium","text-white"],["type","button",1,"text-gray-400","bg-transparent","hover:bg-slate-700","hover:text-white","rounded-lg","text-sm","p-1.5","-mr-2","inline-flex","items-center","transition-colors",3,"click"],[1,"py-6","px-6","lg:px-8"],[1,"space-y-6",3,"ngSubmit","formGroup"],["for","section-title",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","text","id","section-title","formControlName","title","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["type","submit",1,"w-full","text-slate-900","bg-lime-400","hover:bg-lime-500","focus:ring-4","focus:outline-none","focus:ring-lime-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","disabled:bg-slate-600","disabled:cursor-not-allowed",3,"disabled"],["colspan","4",1,"px-6","py-8","text-center","text-gray-500"],["cdkDrag","",1,"border-b","bg-slate-800/50","border-gray-700","hover:bg-slate-700/50",3,"cdkDragData"],["cdkDragHandle","",1,"px-4","py-4","cursor-move","text-gray-500","hover:text-white","w-12","align-middle"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 6h16M4 12h16m-7 6h7"],[1,"px-6","py-4","text-gray-400","line-clamp-1","align-middle"],["target","_blank",1,"text-cyan-400","hover:underline","text-xs","flex","items-center","gap-1",3,"href"],[1,"text-gray-500","text-xs"],[1,"px-6","py-4","text-gray-400","align-middle"],["target","_blank",1,"text-red-400","hover:underline","text-xs","flex","items-center","gap-1",3,"href"],["fill","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["d","M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"],["d","M23.977 6.416c-.105 2.338-1.739 5.543-4.894 9.609-3.268 4.247-6.026 6.37-8.29 6.37-1.409 0-2.578-1.294-3.553-3.881L5.322 11.4C4.603 8.816 3.834 7.522 3.01 7.522c-.179 0-.806.378-1.881 1.132L0 7.197c1.185-1.044 2.351-2.084 3.501-3.128C5.08 2.701 6.266 1.984 7.055 1.91c1.867-.18 3.016 1.1 3.447 3.838.465 2.953.789 4.789.971 5.507.539 2.45 1.131 3.674 1.776 3.674.502 0 1.256-.796 2.265-2.385 1.004-1.589 1.54-2.797 1.612-3.628.144-1.371-.395-2.061-1.614-2.061-.574 0-1.167.121-1.777.391 1.186-3.868 3.434-5.757 6.762-5.637 2.473.06 3.628 1.664 3.493 4.797l-.013.01z"],["id","class-form",1,"space-y-6",3,"ngSubmit","formGroup"],["for","class-title",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","text","id","class-title","formControlName","title","required","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","class-description",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","class-description","formControlName","description","rows","4",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","video-platform",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","video-platform","formControlName","video_platform",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500"],["value","vimeo"],["value","youtube"],["for","video-link",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","url","id","video-link","formControlName","video_link",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500",3,"placeholder"],[1,"text-xs","text-gray-500","mt-1"],["for","class-time",1,"block","mb-2","text-sm","font-medium","text-gray-300"],[1,"relative"],["type","number","id","class-time","readonly","",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-900","border-slate-700","placeholder-gray-400","text-gray-400","cursor-not-allowed",3,"value"],[1,"absolute","right-3","top-1/2","-translate-y-1/2","text-gray-400"],[1,"text-xs","text-lime-400","mt-1"],["type","submit","form","class-form",1,"flex-1","px-5","py-3","rounded-lg","bg-lime-400","hover:bg-lime-500","text-slate-900","font-bold","transition-all","disabled:bg-slate-600","disabled:text-slate-400","disabled:cursor-not-allowed","disabled:opacity-50",3,"disabled"],[1,"fixed","inset-0","z-[102]","bg-black/70","backdrop-blur-sm",3,"click"],[1,"fixed","inset-0","z-[103]","flex","items-center","justify-center","p-4"],[1,"relative","w-full","max-w-lg","bg-gradient-to-br","from-slate-800","to-slate-900","rounded-2xl","shadow-2xl","border-2","border-lime-400/30",3,"click"],[1,"p-8","text-center"],[1,"w-16","h-16","mx-auto","mb-5","rounded-full","bg-lime-400/10","border-2","border-lime-400/30","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-lime-300"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-2xl","font-bold","text-white","mb-3"],[1,"text-slate-300","leading-relaxed"],["type","button",1,"mt-8","w-full","sm:w-auto","px-8","py-3","rounded-xl","bg-lime-400","text-slate-900","font-bold","hover:bg-lime-300","transition",3,"click"]],template:function(e,n){e&1&&(xe(0,RE,48,10)(1,UE,46,11)(2,ek,31,4),xe(3,tk,25,0)),e&2&&(ve(n.viewMode()==="list"?0:n.viewMode()==="content"&&n.selectedCourse()?1:n.viewMode()==="classes"&&n.selectedSection()?2:-1),S(3),ve(n.isInfoModalOpen()?3:-1))},dependencies:[yn,pr,Wa,Hn,Wn,ki,Pf,Nf,hr,wi,dr,Mf,fr,Ur,Lv,Mv,Pv,Nv,Tf,Ff],encapsulation:2})};var Qf=class i{http=lt(ur);toast=lt(ua);base=$t.url;studentsResource=kv({loader:async()=>{try{let t=localStorage.getItem("token")||"",e=await fetch(`${this.base}dashboard/students`,{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)throw new Error("Failed to fetch students");let n=await e.json();return{students:await Promise.all((n.students||[]).map(async a=>{try{let s=await fetch(`${this.base}checkout/list?user=${a._id}`,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)return a;let l=(await s.json()).sales||[],c=new Set,u=new Set;l.forEach(b=>{b.status==="Pagado"&&b.detail&&b.detail.forEach(_=>{let w=_.product&&typeof _.product=="object"?_.product._id:_.product;if(!w){let A=b.detail.indexOf(_);w=`missing-product-${b._id}-${A}`}let E=_.product_type?_.product_type.toLowerCase():"";w&&(E==="course"||E==="curso"?c.add(w):(E==="project"||E==="proyecto")&&u.add(w))})});let h=c.size,g=u.size,d=a.purchased_courses_count&&a.purchased_courses_count>h?a.purchased_courses_count:h;return It(At({},a),{sales:l,purchased_courses_count:d,purchased_projects_count:g})}catch{return a}}))}}catch(t){throw t}}});students=Ge(()=>this.studentsResource.value()?.students||[]);isLoading=Ge(()=>this.studentsResource.isLoading());hasError=Ge(()=>this.studentsResource.status()==="error");searchTerm=Ae("");stateFilter=Ae("");filteredStudents=Ge(()=>{let e=[...this.students()],n=this.searchTerm();if(n){let a=n.toLowerCase();e=e.filter(s=>s.name.toLowerCase().includes(a)||s.surname.toLowerCase().includes(a)||s.email.toLowerCase().includes(a))}let r=this.stateFilter();return r!==""&&(e=e.filter(a=>(a.state===!0||a.state===1)===(r===!0||r===1))),e});reloadStudents(){this.studentsResource.reload()}updateStudentState(t,e){return this.http.put(`${this.base}users/update-state/${t}`,{state:e}).pipe(lr(()=>{this.toast.success(e?"\u2705 Estudiante Activado":"\u274C Estudiante Desactivado","Estado actualizado correctamente"),this.studentsResource.reload()}),ls(n=>(this.toast.error("Error","No se pudo actualizar el estado"),os(()=>n))))}updateStudent(t,e){let n=new FormData;return n.append("_id",t),e.name&&n.append("name",e.name),e.surname&&n.append("surname",e.surname),e.email&&n.append("email",e.email),e.profession!==void 0&&n.append("profession",e.profession),e.description!==void 0&&n.append("description",e.description),e.state!==void 0&&n.append("state",e.state.toString()),this.http.post(`${this.base}users/update`,n).pipe(lr(()=>{this.toast.success("\u2705 Estudiante Actualizado","Los cambios se guardaron correctamente"),this.studentsResource.reload()}),ls(r=>(this.toast.error("Error","No se pudo actualizar el estudiante"),os(()=>r))))}setSearchTerm(t){this.searchTerm.set(t)}setStateFilter(t){this.stateFilter.set(t)}isActive(t){return t.state===!0||t.state===1}totalStudents=Ge(()=>this.students().length);activeStudents=Ge(()=>this.students().filter(t=>this.isActive(t)).length);inactiveStudents=Ge(()=>this.students().filter(t=>!this.isActive(t)).length);totalEnrollments=Ge(()=>this.students().reduce((t,e)=>{let n=e.purchased_courses_count||0,r=e.purchased_projects_count||0;return t+n+r},0));static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var ik=(i,t)=>t._id;function nk(i,t){i&1&&(f(0,"p",3),st(),f(1,"svg",21),ce(2,"path",22),p(),xt(),f(3,"span"),x(4,"Vista de solo lectura - Solo puedes ver la informaci\xF3n de tus estudiantes"),p()())}function rk(i,t){i&1&&(f(0,"div",19),ce(1,"div",23),p())}function ak(i,t){i&1&&(f(0,"div",34),st(),f(1,"svg",45),ce(2,"path",46),p()())}function sk(i,t){i&1&&(f(0,"div",36),x(1,"Cuenta desactivada"),p())}function ok(i,t){if(i&1){let e=nt();f(0,"button",47),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.openEditModal(r))}),x(1," Editar "),p(),f(2,"span",48),x(3,"|"),p(),f(4,"button",49),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.toggleStudentState(r))}),x(5),p()}if(i&2){let e=q().$implicit,n=q(2);S(4),Li(n.isStudentActive(e)?"font-medium text-red-400 hover:underline":"font-medium text-lime-400 hover:underline"),S(),Re(" ",n.isStudentActive(e)?"Desactivar":"Activar"," ")}}function lk(i,t){i&1&&(f(0,"span",44),x(1," Solo lectura "),p())}function ck(i,t){if(i&1&&(f(0,"tr")(1,"th",30)(2,"div",31)(3,"div",32),ce(4,"img",33),xe(5,ak,3,0,"div",34),p(),f(6,"div")(7,"div",35),x(8),p(),xe(9,sk,2,0,"div",36),p()()(),f(10,"td",37)(11,"span",38),x(12),p()(),f(13,"td",37)(14,"span",38),x(15),p()(),f(16,"td",39)(17,"span",40),x(18),p()(),f(19,"td",39)(20,"span",41),x(21),p()(),f(22,"td",39)(23,"span"),x(24),p()(),f(25,"td",42)(26,"div",43),xe(27,ok,6,3)(28,lk,2,0,"span",44),p()()()),i&2){let e=t.$implicit,n=q(2);Li("border-b border-gray-700 hover:bg-slate-700/50 transition-colors "+(n.isStudentActive(e)?"bg-slate-800/50":"bg-slate-800/30 opacity-60")),S(4),Ce("src",n.getAvatarUrl(e.avatar),Ui)("alt",e.name),S(),ve(n.isStudentActive(e)?-1:5),S(3),hi("",e.name," ",e.surname),S(),ve(n.isStudentActive(e)?-1:9),S(3),Ve(e.email),S(3),Ve(e.profession||"-"),S(3),Re(" ",e.purchased_courses_count||0," "),S(3),Re(" ",e.purchased_projects_count||0," "),S(2),Li("px-3 py-1 text-xs font-medium rounded-full "+n.getStateBadgeClass(e)),S(),Re(" ",n.getStateText(e)," "),S(3),ve(n.isAdmin()?27:28)}}function uk(i,t){i&1&&(f(0,"tr")(1,"td",50)(2,"div",51),st(),f(3,"svg",52),ce(4,"path",53),p(),xt(),f(5,"p",54),x(6,"No se encontraron estudiantes"),p(),f(7,"p",55),x(8,"Intenta ajustar los filtros de b\xFAsqueda"),p()()()())}function dk(i,t){if(i&1&&(f(0,"div",20)(1,"table",24)(2,"thead",25)(3,"tr")(4,"th",26),x(5,"Estudiante"),p(),f(6,"th",26),x(7,"Email"),p(),f(8,"th",26),x(9,"Profesi\xF3n"),p(),f(10,"th",27),x(11,"Cursos"),p(),f(12,"th",27),x(13,"Proyectos"),p(),f(14,"th",27),x(15,"Estado"),p(),f(16,"th",28),x(17,"Acciones"),p()()(),f(18,"tbody"),zt(19,ck,29,16,"tr",29,ik,!1,uk,9,0,"tr"),p()()()),i&2){let e=q();S(19),Ht(e.filteredStudents())}}function fk(i,t){if(i&1){let e=nt();f(0,"div",56),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),p(),f(1,"div",57)(2,"div",58)(3,"div",59)(4,"button",60),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),st(),f(5,"svg",61),ce(6,"path",62),p(),xt(),f(7,"span",63),x(8,"Cerrar modal"),p()(),f(9,"div",64)(10,"h3",65),x(11," Editar Estudiante "),p()(),f(12,"div",66)(13,"form",67)(14,"div",68)(15,"div")(16,"label",69),x(17," Nombre "),f(18,"span",70),x(19,"*"),p()(),ce(20,"input",71),p(),f(21,"div")(22,"label",72),x(23," Apellido "),f(24,"span",70),x(25,"*"),p()(),ce(26,"input",73),p()(),f(27,"div")(28,"label",74),x(29," Email "),f(30,"span",70),x(31,"*"),p()(),ce(32,"input",75),p(),f(33,"div")(34,"label",76),x(35," Profesi\xF3n "),p(),ce(36,"input",77),p(),f(37,"div")(38,"label",78),x(39," Descripci\xF3n "),p(),ce(40,"textarea",79),p(),f(41,"div")(42,"label",80),x(43," Estado "),f(44,"span",70),x(45,"*"),p()(),f(46,"select",81)(47,"option",82),x(48,"Activo"),p(),f(49,"option",82),x(50,"Inactivo"),p()()()()(),f(51,"div",83)(52,"button",84),ue("click",function(){be(e);let r=q();return we(r.saveStudent())}),x(53," Guardar Cambios "),p()()()()()}if(i&2){let e=q();S(13),Ce("formGroup",e.studentForm),S(34),Ce("value",!0),S(2),Ce("value",!1),S(3),Ce("disabled",e.studentForm.invalid)}}var eh=class i{studentService=lt(Qf);authService=lt(pn);students=this.studentService.students;filteredStudents=this.studentService.filteredStudents;isLoading=this.studentService.isLoading;isAdmin=Ge(()=>this.authService.user()?.rol==="admin");isInstructor=Ge(()=>this.authService.user()?.rol==="instructor");totalStudents=this.studentService.totalStudents;activeStudents=this.studentService.activeStudents;inactiveStudents=this.studentService.inactiveStudents;totalEnrollments=this.studentService.totalEnrollments;isModalOpen=Ae(!1);isEditing=Ae(!1);currentStudent=Ae(null);studentForm=new Ps({name:new ui("",[bi.required]),surname:new ui("",[bi.required]),email:new ui("",[bi.required,bi.email]),profession:new ui(""),description:new ui(""),state:new ui(!0,[bi.required])});ngOnInit(){setTimeout(()=>{this.students().length>0},1e3)}onSearch(t){let e=t.target.value;this.studentService.setSearchTerm(e)}onStateFilter(t){let e=t.target.value;this.studentService.setStateFilter(e===""?"":e==="true")}openEditModal(t){this.isEditing.set(!0),this.currentStudent.set(t);let e=t.state===!0||t.state===1;this.studentForm.patchValue({name:t.name,surname:t.surname,email:t.email,profession:t.profession||"",description:t.description||"",state:e}),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.studentForm.reset(),this.currentStudent.set(null),this.isEditing.set(!1)}toggleStudentState(t){if(!this.isAdmin()){alert("\u26A0\uFE0F Solo los administradores pueden cambiar el estado");return}let n=!(t.state===!0||t.state===1);confirm(`\xBFEst\xE1s seguro de ${n?"activar":"desactivar"} a ${t.name} ${t.surname}?`)&&this.studentService.updateStudentState(t._id,n).subscribe({error:a=>{}})}saveStudent(){if(!this.isAdmin()){alert("\u26A0\uFE0F Solo los administradores pueden editar estudiantes");return}if(this.studentForm.invalid){Object.keys(this.studentForm.controls).forEach(r=>{this.studentForm.get(r)?.markAsTouched()});return}let t=this.currentStudent();if(!t)return;let e=this.studentForm.value,n={name:e.name||"",surname:e.surname||"",email:e.email||"",profession:e.profession||"",description:e.description||"",state:e.state??!0};this.studentService.updateStudent(t._id,n).subscribe({next:()=>{this.closeModal()},error:r=>{}})}getAvatarUrl(t){return t?`${$t.url}users/imagen-usuario/${t}`:"https://ui-avatars.com/api/?name=Usuario&background=random"}isStudentActive(t){return t.state===!0||t.state===1}getStateBadgeClass(t){return this.isStudentActive(t)?"bg-lime-500/20 text-lime-400 border border-lime-500/30":"bg-red-500/20 text-red-400 border border-red-500/30"}getStateText(t){return this.isStudentActive(t)?"Activo":"Inactivo"}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-students"]],decls:41,vars:8,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-white"],[1,"mt-1","text-sm","text-yellow-400","flex","items-center","gap-2"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"rounded-lg","border","border-white/10","bg-slate-800/50","p-5"],[1,"text-sm","font-medium","text-white/60"],[1,"mt-2","text-3xl","font-extrabold","tracking-tight","text-lime-300"],[1,"mt-2","text-3xl","font-extrabold","tracking-tight","text-lime-400"],[1,"mt-2","text-3xl","font-extrabold","tracking-tight","text-red-400"],[1,"mt-2","text-3xl","font-extrabold","tracking-tight","text-cyan-400"],[1,"flex","flex-col","md:flex-row","gap-4"],[1,"flex-1"],["type","text","placeholder","Buscar por nombre o email...",1,"w-full","border","text-sm","rounded-lg","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500",3,"input"],[1,"w-full","md:w-48"],[1,"w-full","border","text-sm","rounded-lg","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500",3,"change"],["value",""],["value","true"],["value","false"],[1,"flex","justify-center","items-center","py-12"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg","border","border-white/10"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule","evenodd"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"w-full","text-sm","text-left","text-gray-400"],[1,"text-xs","uppercase","bg-slate-900","text-gray-400"],["scope","col",1,"px-6","py-3"],["scope","col",1,"px-6","py-3","text-center"],["scope","col",1,"px-6","py-3","text-right"],[3,"class"],["scope","row",1,"px-6","py-4","font-medium","whitespace-nowrap","text-white"],[1,"flex","items-center","gap-3"],[1,"relative"],[1,"w-10","h-10","rounded-full","object-cover","border-2","border-slate-700",3,"src","alt"],["title","Usuario inactivo",1,"absolute","-bottom-1","-right-1","w-5","h-5","rounded-full","bg-red-500","border-2","border-slate-800","flex","items-center","justify-center"],[1,"font-semibold"],[1,"text-xs","text-red-400","font-medium"],[1,"px-6","py-4"],[1,"text-gray-400"],[1,"px-6","py-4","text-center"],[1,"inline-flex","items-center","justify-center","w-8","h-8","rounded-full","bg-cyan-500/20","text-cyan-400","font-bold"],[1,"inline-flex","items-center","justify-center","w-8","h-8","rounded-full","bg-indigo-500/20","text-indigo-400","font-bold"],[1,"px-6","py-4","text-right"],[1,"flex","items-center","justify-end","gap-2"],[1,"text-sm","text-gray-500","italic"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3","text-white"],["fill-rule","evenodd","d","M13.477 14.89A6 6 0 015.11 6.524l8.367 8.368zm1.414-1.414L6.524 5.11a6 6 0 018.367 8.367zM18 10a8 8 0 11-16 0 8 8 0 0116 0z","clip-rule","evenodd"],["title","Editar estudiante",1,"font-medium","text-lime-400","hover:underline",3,"click"],[1,"text-gray-600"],["title","Cambiar estado del estudiante",3,"click"],["colspan","7",1,"px-6","py-12","text-center"],[1,"flex","flex-col","items-center","justify-center","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"],[1,"text-lg","font-semibold","text-white","mb-1"],[1,"text-sm"],[1,"fixed","inset-0","z-40","bg-gray-900/50","backdrop-blur-sm",3,"click"],[1,"fixed","top-0","right-0","left-0","z-50","justify-center","items-start","w-full","md:inset-0","h-modal","md:h-full","flex","pt-8"],[1,"relative","p-4","w-full","max-w-2xl","max-h-[90vh]"],[1,"relative","rounded-lg","shadow","bg-slate-800","border","border-white/10","flex","flex-col","h-full"],["type","button",1,"absolute","top-3","right-2.5","text-gray-400","bg-transparent","rounded-lg","text-sm","p-1.5","ml-auto","inline-flex","items-center","hover:bg-gray-600","hover:text-white",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"sr-only"],[1,"py-6","px-6","lg:px-8","border-b","border-slate-700"],[1,"text-xl","font-medium","text-white"],[1,"flex-grow","overflow-y-auto","p-6","lg:p-8"],["id","student-form",1,"space-y-6",3,"formGroup"],[1,"grid","grid-cols-2","gap-4"],["for","name",1,"block","mb-2","text-sm","font-medium","text-gray-300"],[1,"text-red-400"],["type","text","id","name","formControlName","name",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","surname",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","text","id","surname","formControlName","surname",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","email","id","email","formControlName","email",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","profession",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["type","text","id","profession","formControlName","profession",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500"],["for","description",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","description","formControlName","description","rows","3",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500","resize-none"],["for","state",1,"block","mb-2","text-sm","font-medium","text-gray-300"],["id","state","formControlName","state",1,"border","text-sm","rounded-lg","block","w-full","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500"],[3,"value"],[1,"p-6","border-t","border-slate-700"],["type","button",1,"w-full","text-slate-900","bg-lime-400","hover:bg-lime-500","focus:ring-4","focus:outline-none","focus:ring-lime-300","font-medium","rounded-lg","text-sm","px-5","py-2.5","text-center","disabled:bg-slate-600","disabled:cursor-not-allowed",3,"click","disabled"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),x(4,"Gesti\xF3n de Estudiantes"),p(),xe(5,nk,5,0,"p",3),p()(),f(6,"div",4)(7,"div",5)(8,"p",6),x(9,"Total Estudiantes"),p(),f(10,"p",7),x(11),p()(),f(12,"div",5)(13,"p",6),x(14,"Activos"),p(),f(15,"p",8),x(16),p()(),f(17,"div",5)(18,"p",6),x(19,"Inactivos"),p(),f(20,"p",9),x(21),p()(),f(22,"div",5)(23,"p",6),x(24,"Total Inscripciones"),p(),f(25,"p",10),x(26),p()()(),f(27,"div",11)(28,"div",12)(29,"input",13),ue("input",function(a){return n.onSearch(a)}),p()(),f(30,"div",14)(31,"select",15),ue("change",function(a){return n.onStateFilter(a)}),f(32,"option",16),x(33,"Todos los estados"),p(),f(34,"option",17),x(35,"Activos"),p(),f(36,"option",18),x(37,"Inactivos"),p()()()(),xe(38,rk,2,0,"div",19),xe(39,dk,22,1,"div",20),p(),xe(40,fk,54,4)),e&2&&(S(5),ve(n.isInstructor()?5:-1),S(6),Re(" ",n.totalStudents()," "),S(5),Re(" ",n.activeStudents()," "),S(5),Re(" ",n.inactiveStudents()," "),S(5),Re(" ",n.totalEnrollments()," "),S(12),ve(n.isLoading()?38:-1),S(),ve(n.isLoading()?-1:39),S(),ve(n.isModalOpen()?40:-1))},dependencies:[mn,Wa,Hn,Wn,ki,hr,wi,dr,pr,fr,Ur],encapsulation:2})};var Tu=(i,t)=>t._id;function hk(i,t){if(i&1&&(f(0,"option",10),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),Ve(e.title)}}function pk(i,t){i&1&&(f(0,"div",11),ce(1,"div",15),p())}function mk(i,t){if(i&1&&ce(0,"img",18),i&2){let e=q().$implicit,n=q(2);Ce("src",n.buildImageUrl(e.imagen),Ui)("alt",e.title)}}function gk(i,t){i&1&&(f(0,"div",19),st(),f(1,"svg",39),ce(2,"path",40),p()())}function xk(i,t){i&1&&(f(0,"span",29),x(1," \u{1F381} GRATUITO "),p())}function vk(i,t){if(i&1&&(f(0,"div",30)(1,"div",41),x(2),Jr(3,"mxnCurrency"),p()()),i&2){let e=q().$implicit;S(2),Re(" ",Ef(3,1,e.price_mxn)," ")}}function _k(i,t){if(i&1&&(f(0,"div",31),st(),f(1,"svg",25),ce(2,"path",42),p(),xt(),f(3,"span",27),x(4),p()()),i&2){let e=q().$implicit;S(4),hi("",e.user.name," ",e.user.surname)}}function bk(i,t){if(i&1){let e=nt();f(0,"button",43),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.openNotesModal(r))}),st(),f(1,"svg",37),ce(2,"path",44),p(),x(3," Notas "),p()}if(i&2){let e=q().$implicit;oi("ring-1",e.admin_notes)}}function wk(i,t){if(i&1){let e=nt();f(0,"button",45),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.deleteProject(r))}),x(1," Eliminar "),p()}}function yk(i,t){i&1&&(f(0,"button",46),st(),f(1,"svg",49),ce(2,"circle",50)(3,"path",51),p(),x(4," Verificando... "),p())}function Sk(i,t){i&1&&(f(0,"button",47),x(1," \u{1F512} Bloqueado "),p())}function Ck(i,t){i&1&&(f(0,"button",48),x(1," Sin permisos "),p())}function Ek(i,t){if(i&1&&xe(0,yk,5,0,"button",46)(1,Sk,2,0,"button",47)(2,Ck,2,0,"button",48),i&2){let e,n=q().$implicit,r=q(2);ve((e=r.projectSalesStatus().get(n._id))!=null&&e.isChecking?0:(e=r.projectSalesStatus().get(n._id))!=null&&e.hasSales?1:2)}}function kk(i,t){if(i&1){let e=nt();f(0,"div",16)(1,"div",17),xe(2,mk,1,2,"img",18)(3,gk,3,0,"div",19),p(),f(4,"div",20)(5,"div",21)(6,"span"),x(7),p()(),f(8,"h3",22),x(9),p(),f(10,"p",23),x(11),p(),f(12,"div",24),st(),f(13,"svg",25),ce(14,"path",26),p(),xt(),f(15,"span",27),x(16),p()(),f(17,"div",28),xe(18,xk,2,0,"span",29)(19,vk,4,3,"div",30),p(),xe(20,_k,5,2,"div",31),f(21,"div",32),xe(22,bk,4,2,"button",33),f(23,"button",34),ue("click",function(){let r=be(e).$implicit,a=q(2);return we(a.openEditModal(r))}),x(24," Editar "),p(),xe(25,wk,2,0,"button",35)(26,Ek,3,1),f(27,"button",36),ue("click",function(){let r=be(e).$implicit,a=q(2);return we(a.openFilesModal(r))}),st(),f(28,"svg",37),ce(29,"path",38),p(),x(30," Archivos ZIP "),p()()()()}if(i&2){let e=t.$implicit,n=q(2);S(2),ve(e.imagen?2:3),S(4),Li("px-3 py-1 text-xs font-medium rounded-full "+n.getStateBadgeClass(e.state)),S(),Re(" ",n.getStateText(e.state)," "),S(2),Re(" ",e.title," "),S(2),Re(" ",e.subtitle," "),S(5),Ve(e.categorie.title),S(2),ve(e.isFree||e.price_mxn===0?18:19),S(2),ve(e.user&&typeof e.user=="object"?20:-1),S(2),ve(e.state===1?22:-1),S(3),ve(n.canDeleteProject(e)?25:26)}}function Tk(i,t){if(i&1&&(f(0,"div",12),zt(1,kk,31,11,"div",16,Tu),p()),i&2){let e=q();S(),Ht(e.projects())}}function Ak(i,t){if(i&1){let e=nt();f(0,"div",13),st(),f(1,"svg",52),ce(2,"path",53),p(),xt(),f(3,"h3",54),x(4,"No hay proyectos"),p(),f(5,"p",55),x(6,"Comienza creando tu primer proyecto"),p(),f(7,"button",56),ue("click",function(){be(e);let r=q();return we(r.openCreateModal())}),x(8," Crear Proyecto "),p()()}}function Fk(i,t){i&1&&(f(0,"div",71),x(1,"El t\xEDtulo es requerido"),p())}function Dk(i,t){i&1&&(f(0,"div",71),x(1,"El subt\xEDtulo es requerido"),p())}function Nk(i,t){i&1&&(f(0,"div",71),x(1,"La descripci\xF3n es requerida"),p())}function Pk(i,t){if(i&1&&(f(0,"option",10),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),Ve(e.title)}}function Mk(i,t){i&1&&(f(0,"div",71),x(1,"La categor\xEDa es requerida"),p())}function Lk(i,t){i&1&&(f(0,"div")(1,"label",101),x(2," Estado "),f(3,"span",69),x(4,"*"),p()(),f(5,"select",102)(6,"option",10),x(7,"Borrador"),p(),f(8,"option",10),x(9,"P\xFAblico"),p(),f(10,"option",10),x(11,"Anulado"),p()()()),i&2&&(S(6),Ce("value",1),S(2),Ce("value",2),S(2),Ce("value",3))}function Ik(i,t){if(i&1&&(f(0,"div",88),st(),f(1,"svg",103),ce(2,"path",104),p(),xt(),f(3,"p",105),x(4),p()()),i&2){let e=q(2);S(4),Ve(e.priceErrorMessage())}}function Rk(i,t){i&1&&(f(0,"div",89),st(),f(1,"svg",106),ce(2,"path",107),p(),xt(),f(3,"div")(4,"p",108),x(5," \u2705 El proyecto se mostrar\xE1 como "),f(6,"strong"),x(7,"GRATUITO"),p()(),f(8,"p",109),x(9," El precio se establecer\xE1 autom\xE1ticamente en $0.00 MXN "),p()()())}function Ok(i,t){i&1&&(f(0,"div",90),st(),f(1,"svg",110),ce(2,"path",111),p(),xt(),f(3,"p",112),x(4," \u{1F4B0} El precio m\xEDnimo debe ser "),f(5,"strong"),x(6,"$10.00 MXN"),p(),x(7," o puedes marcarlo como gratuito "),p()())}function Bk(i,t){if(i&1&&(f(0,"div",96),ce(1,"img",113),p()),i&2){let e=q(2);S(),Ce("src",e.imagePreview(),Ui)}}function jk(i,t){if(i&1){let e=nt();f(0,"div",14)(1,"div",57)(2,"div",58),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),p(),f(3,"div",59)(4,"button",60),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),st(),f(5,"svg",61),ce(6,"path",62),p()(),xt(),f(7,"div",63)(8,"h3",64),x(9),p(),f(10,"p",65),x(11),p()(),f(12,"div",66)(13,"form",67),ue("ngSubmit",function(){be(e);let r=q();return we(r.saveProject())}),f(14,"div")(15,"label",68),x(16," T\xEDtulo "),f(17,"span",69),x(18,"*"),p()(),ce(19,"input",70),xe(20,Fk,2,0,"div",71),p(),f(21,"div")(22,"label",72),x(23," Subt\xEDtulo "),f(24,"span",69),x(25,"*"),p()(),ce(26,"input",73),xe(27,Dk,2,0,"div",71),p(),f(28,"div")(29,"label",74),x(30," Descripci\xF3n "),f(31,"span",69),x(32,"*"),p()(),ce(33,"textarea",75),xe(34,Nk,2,0,"div",71),p(),f(35,"div",76)(36,"div")(37,"label",77),x(38," Categor\xEDa "),f(39,"span",69),x(40,"*"),p()(),f(41,"select",78)(42,"option",9),x(43,"Selecciona una categor\xEDa"),p(),zt(44,Pk,2,2,"option",10,Tu),p(),xe(46,Mk,2,0,"div",71),p(),xe(47,Lk,12,3,"div"),p(),f(48,"div",79)(49,"div",80),ce(50,"input",81),f(51,"label",82),x(52," \u{1F381} Este proyecto es "),f(53,"span",83),x(54,"GRATUITO"),p()()(),f(55,"div")(56,"label",84),x(57," Precio MXN "),f(58,"span",69),x(59,"*"),p()(),f(60,"div",85)(61,"span",86),x(62," $ "),p(),ce(63,"input",87),p(),xe(64,Ik,5,1,"div",88),xe(65,Rk,10,0,"div",89),xe(66,Ok,8,0,"div",90),p()(),f(67,"div")(68,"label",91),x(69," URL del Video (Opcional) "),p(),ce(70,"input",92),p(),f(71,"div")(72,"label",93),x(73," Imagen de portada "),p(),f(74,"div",94)(75,"input",95),ue("change",function(r){be(e);let a=q();return we(a.onImageChange(r))}),p()(),xe(76,Bk,2,1,"div",96),p()()(),f(77,"div",97)(78,"div",98)(79,"button",99),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),x(80," Cancelar "),p(),f(81,"button",100),x(82),p()()()()()()}if(i&2){let e,n,r,a,s,o,l,c,u,h=q();S(9),Re(" ",h.isEditing()?"Editar Proyecto":"Nuevo Proyecto"," "),S(2),Ve(h.isEditing()?"Actualiza la informaci\xF3n del proyecto":"Completa los datos del nuevo proyecto"),S(2),Ce("formGroup",h.projectForm),S(7),ve((e=h.projectForm.get("title"))!=null&&e.invalid&&((e=h.projectForm.get("title"))!=null&&e.touched)?20:-1),S(7),ve((n=h.projectForm.get("subtitle"))!=null&&n.invalid&&((n=h.projectForm.get("subtitle"))!=null&&n.touched)?27:-1),S(7),ve((r=h.projectForm.get("description"))!=null&&r.invalid&&((r=h.projectForm.get("description"))!=null&&r.touched)?34:-1),S(10),Ht(h.categories()),S(2),ve((a=h.projectForm.get("categorie"))!=null&&a.invalid&&((a=h.projectForm.get("categorie"))!=null&&a.touched)?46:-1),S(),ve(((s=h.authService.user())==null?null:s.rol)==="admin"?47:-1),S(16),Li("w-full pl-8 pr-4 py-2.5 border rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 transition-all "+((o=h.projectForm.get("isFree"))!=null&&o.value?"bg-slate-900/50 border-slate-700 opacity-60 cursor-not-allowed":"bg-slate-900 border-slate-700 focus:ring-lime-400 focus:border-transparent")),Ce("readonly",(l=h.projectForm.get("isFree"))==null?null:l.value),S(),ve(h.priceErrorMessage()?64:-1),S(),ve((c=h.projectForm.get("isFree"))!=null&&c.value?65:-1),S(),ve((u=h.projectForm.get("isFree"))!=null&&u.value?-1:66),S(10),ve(h.imagePreview()?76:-1),S(5),Ce("disabled",h.isLoading()),S(),Re(" ",h.isLoading()?"Guardando...":h.isEditing()?"Guardar Cambios":"Crear Proyecto"," ")}}function Vk(i,t){if(i&1){let e=nt();f(0,"li",140)(1,"div",143),st(),f(2,"svg",144),ce(3,"path",145),p(),xt(),f(4,"div")(5,"p",146),x(6),p(),f(7,"p",147),x(8),p()()(),f(9,"button",148),ue("click",function(){let r=be(e).$index,a=q(3);return we(a.removeSelectedFile(r))}),st(),f(10,"svg",61),ce(11,"path",62),p()()()}if(i&2){let e=t.$implicit,n=q(3);S(6),Ve(e.name),S(2),Ve(n.formatFileSize(e.size))}}function Uk(i,t){if(i&1&&(f(0,"div",142)(1,"div",149)(2,"span",150),x(3),p(),f(4,"span",150),x(5),p()(),f(6,"div",151),ce(7,"div",152),p()()),i&2){let e=q(3);S(3),Re(" ",e.uploadPercentage()===100?"Completado":"Subiendo archivo..."," "),S(2),Re("",e.uploadPercentage(),"%"),S(2),uo("width",e.uploadPercentage(),"%")}}function zk(i,t){if(i&1){let e=nt();f(0,"div",96)(1,"h4",138),x(2,"Archivos seleccionados:"),p(),f(3,"ul",139),zt(4,Vk,12,2,"li",140,Zl),p(),f(6,"button",141),ue("click",function(){be(e);let r=q(2);return we(r.uploadZipFiles())}),x(7),p(),xe(8,Uk,8,4,"div",142),p()}if(i&2){let e=q(2);S(4),Ht(e.selectedFiles()),S(2),Ce("disabled",e.uploadingFiles()),S(),Re(" ",e.uploadingFiles()?"Subiendo...":"Subir archivos"," "),S(),ve(e.uploadingFiles()?8:-1)}}function Hk(i,t){if(i&1&&(f(0,"li",155),x(1),p()),i&2){let e=t.$implicit;S(),Ve(e)}}function Wk(i,t){if(i&1&&(f(0,"div",132)(1,"h4",153),x(2,"Errores:"),p(),f(3,"ul",154),zt(4,Hk,2,1,"li",155,Zl),p()()),i&2){let e=q(2);S(4),Ht(e.fileErrorMessages())}}function qk(i,t){if(i&1&&(f(0,"div",133)(1,"p",156),x(2),p()()),i&2){let e=q(2);S(2),Ve(e.fileSuccessMessage())}}function Gk(i,t){if(i&1&&(f(0,"div",135)(1,"div",149)(2,"span",157),x(3),p(),f(4,"span",157),x(5),p()(),f(6,"div",151),ce(7,"div",158),p()()),i&2){let e=q(2);S(3),Re(" ",e.deletePercentage()===100?"Eliminado":"Eliminando archivo..."," "),S(2),Re("",e.deletePercentage(),"%"),S(2),uo("width",e.deletePercentage(),"%")}}function $k(i,t){if(i&1){let e=nt();f(0,"div",159)(1,"div",160),st(),f(2,"svg",161),ce(3,"path",145),p(),xt(),f(4,"div",162)(5,"p",163),x(6),p(),f(7,"p",147),x(8),p()()(),f(9,"div",164)(10,"button",165),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.downloadZipFile(r))}),st(),f(11,"svg",166),ce(12,"path",167),p()(),xt(),f(13,"button",168),ue("click",function(){let r=be(e).$implicit,a=q(3);return we(a.deleteZipFile(r))}),st(),f(14,"svg",61),ce(15,"path",169),p()()()()}if(i&2){let e=t.$implicit,n=q(3);S(6),Ve(e.name),S(2),hi("",n.formatFileSize(e.size)," \u2022 Subido el ",n.formatDate(e.uploadDate)),S(5),Ce("disabled",n.deletingFileId()===e._id)}}function Xk(i,t){if(i&1&&(f(0,"div",136),zt(1,$k,16,4,"div",159,Tu),p()),i&2){let e=q(2);S(),Ht(e.projectFiles())}}function Yk(i,t){i&1&&(f(0,"div",137),st(),f(1,"svg",170),ce(2,"path",171),p(),xt(),f(3,"p",172),x(4,"No hay archivos subidos a\xFAn"),p()())}function Kk(i,t){if(i&1){let e=nt();f(0,"div",114),ue("click",function(){be(e);let r=q();return we(r.closeFilesModal())}),p(),f(1,"div",115)(2,"div",116)(3,"div",117)(4,"button",118),ue("click",function(){be(e);let r=q();return we(r.closeFilesModal())}),st(),f(5,"svg",61),ce(6,"path",62),p()(),xt(),f(7,"div",119)(8,"div")(9,"h3",120),x(10,"Archivos del Proyecto"),p(),f(11,"p",121),x(12,"Sube archivos ZIP (m\xE1ximo 50MB cada uno)"),p()()(),f(13,"div",122)(14,"div",123)(15,"label",124),x(16,"Seleccionar archivos ZIP"),p(),f(17,"div",125)(18,"input",126),ue("change",function(r){be(e);let a=q();return we(a.onZipFilesSelected(r))}),p(),f(19,"label",127),st(),f(20,"svg",128),ce(21,"path",129),p(),xt(),f(22,"span",130),x(23,"Haz clic para seleccionar archivos"),p(),f(24,"span",131),x(25,"Solo archivos .zip de m\xE1ximo 50MB"),p()()(),xe(26,zk,9,3,"div",96),xe(27,Wk,6,0,"div",132),xe(28,qk,3,1,"div",133),p(),f(29,"div")(30,"h4",134),x(31,"Archivos guardados"),p(),xe(32,Gk,8,4,"div",135),xe(33,Xk,3,0,"div",136)(34,Yk,5,0,"div",137),p()()()()()}if(i&2){let e=q();S(26),ve(e.selectedFiles().length>0?26:-1),S(),ve(e.fileErrorMessages().length>0?27:-1),S(),ve(e.fileSuccessMessage()?28:-1),S(4),ve(e.deletingFileId()?32:-1),S(),ve(e.projectFiles().length>0?33:34)}}function Zk(i,t){if(i&1){let e=nt();f(0,"textarea",189),ue("ngModelChange",function(r){be(e);let a=q(2);return we(a.currentProjectNotes.set(r))}),p()}if(i&2){let e=q(2);Ce("ngModel",e.currentProjectNotes())}}function Jk(i,t){if(i&1&&(f(0,"div",185),x(1),p()),i&2){let e=q(2);S(),Re(" ",e.currentProjectNotes()||"Sin notas"," ")}}function Qk(i,t){if(i&1&&(f(0,"p",190),x(1),Jr(2,"date"),p()),i&2){let e=q().$implicit;S(),Re(" \xDAltima actualizaci\xF3n: ",us(2,1,e.updatedAt,"short")," ")}}function e8(i,t){if(i&1&&xe(0,Qk,3,4,"p",190),i&2){let e=t.$implicit,n=q(2);ve(e._id===n.currentProjectIdNotes()&&e.updatedAt?0:-1)}}function t8(i,t){i&1&&(st(),f(0,"svg",37),ce(1,"path",192),p())}function i8(i,t){if(i&1){let e=nt();f(0,"button",191),ue("click",function(){be(e);let r=q(2);return we(r.saveNote())}),x(1),xe(2,t8,2,0,":svg:svg",37),p()}if(i&2){let e=q(2);Ce("disabled",e.isSavingNote()),S(),Re(" ",e.isSavingNote()?"Guardando...":"Guardar Nota"," "),S(),ve(e.isSavingNote()?-1:2)}}function n8(i,t){if(i&1){let e=nt();f(0,"div",173),ue("click",function(){be(e);let r=q();return we(r.closeNotesModal())}),p(),f(1,"div",174)(2,"div",175),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(3,"div",176)(4,"h3",177),st(),f(5,"svg",178),ce(6,"path",179),p(),x(7," Notas del Proyecto "),p(),xt(),f(8,"button",180),ue("click",function(){be(e);let r=q();return we(r.closeNotesModal())}),st(),f(9,"svg",181),ce(10,"path",182),p()()(),xt(),f(11,"div",183),xe(12,Zk,1,1,"textarea",184)(13,Jk,2,1,"div",185),zt(14,e8,1,1,null,null,Tu),p(),f(16,"div",186)(17,"button",187),ue("click",function(){be(e);let r=q();return we(r.closeNotesModal())}),x(18," Cerrar "),p(),xe(19,i8,3,3,"button",188),p()()()}if(i&2){let e=q();S(12),ve(e.isUserAdmin()?12:13),S(2),Ht(e.projects()),S(5),ve(e.isUserAdmin()?19:-1)}}var th=class i{projectService=lt(z0);coursesService=lt(tl);authService=lt(pn);http=lt(ur);toast=lt(ua);projectsState=Ae({projects:[],isLoading:!1,error:null});projects=Ge(()=>this.projectsState().projects);isLoading=Ge(()=>this.projectsState().isLoading);projectSalesStatus=Ae(new Map);searchTerm=Ae("");selectedCategory=Ae("");categories=Ge(()=>this.coursesService.config().categories);users=Ge(()=>this.coursesService.config().users);isModalOpen=Ae(!1);isEditing=Ae(!1);currentProjectId=Ae(null);imagePreview=Ae(null);isFilesModalOpen=Ae(!1);selectedFiles=Ae([]);projectFiles=Ae([]);uploadingFiles=Ae(!1);deletingFileId=Ae(null);fileErrorMessages=Ae([]);fileSuccessMessage=Ae("");uploadPercentage=Ae(0);deletePercentage=Ae(0);showNotesModal=Ae(!1);currentProjectNotes=Ae("");isSavingNote=Ae(!1);currentProjectIdNotes=Ae(null);isUserAdmin=Ge(()=>this.authService.hasRole("admin"));MAX_FILE_SIZE=50*1024*1024;projectForm=new Ps({title:new ui("",[bi.required]),subtitle:new ui("",[bi.required]),description:new ui("",[bi.required]),price_mxn:new ui(0,[bi.required,bi.min(0)]),isFree:new ui(!1),categorie:new ui("",[bi.required]),state:new ui(1,[bi.required]),portada:new ui(null),url_video:new ui("")});priceErrorMessage=Ge(()=>{let t=this.projectForm.get("price_mxn"),e=this.projectForm.get("isFree");if(!t||!e)return null;let n=t.value||0;return e.value?null:n>0&&n<10?"El precio m\xEDnimo debe ser $10.00 MXN":null});ngOnInit(){this.loadProjects(),this.coursesService.reloadConfig(),this.projectForm.get("isFree")?.valueChanges.subscribe(t=>{let e=this.projectForm.get("price_mxn");t&&e?.setValue(0)})}loadProjects(){this.projectsState.update(t=>It(At({},t),{isLoading:!0})),this.projectService.list(this.searchTerm(),this.selectedCategory()).subscribe({next:t=>{this.projectsState.set({projects:t.projects,isLoading:!1,error:null}),this.checkProjectsSales(t.projects)},error:t=>{this.projectsState.set({projects:[],isLoading:!1,error:t})}})}checkProjectsSales(t){if(t.length===0)return;let e=new Map;t.forEach(a=>{e.set(a._id,{hasSales:!1,canDelete:!1,isChecking:!0})}),this.projectSalesStatus.set(new Map(e));let n=0,r=t.length;t.forEach((a,s)=>{this.projectService.checkSales(a._id).subscribe({next:o=>{e.set(a._id,{hasSales:o.hasSales,canDelete:o.canDelete,isChecking:!1}),n++,this.projectSalesStatus.set(new Map(e)),n===r&&e.forEach((l,c)=>{let u=t.find(h=>h._id===c)})},error:o=>{e.set(a._id,{hasSales:!0,canDelete:!1,isChecking:!1}),n++,this.projectSalesStatus.set(new Map(e))}})})}onSearch(t){let e=t.target.value;this.searchTerm.set(e),this.loadProjects()}onCategoryFilter(t){let e=t.target.value;this.selectedCategory.set(e),this.loadProjects()}openCreateModal(){this.isEditing.set(!1),this.projectForm.reset({title:"",subtitle:"",description:"",price_mxn:0,isFree:!1,categorie:"",state:1,portada:null,url_video:""}),this.imagePreview.set(null),this.isModalOpen.set(!0)}openEditModal(t){this.isEditing.set(!0),this.currentProjectId.set(t._id);let e=typeof t.categorie=="object"?t.categorie._id:t.categorie;this.projectForm.patchValue({title:t.title,subtitle:t.subtitle,description:t.description,price_mxn:t.price_mxn,isFree:t.isFree||!1,categorie:e,state:t.state||1,url_video:t.url_video||""}),this.imagePreview.set(t.imagen?this.buildImageUrl(t.imagen):null),this.isModalOpen.set(!0)}closeModal(){this.isModalOpen.set(!1),this.projectForm.reset(),this.imagePreview.set(null),this.currentProjectId.set(null),this.isEditing.set(!1)}onImageChange(t){let e=t.target;if(e.files&&e.files[0]){let n=e.files[0];this.projectForm.patchValue({portada:n});let r=new FileReader;r.onload=()=>{this.imagePreview.set(r.result)},r.readAsDataURL(n)}}saveProject(){if(this.projectForm.invalid){Object.keys(this.projectForm.controls).forEach(a=>{this.projectForm.get(a)?.markAsTouched()});return}let t=this.projectForm.get("isFree")?.value,e=this.projectForm.get("price_mxn")?.value||0;if(!t&&e>0&&e<10){alert("\u26A0\uFE0F El precio m\xEDnimo debe ser $10.00 MXN o puedes marcarlo como gratuito");return}let n=new FormData,r=this.projectForm.value;if(n.append("title",r.title||""),n.append("subtitle",r.subtitle||""),n.append("description",r.description||""),t)n.append("price_mxn","0"),n.append("isFree","true");else{let a=this.projectForm.get("price_mxn"),s=a?.disabled;s&&a?.enable(),n.append("price_mxn",a?.value?.toString()||"0"),n.append("isFree","false"),s&&a?.disable()}n.append("categorie",r.categorie||""),n.append("state",r.state?.toString()||"1"),n.append("url_video",r.url_video||""),r.portada&&n.append("imagen",r.portada),this.isEditing()?(n.append("_id",this.currentProjectId()||""),this.updateProject(n)):this.createProject(n)}createProject(t){this.projectsState.update(e=>It(At({},e),{isLoading:!0})),this.projectService.register(t).subscribe({next:e=>{alert("Proyecto creado exitosamente"),this.closeModal(),this.loadProjects()},error:e=>{alert(e.error?.message_text||"Error al crear el proyecto"),this.projectsState.update(n=>It(At({},n),{isLoading:!1}))}})}updateProject(t){this.projectsState.update(e=>It(At({},e),{isLoading:!0})),this.projectService.update(t).subscribe({next:e=>{alert("Proyecto actualizado exitosamente"),this.closeModal(),this.loadProjects()},error:e=>{alert(e.error?.message_text||"Error al actualizar el proyecto"),this.projectsState.update(n=>It(At({},n),{isLoading:!1}))}})}deleteProject(t){let e=this.projectSalesStatus().get(t._id);if(!e||e.isChecking){alert("\u23F3 Por favor espera, estamos verificando el estado del proyecto...");return}if(e.hasSales){alert(`\u{1F6AB} No se puede eliminar "${t.title}"

Este proyecto tiene estudiantes que ya lo compraron.
No se puede eliminar para proteger la integridad de los datos.`);return}confirm(`\u26A0\uFE0F \xBFEst\xE1s seguro de eliminar "${t.title}"?

Esta acci\xF3n es permanente y no se puede deshacer.`)&&(this.projectsState.update(r=>It(At({},r),{isLoading:!0})),this.projectService.delete(t._id).subscribe({next:r=>{r.code===403?(alert(`\u{1F6AB} ${r.message}`),this.projectsState.update(a=>It(At({},a),{isLoading:!1}))):r.code===200||r.message?.includes("ELIMIN\xD3")?(alert("\u2705 Proyecto eliminado exitosamente"),this.loadProjects()):(alert("\u2705 Proyecto eliminado"),this.loadProjects())},error:r=>{let a=r.error?.message||"Error al eliminar el proyecto";alert(`\u274C ${a}`),this.projectsState.update(s=>It(At({},s),{isLoading:!1}))}}))}canDeleteProject(t){let e=this.authService.user();if(!e)return!1;let n=this.projectSalesStatus().get(t._id);return!n||n.isChecking||n.hasSales?!1:e.rol==="admin"?!0:e.rol==="instructor"?(typeof t.user=="object"?t.user._id:t.user)===e._id:!1}buildImageUrl(t){return`${$t.url}projects/imagen-project/${t}`}getStateBadgeClass(t){switch(t){case 1:return"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30";case 2:return"bg-lime-500/20 text-lime-400 border border-lime-500/30";case 3:return"bg-red-500/20 text-red-400 border border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border border-gray-500/30"}}getStateText(t){switch(t){case 1:return"Borrador";case 2:return"P\xFAblico";case 3:return"Anulado";default:return"Desconocido"}}openFilesModal(t){this.currentProjectId.set(t._id),this.selectedFiles.set([]),this.fileErrorMessages.set([]),this.fileSuccessMessage.set(""),this.loadProjectFiles(t._id),this.isFilesModalOpen.set(!0)}closeFilesModal(){this.isFilesModalOpen.set(!1),this.currentProjectId.set(null),this.selectedFiles.set([]),this.projectFiles.set([]),this.fileErrorMessages.set([]),this.fileSuccessMessage.set("")}loadProjectFiles(t){this.projectService.getByIdAdmin(t).subscribe({next:e=>{this.projectFiles.set(e.project.files||[])},error:e=>{}})}onZipFilesSelected(t){let e=t.target;if(!e.files)return;let n=Array.from(e.files),r=[],a=[];n.forEach(s=>{if(!s.name.toLowerCase().endsWith(".zip")){r.push(`${s.name}: Solo se permiten archivos ZIP`);return}if(s.size>this.MAX_FILE_SIZE){r.push(`${s.name}: Excede el tama\xF1o m\xE1ximo de 50MB`);return}a.push(s)}),this.selectedFiles.update(s=>[...s,...a]),this.fileErrorMessages.set(r),e.value=""}removeSelectedFile(t){this.selectedFiles.update(e=>e.filter((n,r)=>r!==t))}uploadZipFiles(){let t=this.selectedFiles();if(t.length===0)return;let e=this.currentProjectId();if(!e)return;this.uploadingFiles.set(!0),this.fileErrorMessages.set([]),this.fileSuccessMessage.set("");let n=new FormData;t.forEach((r,a)=>{n.append(`file${a}`,r)}),this.projectService.uploadFiles(e,n).subscribe({next:r=>{switch(r.type){case Qo.UploadProgress:if(r.total){let a=Math.round(100*r.loaded/r.total);this.uploadPercentage.set(a)}break;case Qo.Response:this.uploadPercentage.set(100),setTimeout(()=>{let a=r.body;this.fileSuccessMessage.set(`Se subieron ${a.uploadedFiles} archivo(s) correctamente`),a.errors&&a.errors.length>0&&this.fileErrorMessages.set(a.errors),this.selectedFiles.set([]),this.loadProjectFiles(e),this.uploadingFiles.set(!1),this.uploadPercentage.set(0),setTimeout(()=>{this.fileSuccessMessage.set("")},5e3)},1e3);break}},error:r=>{this.fileErrorMessages.set(["Error al subir los archivos. Por favor, intenta de nuevo."]),this.uploadingFiles.set(!1),this.uploadPercentage.set(0)}})}deleteZipFile(t){if(!confirm(`\xBFEst\xE1s seguro de eliminar el archivo "${t.name}"?`))return;let e=this.currentProjectId();if(!e)return;this.deletingFileId.set(t._id),this.deletePercentage.set(0);let n=0,r=setInterval(()=>{n<90&&(n+=Math.floor(Math.random()*5)+5,n>90&&(n=90),this.deletePercentage.set(n))},200);this.projectService.deleteFile(e,t._id).subscribe({next:a=>{clearInterval(r),this.deletePercentage.set(100),setTimeout(()=>{this.fileSuccessMessage.set("Archivo eliminado correctamente"),this.loadProjectFiles(e),this.deletingFileId.set(null),this.deletePercentage.set(0),setTimeout(()=>{this.fileSuccessMessage.set("")},3e3)},1e3)},error:a=>{clearInterval(r),this.fileErrorMessages.set(["Error al eliminar el archivo"]),this.deletingFileId.set(null),this.deletePercentage.set(0)}})}downloadZipFile(t){let e=this.currentProjectId();if(!e)return;let n=this.projectService.getFileDownloadUrl(e,t.filename);window.open(n,"_blank")}formatFileSize(t){if(t===0)return"0 Bytes";let e=1024,n=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(e));return Math.round(t/Math.pow(e,r)*100)/100+" "+n[r]}formatDate(t){return new Date(t).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}openNotesModal(t){this.currentProjectIdNotes.set(t._id),this.currentProjectNotes.set(t.admin_notes||""),this.showNotesModal.set(!0)}closeNotesModal(){this.showNotesModal.set(!1),this.currentProjectNotes.set(""),this.currentProjectIdNotes.set(null)}saveNote(){let t=this.currentProjectIdNotes();t&&(this.isSavingNote.set(!0),this.http.put(`${$t.url}projects/${t}/note`,{admin_notes:this.currentProjectNotes()}).subscribe({next:()=>{this.toast.success("Nota guardada correctamente");let e=this.projectsState().projects,n=e.findIndex(r=>r._id===t);n>=0&&(e[n].admin_notes=this.currentProjectNotes(),this.projectsState.set(It(At({},this.projectsState()),{projects:e}))),this.closeNotesModal(),this.isSavingNote.set(!1)},error:e=>{this.toast.error("Error al guardar la nota"),this.isSavingNote.set(!1)}}))}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-projects"]],decls:21,vars:8,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-white"],[1,"h-10","px-5","rounded-xl","bg-lime-400","text-slate-900","font-bold","hover:bg-lime-300","transition",3,"click"],[1,"flex","flex-col","md:flex-row","gap-4"],[1,"flex-1"],["type","text","placeholder","Buscar proyectos...",1,"w-full","border","text-sm","rounded-lg","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500",3,"input","value"],[1,"w-full","md:w-64"],[1,"w-full","border","text-sm","rounded-lg","p-2.5","bg-slate-700","border-slate-600","text-white","focus:ring-lime-500","focus:border-lime-500",3,"change","value"],["value",""],[3,"value"],[1,"flex","justify-center","items-center","py-12"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"text-center","py-12","rounded-lg","border","border-white/10","bg-slate-800/50"],["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"rounded-lg","shadow-md","overflow-hidden","border","border-white/10","bg-slate-800/50","hover:bg-slate-700/50","transition-colors"],[1,"h-48","bg-slate-900","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"w-full","h-full","flex","items-center","justify-center","text-gray-600"],[1,"p-5"],[1,"mb-3"],[1,"text-xl","font-semibold","text-white","mb-2","line-clamp-2"],[1,"text-sm","text-gray-400","mb-3","line-clamp-2"],[1,"flex","items-center","gap-2","mb-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"text-sm","text-gray-400"],[1,"flex","items-center","gap-3","mb-4"],[1,"inline-flex","items-center","px-3","py-1.5","text-sm","font-bold","text-green-400","bg-green-500/10","border","border-green-500/30","rounded-full"],[1,"flex","flex-col"],[1,"flex","items-center","gap-2","mb-4","pb-4","border-b","border-slate-700"],[1,"grid","grid-cols-2","gap-2"],["title","Agregar o ver notas del proyecto",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-amber-400","hover:bg-slate-900","transition-colors","flex","items-center","justify-center","gap-1",3,"ring-1"],[1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-lime-400","hover:bg-slate-900","transition-colors",3,"click"],["title","Eliminar proyecto",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-red-400","hover:bg-slate-900","transition-colors"],[1,"col-span-2","px-4","py-2","rounded-lg","font-medium","text-sm","text-blue-400","hover:bg-slate-900","transition-colors","flex","items-center","justify-center","gap-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"text-lg","font-bold","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["title","Agregar o ver notas del proyecto",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-amber-400","hover:bg-slate-900","transition-colors","flex","items-center","justify-center","gap-1",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Eliminar proyecto",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-red-400","hover:bg-slate-900","transition-colors",3,"click"],["disabled","","title","Verificando estado del proyecto...",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-gray-500","bg-slate-900/50","cursor-not-allowed","opacity-50","flex","items-center","justify-center","gap-2"],["disabled","","title","\u{1F6AB} Este proyecto tiene estudiantes que ya lo compraron. No se puede eliminar para proteger la integridad de los datos de ventas.",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-gray-500","bg-slate-900/50","cursor-not-allowed","opacity-50"],["disabled","","title","\u274C No tienes permisos para eliminar este proyecto. Solo puedes eliminar tus propios proyectos.",1,"px-4","py-2","rounded-lg","font-medium","text-sm","text-gray-500","bg-slate-900/50","cursor-not-allowed","opacity-50"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-24","w-24","text-gray-600","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"],[1,"text-xl","font-semibold","text-white","mb-2"],[1,"text-gray-400","mb-6"],[1,"px-6","py-2","bg-lime-400","text-slate-900","rounded-lg","hover:bg-lime-300","transition-colors","font-medium",3,"click"],[1,"flex","items-center","justify-center","min-h-screen","px-4","pt-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-slate-900/80","backdrop-blur-sm","transition-opacity",3,"click"],[1,"relative","inline-block","align-bottom","bg-slate-800","rounded-2xl","text-left","overflow-hidden","shadow-2xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-2xl","sm:w-full","border","border-white/10"],["type","button",1,"absolute","top-4","right-4","z-10","text-slate-400","hover:text-white","bg-slate-700/50","hover:bg-slate-700","rounded-lg","p-2","transition-colors",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"bg-gradient-to-br","from-lime-500/10","to-transparent","px-6","py-5","border-b","border-white/10"],[1,"text-xl","font-bold","text-white"],[1,"text-sm","text-slate-400","mt-1"],[1,"max-h-[60vh]","overflow-y-auto","px-6","py-6"],["id","project-form",1,"space-y-5",3,"ngSubmit","formGroup"],["for","title",1,"block","mb-2","text-sm","font-medium","text-slate-300"],[1,"text-red-400"],["type","text","id","title","formControlName","title","placeholder","Nombre del proyecto",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-red-400","text-sm","mt-1"],["for","subtitle",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["type","text","id","subtitle","formControlName","subtitle","placeholder","Breve descripci\xF3n del proyecto",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["for","description",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["id","description","formControlName","description","rows","4","placeholder","Describe tu proyecto en detalle",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent","resize-none"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],["for","categorie",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["id","categorie","formControlName","categorie",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"space-y-4"],[1,"flex","items-center","space-x-3","p-4","bg-lime-500/5","rounded-lg","border","border-lime-500/20"],["type","checkbox","id","isFree","formControlName","isFree",1,"w-5","h-5","text-lime-500","bg-slate-700","border-slate-600","rounded","focus:ring-lime-500","focus:ring-2","cursor-pointer"],["for","isFree",1,"text-white","font-medium","cursor-pointer","select-none","flex-1"],[1,"text-lime-400","ml-1"],["for","price_mxn",1,"block","mb-2","text-sm","font-medium","text-slate-300"],[1,"relative"],[1,"absolute","inset-y-0","left-0","flex","items-center","pl-4","text-slate-400","font-medium"],["type","number","id","price_mxn","formControlName","price_mxn","min","0","step","0.01","placeholder","0.00",3,"readonly"],[1,"mt-2","p-3","bg-red-500/10","border","border-red-500/30","rounded-lg","flex","items-start","gap-2"],[1,"mt-2","p-3","bg-green-500/10","border","border-green-500/30","rounded-lg","flex","items-start","gap-2"],[1,"mt-2","p-3","bg-blue-500/10","border","border-blue-500/30","rounded-lg","flex","items-start","gap-2"],["for","url_video",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["type","url","id","url_video","formControlName","url_video","placeholder","https://youtube.com/watch?v=...",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["for","portada",1,"block","mb-2","text-sm","font-medium","text-slate-300"],[1,"border-2","border-dashed","border-slate-700","rounded-lg","p-4","hover:border-lime-400","transition-colors"],["type","file","id","portada","accept","image/*",1,"block","w-full","text-sm","text-slate-400","file:mr-4","file:py-2","file:px-4","file:rounded-lg","file:border-0","file:text-sm","file:font-semibold","file:bg-lime-500/10","file:text-lime-400","hover:file:bg-lime-500/20","cursor-pointer",3,"change"],[1,"mt-4"],[1,"bg-slate-900/50","px-6","py-4","border-t","border-white/10"],[1,"flex","gap-3","justify-end"],["type","button",1,"px-5","py-2.5","rounded-lg","bg-slate-700","text-slate-300","hover:bg-slate-600","transition-colors","font-medium",3,"click"],["type","submit","form","project-form",1,"px-5","py-2.5","rounded-lg","bg-lime-400","text-slate-900","hover:bg-lime-300","transition-colors","font-semibold","disabled:bg-slate-600","disabled:cursor-not-allowed","disabled:opacity-50",3,"disabled"],["for","state",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["id","state","formControlName","state",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-red-400","flex-shrink-0","mt-0.5"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z","clip-rule","evenodd"],[1,"text-red-300","text-sm","font-medium"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-green-400","flex-shrink-0","mt-0.5"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"text-green-400","text-sm","font-medium"],[1,"text-green-300/70","text-xs","mt-1"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-blue-400","flex-shrink-0","mt-0.5"],["fill-rule","evenodd","d","M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule","evenodd"],[1,"text-blue-300","text-sm"],["alt","Preview",1,"w-full","h-48","object-cover","rounded-lg","ring-1","ring-white/10",3,"src"],[1,"fixed","inset-0","z-40","bg-gray-900/50","backdrop-blur-sm",3,"click"],[1,"fixed","top-0","right-0","left-0","z-50","justify-center","items-start","w-full","md:inset-0","h-modal","md:h-full","flex","pt-8"],[1,"relative","p-4","w-full","max-w-3xl","max-h-[90vh]"],[1,"relative","rounded-lg","shadow-xl","bg-slate-800","border","border-white/10","flex","flex-col","h-full"],["type","button",1,"absolute","top-3","right-2.5","text-gray-400","bg-transparent","hover:bg-slate-700","hover:text-white","rounded-lg","text-sm","p-1.5","-mr-2","inline-flex","items-center","transition-colors","z-10",3,"click"],[1,"flex","justify-between","items-center","py-6","px-6","lg:px-8","border-b","border-slate-700"],[1,"text-xl","font-medium","text-white"],[1,"text-sm","text-gray-400","mt-1"],[1,"flex-grow","overflow-y-auto","p-6","lg:p-8"],[1,"mb-6"],["for","zip-files",1,"block","mb-2","text-sm","font-medium","text-gray-300"],[1,"border-2","border-dashed","border-slate-600","rounded-lg","p-6","text-center","hover:border-lime-500","transition-colors"],["type","file","id","zip-files","multiple","","accept",".zip",1,"hidden",3,"change"],["for","zip-files",1,"cursor-pointer","flex","flex-col","items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-gray-400","mb-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"],[1,"text-sm","text-gray-300"],[1,"text-xs","text-gray-500","mt-1"],[1,"mt-4","bg-red-500/10","border","border-red-500/30","rounded-lg","p-4"],[1,"mt-4","bg-green-500/10","border","border-green-500/30","rounded-lg","p-4"],[1,"text-lg","font-semibold","mb-3","text-white"],[1,"mb-4","p-4","bg-red-500/10","border","border-red-500/30","rounded-lg"],[1,"space-y-3"],[1,"text-center","py-8","text-gray-400"],[1,"text-sm","font-medium","text-gray-300","mb-2"],[1,"space-y-2"],[1,"flex","items-center","justify-between","bg-slate-700/50","p-3","rounded-lg"],[1,"mt-4","w-full","bg-lime-400","text-slate-900","py-2","px-4","rounded-lg","hover:bg-lime-500","disabled:bg-slate-600","disabled:cursor-not-allowed","transition-colors","font-medium",3,"click","disabled"],[1,"mt-4","p-4","bg-lime-500/10","border","border-lime-500/30","rounded-lg"],[1,"flex","items-center","space-x-3"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-blue-400"],["d","M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z"],[1,"text-sm","font-medium","text-white"],[1,"text-xs","text-gray-400"],[1,"text-red-400","hover:text-red-300",3,"click"],[1,"flex","justify-between","mb-1"],[1,"text-sm","font-medium","text-lime-400"],[1,"w-full","bg-gray-700","rounded-full","h-2.5","overflow-hidden"],[1,"bg-lime-500","h-2.5","rounded-full","transition-all","duration-300","ease-out"],[1,"text-sm","font-medium","text-red-400","mb-2"],[1,"list-disc","list-inside","space-y-1"],[1,"text-sm","text-red-300"],[1,"text-sm","text-green-300"],[1,"text-sm","font-medium","text-red-400"],[1,"bg-red-500","h-2.5","rounded-full","transition-all","duration-300","ease-out"],[1,"flex","items-center","justify-between","bg-slate-700/50","p-4","rounded-lg","hover:bg-slate-700","transition-colors"],[1,"flex","items-center","space-x-3","flex-1","min-w-0"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-lime-400","flex-shrink-0"],[1,"flex-1","min-w-0"],[1,"text-sm","font-medium","text-white","truncate"],[1,"flex","items-center","space-x-2","flex-shrink-0","ml-4"],["title","Descargar archivo",1,"p-2","text-blue-400","hover:bg-slate-600","rounded-lg","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],["title","Eliminar archivo",1,"p-2","text-red-400","hover:bg-slate-600","rounded-lg","transition-colors","disabled:opacity-50",3,"click","disabled"],["fill-rule","evenodd","d","M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule","evenodd"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","mb-3","text-gray-600"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"],[1,"text-sm"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm","z-50",3,"click"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4"],[1,"bg-gradient-to-br","from-slate-800","to-slate-900","rounded-2xl","shadow-2xl","max-w-md","w-full","border","border-white/10","overflow-hidden",3,"click"],[1,"bg-gradient-to-r","from-amber-500/20","to-amber-600/20","px-6","py-4","border-b","border-white/10","flex","items-center","justify-between"],[1,"text-lg","font-bold","text-white","flex","items-center","gap-2"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-amber-400"],["d","M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"],[1,"text-white/60","hover:text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"px-6","py-4","space-y-4"],["placeholder","Escribe una nota para este proyecto...",1,"w-full","h-32","px-4","py-3","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-amber-500/50","focus:border-amber-500/50","resize-none",3,"ngModel"],[1,"w-full","h-32","px-4","py-3","bg-slate-900/50","border","border-slate-700/50","rounded-lg","text-white/80","overflow-y-auto","whitespace-pre-wrap","break-words"],[1,"px-6","py-4","border-t","border-white/10","flex","gap-3"],[1,"flex-1","px-4","py-2","bg-slate-700/50","hover:bg-slate-700","text-slate-300","rounded-lg","font-medium","transition-colors",3,"click"],[1,"flex-1","px-4","py-2","bg-amber-500","hover:bg-amber-600","disabled:bg-amber-500/50","text-white","rounded-lg","font-medium","transition-colors","flex","items-center","justify-center","gap-2",3,"disabled"],["placeholder","Escribe una nota para este proyecto...",1,"w-full","h-32","px-4","py-3","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-amber-500/50","focus:border-amber-500/50","resize-none",3,"ngModelChange","ngModel"],[1,"text-xs","text-slate-500"],[1,"flex-1","px-4","py-2","bg-amber-500","hover:bg-amber-600","disabled:bg-amber-500/50","text-white","rounded-lg","font-medium","transition-colors","flex","items-center","justify-center","gap-2",3,"click","disabled"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"h2",2),x(3,"Gesti\xF3n de Proyectos"),p(),f(4,"button",3),ue("click",function(){return n.openCreateModal()}),x(5," Crear Proyecto "),p()(),f(6,"div",4)(7,"div",5)(8,"input",6),ue("input",function(a){return n.onSearch(a)}),p()(),f(9,"div",7)(10,"select",8),ue("change",function(a){return n.onCategoryFilter(a)}),f(11,"option",9),x(12,"Todas las categor\xEDas"),p(),zt(13,hk,2,2,"option",10,Tu),p()()(),xe(15,pk,2,0,"div",11),xe(16,Tk,3,0,"div",12),xe(17,Ak,9,0,"div",13),p(),xe(18,jk,83,17,"div",14),xe(19,Kk,35,5),xe(20,n8,20,2)),e&2&&(S(8),Ce("value",n.searchTerm()),S(2),Ce("value",n.selectedCategory()),S(3),Ht(n.categories()),S(2),ve(n.isLoading()?15:-1),S(),ve(!n.isLoading()&&n.projects().length>0?16:-1),S(),ve(!n.isLoading()&&n.projects().length===0?17:-1),S(),ve(n.isModalOpen()?18:-1),S(),ve(n.isFilesModalOpen()?19:-1),S(),ve(n.showNotesModal()?20:-1))},dependencies:[yn,pr,Wa,Hn,Wn,ki,Pf,Nf,hr,wi,dr,jv,fr,Ur,mn,zn,U0,Ff],encapsulation:2})};var ih=class i{http=lt(ur);base=$t.url;settingsState=Ae({settings:{},isLoading:!1,lastUpdate:null});globalSettingsState=Ae({allSettings:[],groupedSettings:[],isLoading:!1});coursesState=Ae({courses:[],isLoading:!1});projectsState=Ae({projects:[],isLoading:!1});settings=Ge(()=>this.settingsState().settings);isLoading=Ge(()=>this.settingsState().isLoading);lastUpdate=Ge(()=>this.settingsState().lastUpdate);isLoadingSettings=Ge(()=>this.globalSettingsState().isLoading);groupedSettings=Ge(()=>this.globalSettingsState().groupedSettings);courses=Ge(()=>this.coursesState().courses);projects=Ge(()=>this.projectsState().projects);isLoadingCourses=Ge(()=>this.coursesState().isLoading);isLoadingProjects=Ge(()=>this.projectsState().isLoading);generalSettings=Ge(()=>{let t=this.settings();return Object.entries(t).filter(([e,n])=>n.group==="general").reduce((e,[n,r])=>It(At({},e),{[n]:r}),{})});contactSettings=Ge(()=>{let t=this.settings();return Object.entries(t).filter(([e,n])=>n.group==="contact").reduce((e,[n,r])=>It(At({},e),{[n]:r}),{})});socialSettings=Ge(()=>{let t=this.settings();return Object.entries(t).filter(([e,n])=>n.group==="social").reduce((e,[n,r])=>It(At({},e),{[n]:r}),{})});platformName=Ge(()=>this.settings().platform_name?.value||"Dev-Sharks");logoUrl=Ge(()=>{let t=this.settings().logo?.value;return t?`${$t.url}settings/logo/${t}`:null});loadSettings(){this.settingsState.update(e=>It(At({},e),{isLoading:!0}));let t=this.http.get(`${$t.url}settings/all`);return t.subscribe({next:e=>{let n={};Array.isArray(e.settings)?e.settings.forEach(r=>{n[r.key]={key:r.key,value:r.value,name:r.name||r.key,description:r.description||"",group:r.group||"general",type:r.type||"text"}}):n=e.settings||{},this.settingsState.set({settings:n,isLoading:!1,lastUpdate:new Date})},error:e=>{this.settingsState.update(n=>It(At({},n),{isLoading:!1}))}}),t}loadGlobalSettings(){this.globalSettingsState.update(e=>It(At({},e),{isLoading:!0}));let t=this.http.get(`${$t.url}settings/grouped`);return t.subscribe({next:e=>{this.globalSettingsState.set({allSettings:e.settings||[],groupedSettings:this.groupSettingsByCategory(e.settings||[]),isLoading:!1})},error:e=>{this.globalSettingsState.update(n=>It(At({},n),{isLoading:!1}))}}),t}loadCourses(){return this.coursesState.update(t=>It(At({},t),{isLoading:!0})),this.http.get(`${$t.url}courses/list`).pipe(lr(t=>{this.coursesState.set({courses:t.courses||[],isLoading:!1})}))}loadProjects(){return this.projectsState.update(t=>It(At({},t),{isLoading:!0})),this.http.get(`${$t.url}projects/list`).pipe(lr(t=>{this.projectsState.set({projects:t.projects||[],isLoading:!1})}))}toggleCourseFeatured(t,e){return this.http.put(`${$t.url}courses/toggle-featured/${t}`,{is_featured:e})}toggleProjectFeatured(t,e){return this.http.put(`${$t.url}projects/toggle-featured/${t}`,{is_featured:e})}updateLocalCourse(t){this.coursesState.update(e=>It(At({},e),{courses:e.courses.map(n=>n._id===t._id?t:n)}))}updateLocalProject(t){this.projectsState.update(e=>It(At({},e),{projects:e.projects.map(n=>n._id===t._id?t:n)}))}groupSettingsByCategory(t){let e={};return t.forEach(n=>{e[n.group]||(e[n.group]={group:n.group,title:this.getGroupTitle(n.group),description:this.getGroupDescription(n.group),settings:[]}),e[n.group].settings.push(n)}),Object.values(e)}getGroupTitle(t){return{general:"General",commissions:"Comisiones",payments:"Pagos",email:"Email",legal:"Legal",features:"Funcionalidades"}[t]||t}getGroupDescription(t){return{general:"Configuraci\xF3n general del sistema",commissions:"Configuraci\xF3n de comisiones",payments:"Configuraci\xF3n de m\xE9todos de pago",email:"Configuraci\xF3n de emails",legal:"Configuraci\xF3n legal",features:"Configuraci\xF3n de funcionalidades"}[t]||""}updateSettings(t){return this.http.put(`${$t.url}settings/update`,t)}updateLogo(t){let e=new FormData;return e.append("logo",t),this.http.post(`${$t.url}settings/update-logo`,e)}deleteLogo(){return this.http.delete(`${$t.url}settings/delete-logo`)}resetSettings(){return this.http.post(`${$t.url}settings/reset`,{})}initializeDefaults(){return this.http.post(`${$t.url}settings/initialize-defaults`,{})}getSetting(t){return this.settings()[t]?.value||null}buildLogoUrl(t){return t?`${$t.url}settings/logo/${t}`:""}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var L_=(i,t)=>t._id;function r8(i,t){i&1&&(Ue(0,"div",15),ln(1,"div",17),je())}function a8(i,t){i&1&&(Ue(0,"div",22),st(),Ue(1,"svg",30),ln(2,"path",31),je(),x(3," Destacado "),je())}function s8(i,t){i&1&&(Ue(0,"span",27),x(1," \u{1F381} GRATUITO "),je())}function o8(i,t){if(i&1&&(Ue(0,"div",28),x(1),Jr(2,"number"),je()),i&2){let e=q().$implicit;S(),Re(" $",us(2,1,e.price_mxn,"1.0-2")," ")}}function l8(i,t){if(i&1){let e=nt();Ue(0,"div")(1,"div",20),ln(2,"img",21),xe(3,a8,4,0,"div",22),je(),Ue(4,"div",23)(5,"h3",24),x(6),je(),Ue(7,"p",25),x(8),je(),Ue(9,"div",26),xe(10,s8,2,0,"span",27)(11,o8,3,4,"div",28),Ue(12,"button",29),Mn("click",function(r){let a=be(e).$implicit,s=q(3);return we(s.toggleCourseFeatured(a,r))}),x(13),je()()()()}if(i&2){let e=t.$implicit,n=q(3);Li("rounded-lg border overflow-hidden transition-all "+(e.featured?"bg-lime-950/50 border-lime-500/30":"bg-slate-800/50 border-white/10")),S(2),cs("src",n.getCourseImageUrl(e.imagen),Ui)("alt",e.title),S(),ve(e.featured?3:-1),S(3),Re(" ",e.title," "),S(2),Re(" ",e.subtitle," "),S(2),ve(e.isFree||e.price_mxn===0?10:11),S(2),Li(e.featured?"bg-red-500/20 text-red-400 hover:bg-red-500/30 border-red-500/40":"bg-lime-500/20 text-lime-400 hover:bg-lime-500/30 border-lime-500/40"),S(),Re(" ",e.featured?"Quitar Destacado":"Destacar"," ")}}function c8(i,t){i&1&&(Ue(0,"div",19),x(1," No se encontraron cursos "),je())}function u8(i,t){if(i&1&&(Ue(0,"div",16),zt(1,l8,14,11,"div",18,L_,!1,c8,2,0,"div",19),je()),i&2){let e=q(2);S(),Ht(e.filteredCourses())}}function d8(i,t){if(i&1){let e=nt();Ue(0,"div",12)(1,"div",13)(2,"input",14),Mn("input",function(r){be(e);let a=q();return we(a.courseSearch.set(r.target.value))}),je()(),xe(3,r8,2,0,"div",15),xe(4,u8,4,1,"div",16),je()}if(i&2){let e=q();S(2),cs("value",e.courseSearch()),S(),ve(e.isLoadingCourses()?3:-1),S(),ve(e.isLoadingCourses()?-1:4)}}function f8(i,t){i&1&&(Ue(0,"div",15),ln(1,"div",33),je())}function h8(i,t){i&1&&(Ue(0,"div",34),st(),Ue(1,"svg",30),ln(2,"path",31),je(),x(3," Destacado "),je())}function p8(i,t){i&1&&(Ue(0,"span",27),x(1," \u{1F381} GRATUITO "),je())}function m8(i,t){if(i&1&&(Ue(0,"div",35),x(1),Jr(2,"number"),je()),i&2){let e=q().$implicit;S(),Re(" $",us(2,1,e.price_mxn,"1.0-2")," ")}}function g8(i,t){if(i&1){let e=nt();Ue(0,"div")(1,"div",20),ln(2,"img",21),xe(3,h8,4,0,"div",34),je(),Ue(4,"div",23)(5,"h3",24),x(6),je(),Ue(7,"p",25),x(8),je(),Ue(9,"div",26),xe(10,p8,2,0,"span",27)(11,m8,3,4,"div",35),Ue(12,"button",29),Mn("click",function(r){let a=be(e).$implicit,s=q(3);return we(s.toggleProjectFeatured(a,r))}),x(13),je()()()()}if(i&2){let e=t.$implicit,n=q(3);Li("rounded-lg border overflow-hidden transition-all "+(e.featured?"bg-cyan-950/50 border-cyan-500/30":"bg-slate-800/50 border-white/10")),S(2),cs("src",n.getProjectImageUrl(e.imagen),Ui)("alt",e.title),S(),ve(e.featured?3:-1),S(3),Re(" ",e.title," "),S(2),Re(" ",e.subtitle," "),S(2),ve(e.isFree||e.price_mxn===0?10:11),S(2),Li(e.featured?"bg-red-500/20 text-red-400 hover:bg-red-500/30 border-red-500/40":"bg-cyan-500/20 text-cyan-400 hover:bg-cyan-500/30 border-cyan-500/40"),S(),Re(" ",e.featured?"Quitar Destacado":"Destacar"," ")}}function x8(i,t){i&1&&(Ue(0,"div",19),x(1," No se encontraron proyectos "),je())}function v8(i,t){if(i&1&&(Ue(0,"div",16),zt(1,g8,14,11,"div",18,L_,!1,x8,2,0,"div",19),je()),i&2){let e=q(2);S(),Ht(e.filteredProjects())}}function _8(i,t){if(i&1){let e=nt();Ue(0,"div",12)(1,"div",13)(2,"input",32),Mn("input",function(r){be(e);let a=q();return we(a.projectSearch.set(r.target.value))}),je()(),xe(3,f8,2,0,"div",15),xe(4,v8,4,1,"div",16),je()}if(i&2){let e=q();S(2),cs("value",e.projectSearch()),S(),ve(e.isLoadingProjects()?3:-1),S(),ve(e.isLoadingProjects()?-1:4)}}var nh=class i{settingsService=lt(ih);homeService=lt(Af);courses=this.settingsService.courses;projects=this.settingsService.projects;isLoadingCourses=this.settingsService.isLoadingCourses;isLoadingProjects=this.settingsService.isLoadingProjects;activeTab=Ae("courses");courseSearch=Ae("");projectSearch=Ae("");filteredCourses=Ge(()=>{let t=this.courseSearch().toLowerCase();return this.courses().filter(e=>e.title.toLowerCase().includes(t))});filteredProjects=Ge(()=>{let t=this.projectSearch().toLowerCase();return this.projects().filter(e=>e.title.toLowerCase().includes(t))});ngOnInit(){this.settingsService.loadCourses().subscribe(),this.settingsService.loadProjects().subscribe()}toggleCourseFeatured(t,e){e.stopPropagation();let n=t.featured,r=!n;this.settingsService.updateLocalCourse(It(At({},t),{featured:r})),this.settingsService.toggleCourseFeatured(t._id,r).subscribe({next:a=>{this.settingsService.updateLocalCourse(a.course),this.homeService.reloadHome()},error:a=>{this.settingsService.updateLocalCourse(It(At({},t),{featured:n})),alert("Error al actualizar el curso. El cambio ha sido revertido.")}})}toggleProjectFeatured(t,e){e.stopPropagation();let n=t.featured,r=!n;this.settingsService.updateLocalProject(It(At({},t),{featured:r})),this.settingsService.toggleProjectFeatured(t._id,r).subscribe({next:a=>{this.settingsService.updateLocalProject(a.project),this.homeService.reloadHome()},error:a=>{alert("Error al actualizar el proyecto."),this.settingsService.updateLocalProject(It(At({},t),{featured:n}))}})}getCourseImageUrl(t){return t?`${this.settingsService.base}courses/imagen-course/${t}`:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iIzFlMjkzYiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM2NDc0OGIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pjwvc3ZnPg=="}getProjectImageUrl(t){return t?`${this.settingsService.base}projects/imagen-project/${t}`:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iIzFlMjkzYiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiM2NDc0OGIiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pjwvc3ZnPg=="}setTab(t){this.activeTab.set(t)}featuredCoursesCount=Ge(()=>this.courses().filter(t=>t.featured).length);featuredProjectsCount=Ge(()=>this.projects().filter(t=>t.featured).length);static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-settings"]],decls:27,vars:12,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-white"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"rounded-lg","border","border-white/10","bg-slate-800/50","p-5"],[1,"text-sm","font-medium","text-white/60"],[1,"mt-2","text-3xl","font-extrabold","tracking-tight","text-lime-300"],[1,"text-xs","text-white/50","mt-1"],[1,"mt-2","text-3xl","font-extrabold","tracking-tight","text-cyan-300"],[1,"border-b","border-white/10"],["aria-label","Tabs",1,"flex","space-x-8"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm","transition-colors",3,"click"],[1,"space-y-4"],[1,"flex","gap-4"],["type","text","placeholder","Buscar cursos...",1,"flex-1","border","text-sm","rounded-lg","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-lime-500","focus:border-lime-500",3,"input","value"],[1,"flex","justify-center","items-center","py-12"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[3,"class"],[1,"col-span-full","text-center","py-12","text-white/60"],[1,"relative","h-32"],[1,"w-full","h-full","object-cover",3,"src","alt"],[1,"absolute","top-2","right-2","bg-lime-500","text-slate-900","px-2","py-1","rounded-md","text-xs","font-bold","flex","items-center","gap-1"],[1,"p-4"],[1,"font-semibold","text-white","text-sm","line-clamp-2","mb-1"],[1,"text-xs","text-white/60","line-clamp-2","mb-3"],[1,"flex","items-center","justify-between"],[1,"inline-flex","items-center","px-2","py-1","text-xs","font-bold","text-green-400","bg-green-500/10","border","border-green-500/30","rounded"],[1,"text-lime-400","font-bold","text-sm"],[1,"px-3","py-1.5","rounded-lg","text-xs","font-semibold","border","transition-colors",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3","h-3"],["d","M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"],["type","text","placeholder","Buscar proyectos...",1,"flex-1","border","text-sm","rounded-lg","p-2.5","bg-slate-700","border-slate-600","placeholder-gray-400","text-white","focus:ring-cyan-500","focus:border-cyan-500",3,"input","value"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-cyan-400"],[1,"absolute","top-2","right-2","bg-cyan-500","text-slate-900","px-2","py-1","rounded-md","text-xs","font-bold","flex","items-center","gap-1"],[1,"text-cyan-400","font-bold","text-sm"]],template:function(e,n){e&1&&(Ue(0,"div",0)(1,"div",1)(2,"h2",2),x(3,"Ajustes de Destacados"),je()(),Ue(4,"div",3)(5,"div",4)(6,"p",5),x(7,"Cursos Destacados"),je(),Ue(8,"p",6),x(9),je(),Ue(10,"p",7),x(11),je()(),Ue(12,"div",4)(13,"p",5),x(14,"Proyectos Destacados"),je(),Ue(15,"p",8),x(16),je(),Ue(17,"p",7),x(18),je()()(),Ue(19,"div",9)(20,"nav",10)(21,"button",11),Mn("click",function(){return n.setTab("courses")}),x(22),je(),Ue(23,"button",11),Mn("click",function(){return n.setTab("projects")}),x(24),je()()(),xe(25,d8,5,3,"div",12),xe(26,_8,5,3,"div",12),je()),e&2&&(S(9),Re(" ",n.featuredCoursesCount()," "),S(2),Re("de ",n.courses().length," cursos totales"),S(5),Re(" ",n.featuredProjectsCount()," "),S(2),Re("de ",n.projects().length," proyectos totales"),S(3),Li(n.activeTab()==="courses"?"border-lime-400 text-lime-400":"border-transparent text-white/60 hover:text-white hover:border-white/30"),S(),Re(" Cursos (",n.courses().length,") "),S(),Li(n.activeTab()==="projects"?"border-cyan-400 text-cyan-400":"border-transparent text-white/60 hover:text-white hover:border-white/30"),S(),Re(" Proyectos (",n.projects().length,") "),S(),ve(n.activeTab()==="courses"?25:-1),S(),ve(n.activeTab()==="projects"?26:-1))},dependencies:[yn,Tf],encapsulation:2})};var rh=class i{http=lt(ur);base=$t.url;state=Ae({settings:[],isLoading:!1,error:null});settings=Ge(()=>this.state().settings);isLoading=Ge(()=>this.state().isLoading);loadSettings(){return this.state.update(t=>It(At({},t),{isLoading:!0})),this.http.get(`${this.base}settings/list`).pipe(lr(t=>this.state.set({settings:t.settings,isLoading:!1,error:null})),ls(t=>(this.state.set({settings:[],isLoading:!1,error:t}),os(()=>t))))}updateSettings(t){return this.http.put(`${this.base}settings/update`,{settings:t})}static \u0275fac=function(e){return new(e||i)};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};function b8(i,t){i&1&&(Ue(0,"div",5),x(1,"Cargando ajustes..."),je())}function w8(i,t){if(i&1){let e=nt();Ue(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"div")(6,"h3",11)(7,"span",12),x(8,"\u26A1"),je(),x(9," M\xF3dulo de Cursos (Global) "),je(),Ue(10,"p",13),x(11,"Activa o desactiva TODA la funcionalidad de cursos en la plataforma (Men\xFA, Rutas, Creaci\xF3n)."),je(),Ue(12,"p",14),x(13,"Si se desactiva, instructores y alumnos no ver\xE1n la opci\xF3n de cursos."),je()(),Ue(14,"label",15)(15,"input",16),Mn("change",function(r){be(e);let a=q();return we(a.onModuleToggle(r))}),je(),ln(16,"div",17),je()(),Ue(17,"div",18)(18,"div")(19,"h3",19),x(20,"Secci\xF3n de Cursos Destacados"),je(),Ue(21,"p",13),x(22,"Muestra la secci\xF3n de cursos destacados en la p\xE1gina de inicio."),je()(),Ue(23,"label",15)(24,"input",16),Mn("change",function(r){be(e);let a=q();return we(a.onToggleChange("home_show_featured_courses",r))}),je(),ln(25,"div",17),je()(),Ue(26,"div",18)(27,"div")(28,"h3",19),x(29,"Secci\xF3n de Proyectos Destacados"),je(),Ue(30,"p",13),x(31,"Muestra la secci\xF3n de proyectos destacados en la p\xE1gina de inicio."),je()(),Ue(32,"label",15)(33,"input",16),Mn("change",function(r){be(e);let a=q();return we(a.onToggleChange("home_show_featured_projects",r))}),je(),ln(34,"div",17),je()()()()()()}if(i&2){let e=q();S(15),cs("checked",e.coursesModuleEnabled()),S(9),cs("checked",e.showFeaturedCourses()),S(9),cs("checked",e.showFeaturedProjects())}}var ah=class i{appearanceService=lt(rh);homeService=lt(Af);systemConfigService=lt(Ns);toast=lt(ua);settings=this.appearanceService.settings;isLoading=this.appearanceService.isLoading;showFeaturedCourses=Ge(()=>this.getSettingValue("home_show_featured_courses",!0));showFeaturedProjects=Ge(()=>this.getSettingValue("home_show_featured_projects",!0));coursesModuleEnabled=Ge(()=>this.systemConfigService.config()?.modules?.courses??!0);ngOnInit(){this.appearanceService.loadSettings().subscribe(),this.systemConfigService.getConfig()}getSettingValue(t,e=null){let n=this.settings().find(r=>r.key===t);return n?n.value:e}onToggleChange(t,e){let r=e.target.checked;this.appearanceService.updateSettings([{key:t,value:r}]).subscribe({next:()=>{this.homeService.reloadHome(),this.appearanceService.loadSettings().subscribe()},error:a=>this.toast.error(`Error al actualizar el ajuste ${t}:`,a)})}onModuleToggle(t){let e=t.target,n=e.checked,r=new FormData;r.append("modules_courses",String(n)),this.systemConfigService.updateConfig(r).subscribe({next:()=>{this.toast.success(`M\xF3dulo de cursos ${n?"activado":"desactivado"}`),this.systemConfigService.getConfig(),setTimeout(()=>window.location.reload(),1e3)},error:a=>{this.toast.error("Error al actualizar m\xF3dulo de cursos",a),e.checked=!n}})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-appearance"]],decls:9,vars:1,consts:[[1,"p-4","sm:p-6","lg:p-8"],[1,"sm:flex","sm:items-center"],[1,"sm:flex-auto"],[1,"text-base","font-semibold","leading-6","text-white"],[1,"mt-2","text-sm","text-gray-300"],[1,"mt-8","text-gray-400"],[1,"mt-8","flow-root"],[1,"-mx-4","-my-2","overflow-x-auto","sm:-mx-6","lg:-mx-8"],[1,"inline-block","min-w-full","py-2","align-middle","sm:px-6","lg:px-8"],[1,"divide-y","divide-gray-700","rounded-lg","bg-gray-800/50","border","border-gray-700"],[1,"flex","items-center","justify-between","p-4","bg-lime-900/10"],[1,"font-medium","text-white","flex","items-center","gap-2"],[1,"text-lime-400"],[1,"text-sm","text-gray-400"],[1,"text-xs","text-lime-400/70","mt-1"],[1,"relative","inline-flex","items-center","cursor-pointer"],["type","checkbox",1,"sr-only","peer",3,"change","checked"],[1,"w-11","h-6","bg-gray-600","rounded-full","peer","peer-focus:ring-4","peer-focus:ring-lime-800","peer-checked:after:translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-0.5","after:left-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","peer-checked:bg-lime-500"],[1,"flex","items-center","justify-between","p-4"],[1,"font-medium","text-white"]],template:function(e,n){e&1&&(Ue(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),x(4,"Apariencia"),je(),Ue(5,"p",4),x(6," Controla la visibilidad de las secciones en la p\xE1gina de inicio. "),je()()(),xe(7,b8,2,0,"div",5)(8,w8,35,3,"div",6),je()),e&2&&(S(7),ve(n.isLoading()?7:8))},encapsulation:2})};function y8(i,t){if(i&1&&(Ue(0,"p",6),x(1),je()),i&2){let e,n=q(2);S(),Re(" Solicitud #",(e=n.refund()._id)==null?null:e.slice(-8)," ")}}function S8(i,t){if(i&1&&(Ue(0,"div",19)(1,"span",26),x(2,"\u{1F4DA}"),je(),Ue(3,"div")(4,"div",17),x(5),je(),Ue(6,"div",14),x(7,"Curso"),je()()()),i&2){let e=q();S(5),Ve(e.course.title)}}function C8(i,t){if(i&1&&(Ue(0,"div",19)(1,"span",26),x(2,"\u{1F3AF}"),je(),Ue(3,"div")(4,"div",17),x(5),je(),Ue(6,"div",14),x(7,"Proyecto"),je()()()),i&2){let e=q();S(5),Ve(e.project.title)}}function E8(i,t){if(i&1&&(Ue(0,"div",11)(1,"h3",27),x(2,"\u{1F4CA} Desglose Financiero"),je(),Ue(3,"div",28)(4,"div",29)(5,"span",30),x(6,"Monto Original Pagado"),je(),Ue(7,"span",17),x(8),je()(),Ue(9,"div",31)(10,"div",32),st(),Ue(11,"svg",33),ln(12,"path",34),je(),xt(),Ue(13,"div",35)(14,"h4",36),x(15,"\u{1F4B0} Reembolso a Billetera Digital"),je(),Ue(16,"div",37)(17,"p",38),st(),Ue(18,"svg",39),ln(19,"path",40),je(),xt(),Ue(20,"span"),x(21,"El estudiante recibe el "),Ue(22,"strong"),x(23,"100% del monto pagado"),je()()(),Ue(24,"p",38),st(),Ue(25,"svg",39),ln(26,"path",40),je(),xt(),Ue(27,"span"),x(28,"Acreditaci\xF3n autom\xE1tica a billetera"),je()(),Ue(29,"p",38),st(),Ue(30,"svg",39),ln(31,"path",40),je(),xt(),Ue(32,"span"),x(33,"Las comisiones quedan en la plataforma"),je()()()()()(),ln(34,"div",41),Ue(35,"div",42)(36,"span",43),x(37,"\u{1F4B0} A Acreditar en Billetera"),je(),Ue(38,"span",44),x(39),je()(),Ue(40,"div",45),x(41),je(),Ue(42,"details",46)(43,"summary",47),x(44," \u{1F4C4} Ver desglose hist\xF3rico (solo referencia) "),je(),Ue(45,"div",48)(46,"div",16)(47,"span"),x(48,"Subtotal sin IVA:"),je(),Ue(49,"span"),x(50),je()(),Ue(51,"div",16)(52,"span"),x(53),je(),Ue(54,"span"),x(55),je()(),Ue(56,"div",16)(57,"span"),x(58),je(),Ue(59,"span"),x(60),je()(),Ue(61,"div",16)(62,"span"),x(63),je(),Ue(64,"span"),x(65),je()(),Ue(66,"p",49),x(67," * Estos datos son solo para referencia. Las comisiones no se deducen del reembolso. "),je()()()()()),i&2){let e=q(),n=q(2);S(8),Ve(n.formatCurrency(e.originalAmount)),S(31),Re(" ",n.formatCurrency(e.calculations.refundAmount)," "),S(2),Re(" \u2705 ",e.calculations.refundPercentage.toFixed(0),"% del pago original "),S(9),Ve(n.formatCurrency(e.calculations.subtotal)),S(3),Re("IVA (",(e.calculations.ivaRate*100).toFixed(0),"%):"),S(2),Ve(n.formatCurrency(e.calculations.iva)),S(3),Re("Comisi\xF3n Plataforma (",(e.calculations.platformFeeRate*100).toFixed(0),"%):"),S(2),Ve(n.formatCurrency(e.calculations.platformFee)),S(3),Re("Comisi\xF3n Procesamiento (",(e.calculations.processingFeeRate*100).toFixed(0),"%):"),S(2),Ve(n.formatCurrency(e.calculations.processingFee))}}function k8(i,t){if(i&1&&(Ue(0,"div",16)(1,"span",6),x(2,"Referencia / ID:"),je(),Ue(3,"span",50),x(4),je()()),i&2){let e=q(2);S(4),Ve(e.refundDetails.receiptNumber)}}function T8(i,t){if(i&1&&(Ue(0,"div",11)(1,"h3",12),x(2,"\u{1F4B3} M\xE9todo de Pago"),je(),Ue(3,"div",15)(4,"div",16)(5,"span",6),x(6,"M\xE9todo:"),je(),Ue(7,"span",18),x(8),je()(),Ue(9,"div",16)(10,"span",6),x(11,"Titular / Nota:"),je(),Ue(12,"span",18),x(13),je()(),xe(14,k8,5,1,"div",16),je()()),i&2){let e=q();S(8),Ve((e.sale==null?null:e.sale.paymentMethod)||"N/A"),S(5),Ve(e.refundDetails.accountHolder||"-"),S(),ve(e.refundDetails.receiptNumber?14:-1)}}function A8(i,t){if(i&1){let e=nt();Ue(0,"div",54)(1,"img",60),Mn("click",function(){be(e);let r=q(2),a=q(2);return we(a.openImageInNewTab(r.refundDetails.receiptImage))})("error",function(r){be(e);let a=q(4);return we(a.onImageError(r))}),je(),Ue(2,"div",61)(3,"span",62),x(4," \u{1F50D} Click para ampliar "),je()()()}if(i&2){let e=q(2),n=q(2);S(),cs("src",n.getReceiptUrl(e.refundDetails.receiptImage),Ui)("alt","Comprobante de reembolso")}}function F8(i,t){if(i&1){let e=nt();Ue(0,"div",55)(1,"div",63),x(2,"\u{1F4C4}"),je(),Ue(3,"p",64),x(4,"Documento PDF"),je(),Ue(5,"p",65),x(6),je(),Ue(7,"button",66),Mn("click",function(){be(e);let r=q(2),a=q(2);return we(a.openPdfInNewTab(r.refundDetails.receiptImage))}),x(8," \u{1F4E5} Abrir PDF "),je()()}if(i&2){let e=q(2);S(6),Ve(e.refundDetails.receiptImage)}}function D8(i,t){if(i&1){let e=nt();Ue(0,"div",11)(1,"h3",12),x(2,"\u{1F4C4} Comprobante de Reembolso"),je(),Ue(3,"div",28)(4,"div",51)(5,"span",20),x(6,"Archivo subido:"),je(),Ue(7,"span",52),x(8,"\u2705 Disponible"),je()(),Ue(9,"div",53),xe(10,A8,5,2,"div",54)(11,F8,9,1,"div",55),je(),Ue(12,"div",56)(13,"button",57),Mn("click",function(){be(e);let r=q(),a=q(2);return we(a.downloadReceipt(r.refundDetails.receiptImage))}),st(),Ue(14,"svg",58),ln(15,"path",59),je(),x(16," Descargar Comprobante "),je()()()()}if(i&2){let e=q(),n=q(2);S(10),ve(n.isImageFile(e.refundDetails.receiptImage)?10:11)}}function N8(i,t){if(i&1&&(Ue(0,"p",68),x(1),je()),i&2){let e=q(2);S(),hi(" Revisado por: ",e.reviewedBy.name," ",e.reviewedBy.surname," ")}}function P8(i,t){if(i&1&&(Ue(0,"div",21)(1,"h3",67),x(2,"\u{1F4DD} Notas del Administrador"),je(),Ue(3,"p",20),x(4),je(),xe(5,N8,2,2,"p",68),je()),i&2){let e=q();S(4),Ve(e.adminNotes),S(),ve(e.reviewedBy?5:-1)}}function M8(i,t){if(i&1&&(Ue(0,"div",22)(1,"span",23),x(2,"Revisado:"),je(),Ue(3,"span",18),x(4),je()()),i&2){let e=q(),n=q(2);S(4),Ve(n.formatDate(e.reviewedAt))}}function L8(i,t){if(i&1&&(Ue(0,"div",22)(1,"span",23),x(2,"Procesado:"),je(),Ue(3,"span",18),x(4),je()()),i&2){let e=q(),n=q(2);S(4),Ve(n.formatDate(e.processedAt))}}function I8(i,t){if(i&1&&(Ue(0,"div",22)(1,"span",23),x(2,"Completado:"),je(),Ue(3,"span",18),x(4),je()()),i&2){let e=q(),n=q(2);S(4),Ve(n.formatDate(e.completedAt))}}function R8(i,t){if(i&1){let e=nt();Ue(0,"div",10)(1,"div",11)(2,"h3",12),x(3,"Estado de la Solicitud"),je(),Ue(4,"div",13)(5,"span"),x(6),je(),Ue(7,"span",14),x(8),je()()(),Ue(9,"div",11)(10,"h3",12),x(11,"Cliente"),je(),Ue(12,"div",15)(13,"div",16)(14,"span",6),x(15,"Nombre:"),je(),Ue(16,"span",17),x(17),je()(),Ue(18,"div",16)(19,"span",6),x(20,"Email:"),je(),Ue(21,"span",18),x(22),je()()()(),Ue(23,"div",11)(24,"h3",12),x(25,"Producto"),je(),xe(26,S8,8,1,"div",19),xe(27,C8,8,1,"div",19),je(),Ue(28,"div",11)(29,"h3",12),x(30,"Motivo del Reembolso"),je(),Ue(31,"div",15)(32,"div")(33,"span"),x(34),je()(),Ue(35,"p",20),x(36),je()()(),xe(37,E8,68,10,"div",11),xe(38,T8,15,3,"div",11),xe(39,D8,17,1,"div",11),xe(40,P8,6,2,"div",21),Ue(41,"div",11)(42,"h3",12),x(43,"\u23F1\uFE0F Historial"),je(),Ue(44,"div",15)(45,"div",22)(46,"span",23),x(47,"Solicitado:"),je(),Ue(48,"span",18),x(49),je()(),xe(50,M8,5,1,"div",22),xe(51,L8,5,1,"div",22),xe(52,I8,5,1,"div",22),je()()(),Ue(53,"div",24)(54,"button",25),Mn("click",function(){be(e);let r=q(2);return we(r.closeModal())}),x(55," Cerrar "),je()()}if(i&2){let e=t,n=q(2);S(5),Li("px-4 py-2 rounded-full text-sm font-medium "+n.getStatusBadgeClass(e.status)),S(),Re(" ",n.getStatusLabel(e.status)," "),S(2),Re(" Solicitado: ",n.formatDate(e.requestedAt)," "),S(9),hi(" ",e.user==null?null:e.user.name," ",e.user==null?null:e.user.surname," "),S(5),Ve(e.user==null?null:e.user.email),S(4),ve(e.course?26:-1),S(),ve(e.project?27:-1),S(6),Li("px-3 py-1 rounded-full text-xs font-medium "+n.getStatusBadgeClass(e.reason.type)),S(),Re(" ",n.getReasonLabel(e.reason.type)," "),S(2),Ve(e.reason.description),S(),ve(e.calculations?37:-1),S(),ve(e.refundDetails?38:-1),S(),ve(e.status==="completed"&&e.refundDetails&&e.refundDetails.receiptImage?39:-1),S(),ve(e.adminNotes?40:-1),S(9),Ve(n.formatDate(e.requestedAt)),S(),ve(e.reviewedAt?50:-1),S(),ve(e.processedAt?51:-1),S(),ve(e.completedAt?52:-1)}}function O8(i,t){if(i&1){let e=nt();Ue(0,"div",1),Mn("click",function(r){be(e);let a=q();return we(a.handleBackdropClick(r))}),Ue(1,"div",2),Mn("click",function(r){return be(e),we(r.stopPropagation())}),Ue(2,"div",3)(3,"div",4)(4,"div")(5,"h2",5),x(6," \u{1F4B8} Detalles del Reembolso "),je(),xe(7,y8,2,1,"p",6),je(),Ue(8,"button",7),Mn("click",function(){be(e);let r=q();return we(r.closeModal())}),st(),Ue(9,"svg",8),ln(10,"path",9),je()()()(),xe(11,R8,56,21),je()()}if(i&2){let e,n=q();S(7),ve(n.refund()?7:-1),S(4),ve((e=n.refund())?11:-1,e)}}var sh=class i{show=Qr.required();refund=Qr.required();close=Ta();closeModal(){this.close.emit()}handleBackdropClick(t){t.target===t.currentTarget&&this.closeModal()}getStatusBadgeClass(t){return{pending:"bg-yellow-500/20 text-yellow-300",approved:"bg-green-500/20 text-green-300",rejected:"bg-red-500/20 text-red-300",processing:"bg-blue-500/20 text-blue-300",completed:"bg-lime-500/20 text-lime-300",failed:"bg-red-500/20 text-red-300",course_not_started:"bg-blue-500/20 text-blue-300",dissatisfied:"bg-orange-500/20 text-orange-300",technical_issues:"bg-red-500/20 text-red-300",duplicate_purchase:"bg-purple-500/20 text-purple-300",instructor_request:"bg-cyan-500/20 text-cyan-300",other:"bg-slate-500/20 text-slate-300"}[t]||"bg-slate-500/20 text-slate-300"}getStatusLabel(t){return{pending:"Pendiente",approved:"Aprobado",rejected:"Rechazado",processing:"Procesando",completed:"Completado",failed:"Fallido"}[t]||t}getReasonLabel(t){return{course_not_started:"Curso no iniciado",dissatisfied:"Insatisfecho",technical_issues:"Problemas t\xE9cnicos",duplicate_purchase:"Compra duplicada",instructor_request:"Solicitud del instructor",other:"Otro"}[t]||t}formatDate(t){return t?new Date(t).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}formatCurrency(t){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t)}isImageFile(t){let e=[".jpg",".jpeg",".png",".gif",".webp"],n=t.toLowerCase();return e.some(r=>n.endsWith(r))}getReceiptUrl(t){return`https://api.devhubsharks.com/api/refunds/receipt-image/${t}`}openImageInNewTab(t){let e=this.getReceiptUrl(t);window.open(e,"_blank")}openPdfInNewTab(t){let e=this.getReceiptUrl(t);window.open(e,"_blank")}downloadReceipt(t){let e=this.getReceiptUrl(t),n=document.createElement("a");n.href=e,n.download=t,n.target="_blank",document.body.appendChild(n),n.click(),document.body.removeChild(n)}onImageError(t){let e=t.target;e.src="https://via.placeholder.com/400x300?text=Comprobante+no+disponible"}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-refund-details-modal"]],inputs:{show:[1,"show"],refund:[1,"refund"]},outputs:{close:"close"},decls:1,vars:1,consts:[[1,"fixed","inset-0","bg-black/70","z-50","flex","items-center","justify-center","p-4","overflow-y-auto"],[1,"fixed","inset-0","bg-black/70","z-50","flex","items-center","justify-center","p-4","overflow-y-auto",3,"click"],[1,"bg-slate-800","border","border-white/20","rounded-lg","max-w-3xl","w-full","my-8","max-h-[90vh]","flex","flex-col",3,"click"],[1,"border-b","border-white/10","p-6","flex-shrink-0"],[1,"flex","items-start","justify-between"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-slate-400"],[1,"text-slate-400","hover:text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"overflow-y-auto","flex-1","p-6","space-y-6"],[1,"bg-slate-900","rounded-lg","p-4"],[1,"text-sm","font-medium","text-slate-400","mb-3"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-slate-400"],[1,"space-y-2"],[1,"flex","justify-between"],[1,"text-white","font-medium"],[1,"text-white"],[1,"flex","items-center","gap-3"],[1,"text-white","text-sm"],[1,"bg-yellow-500/10","border","border-yellow-500/30","rounded-lg","p-4"],[1,"flex","items-center","gap-3","text-sm"],[1,"w-24","text-slate-400"],[1,"border-t","border-white/10","p-6","flex-shrink-0"],[1,"w-full","px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"text-3xl"],[1,"text-sm","font-medium","text-slate-400","mb-4"],[1,"space-y-3"],[1,"flex","justify-between","py-2","border-b","border-white/10"],[1,"text-slate-300"],[1,"bg-gradient-to-r","from-lime-500/10","to-green-500/10","rounded-lg","p-4","border","border-lime-500/20","my-4"],[1,"flex","items-start","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-lime-400","flex-shrink-0","mt-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex-1"],[1,"text-sm","font-semibold","text-lime-400","mb-2"],[1,"text-xs","text-lime-200/80","space-y-1.5"],[1,"flex","items-center","gap-2"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-green-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"border-t-2","border-lime-500/30","my-3"],[1,"flex","justify-between","py-3","bg-lime-500/10","-mx-2","px-2","rounded"],[1,"text-lime-300","font-bold"],[1,"text-lime-300","font-bold","text-lg"],[1,"text-center","text-sm","text-lime-300","font-medium","mt-2","bg-lime-500/5","py-2","rounded"],[1,"mt-4"],[1,"cursor-pointer","text-xs","text-slate-400","hover:text-slate-300","transition-colors"],[1,"mt-3","space-y-2","text-xs","text-slate-500","pl-4","border-l-2","border-slate-700"],[1,"text-[10px]","text-slate-600","mt-2","italic"],[1,"text-lime-300","font-medium"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-lime-300","text-sm"],[1,"border","border-white/10","rounded-lg","overflow-hidden","bg-slate-800"],[1,"relative","group"],[1,"p-6","text-center"],[1,"flex","gap-2"],[1,"flex-1","px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors","text-sm","flex","items-center","justify-center","gap-2",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],[1,"w-full","h-auto","cursor-pointer","hover:opacity-90","transition-opacity",3,"click","error","src","alt"],[1,"absolute","inset-0","bg-black/0","group-hover:bg-black/30","transition-colors","flex","items-center","justify-center"],[1,"opacity-0","group-hover:opacity-100","text-white","text-sm","font-medium","transition-opacity"],[1,"text-6xl","mb-3"],[1,"text-white","font-medium","mb-2"],[1,"text-sm","text-slate-400","mb-4"],[1,"px-4","py-2","bg-lime-500","hover:bg-lime-600","text-black","rounded-lg","transition-colors","text-sm","font-medium",3,"click"],[1,"text-sm","font-medium","text-yellow-300","mb-2"],[1,"text-xs","text-slate-400","mt-2"]],template:function(e,n){e&1&&xe(0,O8,12,2,"div",0),e&2&&ve(n.show()?0:-1)},encapsulation:2})};function B8(i,t){if(i&1&&(f(0,"p",6),x(1),p()),i&2){let e,n=q(2);S(),hi(" Solicitud de ",(e=n.refund().user)==null?null:e.name," ",(e=n.refund().user)==null?null:e.surname," ")}}function j8(i,t){i&1&&(f(0,"span",41),x(1,"\u23F3"),p())}function V8(i,t){i&1&&(f(0,"span",41),x(1,"\u23F3"),p())}function U8(i,t){if(i&1){let e=nt();f(0,"div",10)(1,"div",11)(2,"h3",12),x(3,"Resumen"),p(),f(4,"div",13)(5,"div",14)(6,"span",6),x(7,"Monto Original:"),p(),f(8,"span",15),x(9),p()(),f(10,"div",14)(11,"span",6),x(12,"A Reembolsar:"),p(),f(13,"span",16),x(14),p()(),f(15,"div",17)(16,"span",6),x(17,"Destino:"),p(),f(18,"span",18),x(19," \u{1F4B0} Billetera Digital "),p()(),f(20,"div",14)(21,"span",6),x(22,"Producto:"),p(),f(23,"span",19),x(24),p()()()(),f(25,"div",11)(26,"h3",12),x(27,"Motivo"),p(),f(28,"div",13)(29,"span"),x(30),p(),f(31,"p",20),x(32),p()()(),f(33,"div",21)(34,"div",22),st(),f(35,"svg",23),ce(36,"path",24),p(),xt(),f(37,"div",25)(38,"h3",26),x(39,"\u{1F4B0} Reembolso a Billetera Digital"),p(),f(40,"div",27)(41,"p",28),st(),f(42,"svg",29),ce(43,"path",30),p(),xt(),f(44,"span"),x(45,"Al aprobar, "),f(46,"strong"),x(47,"el saldo se acreditar\xE1 autom\xE1ticamente"),p(),x(48," a la billetera del estudiante"),p()(),f(49,"p",28),st(),f(50,"svg",29),ce(51,"path",30),p(),xt(),f(52,"span"),x(53,"No requiere transferencias bancarias manuales"),p()(),f(54,"p",28),st(),f(55,"svg",29),ce(56,"path",30),p(),xt(),f(57,"span"),x(58,"El estudiante podr\xE1 usar el saldo inmediatamente"),p()()()()()(),f(59,"div")(60,"label",31),x(61," Notas (opcional para aprobar, obligatorio para rechazar) "),p(),f(62,"textarea",32),nr("ngModelChange",function(r){be(e);let a=q(2);return ir(a.notes,r)||(a.notes=r),we(r)}),p()(),f(63,"div",33)(64,"div",22)(65,"span",34),x(66,"\u2139\uFE0F"),p(),f(67,"div",35)(68,"p",36),x(69,"\xBFQu\xE9 suceder\xE1 al aprobar?"),p(),f(70,"ul",37)(71,"li"),x(72,'El reembolso se marcar\xE1 autom\xE1ticamente como "Completado"'),p(),f(73,"li"),x(74,"El saldo se acreditar\xE1 "),f(75,"strong"),x(76,"instant\xE1neamente"),p(),x(77," a la billetera del estudiante"),p(),f(78,"li"),x(79,"El estudiante recibir\xE1 una notificaci\xF3n por email"),p(),f(80,"li"),x(81,"El curso/proyecto ser\xE1 removido de su perfil"),p(),f(82,"li"),x(83,"Al rechazar, el cliente recibir\xE1 una notificaci\xF3n con el motivo"),p()()()()()(),f(84,"div",38)(85,"div",39)(86,"button",40),ue("click",function(){be(e);let r=q(2);return we(r.handleApprove())}),xe(87,j8,2,0,"span",41),x(88," \u2705 Aprobar Reembolso "),p(),f(89,"button",42),ue("click",function(){be(e);let r=q(2);return we(r.handleReject())}),xe(90,V8,2,0,"span",41),x(91," \u274C Rechazar "),p(),f(92,"button",43),ue("click",function(){be(e);let r=q(2);return we(r.closeModal())}),x(93," Cancelar "),p()()()}if(i&2){let e=t,n=q(2);S(9),Ve(n.formatCurrency(e.originalAmount)),S(5),Ve(n.formatCurrency(e.calculations.refundAmount)),S(10),Ve((e.course==null?null:e.course.title)||(e.project==null?null:e.project.title)),S(5),Li("px-3 py-1 rounded-full text-xs font-medium "+n.getStatusBadgeClass(e.reason.type)),S(),Re(" ",n.getReasonLabel(e.reason.type)," "),S(2),Ve(e.reason.description),S(30),tr("ngModel",n.notes),S(24),Ce("disabled",n.isProcessing()),S(),ve(n.isProcessing()?87:-1),S(2),Ce("disabled",n.isProcessing()),S(),ve(n.isProcessing()?90:-1),S(2),Ce("disabled",n.isProcessing())}}function z8(i,t){if(i&1){let e=nt();f(0,"div",1),ue("click",function(r){be(e);let a=q();return we(a.handleBackdropClick(r))}),f(1,"div",2),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(2,"div",3)(3,"div",4)(4,"div")(5,"h2",5),x(6," \u2705 Revisar Reembolso "),p(),xe(7,B8,2,2,"p",6),p(),f(8,"button",7),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),st(),f(9,"svg",8),ce(10,"path",9),p()()()(),xe(11,U8,94,13),p()()}if(i&2){let e,n=q();S(7),ve(n.refund()?7:-1),S(4),ve((e=n.refund())?11:-1,e)}}var oh=class i{show=Qr.required();refund=Qr.required();close=Ta();approve=Ta();reject=Ta();notes="";isProcessing=Ae(!1);closeModal(){this.notes="",this.isProcessing.set(!1),this.close.emit()}handleBackdropClick(t){t.target===t.currentTarget&&!this.isProcessing()&&this.closeModal()}modalService=lt(Uv);async handleApprove(){let t=this.refund();!t||this.isProcessing()||!await this.modalService.confirm({title:`\xBFAprobar reembolso de ${this.formatCurrency(t.calculations.refundAmount)}?`,message:`\u{1F4B0} El saldo se acreditar\xE1 AUTOM\xC1TICAMENTE a la billetera digital del estudiante.

\u2705 No requiere transferencia bancaria manual.
\u2705 El estudiante podr\xE1 usar el saldo inmediatamente.`,icon:"success",confirmText:"S\xED, Aprobar",cancelText:"Cancelar"})||(this.isProcessing.set(!0),this.approve.emit(this.notes.trim()))}async handleReject(){if(!this.refund()||this.isProcessing())return;if(!this.notes.trim()){this.modalService.alert({title:"Atenci\xF3n",message:"\u26A0\uFE0F Debes proporcionar un motivo para rechazar la solicitud",icon:"warning"});return}await this.modalService.confirm({title:"Rechazar Solicitud",message:`\xBFRechazar esta solicitud de reembolso?

El cliente recibir\xE1 una notificaci\xF3n.`,icon:"error",confirmText:"S\xED, Rechazar",cancelText:"Cancelar"})&&(this.isProcessing.set(!0),this.reject.emit(this.notes.trim()))}getStatusBadgeClass(t){return{course_not_started:"bg-blue-500/20 text-blue-300",dissatisfied:"bg-orange-500/20 text-orange-300",technical_issues:"bg-red-500/20 text-red-300",duplicate_purchase:"bg-purple-500/20 text-purple-300",instructor_request:"bg-cyan-500/20 text-cyan-300",other:"bg-slate-500/20 text-slate-300"}[t]||"bg-slate-500/20 text-slate-300"}getReasonLabel(t){return{course_not_started:"Curso no iniciado",dissatisfied:"Insatisfecho",technical_issues:"Problemas t\xE9cnicos",duplicate_purchase:"Compra duplicada",instructor_request:"Solicitud del instructor",other:"Otro"}[t]||t}formatCurrency(t){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-refund-review-modal"]],inputs:{show:[1,"show"],refund:[1,"refund"]},outputs:{close:"close",approve:"approve",reject:"reject"},decls:1,vars:1,consts:[[1,"fixed","inset-0","bg-black/70","z-50","flex","items-center","justify-center","p-4","overflow-y-auto"],[1,"fixed","inset-0","bg-black/70","z-50","flex","items-center","justify-center","p-4","overflow-y-auto",3,"click"],[1,"bg-slate-800","border","border-white/20","rounded-lg","max-w-2xl","w-full","my-8","max-h-[90vh]","flex","flex-col",3,"click"],[1,"border-b","border-white/10","p-6","flex-shrink-0"],[1,"flex","items-start","justify-between"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-slate-400"],[1,"text-slate-400","hover:text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"overflow-y-auto","flex-1","p-6","space-y-4"],[1,"bg-slate-900","rounded-lg","p-4"],[1,"text-sm","font-medium","text-slate-400","mb-3"],[1,"space-y-2"],[1,"flex","justify-between"],[1,"text-white","font-medium"],[1,"text-lime-300","font-bold"],[1,"flex","justify-between","items-center"],[1,"text-lime-300","text-sm","flex","items-center","gap-1"],[1,"text-white"],[1,"text-white","text-sm","mt-2"],[1,"bg-gradient-to-r","from-lime-500/10","to-green-500/10","rounded-lg","p-4","border","border-lime-500/20"],[1,"flex","items-start","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-lime-400","flex-shrink-0","mt-0.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex-1"],[1,"text-sm","font-semibold","text-lime-400","mb-2"],[1,"text-xs","text-lime-200/80","space-y-1.5"],[1,"flex","items-center","gap-2"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-green-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],["rows","4","placeholder","Escribe notas sobre esta decisi\xF3n...",1,"w-full","px-4","py-2","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"ngModelChange","ngModel"],[1,"bg-blue-500/10","border","border-blue-500/30","rounded-lg","p-4"],[1,"text-2xl","flex-shrink-0"],[1,"text-sm","text-blue-300"],[1,"font-medium","mb-1"],[1,"list-disc","list-inside","space-y-1","text-blue-200"],[1,"border-t","border-white/10","p-6","flex-shrink-0"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-3","bg-lime-500","hover:bg-lime-600","disabled:opacity-50","disabled:cursor-not-allowed","text-black","font-medium","rounded-lg","transition-colors",3,"click","disabled"],[1,"inline-block","animate-spin","mr-2"],[1,"flex-1","px-4","py-3","bg-red-500","hover:bg-red-600","disabled:opacity-50","disabled:cursor-not-allowed","text-white","font-medium","rounded-lg","transition-colors",3,"click","disabled"],[1,"px-4","py-3","bg-slate-700","hover:bg-slate-600","disabled:opacity-50","disabled:cursor-not-allowed","text-white","rounded-lg","transition-colors",3,"click","disabled"]],template:function(e,n){e&1&&xe(0,z8,12,2,"div",0),e&2&&ve(n.show()?0:-1)},dependencies:[mn,ki,wi,zn],encapsulation:2})};function H8(i,t){if(i&1&&(f(0,"p",6),x(1),p()),i&2){let e,n=q(2);S(),hi(" Reembolso a ",(e=n.refund().user)==null?null:e.name," ",(e=n.refund().user)==null?null:e.surname," ")}}function W8(i,t){i&1&&(f(0,"span",38),x(1,"\u23F3"),p())}function q8(i,t){if(i&1){let e=nt();f(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13),x(4,"Monto a Transferir"),p(),f(5,"div",14),x(6),p(),f(7,"div",15),x(8),p()()(),f(9,"div",16)(10,"h3",17),x(11,"\u{1F4B3} M\xE9todo de Pago"),p(),f(12,"div",18)(13,"div",19)(14,"span",6),x(15,"M\xE9todo:"),p(),f(16,"span",20),x(17),p()(),f(18,"div",19)(19,"span",6),x(20,"Nota:"),p(),f(21,"span",21),x(22),p()()()(),f(23,"div")(24,"label",22),x(25," N\xFAmero de Referencia / ID de Transacci\xF3n (opcional) "),p(),f(26,"input",23),nr("ngModelChange",function(r){be(e);let a=q(2);return ir(a.receiptNumber,r)||(a.receiptNumber=r),we(r)}),p(),f(27,"p",24),x(28," Opcional: Ingresa el ID de transacci\xF3n o referencia si aplica (PayPal / proveedor de pago). "),p()(),f(29,"div")(30,"label",22),x(31," Comprobante (opcional) "),p(),f(32,"input",25),ue("change",function(r){be(e);let a=q(2);return we(a.handleFileChange(r))}),p(),f(33,"p",24),x(34," Opcional: Sube el comprobante (imagen o PDF) "),p()(),f(35,"div",26)(36,"div",27)(37,"span",28),x(38,"\u2139\uFE0F"),p(),f(39,"div",29)(40,"p",30),x(41,"Instrucciones:"),p(),f(42,"ol",31)(43,"li"),x(44,"Procesa el reembolso a trav\xE9s del m\xE9todo de pago indicado (PayPal o Wallet)"),p(),f(45,"li"),x(46,"Si corresponde, ingresa el ID de transacci\xF3n o n\xFAmero de referencia"),p(),f(47,"li"),x(48,"Opcionalmente, sube un comprobante (imagen o PDF)"),p(),f(49,"li"),x(50,"El cliente recibir\xE1 una notificaci\xF3n autom\xE1ticamente"),p()()()()(),f(51,"div",32)(52,"div",27)(53,"span",28),x(54,"\u26A0\uFE0F"),p(),f(55,"div",33)(56,"p",30),x(57,"Importante:"),p(),f(58,"p",34),x(59," Solo marca como completado si ya procesaste el reembolso. Esta acci\xF3n no se puede deshacer. "),p()()()()(),f(60,"div",35)(61,"div",36)(62,"button",37),ue("click",function(){be(e);let r=q(2);return we(r.handleComplete())}),xe(63,W8,2,0,"span",38),x(64," \u2705 Marcar como Completado "),p(),f(65,"button",39),ue("click",function(){be(e);let r=q(2);return we(r.closeModal())}),x(66," Cancelar "),p()()()}if(i&2){let e=t,n=q(2);S(6),Re(" ",n.formatCurrency(e.calculations.refundAmount)," "),S(2),Ve(e.currency),S(9),Ve((e.sale==null?null:e.sale.paymentMethod)||"N/A"),S(5),Ve(e.refundDetails.accountHolder||"-"),S(4),tr("ngModel",n.receiptNumber),Ce("disabled",n.isProcessing()),S(6),Ce("disabled",n.isProcessing()),S(30),Ce("disabled",n.isProcessing()),S(),ve(n.isProcessing()?63:-1),S(2),Ce("disabled",n.isProcessing())}}function G8(i,t){if(i&1){let e=nt();f(0,"div",1),ue("click",function(r){be(e);let a=q();return we(a.handleBackdropClick(r))}),f(1,"div",2),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(2,"div",3)(3,"div",4)(4,"div")(5,"h2",5),x(6," \u{1F4B3} Completar Reembolso "),p(),xe(7,H8,2,2,"p",6),p(),f(8,"button",7),ue("click",function(){be(e);let r=q();return we(r.closeModal())}),st(),f(9,"svg",8),ce(10,"path",9),p()()()(),xe(11,q8,67,10),p()()}if(i&2){let e,n=q();S(7),ve(n.refund()?7:-1),S(4),ve((e=n.refund())?11:-1,e)}}var lh=class i{show=Qr.required();refund=Qr.required();close=Ta();complete=Ta();receiptNumber="";receiptFile=void 0;isProcessing=Ae(!1);closeModal(){this.receiptNumber="",this.receiptFile=void 0,this.isProcessing.set(!1),this.close.emit()}handleBackdropClick(t){t.target===t.currentTarget&&!this.isProcessing()&&this.closeModal()}handleFileChange(t){let e=t.target,n=e.files?.[0];if(n){if(n.size>5*1024*1024){alert("\u26A0\uFE0F El archivo no debe superar los 5MB"),e.value="";return}if(!["image/jpeg","image/png","image/jpg","application/pdf"].includes(n.type)){alert("\u26A0\uFE0F Solo se permiten im\xE1genes (JPG, PNG) o PDF"),e.value="";return}this.receiptFile=n}}handleComplete(){let t=this.refund();if(!t||this.isProcessing())return;let e=this.receiptNumber.trim()||"N/A",n=`\xBFConfirmar que has procesado el reembolso de ${this.formatCurrency(t.calculations.refundAmount)}?

ID de transacci\xF3n: ${e}

Esta acci\xF3n no se puede deshacer.`;confirm(n)&&(this.isProcessing.set(!0),this.complete.emit({receiptNumber:this.receiptNumber.trim(),receiptFile:this.receiptFile}))}formatCurrency(t){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-refund-complete-modal"]],inputs:{show:[1,"show"],refund:[1,"refund"]},outputs:{close:"close",complete:"complete"},decls:1,vars:1,consts:[[1,"fixed","inset-0","bg-black/70","z-50","flex","items-center","justify-center","p-4","overflow-y-auto"],[1,"fixed","inset-0","bg-black/70","z-50","flex","items-center","justify-center","p-4","overflow-y-auto",3,"click"],[1,"bg-slate-800","border","border-white/20","rounded-lg","max-w-xl","w-full","my-8","max-h-[90vh]","flex","flex-col",3,"click"],[1,"border-b","border-white/10","p-6","flex-shrink-0"],[1,"flex","items-start","justify-between"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-slate-400"],[1,"text-slate-400","hover:text-white","transition-colors",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"overflow-y-auto","flex-1","p-6","space-y-4"],[1,"bg-lime-500/10","border","border-lime-500/30","rounded-lg","p-4"],[1,"text-center"],[1,"text-sm","text-lime-300","mb-2"],[1,"text-3xl","font-bold","text-lime-300"],[1,"text-sm","text-slate-400","mt-1"],[1,"bg-slate-900","rounded-lg","p-4"],[1,"text-sm","font-medium","text-slate-400","mb-3"],[1,"space-y-2"],[1,"flex","justify-between"],[1,"text-white","font-medium"],[1,"text-white"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","text","placeholder","Ej: TR123456789 o TXN12345",1,"w-full","px-4","py-2","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"ngModelChange","ngModel","disabled"],[1,"text-xs","text-slate-400","mt-1"],["type","file","accept","image/*,application/pdf",1,"w-full","px-4","py-2","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"change","disabled"],[1,"bg-blue-500/10","border","border-blue-500/30","rounded-lg","p-4"],[1,"flex","items-start","gap-3"],[1,"text-2xl","flex-shrink-0"],[1,"text-sm","text-blue-300"],[1,"font-medium","mb-1"],[1,"list-decimal","list-inside","space-y-1","text-blue-200"],[1,"bg-yellow-500/10","border","border-yellow-500/30","rounded-lg","p-4"],[1,"text-sm","text-yellow-300"],[1,"text-yellow-200"],[1,"border-t","border-white/10","p-6","flex-shrink-0"],[1,"flex","gap-3"],[1,"flex-1","px-4","py-3","bg-lime-500","hover:bg-lime-600","disabled:opacity-50","disabled:cursor-not-allowed","text-black","font-medium","rounded-lg","transition-colors",3,"click","disabled"],[1,"inline-block","animate-spin","mr-2"],[1,"px-4","py-3","bg-slate-700","hover:bg-slate-600","disabled:opacity-50","disabled:cursor-not-allowed","text-white","rounded-lg","transition-colors",3,"click","disabled"]],template:function(e,n){e&1&&xe(0,G8,12,2,"div",0),e&2&&ve(n.show()?0:-1)},dependencies:[mn,ki,wi,zn],encapsulation:2})};var $8=()=>[],X8=(i,t)=>t._id;function Y8(i,t){i&1&&(f(0,"div",26),ce(1,"div",31),f(2,"p",32),x(3,"Cargando reembolsos..."),p()())}function K8(i,t){if(i&1&&(f(0,"div",44),x(1),p()),i&2){let e=q().$implicit;S(),Re("\u{1F4DA} ",e.course.title)}}function Z8(i,t){if(i&1&&(f(0,"div",44),x(1),p()),i&2){let e=q().$implicit;S(),Re("\u{1F3AF} ",e.project.title)}}function J8(i,t){if(i&1){let e=nt();f(0,"button",55),ue("click",function(){be(e);let r=q().$implicit,a=q(2);return we(a.openReviewModal(r))}),x(1," \u2705 Revisar "),p()}}function Q8(i,t){if(i&1&&(f(0,"span",47),x(1),p()),i&2){let e=q().$implicit;S(),Re(" Ref: ",e.refundDetails.receiptNumber||"-"," ")}}function eT(i,t){if(i&1){let e=nt();f(0,"tr",41)(1,"td",43)(2,"div",44),x(3),p()(),f(4,"td",45)(5,"div",46),x(6),p(),f(7,"div",47),x(8),p()(),f(9,"td",45),xe(10,K8,2,1,"div",44),xe(11,Z8,2,1,"div",44),f(12,"div",48)(13,"span"),x(14),p()()(),f(15,"td",49)(16,"div",46),x(17),p(),f(18,"div",47),x(19),p()(),f(20,"td",49)(21,"div",50),x(22),p(),f(23,"div",48),x(24," \u{1F4B0} A billetera digital "),p()(),f(25,"td",51)(26,"span"),x(27),p()(),f(28,"td",51)(29,"div",52)(30,"button",53),ue("click",function(){let r=be(e).$implicit,a=q(2);return we(a.openDetailsModal(r))}),x(31," \u{1F441}\uFE0F Ver "),p(),xe(32,J8,2,0,"button",54),xe(33,Q8,2,1,"span",47),p()()()}if(i&2){let e=t.$implicit,n=q(2);S(3),Ve(n.formatDate(e.requestedAt)),S(3),hi(" ",e.user==null?null:e.user.name," ",e.user==null?null:e.user.surname," "),S(2),Ve(e.user==null?null:e.user.email),S(2),ve(e.course?10:-1),S(),ve(e.project?11:-1),S(2),Li("px-2 py-0.5 rounded text-xs "+n.getStatusBadgeClass(e.reason.type)),S(),Re(" ",n.getReasonLabel(e.reason.type)," "),S(3),Re(" ",n.formatCurrency(e.originalAmount)," "),S(2),Ve(e.currency),S(3),Re(" ",n.formatCurrency(e.calculations.refundAmount||0)," "),S(4),Li("px-3 py-1 rounded-full text-xs font-medium "+n.getStatusBadgeClass(e.status)),S(),Re(" ",n.getStatusLabel(e.status)," "),S(5),ve(n.canReview(e)?32:-1),S(),ve(e.status==="completed"?33:-1)}}function tT(i,t){if(i&1){let e=nt();f(0,"button",60),ue("click",function(){let r=be(e).$index,a=q(3);return we(a.goToPage(r+1))}),x(1),p()}if(i&2){let e=t.$index,n=q(3);Li(n.currentPage()===e+1?"px-3 py-1 bg-lime-500 text-black rounded-lg text-sm font-medium":"px-3 py-1 bg-slate-700 hover:bg-slate-600 text-white rounded-lg text-sm transition-colors"),S(),Re(" ",e+1," ")}}function iT(i,t){if(i&1){let e=nt();f(0,"div",42)(1,"div",56),x(2),p(),f(3,"div",57)(4,"button",58),ue("click",function(){be(e);let r=q(2);return we(r.goToPage(r.currentPage()-1))}),x(5," Anterior "),p(),zt(6,tT,2,3,"button",59,Zl),f(8,"button",58),ue("click",function(){be(e);let r=q(2);return we(r.goToPage(r.currentPage()+1))}),x(9," Siguiente "),p()()()}if(i&2){let e=q(2);S(2),Ha(" Mostrando ",(e.currentPage()-1)*e.itemsPerPage()+1," - ",e.Math.min(e.currentPage()*e.itemsPerPage(),e.filteredRefunds().length)," de ",e.filteredRefunds().length," reembolsos "),S(2),Ce("disabled",e.currentPage()===1),S(2),Ht(Ev(5,$8).constructor(e.totalPages())),S(2),Ce("disabled",e.currentPage()===e.totalPages())}}function nT(i,t){if(i&1&&(f(0,"div",33)(1,"div",34)(2,"table",35)(3,"thead",36)(4,"tr")(5,"th",37),x(6,"Fecha"),p(),f(7,"th",37),x(8,"Usuario"),p(),f(9,"th",37),x(10,"Curso/Proyecto"),p(),f(11,"th",38),x(12,"Monto Original"),p(),f(13,"th",38),x(14,"A Acreditar"),p(),f(15,"th",39),x(16,"Estado"),p(),f(17,"th",39),x(18,"Acciones"),p()()(),f(19,"tbody",40),zt(20,eT,34,17,"tr",41,X8),p()()()(),xe(22,iT,10,6,"div",42)),i&2){let e=q();S(20),Ht(e.paginatedRefunds()),S(2),ve(e.totalPages()>1?22:-1)}}function rT(i,t){i&1&&(f(0,"div",27)(1,"p",61),x(2,"\u{1F4ED} No se encontraron reembolsos"),p(),f(3,"p",62),x(4,"Ajusta los filtros o espera nuevas solicitudes"),p()())}var ch=class i{refundsService=lt(Vv);authService=lt(pn);refunds=Ge(()=>this.refundsService.refunds());isLoading=Ge(()=>this.refundsService.isLoading());statusFilter=Ae("all");searchTerm=Ae("");currentPage=Ae(1);itemsPerPage=Ae(10);showDetailsModal=Ae(!1);selectedRefund=Ae(null);showReviewModal=Ae(!1);reviewRefund=Ae(null);showCompleteModal=Ae(!1);completeRefund=Ae(null);filteredRefunds=Ge(()=>{let t=this.statusFilter(),e=this.searchTerm().toLowerCase().trim(),n=this.refunds();return t!=="all"&&(n=n.filter(r=>r.status===t)),e&&(n=n.filter(r=>{let a=r.user?.name?.toLowerCase()||"",s=r.user?.surname?.toLowerCase()||"",o=r.course?.title?.toLowerCase()||"",l=r.project?.title?.toLowerCase()||"",c=r.originalAmount.toString();return a.includes(e)||s.includes(e)||o.includes(e)||l.includes(e)||c.includes(e)})),n});totalPages=Ge(()=>Math.ceil(this.filteredRefunds().length/this.itemsPerPage()));paginatedRefunds=Ge(()=>{let t=(this.currentPage()-1)*this.itemsPerPage(),e=t+this.itemsPerPage();return this.filteredRefunds().slice(t,e)});stats=Ge(()=>{let t=this.filteredRefunds();return{total:t.length,pending:t.filter(e=>e.status==="pending").length,processing:t.filter(e=>e.status==="processing").length,completed:t.filter(e=>e.status==="completed").length,rejected:t.filter(e=>e.status==="rejected").length,totalOriginal:t.reduce((e,n)=>e+n.originalAmount,0),totalRefunded:t.reduce((e,n)=>e+(n.calculations?.refundAmount||0),0)}});user=Ge(()=>this.authService.user());async ngOnInit(){await this.loadRefunds()}async loadRefunds(){await this.refundsService.loadRefunds()}openDetailsModal(t){this.selectedRefund.set(t),this.showDetailsModal.set(!0)}closeDetailsModal(){this.showDetailsModal.set(!1),this.selectedRefund.set(null)}openReviewModal(t){this.reviewRefund.set(t),this.showReviewModal.set(!0)}closeReviewModal(){this.showReviewModal.set(!1),this.reviewRefund.set(null)}async handleApprove(t){let e=this.reviewRefund();if(e)try{await this.refundsService.reviewRefund(e._id,"approved",t),alert("\u2705 Reembolso aprobado. Ahora debe procesarse el pago."),this.closeReviewModal()}catch{alert("\u274C Error al aprobar reembolso")}}async handleReject(t){let e=this.reviewRefund();if(e)try{await this.refundsService.reviewRefund(e._id,"rejected",t),alert("\u2705 Reembolso rechazado"),this.closeReviewModal()}catch{alert("\u274C Error al rechazar reembolso")}}openCompleteModal(t){this.completeRefund.set(t),this.showCompleteModal.set(!0)}closeCompleteModal(){this.showCompleteModal.set(!1),this.completeRefund.set(null)}async handleComplete(t){let e=this.completeRefund();if(e)try{await this.refundsService.markCompleted(e._id,t.receiptNumber,t.receiptImage),alert("\u2705 Reembolso completado"),this.closeCompleteModal()}catch{alert("\u274C Error al completar reembolso")}}getStatusBadgeClass(t){return{pending:"bg-yellow-500/20 text-yellow-300",approved:"bg-green-500/20 text-green-300",rejected:"bg-red-500/20 text-red-300",processing:"bg-blue-500/20 text-blue-300",completed:"bg-lime-500/20 text-lime-300",failed:"bg-red-500/20 text-red-300"}[t]||"bg-slate-500/20 text-slate-300"}getStatusLabel(t){return{pending:"Pendiente",approved:"Aprobado",rejected:"Rechazado",processing:"Procesando",completed:"Completado",failed:"Fallido"}[t]||t}getReasonLabel(t){return{course_not_started:"Curso no iniciado",dissatisfied:"Insatisfecho",technical_issues:"Problemas t\xE9cnicos",duplicate_purchase:"Compra duplicada",instructor_request:"Solicitud del instructor",other:"Otro"}[t]||t}formatDate(t){return t?new Date(t).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-"}formatCurrency(t){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t)}goToPage(t){t>=1&&t<=this.totalPages()&&this.currentPage.set(t)}canReview(t){let e=this.user();if(!e||t.status!=="pending")return!1;if(e.rol==="admin")return!0;if(e.rol==="instructor"){let n=t.course?.user?._id||t.course?.user,r=t.project?.user?._id||t.project?.user;return n===e._id||r===e._id}return!1}canComplete(t){return this.user()?.rol==="admin"&&t.status==="processing"}Math=Math;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-refunds"]],decls:71,vars:22,consts:[[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-slate-400"],[1,"grid","grid-cols-1","md:grid-cols-4","lg:grid-cols-6","gap-4","mb-6"],[1,"bg-slate-800","border","border-white/10","rounded-lg","p-4"],[1,"text-slate-400","text-sm","mb-1"],[1,"text-2xl","font-bold","text-white"],[1,"text-2xl","font-bold","text-yellow-300"],[1,"text-2xl","font-bold","text-blue-300"],[1,"text-2xl","font-bold","text-lime-300"],[1,"text-lg","font-bold","text-white"],[1,"text-lg","font-bold","text-lime-300"],[1,"text-xs","text-slate-500","mt-1"],[1,"bg-slate-800","border","border-white/10","rounded-lg","p-4","mb-4"],[1,"flex","flex-wrap","gap-4"],[1,"flex-1","min-w-[200px]"],["type","text","placeholder","\u{1F50D} Buscar por usuario, curso, monto...",1,"w-full","px-4","py-2","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"ngModelChange","ngModel"],[1,"px-4","py-2","bg-slate-900","border","border-slate-700","rounded-lg","text-white","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"ngModelChange","ngModel"],["value","all"],["value","pending"],["value","processing"],["value","completed"],["value","rejected"],["value","failed"],[3,"value"],[1,"text-center","py-12"],[1,"text-center","py-12","bg-slate-800","border","border-white/10","rounded-lg"],[3,"close","show","refund"],[3,"close","approve","reject","show","refund"],[3,"close","complete","show","refund"],[1,"inline-block","animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"text-slate-400","mt-4"],[1,"bg-slate-800","border","border-white/10","rounded-lg","overflow-hidden"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-900","border-b","border-white/10"],[1,"px-4","py-3","text-left","text-xs","font-medium","text-slate-400","uppercase"],[1,"px-4","py-3","text-right","text-xs","font-medium","text-slate-400","uppercase"],[1,"px-4","py-3","text-center","text-xs","font-medium","text-slate-400","uppercase"],[1,"divide-y","divide-white/10"],[1,"hover:bg-slate-700/50","transition-colors"],[1,"mt-4","flex","items-center","justify-between"],[1,"px-4","py-4","whitespace-nowrap"],[1,"text-sm","text-white"],[1,"px-4","py-4"],[1,"text-sm","font-medium","text-white"],[1,"text-xs","text-slate-400"],[1,"text-xs","text-slate-400","mt-1"],[1,"px-4","py-4","text-right"],[1,"text-sm","font-bold","text-lime-300"],[1,"px-4","py-4","text-center"],[1,"flex","items-center","justify-center","gap-2"],["title","Ver detalles completos",1,"px-3","py-1","bg-slate-700","hover:bg-slate-600","text-white","text-xs","rounded-lg","transition-colors",3,"click"],[1,"px-3","py-1","bg-lime-500","hover:bg-lime-600","text-black","text-xs","rounded-lg","transition-colors"],[1,"px-3","py-1","bg-lime-500","hover:bg-lime-600","text-black","text-xs","rounded-lg","transition-colors",3,"click"],[1,"text-sm","text-slate-400"],[1,"flex","gap-2"],[1,"px-3","py-1","bg-slate-700","hover:bg-slate-600","disabled:opacity-50","disabled:cursor-not-allowed","text-white","rounded-lg","text-sm","transition-colors",3,"click","disabled"],[3,"class"],[3,"click"],[1,"text-slate-400","text-lg"],[1,"text-slate-500","text-sm","mt-2"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"h1",2),x(3,"\u{1F4B8} Gesti\xF3n de Reembolsos"),p(),f(4,"p",3),x(5,"Solicitudes de devoluci\xF3n - Acreditaci\xF3n autom\xE1tica a billetera digital"),p()(),f(6,"div",4)(7,"div",5)(8,"div",6),x(9,"Total"),p(),f(10,"div",7),x(11),p()(),f(12,"div",5)(13,"div",6),x(14,"Pendientes"),p(),f(15,"div",8),x(16),p()(),f(17,"div",5)(18,"div",6),x(19,"Procesando"),p(),f(20,"div",9),x(21),p()(),f(22,"div",5)(23,"div",6),x(24,"Completados"),p(),f(25,"div",10),x(26),p()(),f(27,"div",5)(28,"div",6),x(29,"Original Total"),p(),f(30,"div",11),x(31),p()(),f(32,"div",5)(33,"div",6),x(34,"Reembolsado"),p(),f(35,"div",12),x(36),p(),f(37,"div",13),x(38,"\u{1F4B0} Acreditado a billeteras"),p()()(),f(39,"div",14)(40,"div",15)(41,"div",16)(42,"input",17),ue("ngModelChange",function(a){return n.searchTerm.set(a),n.currentPage.set(1)}),p()(),f(43,"select",18),ue("ngModelChange",function(a){return n.statusFilter.set(a),n.currentPage.set(1)}),f(44,"option",19),x(45,"\u{1F4CB} Todos los estados"),p(),f(46,"option",20),x(47,"\u23F3 Pendientes"),p(),f(48,"option",21),x(49,"\u{1F504} Procesando"),p(),f(50,"option",22),x(51,"\u2705 Completados"),p(),f(52,"option",23),x(53,"\u274C Rechazados"),p(),f(54,"option",24),x(55,"\u26A0\uFE0F Fallidos"),p()(),f(56,"select",18),ue("ngModelChange",function(a){return n.itemsPerPage.set(a),n.currentPage.set(1)}),f(57,"option",25),x(58,"5 por p\xE1gina"),p(),f(59,"option",25),x(60,"10 por p\xE1gina"),p(),f(61,"option",25),x(62,"15 por p\xE1gina"),p(),f(63,"option",25),x(64,"20 por p\xE1gina"),p()()()(),xe(65,Y8,4,0,"div",26),xe(66,nT,23,1),xe(67,rT,5,0,"div",27),p(),f(68,"app-refund-details-modal",28),ue("close",function(){return n.closeDetailsModal()}),p(),f(69,"app-refund-review-modal",29),ue("close",function(){return n.closeReviewModal()})("approve",function(a){return n.handleApprove(a)})("reject",function(a){return n.handleReject(a)}),p(),f(70,"app-refund-complete-modal",30),ue("close",function(){return n.closeCompleteModal()})("complete",function(a){return n.handleComplete(a)}),p()),e&2&&(S(11),Ve(n.stats().total),S(5),Ve(n.stats().pending),S(5),Ve(n.stats().processing),S(5),Ve(n.stats().completed),S(5),Ve(n.formatCurrency(n.stats().totalOriginal)),S(5),Ve(n.formatCurrency(n.stats().totalRefunded)),S(6),Ce("ngModel",n.searchTerm()),S(),Ce("ngModel",n.statusFilter()),S(13),Ce("ngModel",n.itemsPerPage()),S(),Ce("value",5),S(2),Ce("value",10),S(2),Ce("value",15),S(2),Ce("value",20),S(2),ve(n.isLoading()?65:-1),S(),ve(!n.isLoading()&&n.paginatedRefunds().length>0?66:-1),S(),ve(!n.isLoading()&&n.paginatedRefunds().length===0?67:-1),S(),Ce("show",n.showDetailsModal())("refund",n.selectedRefund()),S(),Ce("show",n.showReviewModal())("refund",n.reviewRefund()),S(),Ce("show",n.showCompleteModal())("refund",n.completeRefund()))},dependencies:[mn,Hn,Wn,ki,hr,wi,zn,sh,oh,lh],encapsulation:2})};var I_=(i,t)=>t._id;function aT(i,t){if(i&1&&(f(0,"span",12),x(1),p()),i&2){let e=q();S(),Re(" ",e.pendingCourses().length," ")}}function sT(i,t){i&1&&ce(0,"div",13)}function oT(i,t){if(i&1&&(f(0,"span",14),x(1),p()),i&2){let e=q();S(),Re(" ",e.pendingProjects().length," ")}}function lT(i,t){i&1&&ce(0,"div",15)}function cT(i,t){i&1&&(f(0,"div",16),ce(1,"div",17),p())}function uT(i,t){i&1&&(f(0,"div",18)(1,"p",3),x(2,"No hay cursos pendientes de revisi\xF3n"),p()())}function dT(i,t){i&1&&(f(0,"div",23),x(1," Borrador "),p())}function fT(i,t){if(i&1){let e=nt();f(0,"div",20)(1,"div",21),ce(2,"img",22),xe(3,dT,2,0,"div",23),p(),f(4,"div",24)(5,"h3",25),x(6),p(),f(7,"p",26),x(8),p(),f(9,"button",27),ue("click",function(){let r=be(e).$implicit,a=q(4);return we(a.goToReview("course",r))}),x(10," Revisar Curso "),p()()()}if(i&2){let e=t.$implicit,n=q(4);S(2),Ce("src",n.buildImageUrl(e.imagen,"course"),Ui),S(),ve(e.state===1?3:-1),S(3),Ve(e.title),S(2),Re("Instructor: ",(e.user==null?null:e.user.full_name)||(e.user==null?null:e.user.name)+" "+(e.user==null?null:e.user.surname)||"Desconocido")}}function hT(i,t){if(i&1&&(f(0,"div",19),zt(1,fT,11,4,"div",20,I_),p()),i&2){let e=q(3);S(),Ht(e.pendingCourses())}}function pT(i,t){if(i&1&&xe(0,uT,3,0,"div",18)(1,hT,3,0,"div",19),i&2){let e=q(2);ve(e.pendingCourses().length===0?0:1)}}function mT(i,t){i&1&&(f(0,"div",18)(1,"p",3),x(2,"No hay proyectos pendientes de revisi\xF3n"),p()())}function gT(i,t){if(i&1){let e=nt();f(0,"div",28)(1,"div",21),ce(2,"img",29),f(3,"div",23),x(4," Borrador "),p()(),f(5,"div",24)(6,"h3",25),x(7),p(),f(8,"p",26),x(9),p(),f(10,"button",27),ue("click",function(){let r=be(e).$implicit,a=q(4);return we(a.goToReview("project",r))}),x(11," Revisar Proyecto "),p()()()}if(i&2){let e=t.$implicit,n=q(4);S(2),Ce("src",n.buildImageUrl(e.imagen,"project"),Ui),S(5),Ve(e.title),S(2),Re("Instructor: ",(e.user==null?null:e.user.full_name)||(e.user==null?null:e.user.name)+" "+(e.user==null?null:e.user.surname)||"Desconocido"," ")}}function xT(i,t){if(i&1&&(f(0,"div",19),zt(1,gT,12,3,"div",28,I_),p()),i&2){let e=q(3);S(),Ht(e.pendingProjects())}}function vT(i,t){if(i&1&&xe(0,mT,3,0,"div",18)(1,xT,3,0,"div",19),i&2){let e=q(2);ve(e.pendingProjects().length===0?0:1)}}function _T(i,t){if(i&1&&(xe(0,pT,2,1),xe(1,vT,2,1)),i&2){let e=q();ve(e.activeTab()==="courses"?0:-1),S(),ve(e.activeTab()==="projects"?1:-1)}}var uh=class i{coursesService=lt(tl);projectService=lt(z0);router=lt(el);activeTab=Ae("courses");pendingCourses=Ae([]);pendingProjects=Ae([]);isLoading=Ae(!1);ngOnInit(){this.loadPendingItems()}loadPendingItems(){this.isLoading.set(!0),this.coursesService.getCoursesAdmin("Borrador").subscribe({next:t=>{this.pendingCourses.set(t.courses||[]),this.checkLoading()},error:()=>this.checkLoading()}),this.projectService.getProjectsAdmin("Borrador").subscribe({next:t=>{this.pendingProjects.set(t.projects||[]),this.checkLoading()},error:()=>this.checkLoading()})}checkLoading(){this.isLoading.set(!1)}setActiveTab(t){this.activeTab.set(t)}goToReview(t,e){t==="course"?(this.coursesService.setFiltro({search:e.title}),this.router.navigate(["/dashboard"],{queryParams:{section:"courses"}})):this.router.navigate(["/dashboard"],{queryParams:{section:"projects"}})}buildImageUrl(t,e){return t?t.startsWith("http")?t:e==="course"?`${$t.images.course}${t}`:`${$t.images.project}${t}`:""}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-review-notifications"]],decls:18,vars:14,consts:[[1,"p-6"],[1,"mb-8"],[1,"text-3xl","font-bold","text-white","mb-2"],[1,"text-slate-400"],[1,"flex","gap-4","mb-6","border-b","border-white/10"],[1,"pb-3","px-1","text-sm","font-medium","transition-colors","relative",3,"click"],["class","ml-2 bg-lime-500/10 text-lime-400 px-2 py-0.5 rounded-full text-xs",4,"ngIf"],["class","absolute bottom-0 left-0 w-full h-0.5 bg-lime-400",4,"ngIf"],["class","ml-2 bg-cyan-500/10 text-cyan-400 px-2 py-0.5 rounded-full text-xs",4,"ngIf"],["class","absolute bottom-0 left-0 w-full h-0.5 bg-cyan-400",4,"ngIf"],[1,"space-y-4"],["class","flex justify-center py-12",4,"ngIf"],[1,"ml-2","bg-lime-500/10","text-lime-400","px-2","py-0.5","rounded-full","text-xs"],[1,"absolute","bottom-0","left-0","w-full","h-0.5","bg-lime-400"],[1,"ml-2","bg-cyan-500/10","text-cyan-400","px-2","py-0.5","rounded-full","text-xs"],[1,"absolute","bottom-0","left-0","w-full","h-0.5","bg-cyan-400"],[1,"flex","justify-center","py-12"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-white"],[1,"text-center","py-12","bg-white/5","rounded-xl","border","border-white/5"],[1,"grid","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"bg-slate-900","border","border-white/10","rounded-xl","overflow-hidden","hover:border-lime-500/30","transition-all"],[1,"h-40","bg-slate-800","relative"],["alt","Course cover",1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","top-2","right-2","px-2","py-1","bg-yellow-500/20","text-yellow-500","text-xs","font-bold","rounded"],[1,"p-4"],[1,"font-bold","text-white","mb-1","line-clamp-1"],[1,"text-sm","text-slate-400","mb-4"],[1,"w-full","py-2","bg-white/5","hover:bg-white/10","border","border-white/10","rounded-lg","text-sm","font-medium","text-white","transition-colors",3,"click"],[1,"bg-slate-900","border","border-white/10","rounded-xl","overflow-hidden","hover:border-cyan-500/30","transition-all"],["alt","Project cover",1,"w-full","h-full","object-cover",3,"src"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"h1",2),x(3,"Solicitudes de Publicaci\xF3n"),p(),f(4,"p",3),x(5,"Revisa y aprueba los cursos y proyectos pendientes de publicaci\xF3n."),p()(),f(6,"div",4)(7,"button",5),ue("click",function(){return n.setActiveTab("courses")}),x(8," Cursos Pendientes "),Vr(9,aT,2,1,"span",6)(10,sT,1,0,"div",7),p(),f(11,"button",5),ue("click",function(){return n.setActiveTab("projects")}),x(12," Proyectos Pendientes "),Vr(13,oT,2,1,"span",8)(14,lT,1,0,"div",9),p()(),f(15,"div",10),Vr(16,cT,2,0,"div",11),xe(17,_T,2,2),p()()),e&2&&(S(7),oi("text-lime-400",n.activeTab()==="courses")("text-slate-400",n.activeTab()!=="courses"),S(2),Ce("ngIf",n.pendingCourses().length>0),S(),Ce("ngIf",n.activeTab()==="courses"),S(),oi("text-cyan-400",n.activeTab()==="projects")("text-slate-400",n.activeTab()!=="projects"),S(2),Ce("ngIf",n.pendingProjects().length>0),S(),Ce("ngIf",n.activeTab()==="projects"),S(2),Ce("ngIf",n.isLoading()),S(),ve(n.isLoading()?-1:17))},dependencies:[yn,kf],encapsulation:2})};function bT(i,t){i&1&&(f(0,"p",6),x(1,"El nombre del sitio es requerido (m\xEDn. 3 caracteres)"),p())}function wT(i,t){if(i&1&&(f(0,"div",21)(1,"span",22),x(2),p(),f(3,"span",23),x(4),p()()),i&2){let e=q(2);S(2),hi(" \u{1F4CA} ",e.logoInfo().width," x ",e.logoInfo().height,"px "),S(2),Re(" \u{1F4CF} ",e.logoInfo().size," ")}}function yT(i,t){if(i&1&&(f(0,"div",10)(1,"span",20),x(2," \u2728 Nuevo logo seleccionado "),p(),xe(3,wT,5,3,"div",21),p()),i&2){let e=q();S(3),ve(e.logoInfo()?3:-1)}}function ST(i,t){if(i&1){let e=nt();f(0,"button",24),ue("click",function(){be(e);let r=q();return we(r.removeLogo())}),x(1," \u{1F5D1}\uFE0F Quitar "),p()}}var Au=class i{form;systemConfigService;logoSelected=new mu;logoRemoved=new mu;logoPreview=Ae(null);logoFile=Ae(null);logoInfo=Ae(null);currentLogoUrl=Ge(()=>{let t=this.logoPreview();if(t)return t;let e=this.systemConfigService.config();return e?.logo?this.systemConfigService.buildLogoUrl(e.logo):"https://placehold.co/200x80?text=Sin+Logo"});onLogoSelected(t){let e=t.target.files[0];if(!e)return;if(!e.type.startsWith("image/")){alert("\u274C Por favor selecciona una imagen v\xE1lida (JPG, PNG, SVG, WEBP)");return}let n=10*1024*1024;if(e.size>n){let a=(e.size/1048576).toFixed(2);alert(`\u274C La imagen es demasiado grande (${a}MB). El tama\xF1o m\xE1ximo es 10MB`);return}this.logoFile.set(e);let r=new FileReader;r.onload=a=>{let s=a.target.result;this.logoPreview.set(s);let o=new Image;o.onload=()=>{let l={width:o.width,height:o.height,size:`${(e.size/1048576).toFixed(2)}MB`};this.logoInfo.set(l)},o.src=s},r.readAsDataURL(e),this.logoSelected.emit(t)}removeLogo(){this.logoFile.set(null),this.logoPreview.set(null),this.logoInfo.set(null),this.logoRemoved.emit()}getLogoFile(){return this.logoFile()}clearPreview(){this.logoFile.set(null),this.logoPreview.set(null),this.logoInfo.set(null)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-basic-info"]],inputs:{form:"form",systemConfigService:"systemConfigService"},outputs:{logoSelected:"logoSelected",logoRemoved:"logoRemoved"},decls:45,vars:6,consts:[[1,"bg-slate-800","rounded-lg","p-6","border","border-white/10"],[1,"text-xl","font-bold","text-white","mb-6","flex","items-center","gap-2"],[1,"space-y-6",3,"formGroup"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],[1,"text-red-400"],["type","text","formControlName","siteName","placeholder","Ej: Dev-Sharks",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"mt-1","text-sm","text-red-400"],[1,"mb-4","p-6","bg-slate-900","rounded-lg","border","border-slate-700"],[1,"flex","items-center","justify-center","min-h-[160px]"],["alt","Logo preview",1,"max-h-40","max-w-full","w-auto","object-contain","transition-all","duration-300","hover:scale-105",2,"max-width","min(100%, 400px)",3,"src"],[1,"mt-3","text-center","space-y-2"],[1,"flex","gap-2"],[1,"flex-1","cursor-pointer"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"px-4","py-2.5","bg-lime-500","hover:bg-lime-600","text-slate-900","font-medium","rounded-lg","text-center","transition-colors"],["type","button",1,"px-4","py-2.5","bg-red-500/20","hover:bg-red-500/30","text-red-400","font-medium","rounded-lg","transition-colors"],[1,"mt-2","text-xs","text-slate-400"],[1,"text-lime-400"],["formControlName","siteDescription","rows","3","placeholder","Breve descripci\xF3n de tu plataforma...",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent","resize-none"],[1,"mt-1","text-xs","text-slate-400"],[1,"inline-block","px-3","py-1","bg-lime-500/20","text-lime-400","text-xs","rounded-full"],[1,"text-xs","text-slate-400"],[1,"inline-block","px-2","py-1","bg-slate-800","rounded"],[1,"inline-block","px-2","py-1","bg-slate-800","rounded","ml-2"],["type","button",1,"px-4","py-2.5","bg-red-500/20","hover:bg-red-500/30","text-red-400","font-medium","rounded-lg","transition-colors",3,"click"]],template:function(e,n){if(e&1&&(f(0,"div",0)(1,"h3",1)(2,"span"),x(3,"\u{1F3E2}"),p(),f(4,"span"),x(5,"Informaci\xF3n B\xE1sica"),p()(),f(6,"div",2)(7,"div")(8,"label",3),x(9," Nombre del Sitio "),f(10,"span",4),x(11,"*"),p()(),ce(12,"input",5),xe(13,bT,2,0,"p",6),p(),f(14,"div")(15,"label",3),x(16," Logotipo del Sitio "),p(),f(17,"div",7)(18,"div",8),ce(19,"img",9),p(),xe(20,yT,4,1,"div",10),p(),f(21,"div",11)(22,"label",12)(23,"input",13),ue("change",function(a){return n.onLogoSelected(a)}),p(),f(24,"div",14),x(25),p()(),xe(26,ST,2,0,"button",15),p(),f(27,"p",16),x(28," \u{1F4DD} Formatos: JPG, PNG, SVG, WEBP | \u{1F4CF} Tama\xF1o m\xE1ximo: "),f(29,"strong",17),x(30,"10MB"),p(),ce(31,"br"),x(32," \u{1F4CA} Dimensiones sugeridas: "),f(33,"strong",17),x(34,"200x80px"),p(),x(35," (rectangular) o "),f(36,"strong",17),x(37,"300x300px"),p(),x(38," (cuadrado) "),p()(),f(39,"div")(40,"label",3),x(41," Descripci\xF3n del Sitio "),p(),ce(42,"textarea",18),f(43,"p",19),x(44," Esta descripci\xF3n aparecer\xE1 en meta tags y motores de b\xFAsqueda "),p()()()()),e&2){let r;S(6),Ce("formGroup",n.form),S(7),ve((r=n.form.get("siteName"))!=null&&r.invalid&&((r=n.form.get("siteName"))!=null&&r.touched)?13:-1),S(6),Ce("src",n.currentLogoUrl(),Ui),S(),ve(n.logoPreview()?20:-1),S(5),Re(" \u{1F4E4} ",n.logoPreview()?"Cambiar Logo":"Subir Logo"," "),S(),ve(n.logoPreview()?26:-1)}},dependencies:[pr,ki,wi,dr,fr,Ur],encapsulation:2})};function CT(i,t){i&1&&(f(0,"p",6),x(1,"Por favor ingresa un email v\xE1lido"),p())}function ET(i,t){i&1&&(f(0,"p",6),x(1,"Por favor ingresa un email v\xE1lido"),p())}var dh=class i{form;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-contact-info"]],inputs:{form:"form"},decls:29,vars:3,consts:[[1,"bg-slate-800","rounded-lg","p-6","border","border-white/10"],[1,"text-xl","font-bold","text-white","mb-6","flex","items-center","gap-2"],[1,"space-y-6",3,"formGroup"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],[1,"text-red-400"],["type","email","formControlName","email","placeholder","contacto@Dev-Sharks.com",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"mt-1","text-sm","text-red-400"],[1,"mt-1","text-xs","text-slate-400"],["type","tel","formControlName","phone","placeholder","+52 123 456 7890",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["type","email","formControlName","supportEmail","placeholder","soporte@Dev-Sharks.com",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"]],template:function(e,n){if(e&1&&(f(0,"div",0)(1,"h3",1)(2,"span"),x(3,"\u{1F4DE}"),p(),f(4,"span"),x(5,"Informaci\xF3n de Contacto"),p()(),f(6,"div",2)(7,"div")(8,"label",3),x(9," Email Principal "),f(10,"span",4),x(11,"*"),p()(),ce(12,"input",5),xe(13,CT,2,0,"p",6),f(14,"p",7),x(15," Email principal de contacto de la plataforma "),p()(),f(16,"div")(17,"label",3),x(18," Tel\xE9fono "),p(),ce(19,"input",8),f(20,"p",7),x(21," Tel\xE9fono de contacto (opcional) "),p()(),f(22,"div")(23,"label",3),x(24," Email de Soporte "),p(),ce(25,"input",9),xe(26,ET,2,0,"p",6),f(27,"p",7),x(28," Email dedicado para soporte t\xE9cnico (opcional) "),p()()()()),e&2){let r,a;S(6),Ce("formGroup",n.form),S(7),ve((r=n.form.get("email"))!=null&&r.invalid&&((r=n.form.get("email"))!=null&&r.touched)?13:-1),S(13),ve((a=n.form.get("supportEmail"))!=null&&a.invalid&&((a=n.form.get("supportEmail"))!=null&&a.touched)?26:-1)}},dependencies:[pr,ki,wi,dr,fr,Ur],encapsulation:2})};var fh=class i{form;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-social-media"]],inputs:{form:"form"},decls:65,vars:1,consts:[[1,"bg-slate-800","rounded-lg","p-6","border","border-white/10"],[1,"text-xl","font-bold","text-white","mb-6","flex","items-center","gap-2"],[1,"space-y-5",3,"formGroup"],[1,"block","text-sm","font-medium","text-slate-300","mb-2","flex","items-center","gap-2"],[1,"text-blue-400"],["type","url","formControlName","facebook","placeholder","https://facebook.com/tu-pagina",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-pink-400"],["type","url","formControlName","instagram","placeholder","https://instagram.com/tu-perfil",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-red-400"],["type","url","formControlName","youtube","placeholder","https://youtube.com/@tu-canal",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["type","url","formControlName","tiktok","placeholder","https://tiktok.com/@tu-usuario",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-purple-400"],["type","url","formControlName","twitch","placeholder","https://twitch.tv/tu-canal",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-sky-400"],["type","url","formControlName","twitter","placeholder","https://x.com/tu-usuario",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-blue-500"],["type","url","formControlName","linkedin","placeholder","https://linkedin.com/company/tu-empresa",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["type","url","formControlName","website","placeholder","https://tu-sitio-web.com",1,"w-full","px-4","py-2.5","bg-slate-900","border","border-slate-700","rounded-lg","text-white","placeholder-slate-500","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"text-xs","text-slate-400","mt-4"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"h3",1)(2,"span"),x(3,"\u{1F310}"),p(),f(4,"span"),x(5,"Redes Sociales"),p()(),f(6,"div",2)(7,"div")(8,"label",3)(9,"span",4),x(10,"\u{1F4D8}"),p(),f(11,"span"),x(12,"Facebook"),p()(),ce(13,"input",5),p(),f(14,"div")(15,"label",3)(16,"span",6),x(17,"\u{1F4F7}"),p(),f(18,"span"),x(19,"Instagram"),p()(),ce(20,"input",7),p(),f(21,"div")(22,"label",3)(23,"span",8),x(24,"\u{1F3A5}"),p(),f(25,"span"),x(26,"YouTube"),p()(),ce(27,"input",9),p(),f(28,"div")(29,"label",3)(30,"span"),x(31,"\u{1F3B5}"),p(),f(32,"span"),x(33,"TikTok"),p()(),ce(34,"input",10),p(),f(35,"div")(36,"label",3)(37,"span",11),x(38,"\u{1F4E1}"),p(),f(39,"span"),x(40,"Twitch"),p()(),ce(41,"input",12),p(),f(42,"div")(43,"label",3)(44,"span",13),x(45,"\u{1F426}"),p(),f(46,"span"),x(47,"Twitter / X"),p()(),ce(48,"input",14),p(),f(49,"div")(50,"label",3)(51,"span",15),x(52,"\u{1F4BC}"),p(),f(53,"span"),x(54,"LinkedIn"),p()(),ce(55,"input",16),p(),f(56,"div")(57,"label",3)(58,"span"),x(59,"\u{1F30D}"),p(),f(60,"span"),x(61,"Sitio Web Adicional"),p()(),ce(62,"input",17),p(),f(63,"p",18),x(64," \u{1F4A1} Todas las redes sociales son opcionales. Solo completa las que uses. "),p()()()),e&2&&(S(6),Ce("formGroup",n.form))},dependencies:[pr,ki,wi,dr,fr,Ur],encapsulation:2})};function kT(i,t){i&1&&(f(0,"span",32),ce(1,"i",33),p())}function TT(i,t){i&1&&(f(0,"span",32),ce(1,"i",34),p())}function AT(i,t){i&1&&ce(0,"i",43)}function FT(i,t){i&1&&ce(0,"div",44)}function DT(i,t){if(i&1&&ce(0,"div",45),i&2){let e=q(2);uo("width",e.downloadPercentage(),"%")}}function NT(i,t){i&1&&(f(0,"p",46),x(1," El servidor est\xE1 preparando el archivo. Esto puede tardar unos segundos dependiendo del tama\xF1o de la base de datos. "),p())}function PT(i,t){if(i&1&&(f(0,"div",35)(1,"div",36)(2,"span",37),Vr(3,AT,1,0,"i",38),x(4),p(),f(5,"span",37),x(6),p()(),f(7,"div",39),Vr(8,FT,1,0,"div",40)(9,DT,1,2,"div",41),p(),Vr(10,NT,2,0,"p",42),p()),i&2){let e=q();S(3),Ce("ngIf",e.downloadPercentage()===0),S(),Re(" ",e.downloadPercentage()>0?"Descargando archivo...":"Generando respaldo..."," "),S(2),Re("",e.downloadPercentage(),"%"),S(2),Ce("ngIf",e.downloadPercentage()===0),S(),Ce("ngIf",e.downloadPercentage()>0),S(),Ce("ngIf",e.downloadPercentage()===0)}}function MT(i,t){i&1&&(f(0,"span",32),ce(1,"i",33),p())}function LT(i,t){i&1&&(f(0,"span",32),ce(1,"i",47),p())}function IT(i,t){if(i&1&&(f(0,"div",35)(1,"div",36)(2,"span",37),x(3),p(),f(4,"span",37),x(5),p()(),f(6,"div",48),ce(7,"div",45),p()()),i&2){let e=q();S(3),Ve(e.restoreMessage()),S(2),Re("",e.restorePercentage(),"%"),S(2),uo("width",e.restorePercentage(),"%")}}function RT(i,t){i&1&&(f(0,"div",63),ce(1,"i",64),p())}function OT(i,t){if(i&1){let e=nt();f(0,"div")(1,"textarea",65),ue("ngModelChange",function(r){be(e);let a=q(2);return we(a.backupNotes.set(r))}),x(2,"                "),p()()}if(i&2){let e=q(2);S(),Li("w-full h-32 px-4 py-3 bg-slate-900 border border-slate-700 rounded-lg text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50 resize-none "+(e.isUserAdmin()?"":"cursor-not-allowed opacity-60")),Ce("ngModel",e.backupNotes())("readonly",!e.isUserAdmin())}}function BT(i,t){i&1&&ce(0,"i",68)}function jT(i,t){if(i&1){let e=nt();f(0,"button",66),ue("click",function(){be(e);let r=q(2);return we(r.saveBackupNotes())}),x(1),Vr(2,BT,1,0,"i",67),p()}if(i&2){let e=q(2);Ce("disabled",e.isSavingNote()),S(),Re(" ",e.isSavingNote()?"Guardando...":"Guardar Notas"," "),S(),Ce("ngIf",!e.isSavingNote())}}function VT(i,t){if(i&1){let e=nt();f(0,"div",49)(1,"div",50),ue("click",function(){be(e);let r=q();return we(r.closeNotesModal())}),p(),f(2,"div",51),ue("click",function(r){return be(e),we(r.stopPropagation())}),f(3,"div",52)(4,"h3",53),ce(5,"i",54),x(6," Notas de Respaldo "),p(),f(7,"button",55),ue("click",function(){be(e);let r=q();return we(r.closeNotesModal())}),ce(8,"i",56),p()(),f(9,"div",57),Vr(10,RT,2,0,"div",58)(11,OT,3,4,"div",59),p(),f(12,"div",60)(13,"button",61),ue("click",function(){be(e);let r=q();return we(r.closeNotesModal())}),x(14," Cerrar "),p(),Vr(15,jT,3,3,"button",62),p()()()}if(i&2){let e=q();S(10),Ce("ngIf",e.isLoadingNotes()),S(),Ce("ngIf",!e.isLoadingNotes()),S(4),Ce("ngIf",e.isUserAdmin())}}var hh=class i{systemConfigService=lt(Ns);websocketService=lt(rl);authService=lt(pn);http=lt(ur);toast=lt(ua);wsSubscription;isDownloading=Ae(!1);isRestoring=Ae(!1);restorePercentage=Ae(0);restoreMessage=Ae("");downloadPercentage=Ae(0);showNotesModal=Ae(!1);backupNotes=Ae("");isSavingNote=Ae(!1);isLoadingNotes=Ae(!1);isUserAdmin=Ae(!1);ngOnInit(){this.wsSubscription=this.websocketService.restoreProgress$.subscribe(t=>{console.log("\u{1F4E1} Progreso recibido:",t),this.restorePercentage.set(t.percentage),this.restoreMessage.set(t.message),t.percentage===100&&setTimeout(()=>window.location.reload(),2e3)}),this.isUserAdmin.set(this.authService.hasRole("admin"))}ngOnDestroy(){this.wsSubscription?.unsubscribe()}downloadBackup(){if(this.isDownloading())return;this.isDownloading.set(!0),this.downloadPercentage.set(0);let t=0,e=setInterval(()=>{t<90&&(t+=Math.floor(Math.random()*3)+1,t>90&&(t=90),this.downloadPercentage.set(t))},800);this.systemConfigService.downloadBackup().subscribe({next:n=>{switch(n.type){case Qo.DownloadProgress:if(clearInterval(e),n.total){let r=Math.round(100*n.loaded/n.total);this.downloadPercentage.set(Math.max(r,t))}break;case Qo.Response:clearInterval(e),this.downloadPercentage.set(100),setTimeout(()=>{let r=n.body,a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a;let o=new Date().toISOString().replace(/[:.]/g,"-");s.download=`backup-${o}.zip`,s.click(),window.URL.revokeObjectURL(a),this.isDownloading.set(!1),this.downloadPercentage.set(0)},1e3);break}},error:()=>{clearInterval(e),alert("\u274C Error al descargar el respaldo"),this.isDownloading.set(!1),this.downloadPercentage.set(0)}})}onFileSelected(t){let e=t.target.files[0];if(e){if(!e.name.endsWith(".zip")){alert("\u274C Por favor selecciona un archivo .zip v\xE1lido");return}confirm(`\u26A0\uFE0F \xBFEst\xE1s seguro de que quieres restaurar este respaldo?

ESTA ACCI\xD3N ES DESTRUCTIVA: Se borrar\xE1n todos los datos actuales y se reemplazar\xE1n con los del respaldo.

Esta acci\xF3n no se puede deshacer.`)?this.restoreBackup(e):t.target.value=""}}restoreBackup(t){this.isRestoring()||(this.isRestoring.set(!0),this.restorePercentage.set(0),this.restoreMessage.set("Iniciando carga..."),this.systemConfigService.restoreBackup(t).subscribe({next:e=>{switch(e.type){case Qo.UploadProgress:if(e.total){let n=Math.round(100*e.loaded/e.total);this.restorePercentage.set(n),this.restoreMessage.set("Subiendo archivo...")}break;case Qo.Response:this.restorePercentage.set(100),this.restoreMessage.set("Completado"),setTimeout(()=>{alert(`\u2705 Base de datos restaurada correctamente.

`+e.body.message),this.isRestoring.set(!1),this.restorePercentage.set(0)},1e3);break}},error:e=>{console.error(e);let n=e.error?.message||"Error desconocido";alert(`\u274C Error al restaurar la base de datos:
`+n),this.isRestoring.set(!1),this.restorePercentage.set(0)}}))}openNotesModal(){this.showNotesModal.set(!0),this.loadBackupNotes()}closeNotesModal(){this.showNotesModal.set(!1),this.backupNotes.set("")}loadBackupNotes(){this.isLoadingNotes.set(!0),this.http.get(`${$t.url}system-config/backup-notes`).subscribe({next:t=>{this.backupNotes.set(t.notes||""),this.isLoadingNotes.set(!1)},error:t=>{console.error("Error cargando notas:",t),this.backupNotes.set(""),this.isLoadingNotes.set(!1),this.toast.error("Error al cargar las notas")}})}saveBackupNotes(){this.isUserAdmin()&&(this.isSavingNote.set(!0),this.http.put(`${$t.url}system-config/backup-notes`,{backup_notes:this.backupNotes()}).subscribe({next:()=>{this.toast.success("Notas guardadas correctamente"),this.closeNotesModal(),this.isSavingNote.set(!1)},error:t=>{console.error("Error guardando notas:",t),this.toast.error("Error al guardar las notas"),this.isSavingNote.set(!1)}}))}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-backup-config"]],decls:54,vars:11,consts:[["fileInput",""],[1,"p-6","bg-white","border","border-gray-200","rounded-lg","shadow-sm","dark:bg-gray-800","dark:border-gray-700"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900","dark:text-white"],[1,"fas","fa-database","mr-2","text-primary-600"],[1,"px-3","py-2","text-sm","bg-amber-500","hover:bg-amber-600","text-white","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"fas","fa-sticky-note"],[1,"mb-6","text-sm","text-gray-500","dark:text-gray-400"],[1,"mb-8"],[1,"text-md","font-medium","text-gray-900","dark:text-white","mb-3"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-4","p-4","bg-gray-50","dark:bg-gray-700","rounded-lg","border","border-gray-200","dark:border-gray-600"],[1,"flex","items-center","text-sm","text-gray-600","dark:text-gray-300"],[1,"fas","fa-file-archive","text-2xl","mr-3","text-yellow-500"],[1,"block","font-semibold"],[1,"text-xs"],[1,"w-full","sm:w-auto","px-5","py-2.5","text-sm","font-medium","text-white","inline-flex","items-center","justify-center","bg-primary-700","hover:bg-primary-800","focus:ring-4","focus:outline-none","focus:ring-primary-300","rounded-lg","text-center","dark:bg-primary-600","dark:hover:bg-primary-700","dark:focus:ring-primary-800","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["class","mr-2",4,"ngIf"],["class","mt-4 p-4 bg-blue-50 border border-blue-100 rounded-lg",4,"ngIf"],[1,"mb-4"],[1,"text-md","font-medium","text-red-600","dark:text-red-400","mb-3","flex","items-center"],[1,"fas","fa-exclamation-triangle","mr-2"],[1,"flex","flex-col","sm:flex-row","items-center","justify-between","gap-4","p-4","bg-red-50","dark:bg-red-900/10","rounded-lg","border","border-red-200","dark:border-red-900/30"],[1,"fas","fa-upload","text-2xl","mr-3","text-red-500"],[1,"block","font-semibold","text-gray-900","dark:text-gray-100"],[1,"text-xs","text-red-600","dark:text-red-400","font-bold"],[1,"w-full","sm:w-auto"],["type","file","accept",".zip",1,"hidden",3,"change"],[1,"w-full","sm:w-auto","px-5","py-2.5","text-sm","font-medium","text-white","inline-flex","items-center","justify-center","bg-red-600","hover:bg-red-700","focus:ring-4","focus:outline-none","focus:ring-red-300","rounded-lg","text-center","dark:bg-red-600","dark:hover:bg-red-700","dark:focus:ring-red-900","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["role","alert",1,"mt-4","flex","items-start","p-4","mb-4","text-sm","text-blue-800","rounded-lg","bg-blue-50","dark:bg-gray-800","dark:text-blue-400"],[1,"fas","fa-info-circle","flex-shrink-0","w-4","h-4","mt-[2px]","mr-3"],[1,"font-medium"],["class","fixed inset-0 z-50 flex items-center justify-center p-4",4,"ngIf"],[1,"mr-2"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-download"],[1,"mt-4","p-4","bg-blue-50","border","border-blue-100","rounded-lg"],[1,"flex","justify-between","mb-1"],[1,"text-sm","font-medium","text-blue-700"],["class","fas fa-cog fa-spin mr-2",4,"ngIf"],[1,"w-full","bg-gray-200","rounded-full","h-2.5","overflow-hidden"],["class","bg-blue-600 h-2.5 rounded-full animate-pulse w-full",4,"ngIf"],["class","bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out",3,"width",4,"ngIf"],["class","text-xs text-blue-500 mt-2",4,"ngIf"],[1,"fas","fa-cog","fa-spin","mr-2"],[1,"bg-blue-600","h-2.5","rounded-full","animate-pulse","w-full"],[1,"bg-blue-600","h-2.5","rounded-full","transition-all","duration-300","ease-out"],[1,"text-xs","text-blue-500","mt-2"],[1,"fas","fa-upload"],[1,"w-full","bg-gray-200","rounded-full","h-2.5"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm",3,"click"],[1,"bg-gradient-to-br","from-slate-800","to-slate-900","rounded-2xl","shadow-2xl","max-w-md","w-full","border","border-white/10","overflow-hidden","relative","z-50",3,"click"],[1,"bg-gradient-to-r","from-amber-500/20","to-amber-600/20","px-6","py-4","border-b","border-white/10","flex","items-center","justify-between"],[1,"text-lg","font-bold","text-white","flex","items-center","gap-2"],[1,"fas","fa-sticky-note","text-amber-400"],[1,"text-white/60","hover:text-white","transition-colors",3,"click"],[1,"fas","fa-times","text-xl"],[1,"px-6","py-4","space-y-4"],["class","flex justify-center items-center py-8",4,"ngIf"],[4,"ngIf"],[1,"px-6","py-4","border-t","border-white/10","flex","gap-3"],[1,"flex-1","px-4","py-2","bg-slate-700/50","hover:bg-slate-700","text-slate-300","rounded-lg","font-medium","transition-colors",3,"click"],["class","flex-1 px-4 py-2 bg-amber-500 hover:bg-amber-600 disabled:bg-amber-500/50 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",3,"disabled","click",4,"ngIf"],[1,"flex","justify-center","items-center","py-8"],[1,"fas","fa-spinner","fa-spin","text-amber-400","text-2xl"],["placeholder","Escribe notas sobre el respaldo...",3,"ngModelChange","ngModel","readonly"],[1,"flex-1","px-4","py-2","bg-amber-500","hover:bg-amber-600","disabled:bg-amber-500/50","text-white","rounded-lg","font-medium","transition-colors","flex","items-center","justify-center","gap-2",3,"click","disabled"],["class","fas fa-check",4,"ngIf"],[1,"fas","fa-check"]],template:function(e,n){if(e&1){let r=nt();f(0,"div",1)(1,"div",2)(2,"h3",3),ce(3,"i",4),x(4," Respaldo y Restauraci\xF3n "),p(),f(5,"button",5),ue("click",function(){return be(r),we(n.openNotesModal())}),ce(6,"i",6),x(7," Ver Notas "),p()(),f(8,"div",7)(9,"p"),x(10," Administre las copias de seguridad de su base de datos. Puede descargar un respaldo actual o restaurar uno anterior. "),p()(),f(11,"div",8)(12,"h4",9),x(13,"Descargar Respaldo Actual"),p(),f(14,"div",10)(15,"div",11),ce(16,"i",12),f(17,"div")(18,"span",13),x(19,"Generar ZIP"),p(),f(20,"span",14),x(21,"Incluye dump completo de MongoDB"),p()()(),f(22,"button",15),ue("click",function(){return be(r),we(n.downloadBackup())}),Vr(23,kT,2,0,"span",16)(24,TT,2,0,"span",16),x(25),p()(),Vr(26,PT,11,6,"div",17),p(),f(27,"div",18)(28,"h4",19),ce(29,"i",20),x(30," Restaurar Base de Datos "),p(),f(31,"div",21)(32,"div",11),ce(33,"i",22),f(34,"div")(35,"span",23),x(36,"Subir archivo ZIP"),p(),f(37,"span",24),x(38,"\u26A0\uFE0F Esta acci\xF3n reemplazar\xE1 toda la base de datos actual."),p()()(),f(39,"div",25)(40,"input",26,0),ue("change",function(s){return be(r),we(n.onFileSelected(s))}),p(),f(42,"button",27),ue("click",function(){be(r);let s=Sv(41);return we(s.click())}),Vr(43,MT,2,0,"span",16)(44,LT,2,0,"span",16),x(45),p()()(),Vr(46,IT,8,4,"div",17),p(),f(47,"div",28),ce(48,"i",29),f(49,"div")(50,"span",30),x(51,"Nota:"),p(),x(52," Para la restauraci\xF3n, aseg\xFArese de subir un archivo .zip v\xE1lido generado previamente por este sistema. El proceso puede tardar unos minutos. "),p()()(),Vr(53,VT,16,3,"div",31)}e&2&&(S(22),Ce("disabled",n.isDownloading()||n.isRestoring()),S(),Ce("ngIf",n.isDownloading()),S(),Ce("ngIf",!n.isDownloading()),S(),Re(" ",n.isDownloading()?"Generando...":"Descargar Respaldo"," "),S(),Ce("ngIf",n.isDownloading()),S(16),Ce("disabled",n.isRestoring()||n.isDownloading()),S(),Ce("ngIf",n.isRestoring()),S(),Ce("ngIf",!n.isRestoring()),S(),Re(" ",n.isRestoring()?"Restaurando...":"Subir y Restaurar"," "),S(),Ce("ngIf",n.isRestoring()),S(7),Ce("ngIf",n.showNotesModal()))},dependencies:[yn,kf,mn,ki,wi,zn],encapsulation:2})};function UT(i,t){i&1&&(f(0,"div",5)(1,"span",12),x(2,"\u2705"),p(),f(3,"div")(4,"p",16),x(5,"Configuraci\xF3n guardada exitosamente"),p(),f(6,"p",17),x(7,"Los cambios se han aplicado correctamente"),p()()())}function zT(i,t){i&1&&(f(0,"div",9)(1,"div",18),ce(2,"div",19),f(3,"p",4),x(4,"Cargando configuraci\xF3n..."),p()()())}function HT(i,t){i&1&&ce(0,"app-admin-payment-settings")}function WT(i,t){i&1&&ce(0,"app-backup-config")}function qT(i,t){if(i&1&&ce(0,"app-basic-info",22),i&2){let e=q(3);Ce("form",e.configForm)("systemConfigService",e.systemConfigService)}}function GT(i,t){if(i&1&&ce(0,"app-contact-info",23),i&2){let e=q(3);Ce("form",e.configForm)}}function $T(i,t){if(i&1&&ce(0,"app-social-media",23),i&2){let e=q(3);Ce("form",e.configForm)}}function XT(i,t){i&1&&(ce(0,"div",27),f(1,"span"),x(2,"Guardando..."),p())}function YT(i,t){i&1&&(f(0,"span"),x(1,"\u{1F4BE}"),p(),f(2,"span"),x(3,"Guardar Cambios"),p())}function KT(i,t){if(i&1){let e=nt();f(0,"form",21),ue("ngSubmit",function(){be(e);let r=q(2);return we(r.onSubmit())}),xe(1,qT,1,2,"app-basic-info",22),xe(2,GT,1,1,"app-contact-info",23),xe(3,$T,1,1,"app-social-media",23),f(4,"div",24)(5,"button",25),ue("click",function(){be(e);let r=q(2);return we(r.loadConfig())}),x(6," \u{1F504} Recargar "),p(),f(7,"button",26),xe(8,XT,3,0)(9,YT,4,0),p()()()}if(i&2){let e=q(2);Ce("formGroup",e.configForm),S(),ve(e.activeTab()==="basic"?1:-1),S(),ve(e.activeTab()==="contact"?2:-1),S(),ve(e.activeTab()==="social"?3:-1),S(2),Ce("disabled",e.isSaving()),S(2),Ce("disabled",!e.isFormValid()||e.isSaving()),S(),ve(e.isSaving()?8:9)}}function ZT(i,t){if(i&1&&xe(0,HT,1,0,"app-admin-payment-settings")(1,WT,1,0,"app-backup-config")(2,KT,10,7,"form",20),i&2){let e=q();ve(e.activeTab()==="payment"?0:e.activeTab()==="backup"?1:2)}}var ph=class i{basicInfoComponent;fb=lt(Lf);router=lt(el);systemConfigService=lt(Ns);authService=lt(pn);configForm;isSaving=Ae(!1);activeTab=Ae("basic");showSuccess=Ae(!1);formIsValid=Ae(!1);config=Ge(()=>this.systemConfigService.config());isLoading=Ge(()=>this.systemConfigService.isLoading());isFormValid=Ge(()=>this.formIsValid());ngOnInit(){let t=this.authService.user();if(!t||t.rol!=="admin"){this.router.navigate(["/dashboard"]);return}this.initForm(),this.loadConfig(),this.configForm.statusChanges.subscribe(()=>{let e=this.configForm.get("siteName"),n=!!(e?.valid&&e.value?.trim().length>=3);this.formIsValid.set(n)}),this.configForm.valueChanges.subscribe(()=>{let e=this.configForm.get("siteName"),n=!!(e?.valid&&e.value?.trim().length>=3);this.formIsValid.set(n)}),setTimeout(()=>{let e=this.configForm.get("siteName"),n=!!(e?.valid&&e.value?.trim().length>=3);this.formIsValid.set(n)},1e3)}initForm(){this.configForm=this.fb.group({siteName:["",[bi.required,bi.minLength(3)]],siteDescription:[""],email:[""],phone:[""],supportEmail:[""],facebook:[""],instagram:[""],youtube:[""],tiktok:[""],twitch:[""],twitter:[""],linkedin:[""],website:[""],backup_enabled:[!1]})}loadConfig(){this.systemConfigService.getConfig(),setTimeout(()=>{let t=this.config();t&&this.fillForm(t)},500)}fillForm(t){this.configForm.patchValue({siteName:t.siteName||"",siteDescription:t.siteDescription||"",email:t.email||"",phone:t.phone||"",supportEmail:t.supportEmail||"",facebook:t.socialMedia?.facebook||"",instagram:t.socialMedia?.instagram||"",youtube:t.socialMedia?.youtube||"",tiktok:t.socialMedia?.tiktok||"",twitch:t.socialMedia?.twitch||"",twitter:t.socialMedia?.twitter||"",linkedin:t.socialMedia?.linkedin||"",website:t.socialMedia?.website||"",backup_enabled:t.backup?.enabled||!1}),setTimeout(()=>{let e=this.configForm.get("siteName"),n=!!(e?.valid&&e.value?.trim().length>=3);this.formIsValid.set(n)},100)}setActiveTab(t){this.activeTab.set(t)}async onSubmit(){if(Object.keys(this.configForm.controls).forEach(t=>{this.configForm.get(t)?.invalid}),this.configForm.invalid){alert("\u274C Por favor completa todos los campos requeridos");return}this.isSaving()||await this.submitForm()}async submitForm(){this.isSaving.set(!0);try{let t=new FormData,e=this.configForm.value;t.append("siteName",e.siteName),t.append("siteDescription",e.siteDescription||""),t.append("email",e.email),t.append("phone",e.phone||""),t.append("supportEmail",e.supportEmail||""),t.append("facebook",e.facebook||""),t.append("instagram",e.instagram||""),t.append("youtube",e.youtube||""),t.append("tiktok",e.tiktok||""),t.append("twitch",e.twitch||""),t.append("twitter",e.twitter||""),t.append("linkedin",e.linkedin||""),t.append("linkedin",e.linkedin||""),t.append("website",e.website||""),t.append("backup_enabled",String(e.backup_enabled));let n=this.basicInfoComponent?.getLogoFile();n&&t.append("logo",n),await this.systemConfigService.updateConfig(t).toPromise(),this.showSuccess.set(!0),setTimeout(()=>this.showSuccess.set(!1),3e3),this.basicInfoComponent?.clearPreview(),this.systemConfigService.getConfig()}catch(t){alert(`\u274C Error al guardar: ${t.error?.message||"Error desconocido"}`)}finally{this.isSaving.set(!1)}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-system-settings"]],viewQuery:function(e,n){if(e&1&&yf(Au,5),e&2){let r;Sf(r=Cf())&&(n.basicInfoComponent=r.first)}},decls:53,vars:42,consts:[[1,"min-h-screen","bg-slate-900","p-6"],[1,"max-w-5xl","mx-auto"],[1,"mb-8"],[1,"text-3xl","font-bold","text-white","mb-2","flex","items-center","gap-3"],[1,"text-slate-400"],[1,"mb-6","p-4","bg-green-500/20","border","border-green-500/50","rounded-lg","flex","items-center","gap-3","animate-pulse"],[1,"mb-6","bg-slate-800","rounded-lg","p-1","border","border-white/10"],[1,"flex","gap-1"],[1,"flex-1","px-4","py-3","rounded-lg","font-medium","transition-all",3,"click"],[1,"bg-slate-800","rounded-lg","p-12","border","border-white/10"],[1,"mt-8","bg-blue-500/10","border","border-blue-500/30","rounded-lg","p-4"],[1,"flex","gap-3"],[1,"text-2xl"],[1,"flex-1"],[1,"text-blue-300","font-medium","mb-1"],[1,"text-sm","text-blue-200/80","space-y-1"],[1,"text-green-400","font-medium"],[1,"text-green-300/70","text-sm"],[1,"flex","flex-col","items-center","justify-center","gap-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-4","border-slate-700","border-t-lime-400"],[3,"formGroup"],[3,"ngSubmit","formGroup"],[3,"form","systemConfigService"],[3,"form"],[1,"mt-8","flex","justify-end","gap-4"],["type","button",1,"px-6","py-3","bg-slate-700","hover:bg-slate-600","text-white","font-medium","rounded-lg","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],["type","submit",1,"px-8","py-3","bg-lime-500","hover:bg-lime-600","text-slate-900","font-bold","rounded-lg","transition-all","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center","gap-2",3,"disabled"],[1,"animate-spin","rounded-full","h-5","w-5","border-2","border-slate-900","border-t-transparent"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3)(4,"span"),x(5,"\u2699\uFE0F"),p(),f(6,"span"),x(7,"Configuraci\xF3n del Sistema"),p()(),f(8,"p",4),x(9," Administra la informaci\xF3n b\xE1sica, contacto y redes sociales de tu plataforma "),p()(),xe(10,UT,8,0,"div",5),f(11,"div",6)(12,"div",7)(13,"button",8),ue("click",function(){return n.setActiveTab("basic")}),x(14," \u{1F3E2} Informaci\xF3n B\xE1sica "),p(),f(15,"button",8),ue("click",function(){return n.setActiveTab("contact")}),x(16," \u{1F4DE} Contacto "),p(),f(17,"button",8),ue("click",function(){return n.setActiveTab("social")}),x(18," \u{1F310} Redes Sociales "),p(),f(19,"button",8),ue("click",function(){return n.setActiveTab("payment")}),x(20," \u{1F4B3} M\xE9todos de Pago "),p(),f(21,"button",8),ue("click",function(){return n.setActiveTab("backup")}),x(22," \u{1F4BE} Backups "),p()()(),xe(23,zT,5,0,"div",9)(24,ZT,3,1),f(25,"div",10)(26,"div",11)(27,"span",12),x(28,"\u{1F4A1}"),p(),f(29,"div",13)(30,"p",14),x(31,"Consejos de configuraci\xF3n"),p(),f(32,"ul",15)(33,"li"),x(34,"\u2022 El "),f(35,"strong"),x(36,"nombre del sitio"),p(),x(37," aparecer\xE1 en el t\xEDtulo de todas las p\xE1ginas"),p(),f(38,"li"),x(39,"\u2022 El "),f(40,"strong"),x(41,"logo"),p(),x(42," se mostrar\xE1 en el header y emails"),p(),f(43,"li"),x(44,"\u2022 El "),f(45,"strong"),x(46,"email principal"),p(),x(47," recibir\xE1 notificaciones importantes del sistema"),p(),f(48,"li"),x(49,"\u2022 Las "),f(50,"strong"),x(51,"redes sociales"),p(),x(52," aparecer\xE1n en el footer de tu sitio"),p()()()()()()()),e&2&&(S(10),ve(n.showSuccess()?10:-1),S(3),oi("bg-lime-500",n.activeTab()==="basic")("text-slate-900",n.activeTab()==="basic")("text-slate-300",n.activeTab()!=="basic")("hover:bg-slate-700",n.activeTab()!=="basic"),S(2),oi("bg-lime-500",n.activeTab()==="contact")("text-slate-900",n.activeTab()==="contact")("text-slate-300",n.activeTab()!=="contact")("hover:bg-slate-700",n.activeTab()!=="contact"),S(2),oi("bg-lime-500",n.activeTab()==="social")("text-slate-900",n.activeTab()==="social")("text-slate-300",n.activeTab()!=="social")("hover:bg-slate-700",n.activeTab()!=="social"),S(2),oi("bg-lime-500",n.activeTab()==="payment")("text-slate-900",n.activeTab()==="payment")("text-slate-300",n.activeTab()!=="payment")("hover:bg-slate-700",n.activeTab()!=="payment"),S(2),oi("bg-lime-500",n.activeTab()==="backup")("text-slate-900",n.activeTab()==="backup")("text-slate-300",n.activeTab()!=="backup")("hover:bg-slate-700",n.activeTab()!=="backup"),S(2),ve(n.isLoading()?23:24))},dependencies:[pr,Wa,dr,fr,Au,dh,fh,n_,hh],encapsulation:2})};function Nu(i){return i+.5|0}var al=(i,t,e)=>Math.max(Math.min(i,e),t);function Fu(i){return al(Nu(i*2.55),0,255)}function sl(i){return al(Nu(i*255),0,255)}function mo(i){return al(Nu(i/2.55)/100,0,1)}function R_(i){return al(Nu(i*100),0,100)}var qa={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},gm=[..."0123456789ABCDEF"],JT=i=>gm[i&15],QT=i=>gm[(i&240)>>4]+gm[i&15],mh=i=>(i&240)>>4===(i&15),eA=i=>mh(i.r)&&mh(i.g)&&mh(i.b)&&mh(i.a);function tA(i){var t=i.length,e;return i[0]==="#"&&(t===4||t===5?e={r:255&qa[i[1]]*17,g:255&qa[i[2]]*17,b:255&qa[i[3]]*17,a:t===5?qa[i[4]]*17:255}:(t===7||t===9)&&(e={r:qa[i[1]]<<4|qa[i[2]],g:qa[i[3]]<<4|qa[i[4]],b:qa[i[5]]<<4|qa[i[6]],a:t===9?qa[i[7]]<<4|qa[i[8]]:255})),e}var iA=(i,t)=>i<255?t(i):"";function nA(i){var t=eA(i)?JT:QT;return i?"#"+t(i.r)+t(i.g)+t(i.b)+iA(i.a,t):void 0}var rA=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function V_(i,t,e){let n=t*Math.min(e,1-e),r=(a,s=(a+i/30)%12)=>e-n*Math.max(Math.min(s-3,9-s,1),-1);return[r(0),r(8),r(4)]}function aA(i,t,e){let n=(r,a=(r+i/60)%6)=>e-e*t*Math.max(Math.min(a,4-a,1),0);return[n(5),n(3),n(1)]}function sA(i,t,e){let n=V_(i,1,.5),r;for(t+e>1&&(r=1/(t+e),t*=r,e*=r),r=0;r<3;r++)n[r]*=1-t-e,n[r]+=t;return n}function oA(i,t,e,n,r){return i===r?(t-e)/n+(t<e?6:0):t===r?(e-i)/n+2:(i-t)/n+4}function xm(i){let e=i.r/255,n=i.g/255,r=i.b/255,a=Math.max(e,n,r),s=Math.min(e,n,r),o=(a+s)/2,l,c,u;return a!==s&&(u=a-s,c=o>.5?u/(2-a-s):u/(a+s),l=oA(e,n,r,u,a),l=l*60+.5),[l|0,c||0,o]}function vm(i,t,e,n){return(Array.isArray(t)?i(t[0],t[1],t[2]):i(t,e,n)).map(sl)}function _m(i,t,e){return vm(V_,i,t,e)}function lA(i,t,e){return vm(sA,i,t,e)}function cA(i,t,e){return vm(aA,i,t,e)}function U_(i){return(i%360+360)%360}function uA(i){let t=rA.exec(i),e=255,n;if(!t)return;t[5]!==n&&(e=t[6]?Fu(+t[5]):sl(+t[5]));let r=U_(+t[2]),a=+t[3]/100,s=+t[4]/100;return t[1]==="hwb"?n=lA(r,a,s):t[1]==="hsv"?n=cA(r,a,s):n=_m(r,a,s),{r:n[0],g:n[1],b:n[2],a:e}}function dA(i,t){var e=xm(i);e[0]=U_(e[0]+t),e=_m(e),i.r=e[0],i.g=e[1],i.b=e[2]}function fA(i){if(!i)return;let t=xm(i),e=t[0],n=R_(t[1]),r=R_(t[2]);return i.a<255?`hsla(${e}, ${n}%, ${r}%, ${mo(i.a)})`:`hsl(${e}, ${n}%, ${r}%)`}var O_={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},B_={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function hA(){let i={},t=Object.keys(B_),e=Object.keys(O_),n,r,a,s,o;for(n=0;n<t.length;n++){for(s=o=t[n],r=0;r<e.length;r++)a=e[r],o=o.replace(a,O_[a]);a=parseInt(B_[s],16),i[o]=[a>>16&255,a>>8&255,a&255]}return i}var gh;function pA(i){gh||(gh=hA(),gh.transparent=[0,0,0,0]);let t=gh[i.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}var mA=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function gA(i){let t=mA.exec(i),e=255,n,r,a;if(t){if(t[7]!==n){let s=+t[7];e=t[8]?Fu(s):al(s*255,0,255)}return n=+t[1],r=+t[3],a=+t[5],n=255&(t[2]?Fu(n):al(n,0,255)),r=255&(t[4]?Fu(r):al(r,0,255)),a=255&(t[6]?Fu(a):al(a,0,255)),{r:n,g:r,b:a,a:e}}}function xA(i){return i&&(i.a<255?`rgba(${i.r}, ${i.g}, ${i.b}, ${mo(i.a)})`:`rgb(${i.r}, ${i.g}, ${i.b})`)}var mm=i=>i<=.0031308?i*12.92:Math.pow(i,1/2.4)*1.055-.055,X0=i=>i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4);function vA(i,t,e){let n=X0(mo(i.r)),r=X0(mo(i.g)),a=X0(mo(i.b));return{r:sl(mm(n+e*(X0(mo(t.r))-n))),g:sl(mm(r+e*(X0(mo(t.g))-r))),b:sl(mm(a+e*(X0(mo(t.b))-a))),a:i.a+e*(t.a-i.a)}}function xh(i,t,e){if(i){let n=xm(i);n[t]=Math.max(0,Math.min(n[t]+n[t]*e,t===0?360:1)),n=_m(n),i.r=n[0],i.g=n[1],i.b=n[2]}}function z_(i,t){return i&&Object.assign(t||{},i)}function j_(i){var t={r:0,g:0,b:0,a:255};return Array.isArray(i)?i.length>=3&&(t={r:i[0],g:i[1],b:i[2],a:255},i.length>3&&(t.a=sl(i[3]))):(t=z_(i,{r:0,g:0,b:0,a:1}),t.a=sl(t.a)),t}function _A(i){return i.charAt(0)==="r"?gA(i):uA(i)}var Du=class i{constructor(t){if(t instanceof i)return t;let e=typeof t,n;e==="object"?n=j_(t):e==="string"&&(n=tA(t)||pA(t)||_A(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=z_(this._rgb);return t&&(t.a=mo(t.a)),t}set rgb(t){this._rgb=j_(t)}rgbString(){return this._valid?xA(this._rgb):void 0}hexString(){return this._valid?nA(this._rgb):void 0}hslString(){return this._valid?fA(this._rgb):void 0}mix(t,e){if(t){let n=this.rgb,r=t.rgb,a,s=e===a?.5:e,o=2*s-1,l=n.a-r.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;a=1-c,n.r=255&c*n.r+a*r.r+.5,n.g=255&c*n.g+a*r.g+.5,n.b=255&c*n.b+a*r.b+.5,n.a=s*n.a+(1-s)*r.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=vA(this._rgb,t._rgb,e)),this}clone(){return new i(this.rgb)}alpha(t){return this._rgb.a=sl(t),this}clearer(t){let e=this._rgb;return e.a*=1-t,this}greyscale(){let t=this._rgb,e=Nu(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){let e=this._rgb;return e.a*=1+t,this}negate(){let t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return xh(this._rgb,2,t),this}darken(t){return xh(this._rgb,2,-t),this}saturate(t){return xh(this._rgb,1,t),this}desaturate(t){return xh(this._rgb,1,-t),this}rotate(t){return dA(this._rgb,t),this}};function Rs(){}var Q_=(()=>{let i=0;return()=>i++})();function di(i){return i==null}function an(i){if(Array.isArray&&Array.isArray(i))return!0;let t=Object.prototype.toString.call(i);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function fi(i){return i!==null&&Object.prototype.toString.call(i)==="[object Object]"}function vn(i){return(typeof i=="number"||i instanceof Number)&&isFinite(+i)}function da(i,t){return vn(i)?i:t}function ei(i,t){return typeof i>"u"?t:i}var eb=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100:+i/t,Sm=(i,t)=>typeof i=="string"&&i.endsWith("%")?parseFloat(i)/100*t:+i;function Zi(i,t,e){if(i&&typeof i.call=="function")return i.apply(e,t)}function Ii(i,t,e,n){let r,a,s;if(an(i))if(a=i.length,n)for(r=a-1;r>=0;r--)t.call(e,i[r],r);else for(r=0;r<a;r++)t.call(e,i[r],r);else if(fi(i))for(s=Object.keys(i),a=s.length,r=0;r<a;r++)t.call(e,i[s[r]],s[r])}function Lu(i,t){let e,n,r,a;if(!i||!t||i.length!==t.length)return!1;for(e=0,n=i.length;e<n;++e)if(r=i[e],a=t[e],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function wh(i){if(an(i))return i.map(wh);if(fi(i)){let t=Object.create(null),e=Object.keys(i),n=e.length,r=0;for(;r<n;++r)t[e[r]]=wh(i[e[r]]);return t}return i}function tb(i){return["__proto__","prototype","constructor"].indexOf(i)===-1}function bA(i,t,e,n){if(!tb(i))return;let r=t[i],a=e[i];fi(r)&&fi(a)?K0(r,a,n):t[i]=wh(a)}function K0(i,t,e){let n=an(t)?t:[t],r=n.length;if(!fi(i))return i;e=e||{};let a=e.merger||bA,s;for(let o=0;o<r;++o){if(s=n[o],!fi(s))continue;let l=Object.keys(s);for(let c=0,u=l.length;c<u;++c)a(l[c],i,s,e)}return i}function J0(i,t){return K0(i,t,{merger:wA})}function wA(i,t,e){if(!tb(i))return;let n=t[i],r=e[i];fi(n)&&fi(r)?J0(n,r):Object.prototype.hasOwnProperty.call(t,i)||(t[i]=wh(r))}var H_={"":i=>i,x:i=>i.x,y:i=>i.y};function yA(i){let t=i.split("."),e=[],n="";for(let r of t)n+=r,n.endsWith("\\")?n=n.slice(0,-1)+".":(e.push(n),n="");return e}function SA(i){let t=yA(i);return e=>{for(let n of t){if(n==="")break;e=e&&e[n]}return e}}function vo(i,t){return(H_[t]||(H_[t]=SA(t)))(i)}function Eh(i){return i.charAt(0).toUpperCase()+i.slice(1)}var Q0=i=>typeof i<"u",go=i=>typeof i=="function",Cm=(i,t)=>{if(i.size!==t.size)return!1;for(let e of i)if(!t.has(e))return!1;return!0};function ib(i){return i.type==="mouseup"||i.type==="click"||i.type==="contextmenu"}var Si=Math.PI,sn=2*Si,CA=sn+Si,yh=Number.POSITIVE_INFINITY,EA=Si/180,Sn=Si/2,e0=Si/4,W_=Si*2/3,xo=Math.log10,fs=Math.sign;function ec(i,t,e){return Math.abs(i-t)<e}function Em(i){let t=Math.round(i);i=ec(i,t,i/1e3)?t:i;let e=Math.pow(10,Math.floor(xo(i))),n=i/e;return(n<=1?1:n<=2?2:n<=5?5:10)*e}function nb(i){let t=[],e=Math.sqrt(i),n;for(n=1;n<e;n++)i%n===0&&(t.push(n),t.push(i/n));return e===(e|0)&&t.push(e),t.sort((r,a)=>r-a).pop(),t}function kA(i){return typeof i=="symbol"||typeof i=="object"&&i!==null&&!(Symbol.toPrimitive in i||"toString"in i||"valueOf"in i)}function n0(i){return!kA(i)&&!isNaN(parseFloat(i))&&isFinite(i)}function rb(i,t){let e=Math.round(i);return e-t<=i&&e+t>=i}function km(i,t,e){let n,r,a;for(n=0,r=i.length;n<r;n++)a=i[n][e],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function Ga(i){return i*(Si/180)}function kh(i){return i*(180/Si)}function Tm(i){if(!vn(i))return;let t=1,e=0;for(;Math.round(i*t)/t!==i;)t*=10,e++;return e}function Am(i,t){let e=t.x-i.x,n=t.y-i.y,r=Math.sqrt(e*e+n*n),a=Math.atan2(n,e);return a<-.5*Si&&(a+=sn),{angle:a,distance:r}}function Sh(i,t){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))}function TA(i,t){return(i-t+CA)%sn-Si}function kr(i){return(i%sn+sn)%sn}function tc(i,t,e,n){let r=kr(i),a=kr(t),s=kr(e),o=kr(a-r),l=kr(s-r),c=kr(r-a),u=kr(r-s);return r===a||r===s||n&&a===s||o>l&&c<u}function rr(i,t,e){return Math.max(t,Math.min(e,i))}function ab(i){return rr(i,-32768,32767)}function Os(i,t,e,n=1e-6){return i>=Math.min(t,e)-n&&i<=Math.max(t,e)+n}function Th(i,t,e){e=e||(s=>i[s]<t);let n=i.length-1,r=0,a;for(;n-r>1;)a=r+n>>1,e(a)?r=a:n=a;return{lo:r,hi:n}}var Ls=(i,t,e,n)=>Th(i,e,n?r=>{let a=i[r][t];return a<e||a===e&&i[r+1][t]===e}:r=>i[r][t]<e),sb=(i,t,e)=>Th(i,e,n=>i[n][t]>=e);function ob(i,t,e){let n=0,r=i.length;for(;n<r&&i[n]<t;)n++;for(;r>n&&i[r-1]>e;)r--;return n>0||r<i.length?i.slice(n,r):i}var lb=["push","pop","shift","splice","unshift"];function cb(i,t){if(i._chartjs){i._chartjs.listeners.push(t);return}Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),lb.forEach(e=>{let n="_onData"+Eh(e),r=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value(...a){let s=r.apply(this,a);return i._chartjs.listeners.forEach(o=>{typeof o[n]=="function"&&o[n](...a)}),s}})})}function Fm(i,t){let e=i._chartjs;if(!e)return;let n=e.listeners,r=n.indexOf(t);r!==-1&&n.splice(r,1),!(n.length>0)&&(lb.forEach(a=>{delete i[a]}),delete i._chartjs)}function Dm(i){let t=new Set(i);return t.size===i.length?i:Array.from(t)}var Nm=(function(){return typeof window>"u"?function(i){return i()}:window.requestAnimationFrame})();function Pm(i,t){let e=[],n=!1;return function(...r){e=r,n||(n=!0,Nm.call(window,()=>{n=!1,i.apply(t,e)}))}}function ub(i,t){let e;return function(...n){return t?(clearTimeout(e),e=setTimeout(i,t,n)):i.apply(this,n),t}}var Ah=i=>i==="start"?"left":i==="end"?"right":"center",Tr=(i,t,e)=>i==="start"?t:i==="end"?e:(t+e)/2,db=(i,t,e,n)=>i===(n?"left":"right")?e:i==="center"?(t+e)/2:t;function Mm(i,t,e){let n=t.length,r=0,a=n;if(i._sorted){let{iScale:s,vScale:o,_parsed:l}=i,c=i.dataset&&i.dataset.options?i.dataset.options.spanGaps:null,u=s.axis,{min:h,max:g,minDefined:d,maxDefined:b}=s.getUserBounds();if(d){if(r=Math.min(Ls(l,u,h).lo,e?n:Ls(t,u,s.getPixelForValue(h)).lo),c){let _=l.slice(0,r+1).reverse().findIndex(w=>!di(w[o.axis]));r-=Math.max(0,_)}r=rr(r,0,n-1)}if(b){let _=Math.max(Ls(l,s.axis,g,!0).hi+1,e?0:Ls(t,u,s.getPixelForValue(g),!0).hi+1);if(c){let w=l.slice(_-1).findIndex(E=>!di(E[o.axis]));_+=Math.max(0,w)}a=rr(_,r,n)-r}else a=n-r}return{start:r,count:a}}function Lm(i){let{xScale:t,yScale:e,_scaleRanges:n}=i,r={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!n)return i._scaleRanges=r,!0;let a=n.xmin!==t.min||n.xmax!==t.max||n.ymin!==e.min||n.ymax!==e.max;return Object.assign(n,r),a}var vh=i=>i===0||i===1,q_=(i,t,e)=>-(Math.pow(2,10*(i-=1))*Math.sin((i-t)*sn/e)),G_=(i,t,e)=>Math.pow(2,-10*i)*Math.sin((i-t)*sn/e)+1,Y0={linear:i=>i,easeInQuad:i=>i*i,easeOutQuad:i=>-i*(i-2),easeInOutQuad:i=>(i/=.5)<1?.5*i*i:-.5*(--i*(i-2)-1),easeInCubic:i=>i*i*i,easeOutCubic:i=>(i-=1)*i*i+1,easeInOutCubic:i=>(i/=.5)<1?.5*i*i*i:.5*((i-=2)*i*i+2),easeInQuart:i=>i*i*i*i,easeOutQuart:i=>-((i-=1)*i*i*i-1),easeInOutQuart:i=>(i/=.5)<1?.5*i*i*i*i:-.5*((i-=2)*i*i*i-2),easeInQuint:i=>i*i*i*i*i,easeOutQuint:i=>(i-=1)*i*i*i*i+1,easeInOutQuint:i=>(i/=.5)<1?.5*i*i*i*i*i:.5*((i-=2)*i*i*i*i+2),easeInSine:i=>-Math.cos(i*Sn)+1,easeOutSine:i=>Math.sin(i*Sn),easeInOutSine:i=>-.5*(Math.cos(Si*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>vh(i)?i:i<.5?.5*Math.pow(2,10*(i*2-1)):.5*(-Math.pow(2,-10*(i*2-1))+2),easeInCirc:i=>i>=1?i:-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-(i-=1)*i),easeInOutCirc:i=>(i/=.5)<1?-.5*(Math.sqrt(1-i*i)-1):.5*(Math.sqrt(1-(i-=2)*i)+1),easeInElastic:i=>vh(i)?i:q_(i,.075,.3),easeOutElastic:i=>vh(i)?i:G_(i,.075,.3),easeInOutElastic(i){return vh(i)?i:i<.5?.5*q_(i*2,.1125,.45):.5+.5*G_(i*2-1,.1125,.45)},easeInBack(i){return i*i*((1.70158+1)*i-1.70158)},easeOutBack(i){return(i-=1)*i*((1.70158+1)*i+1.70158)+1},easeInOutBack(i){let t=1.70158;return(i/=.5)<1?.5*(i*i*(((t*=1.525)+1)*i-t)):.5*((i-=2)*i*(((t*=1.525)+1)*i+t)+2)},easeInBounce:i=>1-Y0.easeOutBounce(1-i),easeOutBounce(i){return i<1/2.75?7.5625*i*i:i<2/2.75?7.5625*(i-=1.5/2.75)*i+.75:i<2.5/2.75?7.5625*(i-=2.25/2.75)*i+.9375:7.5625*(i-=2.625/2.75)*i+.984375},easeInOutBounce:i=>i<.5?Y0.easeInBounce(i*2)*.5:Y0.easeOutBounce(i*2-1)*.5+.5};function Im(i){if(i&&typeof i=="object"){let t=i.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Rm(i){return Im(i)?i:new Du(i)}function bm(i){return Im(i)?i:new Du(i).saturate(.5).darken(.1).hexString()}var AA=["x","y","borderWidth","radius","tension"],FA=["color","borderColor","backgroundColor"];function DA(i){i.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),i.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),i.set("animations",{colors:{type:"color",properties:FA},numbers:{type:"number",properties:AA}}),i.describe("animations",{_fallback:"animation"}),i.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function NA(i){i.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var $_=new Map;function PA(i,t){t=t||{};let e=i+JSON.stringify(t),n=$_.get(e);return n||(n=new Intl.NumberFormat(i,t),$_.set(e,n)),n}function ic(i,t,e){return PA(t,e).format(i)}var fb={values(i){return an(i)?i:""+i},numeric(i,t,e){if(i===0)return"0";let n=this.chart.options.locale,r,a=i;if(e.length>1){let c=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),a=MA(i,e)}let s=xo(Math.abs(a)),o=isNaN(s)?1:Math.max(Math.min(-1*Math.floor(s),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),ic(i,n,l)},logarithmic(i,t,e){if(i===0)return"0";let n=e[t].significand||i/Math.pow(10,Math.floor(xo(i)));return[1,2,3,5,10,15].includes(n)||t>.8*e.length?fb.numeric.call(this,i,t,e):""}};function MA(i,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&i!==Math.floor(i)&&(e=i-Math.floor(i)),e}var Iu={formatters:fb};function LA(i){i.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Iu.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),i.route("scale.ticks","color","","color"),i.route("scale.grid","color","","borderColor"),i.route("scale.border","color","","borderColor"),i.route("scale.title","color","","color"),i.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),i.describe("scales",{_fallback:"scale"}),i.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}var cl=Object.create(null),Fh=Object.create(null);function Pu(i,t){if(!t)return i;let e=t.split(".");for(let n=0,r=e.length;n<r;++n){let a=e[n];i=i[a]||(i[a]=Object.create(null))}return i}function wm(i,t,e){return typeof t=="string"?K0(Pu(i,t),e):K0(Pu(i,""),t)}var ym=class{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,r)=>bm(r.backgroundColor),this.hoverBorderColor=(n,r)=>bm(r.borderColor),this.hoverColor=(n,r)=>bm(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return wm(this,t,e)}get(t){return Pu(this,t)}describe(t,e){return wm(Fh,t,e)}override(t,e){return wm(cl,t,e)}route(t,e,n,r){let a=Pu(this,t),s=Pu(this,n),o="_"+e;Object.defineProperties(a,{[o]:{value:a[e],writable:!0},[e]:{enumerable:!0,get(){let l=this[o],c=s[r];return fi(l)?Object.assign({},c,l):ei(l,c)},set(l){this[o]=l}}})}apply(t){t.forEach(e=>e(this))}},un=new ym({_scriptable:i=>!i.startsWith("on"),_indexable:i=>i!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[DA,NA,LA]);function IA(i){return!i||di(i.size)||di(i.family)?null:(i.style?i.style+" ":"")+(i.weight?i.weight+" ":"")+i.size+"px "+i.family}function Mu(i,t,e,n,r){let a=t[r];return a||(a=t[r]=i.measureText(r).width,e.push(r)),a>n&&(n=a),n}function hb(i,t,e,n){n=n||{};let r=n.data=n.data||{},a=n.garbageCollect=n.garbageCollect||[];n.font!==t&&(r=n.data={},a=n.garbageCollect=[],n.font=t),i.save(),i.font=t;let s=0,o=e.length,l,c,u,h,g;for(l=0;l<o;l++)if(h=e[l],h!=null&&!an(h))s=Mu(i,r,a,s,h);else if(an(h))for(c=0,u=h.length;c<u;c++)g=h[c],g!=null&&!an(g)&&(s=Mu(i,r,a,s,g));i.restore();let d=a.length/2;if(d>e.length){for(l=0;l<d;l++)delete r[a[l]];a.splice(0,d)}return s}function ul(i,t,e){let n=i.currentDevicePixelRatio,r=e!==0?Math.max(e/2,.5):0;return Math.round((t-r)*n)/n+r}function Om(i,t){!t&&!i||(t=t||i.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,i.width,i.height),t.restore())}function Dh(i,t,e,n){Bm(i,t,e,n,null)}function Bm(i,t,e,n,r){let a,s,o,l,c,u,h,g,d=t.pointStyle,b=t.rotation,_=t.radius,w=(b||0)*EA;if(d&&typeof d=="object"&&(a=d.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){i.save(),i.translate(e,n),i.rotate(w),i.drawImage(d,-d.width/2,-d.height/2,d.width,d.height),i.restore();return}if(!(isNaN(_)||_<=0)){switch(i.beginPath(),d){default:r?i.ellipse(e,n,r/2,_,0,0,sn):i.arc(e,n,_,0,sn),i.closePath();break;case"triangle":u=r?r/2:_,i.moveTo(e+Math.sin(w)*u,n-Math.cos(w)*_),w+=W_,i.lineTo(e+Math.sin(w)*u,n-Math.cos(w)*_),w+=W_,i.lineTo(e+Math.sin(w)*u,n-Math.cos(w)*_),i.closePath();break;case"rectRounded":c=_*.516,l=_-c,s=Math.cos(w+e0)*l,h=Math.cos(w+e0)*(r?r/2-c:l),o=Math.sin(w+e0)*l,g=Math.sin(w+e0)*(r?r/2-c:l),i.arc(e-h,n-o,c,w-Si,w-Sn),i.arc(e+g,n-s,c,w-Sn,w),i.arc(e+h,n+o,c,w,w+Sn),i.arc(e-g,n+s,c,w+Sn,w+Si),i.closePath();break;case"rect":if(!b){l=Math.SQRT1_2*_,u=r?r/2:l,i.rect(e-u,n-l,2*u,2*l);break}w+=e0;case"rectRot":h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,g=Math.sin(w)*(r?r/2:_),i.moveTo(e-h,n-o),i.lineTo(e+g,n-s),i.lineTo(e+h,n+o),i.lineTo(e-g,n+s),i.closePath();break;case"crossRot":w+=e0;case"cross":h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,g=Math.sin(w)*(r?r/2:_),i.moveTo(e-h,n-o),i.lineTo(e+h,n+o),i.moveTo(e+g,n-s),i.lineTo(e-g,n+s);break;case"star":h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,g=Math.sin(w)*(r?r/2:_),i.moveTo(e-h,n-o),i.lineTo(e+h,n+o),i.moveTo(e+g,n-s),i.lineTo(e-g,n+s),w+=e0,h=Math.cos(w)*(r?r/2:_),s=Math.cos(w)*_,o=Math.sin(w)*_,g=Math.sin(w)*(r?r/2:_),i.moveTo(e-h,n-o),i.lineTo(e+h,n+o),i.moveTo(e+g,n-s),i.lineTo(e-g,n+s);break;case"line":s=r?r/2:Math.cos(w)*_,o=Math.sin(w)*_,i.moveTo(e-s,n-o),i.lineTo(e+s,n+o);break;case"dash":i.moveTo(e,n),i.lineTo(e+Math.cos(w)*(r?r/2:_),n+Math.sin(w)*_);break;case!1:i.closePath();break}i.fill(),t.borderWidth>0&&i.stroke()}}function Is(i,t,e){return e=e||.5,!t||i&&i.x>t.left-e&&i.x<t.right+e&&i.y>t.top-e&&i.y<t.bottom+e}function Ru(i,t){i.save(),i.beginPath(),i.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),i.clip()}function Ou(i){i.restore()}function pb(i,t,e,n,r){if(!t)return i.lineTo(e.x,e.y);if(r==="middle"){let a=(t.x+e.x)/2;i.lineTo(a,t.y),i.lineTo(a,e.y)}else r==="after"!=!!n?i.lineTo(t.x,e.y):i.lineTo(e.x,t.y);i.lineTo(e.x,e.y)}function mb(i,t,e,n){if(!t)return i.lineTo(e.x,e.y);i.bezierCurveTo(n?t.cp1x:t.cp2x,n?t.cp1y:t.cp2y,n?e.cp2x:e.cp1x,n?e.cp2y:e.cp1y,e.x,e.y)}function RA(i,t){t.translation&&i.translate(t.translation[0],t.translation[1]),di(t.rotation)||i.rotate(t.rotation),t.color&&(i.fillStyle=t.color),t.textAlign&&(i.textAlign=t.textAlign),t.textBaseline&&(i.textBaseline=t.textBaseline)}function OA(i,t,e,n,r){if(r.strikethrough||r.underline){let a=i.measureText(n),s=t-a.actualBoundingBoxLeft,o=t+a.actualBoundingBoxRight,l=e-a.actualBoundingBoxAscent,c=e+a.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;i.strokeStyle=i.fillStyle,i.beginPath(),i.lineWidth=r.decorationWidth||2,i.moveTo(s,u),i.lineTo(o,u),i.stroke()}}function BA(i,t){let e=i.fillStyle;i.fillStyle=t.color,i.fillRect(t.left,t.top,t.width,t.height),i.fillStyle=e}function dl(i,t,e,n,r,a={}){let s=an(t)?t:[t],o=a.strokeWidth>0&&a.strokeColor!=="",l,c;for(i.save(),i.font=r.string,RA(i,a),l=0;l<s.length;++l)c=s[l],a.backdrop&&BA(i,a.backdrop),o&&(a.strokeColor&&(i.strokeStyle=a.strokeColor),di(a.strokeWidth)||(i.lineWidth=a.strokeWidth),i.strokeText(c,e,n,a.maxWidth)),i.fillText(c,e,n,a.maxWidth),OA(i,e,n,c,a),n+=Number(r.lineHeight);i.restore()}function nc(i,t){let{x:e,y:n,w:r,h:a,radius:s}=t;i.arc(e+s.topLeft,n+s.topLeft,s.topLeft,1.5*Si,Si,!0),i.lineTo(e,n+a-s.bottomLeft),i.arc(e+s.bottomLeft,n+a-s.bottomLeft,s.bottomLeft,Si,Sn,!0),i.lineTo(e+r-s.bottomRight,n+a),i.arc(e+r-s.bottomRight,n+a-s.bottomRight,s.bottomRight,Sn,0,!0),i.lineTo(e+r,n+s.topRight),i.arc(e+r-s.topRight,n+s.topRight,s.topRight,0,-Sn,!0),i.lineTo(e+s.topLeft,n)}var jA=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,VA=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function UA(i,t){let e=(""+i).match(jA);if(!e||e[1]==="normal")return t*1.2;switch(i=+e[2],e[3]){case"px":return i;case"%":i/=100;break}return t*i}var zA=i=>+i||0;function Nh(i,t){let e={},n=fi(t),r=n?Object.keys(t):t,a=fi(i)?n?s=>ei(i[s],i[t[s]]):s=>i[s]:()=>i;for(let s of r)e[s]=zA(a(s));return e}function jm(i){return Nh(i,{top:"y",right:"x",bottom:"y",left:"x"})}function fl(i){return Nh(i,["topLeft","topRight","bottomLeft","bottomRight"])}function Ar(i){let t=jm(i);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function qn(i,t){i=i||{},t=t||un.font;let e=ei(i.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let n=ei(i.style,t.style);n&&!(""+n).match(VA)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);let r={family:ei(i.family,t.family),lineHeight:UA(ei(i.lineHeight,t.lineHeight),e),size:e,style:n,weight:ei(i.weight,t.weight),string:""};return r.string=IA(r),r}function rc(i,t,e,n){let r=!0,a,s,o;for(a=0,s=i.length;a<s;++a)if(o=i[a],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t),r=!1),e!==void 0&&an(o)&&(o=o[e%o.length],r=!1),o!==void 0))return n&&!r&&(n.cacheable=!1),o}function gb(i,t,e){let{min:n,max:r}=i,a=Sm(t,(r-n)/2),s=(o,l)=>e&&o===0?0:o+l;return{min:s(n,-Math.abs(a)),max:s(r,a)}}function _o(i,t){return Object.assign(Object.create(i),t)}function Ph(i,t=[""],e,n,r=()=>i[0]){let a=e||i;typeof n>"u"&&(n=_b("_fallback",i));let s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:i,_rootScopes:a,_fallback:n,_getTarget:r,override:o=>Ph([o,...i],t,a,n)};return new Proxy(s,{deleteProperty(o,l){return delete o[l],delete o._keys,delete i[0][l],!0},get(o,l){return xb(o,l,()=>KA(l,t,i,o))},getOwnPropertyDescriptor(o,l){return Reflect.getOwnPropertyDescriptor(o._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(i[0])},has(o,l){return Y_(o).includes(l)},ownKeys(o){return Y_(o)},set(o,l,c){let u=o._storage||(o._storage=r());return o[l]=u[l]=c,delete o._keys,!0}})}function i0(i,t,e,n){let r={_cacheable:!1,_proxy:i,_context:t,_subProxy:e,_stack:new Set,_descriptors:Vm(i,n),setContext:a=>i0(i,a,e,n),override:a=>i0(i.override(a),t,e,n)};return new Proxy(r,{deleteProperty(a,s){return delete a[s],delete i[s],!0},get(a,s,o){return xb(a,s,()=>WA(a,s,o))},getOwnPropertyDescriptor(a,s){return a._descriptors.allKeys?Reflect.has(i,s)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(i,s)},getPrototypeOf(){return Reflect.getPrototypeOf(i)},has(a,s){return Reflect.has(i,s)},ownKeys(){return Reflect.ownKeys(i)},set(a,s,o){return i[s]=o,delete a[s],!0}})}function Vm(i,t={scriptable:!0,indexable:!0}){let{_scriptable:e=t.scriptable,_indexable:n=t.indexable,_allKeys:r=t.allKeys}=i;return{allKeys:r,scriptable:e,indexable:n,isScriptable:go(e)?e:()=>e,isIndexable:go(n)?n:()=>n}}var HA=(i,t)=>i?i+Eh(t):t,Um=(i,t)=>fi(t)&&i!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function xb(i,t,e){if(Object.prototype.hasOwnProperty.call(i,t)||t==="constructor")return i[t];let n=e();return i[t]=n,n}function WA(i,t,e){let{_proxy:n,_context:r,_subProxy:a,_descriptors:s}=i,o=n[t];return go(o)&&s.isScriptable(t)&&(o=qA(t,o,i,e)),an(o)&&o.length&&(o=GA(t,o,i,s.isIndexable)),Um(t,o)&&(o=i0(o,r,a&&a[t],s)),o}function qA(i,t,e,n){let{_proxy:r,_context:a,_subProxy:s,_stack:o}=e;if(o.has(i))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+i);o.add(i);let l=t(a,s||n);return o.delete(i),Um(i,l)&&(l=zm(r._scopes,r,i,l)),l}function GA(i,t,e,n){let{_proxy:r,_context:a,_subProxy:s,_descriptors:o}=e;if(typeof a.index<"u"&&n(i))return t[a.index%t.length];if(fi(t[0])){let l=t,c=r._scopes.filter(u=>u!==l);t=[];for(let u of l){let h=zm(c,r,i,u);t.push(i0(h,a,s&&s[i],o))}}return t}function vb(i,t,e){return go(i)?i(t,e):i}var $A=(i,t)=>i===!0?t:typeof i=="string"?vo(t,i):void 0;function XA(i,t,e,n,r){for(let a of t){let s=$A(e,a);if(s){i.add(s);let o=vb(s._fallback,e,r);if(typeof o<"u"&&o!==e&&o!==n)return o}else if(s===!1&&typeof n<"u"&&e!==n)return null}return!1}function zm(i,t,e,n){let r=t._rootScopes,a=vb(t._fallback,e,n),s=[...i,...r],o=new Set;o.add(n);let l=X_(o,s,e,a||e,n);return l===null||typeof a<"u"&&a!==e&&(l=X_(o,s,a,l,n),l===null)?!1:Ph(Array.from(o),[""],r,a,()=>YA(t,e,n))}function X_(i,t,e,n,r){for(;e;)e=XA(i,t,e,n,r);return e}function YA(i,t,e){let n=i._getTarget();t in n||(n[t]={});let r=n[t];return an(r)&&fi(e)?e:r||{}}function KA(i,t,e,n){let r;for(let a of t)if(r=_b(HA(a,i),e),typeof r<"u")return Um(i,r)?zm(e,n,i,r):r}function _b(i,t){for(let e of t){if(!e)continue;let n=e[i];if(typeof n<"u")return n}}function Y_(i){let t=i._keys;return t||(t=i._keys=ZA(i._scopes)),t}function ZA(i){let t=new Set;for(let e of i)for(let n of Object.keys(e).filter(r=>!r.startsWith("_")))t.add(n);return Array.from(t)}function Hm(i,t,e,n){let{iScale:r}=i,{key:a="r"}=this._parsing,s=new Array(n),o,l,c,u;for(o=0,l=n;o<l;++o)c=o+e,u=t[c],s[o]={r:r.parse(vo(u,a),c)};return s}var JA=Number.EPSILON||1e-14,Z0=(i,t)=>t<i.length&&!i[t].skip&&i[t],bb=i=>i==="x"?"y":"x";function QA(i,t,e,n){let r=i.skip?t:i,a=t,s=e.skip?t:e,o=Sh(a,r),l=Sh(s,a),c=o/(o+l),u=l/(o+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;let h=n*c,g=n*u;return{previous:{x:a.x-h*(s.x-r.x),y:a.y-h*(s.y-r.y)},next:{x:a.x+g*(s.x-r.x),y:a.y+g*(s.y-r.y)}}}function e7(i,t,e){let n=i.length,r,a,s,o,l,c=Z0(i,0);for(let u=0;u<n-1;++u)if(l=c,c=Z0(i,u+1),!(!l||!c)){if(ec(t[u],0,JA)){e[u]=e[u+1]=0;continue}r=e[u]/t[u],a=e[u+1]/t[u],o=Math.pow(r,2)+Math.pow(a,2),!(o<=9)&&(s=3/Math.sqrt(o),e[u]=r*s*t[u],e[u+1]=a*s*t[u])}}function t7(i,t,e="x"){let n=bb(e),r=i.length,a,s,o,l=Z0(i,0);for(let c=0;c<r;++c){if(s=o,o=l,l=Z0(i,c+1),!o)continue;let u=o[e],h=o[n];s&&(a=(u-s[e])/3,o[`cp1${e}`]=u-a,o[`cp1${n}`]=h-a*t[c]),l&&(a=(l[e]-u)/3,o[`cp2${e}`]=u+a,o[`cp2${n}`]=h+a*t[c])}}function i7(i,t="x"){let e=bb(t),n=i.length,r=Array(n).fill(0),a=Array(n),s,o,l,c=Z0(i,0);for(s=0;s<n;++s)if(o=l,l=c,c=Z0(i,s+1),!!l){if(c){let u=c[t]-l[t];r[s]=u!==0?(c[e]-l[e])/u:0}a[s]=o?c?fs(r[s-1])!==fs(r[s])?0:(r[s-1]+r[s])/2:r[s-1]:r[s]}e7(i,r,a),t7(i,a,t)}function _h(i,t,e){return Math.max(Math.min(i,e),t)}function n7(i,t){let e,n,r,a,s,o=Is(i[0],t);for(e=0,n=i.length;e<n;++e)s=a,a=o,o=e<n-1&&Is(i[e+1],t),a&&(r=i[e],s&&(r.cp1x=_h(r.cp1x,t.left,t.right),r.cp1y=_h(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=_h(r.cp2x,t.left,t.right),r.cp2y=_h(r.cp2y,t.top,t.bottom)))}function wb(i,t,e,n,r){let a,s,o,l;if(t.spanGaps&&(i=i.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")i7(i,r);else{let c=n?i[i.length-1]:i[0];for(a=0,s=i.length;a<s;++a)o=i[a],l=QA(c,o,i[Math.min(a+1,s-(n?0:1))%s],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}t.capBezierPoints&&n7(i,e)}function Mh(){return typeof window<"u"&&typeof document<"u"}function Lh(i){let t=i.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function Ch(i,t,e){let n;return typeof i=="string"?(n=parseInt(i,10),i.indexOf("%")!==-1&&(n=n/100*t.parentNode[e])):n=i,n}var Ih=i=>i.ownerDocument.defaultView.getComputedStyle(i,null);function r7(i,t){return Ih(i).getPropertyValue(t)}var a7=["top","right","bottom","left"];function t0(i,t,e){let n={};e=e?"-"+e:"";for(let r=0;r<4;r++){let a=a7[r];n[a]=parseFloat(i[t+"-"+a+e])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}var s7=(i,t,e)=>(i>0||t>0)&&(!e||!e.shadowRoot);function o7(i,t){let e=i.touches,n=e&&e.length?e[0]:i,{offsetX:r,offsetY:a}=n,s=!1,o,l;if(s7(r,a,i.target))o=r,l=a;else{let c=t.getBoundingClientRect();o=n.clientX-c.left,l=n.clientY-c.top,s=!0}return{x:o,y:l,box:s}}function hl(i,t){if("native"in i)return i;let{canvas:e,currentDevicePixelRatio:n}=t,r=Ih(e),a=r.boxSizing==="border-box",s=t0(r,"padding"),o=t0(r,"border","width"),{x:l,y:c,box:u}=o7(i,e),h=s.left+(u&&o.left),g=s.top+(u&&o.top),{width:d,height:b}=t;return a&&(d-=s.width+o.width,b-=s.height+o.height),{x:Math.round((l-h)/d*e.width/n),y:Math.round((c-g)/b*e.height/n)}}function l7(i,t,e){let n,r;if(t===void 0||e===void 0){let a=i&&Lh(i);if(!a)t=i.clientWidth,e=i.clientHeight;else{let s=a.getBoundingClientRect(),o=Ih(a),l=t0(o,"border","width"),c=t0(o,"padding");t=s.width-c.width-l.width,e=s.height-c.height-l.height,n=Ch(o.maxWidth,a,"clientWidth"),r=Ch(o.maxHeight,a,"clientHeight")}}return{width:t,height:e,maxWidth:n||yh,maxHeight:r||yh}}var ll=i=>Math.round(i*10)/10;function yb(i,t,e,n){let r=Ih(i),a=t0(r,"margin"),s=Ch(r.maxWidth,i,"clientWidth")||yh,o=Ch(r.maxHeight,i,"clientHeight")||yh,l=l7(i,t,e),{width:c,height:u}=l;if(r.boxSizing==="content-box"){let g=t0(r,"border","width"),d=t0(r,"padding");c-=d.width+g.width,u-=d.height+g.height}return c=Math.max(0,c-a.width),u=Math.max(0,n?c/n:u-a.height),c=ll(Math.min(c,s,l.maxWidth)),u=ll(Math.min(u,o,l.maxHeight)),c&&!u&&(u=ll(c/2)),(t!==void 0||e!==void 0)&&n&&l.height&&u>l.height&&(u=l.height,c=ll(Math.floor(u*n))),{width:c,height:u}}function Wm(i,t,e){let n=t||1,r=ll(i.height*n),a=ll(i.width*n);i.height=ll(i.height),i.width=ll(i.width);let s=i.canvas;return s.style&&(e||!s.style.height&&!s.style.width)&&(s.style.height=`${i.height}px`,s.style.width=`${i.width}px`),i.currentDevicePixelRatio!==n||s.height!==r||s.width!==a?(i.currentDevicePixelRatio=n,s.height=r,s.width=a,i.ctx.setTransform(n,0,0,n,0,0),!0):!1}var Sb=(function(){let i=!1;try{let t={get passive(){return i=!0,!1}};Mh()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return i})();function qm(i,t){let e=r7(i,t),n=e&&e.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function ol(i,t,e,n){return{x:i.x+e*(t.x-i.x),y:i.y+e*(t.y-i.y)}}function Cb(i,t,e,n){return{x:i.x+e*(t.x-i.x),y:n==="middle"?e<.5?i.y:t.y:n==="after"?e<1?i.y:t.y:e>0?t.y:i.y}}function Eb(i,t,e,n){let r={x:i.cp2x,y:i.cp2y},a={x:t.cp1x,y:t.cp1y},s=ol(i,r,e),o=ol(r,a,e),l=ol(a,t,e),c=ol(s,o,e),u=ol(o,l,e);return ol(c,u,e)}var c7=function(i,t){return{x(e){return i+i+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,n){return e-n},leftForLtr(e,n){return e-n}}},u7=function(){return{x(i){return i},setWidth(i){},textAlign(i){return i},xPlus(i,t){return i+t},leftForLtr(i,t){return i}}};function r0(i,t,e){return i?c7(t,e):u7()}function Gm(i,t){let e,n;(t==="ltr"||t==="rtl")&&(e=i.canvas.style,n=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),i.prevTextDirection=n)}function $m(i,t){t!==void 0&&(delete i.prevTextDirection,i.canvas.style.setProperty("direction",t[0],t[1]))}function kb(i){return i==="angle"?{between:tc,compare:TA,normalize:kr}:{between:Os,compare:(t,e)=>t-e,normalize:t=>t}}function K_({start:i,end:t,count:e,loop:n,style:r}){return{start:i%e,end:t%e,loop:n&&(t-i+1)%e===0,style:r}}function d7(i,t,e){let{property:n,start:r,end:a}=e,{between:s,normalize:o}=kb(n),l=t.length,{start:c,end:u,loop:h}=i,g,d;if(h){for(c+=l,u+=l,g=0,d=l;g<d&&s(o(t[c%l][n]),r,a);++g)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:i.style}}function Xm(i,t,e){if(!e)return[i];let{property:n,start:r,end:a}=e,s=t.length,{compare:o,between:l,normalize:c}=kb(n),{start:u,end:h,loop:g,style:d}=d7(i,t,e),b=[],_=!1,w=null,E,A,D,N=()=>l(r,D,E)&&o(r,D)!==0,z=()=>o(a,E)===0||l(a,D,E),J=()=>_||N(),W=()=>!_||z();for(let U=u,M=u;U<=h;++U)A=t[U%s],!A.skip&&(E=c(A[n]),E!==D&&(_=l(E,r,a),w===null&&J()&&(w=o(E,r)===0?U:M),w!==null&&W()&&(b.push(K_({start:w,end:U,loop:g,count:s,style:d})),w=null),M=U,D=E));return w!==null&&b.push(K_({start:w,end:h,loop:g,count:s,style:d})),b}function Ym(i,t){let e=[],n=i.segments;for(let r=0;r<n.length;r++){let a=Xm(n[r],i.points,t);a.length&&e.push(...a)}return e}function f7(i,t,e,n){let r=0,a=t-1;if(e&&!n)for(;r<t&&!i[r].skip;)r++;for(;r<t&&i[r].skip;)r++;for(r%=t,e&&(a+=r);a>r&&i[a%t].skip;)a--;return a%=t,{start:r,end:a}}function h7(i,t,e,n){let r=i.length,a=[],s=t,o=i[t],l;for(l=t+1;l<=e;++l){let c=i[l%r];c.skip||c.stop?o.skip||(n=!1,a.push({start:t%r,end:(l-1)%r,loop:n}),t=s=c.stop?l:null):(s=l,o.skip&&(t=l)),o=c}return s!==null&&a.push({start:t%r,end:s%r,loop:n}),a}function Tb(i,t){let e=i.points,n=i.options.spanGaps,r=e.length;if(!r)return[];let a=!!i._loop,{start:s,end:o}=f7(e,r,a,n);if(n===!0)return Z_(i,[{start:s,end:o,loop:a}],e,t);let l=o<s?o+r:o,c=!!i._fullLoop&&s===0&&o===r-1;return Z_(i,h7(e,s,l,c),e,t)}function Z_(i,t,e,n){return!n||!n.setContext||!e?t:p7(i,t,e,n)}function p7(i,t,e,n){let r=i._chart.getContext(),a=J_(i.options),{_datasetIndex:s,options:{spanGaps:o}}=i,l=e.length,c=[],u=a,h=t[0].start,g=h;function d(b,_,w,E){let A=o?-1:1;if(b!==_){for(b+=l;e[b%l].skip;)b-=A;for(;e[_%l].skip;)_+=A;b%l!==_%l&&(c.push({start:b%l,end:_%l,loop:w,style:E}),u=E,h=_%l)}}for(let b of t){h=o?h:b.start;let _=e[h%l],w;for(g=h+1;g<=b.end;g++){let E=e[g%l];w=J_(n.setContext(_o(r,{type:"segment",p0:_,p1:E,p0DataIndex:(g-1)%l,p1DataIndex:g%l,datasetIndex:s}))),m7(w,u)&&d(h,g-1,b.loop,u),_=E,u=w}h<g-1&&d(h,g-1,b.loop,u)}return c}function J_(i){return{backgroundColor:i.backgroundColor,borderCapStyle:i.borderCapStyle,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderJoinStyle:i.borderJoinStyle,borderWidth:i.borderWidth,borderColor:i.borderColor}}function m7(i,t){if(!t)return!1;let e=[],n=function(r,a){return Im(a)?(e.includes(a)||e.push(a),e.indexOf(a)):a};return JSON.stringify(i,n)!==JSON.stringify(t,n)}function bh(i,t,e){return i.options.clip?i[e]:t[e]}function g7(i,t){let{xScale:e,yScale:n}=i;return e&&n?{left:bh(e,t,"left"),right:bh(e,t,"right"),top:bh(n,t,"top"),bottom:bh(n,t,"bottom")}:t}function Km(i,t){let e=t._clip;if(e.disabled)return!1;let n=g7(t,i.chartArea);return{left:e.left===!1?0:n.left-(e.left===!0?0:e.left),right:e.right===!1?i.width:n.right+(e.right===!0?0:e.right),top:e.top===!1?0:n.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?i.height:n.bottom+(e.bottom===!0?0:e.bottom)}}var lg=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,r){let a=e.listeners[r],s=e.duration;a.forEach(o=>o({chart:t,initial:e.initial,numSteps:s,currentStep:Math.min(n-e.start,s)}))}_refresh(){this._request||(this._running=!0,this._request=Nm.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((n,r)=>{if(!n.running||!n.items.length)return;let a=n.items,s=a.length-1,o=!1,l;for(;s>=0;--s)l=a[s],l._active?(l._total>n.duration&&(n.duration=l._total),l.tick(t),o=!0):(a[s]=a[a.length-1],a.pop());o&&(r.draw(),this._notify(r,n,t,"progress")),a.length||(n.running=!1,this._notify(r,n,t,"complete"),n.initial=!1),e+=a.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){let e=this._charts,n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){let e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((n,r)=>Math.max(n,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;let e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){let e=this._charts.get(t);if(!e||!e.items.length)return;let n=e.items,r=n.length-1;for(;r>=0;--r)n[r].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}},bo=new lg,Ab="transparent",x7={boolean(i,t,e){return e>.5?t:i},color(i,t,e){let n=Rm(i||Ab),r=n.valid&&Rm(t||Ab);return r&&r.valid?r.mix(n,e).hexString():t},number(i,t,e){return i+(t-i)*e}},cg=class{constructor(t,e,n,r){let a=e[n];r=rc([t.to,r,a,t.from]);let s=rc([t.from,a,r]);this._active=!0,this._fn=t.fn||x7[t.type||typeof s],this._easing=Y0[t.easing]||Y0.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=s,this._to=r,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);let r=this._target[this._prop],a=n-this._start,s=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(s,t.duration)),this._total+=a,this._loop=!!t.loop,this._to=rc([t.to,e,r,t.from]),this._from=rc([t.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){let e=t-this._start,n=this._duration,r=this._prop,a=this._from,s=this._loop,o=this._to,l;if(this._active=a!==o&&(s||e<n),!this._active){this._target[r]=o,this._notify(!0);return}if(e<0){this._target[r]=a;return}l=e/n%2,l=s&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(a,o,l)}wait(){let t=this._promises||(this._promises=[]);return new Promise((e,n)=>{t.push({res:e,rej:n})})}_notify(t){let e=t?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][e]()}},Wh=class{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!fi(t))return;let e=Object.keys(un.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{let a=t[r];if(!fi(a))return;let s={};for(let o of e)s[o]=a[o];(an(a.properties)&&a.properties||[r]).forEach(o=>{(o===r||!n.has(o))&&n.set(o,s)})})}_animateOptions(t,e){let n=e.options,r=_7(t,n);if(!r)return[];let a=this._createAnimations(r,n);return n.$shared&&v7(t.options.$animations,n).then(()=>{t.options=n},()=>{}),a}_createAnimations(t,e){let n=this._properties,r=[],a=t.$animations||(t.$animations={}),s=Object.keys(e),o=Date.now(),l;for(l=s.length-1;l>=0;--l){let c=s[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(t,e));continue}let u=e[c],h=a[c],g=n.get(c);if(h)if(g&&h.active()){h.update(g,u,o);continue}else h.cancel();if(!g||!g.duration){t[c]=u;continue}a[c]=h=new cg(g,t,c,u),r.push(h)}return r}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}let n=this._createAnimations(t,e);if(n.length)return bo.add(this._chart,n),!0}};function v7(i,t){let e=[],n=Object.keys(t);for(let r=0;r<n.length;r++){let a=i[n[r]];a&&a.active()&&e.push(a.wait())}return Promise.all(e)}function _7(i,t){if(!t)return;let e=i.options;if(!e){i.options=t;return}return e.$shared&&(i.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function Fb(i,t){let e=i&&i.options||{},n=e.reverse,r=e.min===void 0?t:0,a=e.max===void 0?t:0;return{start:n?a:r,end:n?r:a}}function b7(i,t,e){if(e===!1)return!1;let n=Fb(i,e),r=Fb(t,e);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}function w7(i){let t,e,n,r;return fi(i)?(t=i.top,e=i.right,n=i.bottom,r=i.left):t=e=n=r=i,{top:t,right:e,bottom:n,left:r,disabled:i===!1}}function A5(i,t){let e=[],n=i._getSortedDatasetMetas(t),r,a;for(r=0,a=n.length;r<a;++r)e.push(n[r].index);return e}function Db(i,t,e,n={}){let r=i.keys,a=n.mode==="single",s,o,l,c;if(t===null)return;let u=!1;for(s=0,o=r.length;s<o;++s){if(l=+r[s],l===e){if(u=!0,n.all)continue;break}c=i.values[l],vn(c)&&(a||t===0||fs(t)===fs(c))&&(t+=c)}return!u&&!n.all?0:t}function y7(i,t){let{iScale:e,vScale:n}=t,r=e.axis==="x"?"x":"y",a=n.axis==="x"?"x":"y",s=Object.keys(i),o=new Array(s.length),l,c,u;for(l=0,c=s.length;l<c;++l)u=s[l],o[l]={[r]:u,[a]:i[u]};return o}function Zm(i,t){let e=i&&i.options.stacked;return e||e===void 0&&t.stack!==void 0}function S7(i,t,e){return`${i.id}.${t.id}.${e.stack||e.type}`}function C7(i){let{min:t,max:e,minDefined:n,maxDefined:r}=i.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:r?e:Number.POSITIVE_INFINITY}}function E7(i,t,e){let n=i[t]||(i[t]={});return n[e]||(n[e]={})}function Nb(i,t,e,n){for(let r of t.getMatchingVisibleMetas(n).reverse()){let a=i[r.index];if(e&&a>0||!e&&a<0)return r.index}return null}function Pb(i,t){let{chart:e,_cachedMeta:n}=i,r=e._stacks||(e._stacks={}),{iScale:a,vScale:s,index:o}=n,l=a.axis,c=s.axis,u=S7(a,s,n),h=t.length,g;for(let d=0;d<h;++d){let b=t[d],{[l]:_,[c]:w}=b,E=b._stacks||(b._stacks={});g=E[c]=E7(r,u,_),g[o]=w,g._top=Nb(g,s,!0,n.type),g._bottom=Nb(g,s,!1,n.type);let A=g._visualValues||(g._visualValues={});A[o]=w}}function Jm(i,t){let e=i.scales;return Object.keys(e).filter(n=>e[n].axis===t).shift()}function k7(i,t){return _o(i,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function T7(i,t,e){return _o(i,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Bu(i,t){let e=i.controller.index,n=i.vScale&&i.vScale.axis;if(n){t=t||i._parsed;for(let r of t){let a=r._stacks;if(!a||a[n]===void 0||a[n][e]===void 0)return;delete a[n][e],a[n]._visualValues!==void 0&&a[n]._visualValues[e]!==void 0&&delete a[n]._visualValues[e]}}}var Qm=i=>i==="reset"||i==="none",Mb=(i,t)=>t?i:Object.assign({},i),A7=(i,t,e)=>i&&!t.hidden&&t._stacked&&{keys:A5(e,!0),values:null},ml=(()=>{class i{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Zm(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Bu(this._cachedMeta),this.index=e}linkScales(){let e=this.chart,n=this._cachedMeta,r=this.getDataset(),a=(g,d,b,_)=>g==="x"?d:g==="r"?_:b,s=n.xAxisID=ei(r.xAxisID,Jm(e,"x")),o=n.yAxisID=ei(r.yAxisID,Jm(e,"y")),l=n.rAxisID=ei(r.rAxisID,Jm(e,"r")),c=n.indexAxis,u=n.iAxisID=a(c,s,o,l),h=n.vAxisID=a(c,o,s,l);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(l),n.iScale=this.getScaleForId(u),n.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){let n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){let e=this._cachedMeta;this._data&&Fm(this._data,this),e._stacked&&Bu(e)}_dataCheck(){let e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(fi(n)){let a=this._cachedMeta;this._data=y7(n,a)}else if(r!==n){if(r){Fm(r,this);let a=this._cachedMeta;Bu(a),a._parsed=[]}n&&Object.isExtensible(n)&&cb(n,this),this._syncList=[],this._data=n}}addElements(){let e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){let n=this._cachedMeta,r=this.getDataset(),a=!1;this._dataCheck();let s=n._stacked;n._stacked=Zm(n.vScale,n),n.stack!==r.stack&&(a=!0,Bu(n),n.stack=r.stack),this._resyncElements(e),(a||s!==n._stacked)&&(Pb(this,n._parsed),n._stacked=Zm(n.vScale,n))}configure(){let e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){let{_cachedMeta:r,_data:a}=this,{iScale:s,_stacked:o}=r,l=s.axis,c=e===0&&n===a.length?!0:r._sorted,u=e>0&&r._parsed[e-1],h,g,d;if(this._parsing===!1)r._parsed=a,r._sorted=!0,d=a;else{an(a[e])?d=this.parseArrayData(r,a,e,n):fi(a[e])?d=this.parseObjectData(r,a,e,n):d=this.parsePrimitiveData(r,a,e,n);let b=()=>g[l]===null||u&&g[l]<u[l];for(h=0;h<n;++h)r._parsed[h+e]=g=d[h],c&&(b()&&(c=!1),u=g);r._sorted=c}o&&Pb(this,d)}parsePrimitiveData(e,n,r,a){let{iScale:s,vScale:o}=e,l=s.axis,c=o.axis,u=s.getLabels(),h=s===o,g=new Array(a),d,b,_;for(d=0,b=a;d<b;++d)_=d+r,g[d]={[l]:h||s.parse(u[_],_),[c]:o.parse(n[_],_)};return g}parseArrayData(e,n,r,a){let{xScale:s,yScale:o}=e,l=new Array(a),c,u,h,g;for(c=0,u=a;c<u;++c)h=c+r,g=n[h],l[c]={x:s.parse(g[0],h),y:o.parse(g[1],h)};return l}parseObjectData(e,n,r,a){let{xScale:s,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(a),h,g,d,b;for(h=0,g=a;h<g;++h)d=h+r,b=n[d],u[h]={x:s.parse(vo(b,l),d),y:o.parse(vo(b,c),d)};return u}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){let a=this.chart,s=this._cachedMeta,o=n[e.axis],l={keys:A5(a,!0),values:n._stacks[e.axis]._visualValues};return Db(l,o,s.index,{mode:r})}updateRangeFromParsed(e,n,r,a){let s=r[n.axis],o=s===null?NaN:s,l=a&&r._stacks[n.axis];a&&l&&(a.values=l,o=Db(a,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){let r=this._cachedMeta,a=r._parsed,s=r._sorted&&e===r.iScale,o=a.length,l=this._getOtherScale(e),c=A7(n,r,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:g}=C7(l),d,b;function _(){b=a[d];let w=b[l.axis];return!vn(b[e.axis])||h>w||g<w}for(d=0;d<o&&!(!_()&&(this.updateRangeFromParsed(u,e,b,c),s));++d);if(s){for(d=o-1;d>=0;--d)if(!_()){this.updateRangeFromParsed(u,e,b,c);break}}return u}getAllParsedValues(e){let n=this._cachedMeta._parsed,r=[],a,s,o;for(a=0,s=n.length;a<s;++a)o=n[a][e.axis],vn(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){let n=this._cachedMeta,r=n.iScale,a=n.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:a?""+a.getLabelForValue(s[a.axis]):""}}_update(e){let n=this._cachedMeta;this.update(e||"default"),n._clip=w7(ei(this.options.clip,b7(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){let e=this._ctx,n=this.chart,r=this._cachedMeta,a=r.data||[],s=n.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||a.length-l,u=this.options.drawActiveElementsOnTop,h;for(r.dataset&&r.dataset.draw(e,s,l,c),h=l;h<l+c;++h){let g=a[h];g.hidden||(g.active&&u?o.push(g):g.draw(e,s))}for(h=0;h<o.length;++h)o[h].draw(e,s)}getStyle(e,n){let r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){let a=this.getDataset(),s;if(e>=0&&e<this._cachedMeta.data.length){let o=this._cachedMeta.data[e];s=o.$context||(o.$context=T7(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=a.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=k7(this.chart.getContext(),this.index)),s.dataset=a,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){let a=n==="active",s=this._cachedDataOpts,o=e+"-"+n,l=s[o],c=this.enableOptionSharing&&Q0(r);if(l)return Mb(l,c);let u=this.chart.config,h=u.datasetElementScopeKeys(this._type,e),g=a?[`${e}Hover`,"hover",e,""]:[e,""],d=u.getOptionScopes(this.getDataset(),h),b=Object.keys(un.elements[e]),_=()=>this.getContext(r,a,n),w=u.resolveNamedOptions(d,b,_,g);return w.$shared&&(w.$shared=c,s[o]=Object.freeze(Mb(w,c))),w}_resolveAnimations(e,n,r){let a=this.chart,s=this._cachedDataOpts,o=`animation-${n}`,l=s[o];if(l)return l;let c;if(a.options.animation!==!1){let h=this.chart.config,g=h.datasetAnimationScopeKeys(this._type,n),d=h.getOptionScopes(this.getDataset(),g);c=h.createResolver(d,this.getContext(e,r,n))}let u=new Wh(a,c&&c.animations);return c&&c._cacheable&&(s[o]=Object.freeze(u)),u}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||Qm(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){let r=this.resolveDataElementOptions(e,n),a=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(n,s)||s!==a;return this.updateSharedOptions(s,n,r),{sharedOptions:s,includeOptions:o}}updateElement(e,n,r,a){Qm(a)?Object.assign(e,r):this._resolveAnimations(n,a).update(e,r)}updateSharedOptions(e,n,r){e&&!Qm(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,a){e.active=a;let s=this.getStyle(n,a);this._resolveAnimations(n,r,a).update(e,{options:!a&&this.getSharedOptions(s)||s})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){let n=this._data,r=this._cachedMeta.data;for(let[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];let a=r.length,s=n.length,o=Math.min(s,a);o&&this.parse(0,o),s>a?this._insertElements(a,s-a,e):s<a&&this._removeElements(s,a-s)}_insertElements(e,n,r=!0){let a=this._cachedMeta,s=a.data,o=e+n,l,c=u=>{for(u.length+=n,l=u.length-1;l>=o;l--)u[l]=u[l-n]};for(c(s),l=e;l<o;++l)s[l]=new this.dataElementType;this._parsing&&c(a._parsed),this.parse(e,n),r&&this.updateElements(s,e,n,"reset")}updateElements(e,n,r,a){}_removeElements(e,n){let r=this._cachedMeta;if(this._parsing){let a=r._parsed.splice(e,n);r._stacked&&Bu(r,a)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{let[n,r,a]=e;this[n](r,a)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){let e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);let r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return i})();function F7(i,t){if(!i._cache.$bar){let e=i.getMatchingVisibleMetas(t),n=[];for(let r=0,a=e.length;r<a;r++)n=n.concat(e[r].controller.getAllParsedValues(i));i._cache.$bar=Dm(n.sort((r,a)=>r-a))}return i._cache.$bar}function D7(i){let t=i.iScale,e=F7(t,i.type),n=t._length,r,a,s,o,l=()=>{s===32767||s===-32768||(Q0(o)&&(n=Math.min(n,Math.abs(s-o)||n)),o=s)};for(r=0,a=e.length;r<a;++r)s=t.getPixelForValue(e[r]),l();for(o=void 0,r=0,a=t.ticks.length;r<a;++r)s=t.getPixelForTick(r),l();return n}function N7(i,t,e,n){let r=e.barThickness,a,s;return di(r)?(a=t.min*e.categoryPercentage,s=e.barPercentage):(a=r*n,s=1),{chunk:a/n,ratio:s,start:t.pixels[i]-a/2}}function P7(i,t,e,n){let r=t.pixels,a=r[i],s=i>0?r[i-1]:null,o=i<r.length-1?r[i+1]:null,l=e.categoryPercentage;s===null&&(s=a-(o===null?t.end-t.start:o-a)),o===null&&(o=a+a-s);let c=a-(a-Math.min(s,o))/2*l;return{chunk:Math.abs(o-s)/2*l/n,ratio:e.barPercentage,start:c}}function M7(i,t,e,n){let r=e.parse(i[0],n),a=e.parse(i[1],n),s=Math.min(r,a),o=Math.max(r,a),l=s,c=o;Math.abs(s)>Math.abs(o)&&(l=o,c=s),t[e.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:a,min:s,max:o}}function F5(i,t,e,n){return an(i)?M7(i,t,e,n):t[e.axis]=e.parse(i,n),t}function Lb(i,t,e,n){let r=i.iScale,a=i.vScale,s=r.getLabels(),o=r===a,l=[],c,u,h,g;for(c=e,u=e+n;c<u;++c)g=t[c],h={},h[r.axis]=o||r.parse(s[c],c),l.push(F5(g,h,a,c));return l}function eg(i){return i&&i.barStart!==void 0&&i.barEnd!==void 0}function L7(i,t,e){return i!==0?fs(i):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function I7(i){let t,e,n,r,a;return i.horizontal?(t=i.base>i.x,e="left",n="right"):(t=i.base<i.y,e="bottom",n="top"),t?(r="end",a="start"):(r="start",a="end"),{start:e,end:n,reverse:t,top:r,bottom:a}}function R7(i,t,e,n){let r=t.borderSkipped,a={};if(!r){i.borderSkipped=a;return}if(r===!0){i.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:s,end:o,reverse:l,top:c,bottom:u}=I7(i);r==="middle"&&e&&(i.enableBorderRadius=!0,(e._top||0)===n?r=c:(e._bottom||0)===n?r=u:(a[Ib(u,s,o,l)]=!0,r=c)),a[Ib(r,s,o,l)]=!0,i.borderSkipped=a}function Ib(i,t,e,n){return n?(i=O7(i,t,e),i=Rb(i,e,t)):i=Rb(i,t,e),i}function O7(i,t,e){return i===t?e:i===e?t:i}function Rb(i,t,e){return i==="start"?t:i==="end"?e:i}function B7(i,{inflateAmount:t},e){i.inflateAmount=t==="auto"?e===1?.33:0:t}var j7=(()=>{class i extends ml{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,r,a){return Lb(e,n,r,a)}parseArrayData(e,n,r,a){return Lb(e,n,r,a)}parseObjectData(e,n,r,a){let{iScale:s,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=s.axis==="x"?l:c,h=o.axis==="x"?l:c,g=[],d,b,_,w;for(d=r,b=r+a;d<b;++d)w=n[d],_={},_[s.axis]=s.parse(vo(w,u),d),g.push(F5(vo(w,h),_,o,d));return g}updateRangeFromParsed(e,n,r,a){super.updateRangeFromParsed(e,n,r,a);let s=r._custom;s&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){let n=this._cachedMeta,{iScale:r,vScale:a}=n,s=this.getParsed(e),o=s._custom,l=eg(o)?"["+o.start+", "+o.end+"]":""+a.getLabelForValue(s[a.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();let e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){let n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,a){let s=a==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),h=this._getRuler(),{sharedOptions:g,includeOptions:d}=this._getSharedOptions(n,a);for(let b=n;b<n+r;b++){let _=this.getParsed(b),w=s||di(_[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(b),E=this._calculateBarIndexPixels(b,h),A=(_._stacks||{})[l.axis],D={horizontal:u,base:w.base,enableBorderRadius:!A||eg(_._custom)||o===A._top||o===A._bottom,x:u?w.head:E.center,y:u?E.center:w.head,height:u?E.size:Math.abs(w.size),width:u?Math.abs(w.size):E.size};d&&(D.options=g||this.resolveDataElementOptions(b,e[b].active?"active":a));let N=D.options||e[b].options;R7(D,N,A,o),B7(D,N,h.ratio),this.updateElement(e[b],b,D,a)}}_getStacks(e,n){let{iScale:r}=this._cachedMeta,a=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),s=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(n),c=l&&l[r.axis],u=h=>{let g=h._parsed.find(b=>b[r.axis]===c),d=g&&g[h.vScale.axis];if(di(d)||isNaN(d))return!0};for(let h of a)if(!(n!==void 0&&u(h))&&((s===!1||o.indexOf(h.stack)===-1||s===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){let e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===n).shift()}_getAxis(){let e={},n=this.getFirstScaleIdForIndexAxis();for(let r of this.chart.data.datasets)e[ei(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,r){let a=this._getStacks(e,r),s=n!==void 0?a.indexOf(n):-1;return s===-1?a.length-1:s}_getRuler(){let e=this.options,n=this._cachedMeta,r=n.iScale,a=[],s,o;for(s=0,o=n.data.length;s<o;++s)a.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));let l=e.barThickness;return{min:l||D7(n),pixels:a,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){let{_cachedMeta:{vScale:n,_stacked:r,index:a},options:{base:s,minBarLength:o}}=this,l=s||0,c=this.getParsed(e),u=c._custom,h=eg(u),g=c[n.axis],d=0,b=r?this.applyStack(n,c,r):g,_,w;b!==g&&(d=b-g,b=g),h&&(g=u.barStart,b=u.barEnd-u.barStart,g!==0&&fs(g)!==fs(u.barEnd)&&(d=0),d+=g);let E=!di(s)&&!h?s:d,A=n.getPixelForValue(E);if(this.chart.getDataVisibility(e)?_=n.getPixelForValue(d+b):_=A,w=_-A,Math.abs(w)<o){w=L7(w,n,l)*o,g===l&&(A-=w/2);let D=n.getPixelForDecimal(0),N=n.getPixelForDecimal(1),z=Math.min(D,N),J=Math.max(D,N);A=Math.max(Math.min(A,J),z),_=A+w,r&&!h&&(c._stacks[n.axis]._visualValues[a]=n.getValueForPixel(_)-n.getValueForPixel(A))}if(A===n.getPixelForValue(l)){let D=fs(w)*n.getLineWidthForValue(l)/2;A+=D,w-=D}return{size:w,base:A,head:_,center:_+w/2}}_calculateBarIndexPixels(e,n){let r=n.scale,a=this.options,s=a.skipNull,o=ei(a.maxBarThickness,1/0),l,c,u=this._getAxisCount();if(n.grouped){let h=s?this._getStackCount(e):n.stackCount,g=a.barThickness==="flex"?P7(e,n,a,h*u):N7(e,n,a,h*u),d=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,b=this._getAxis().indexOf(ei(d,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+b;l=g.start+g.chunk*_+g.chunk/2,c=Math.min(o,g.chunk*g.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,n.min*n.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){let e=this._cachedMeta,n=e.vScale,r=e.data,a=r.length,s=0;for(;s<a;++s)this.getParsed(s)[n.axis]!==null&&!r[s].hidden&&r[s].draw(this._ctx)}}return i})(),V7=(()=>{class i extends ml{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,r,a){let s=super.parsePrimitiveData(e,n,r,a);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+r).radius;return s}parseArrayData(e,n,r,a){let s=super.parseArrayData(e,n,r,a);for(let o=0;o<s.length;o++){let l=n[r+o];s[o]._custom=ei(l[2],this.resolveDataElementOptions(o+r).radius)}return s}parseObjectData(e,n,r,a){let s=super.parseObjectData(e,n,r,a);for(let o=0;o<s.length;o++){let l=n[r+o];s[o]._custom=ei(l&&l.r&&+l.r,this.resolveDataElementOptions(o+r).radius)}return s}getMaxOverflow(){let e=this._cachedMeta.data,n=0;for(let r=e.length-1;r>=0;--r)n=Math.max(n,e[r].size(this.resolveDataElementOptions(r))/2);return n>0&&n}getLabelAndValue(e){let n=this._cachedMeta,r=this.chart.data.labels||[],{xScale:a,yScale:s}=n,o=this.getParsed(e),l=a.getLabelForValue(o.x),c=s.getLabelForValue(o.y),u=o._custom;return{label:r[e]||"",value:"("+l+", "+c+(u?", "+u:"")+")"}}update(e){let n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,r,a){let s=a==="reset",{iScale:o,vScale:l}=this._cachedMeta,{sharedOptions:c,includeOptions:u}=this._getSharedOptions(n,a),h=o.axis,g=l.axis;for(let d=n;d<n+r;d++){let b=e[d],_=!s&&this.getParsed(d),w={},E=w[h]=s?o.getPixelForDecimal(.5):o.getPixelForValue(_[h]),A=w[g]=s?l.getBasePixel():l.getPixelForValue(_[g]);w.skip=isNaN(E)||isNaN(A),u&&(w.options=c||this.resolveDataElementOptions(d,b.active?"active":a),s&&(w.options.radius=0)),this.updateElement(b,d,w,a)}}resolveDataElementOptions(e,n){let r=this.getParsed(e),a=super.resolveDataElementOptions(e,n);a.$shared&&(a=Object.assign({},a,{$shared:!1}));let s=a.radius;return n!=="active"&&(a.radius=0),a.radius+=ei(r&&r._custom,s),a}}return i})();function U7(i,t,e){let n=1,r=1,a=0,s=0;if(t<sn){let o=i,l=o+t,c=Math.cos(o),u=Math.sin(o),h=Math.cos(l),g=Math.sin(l),d=(D,N,z)=>tc(D,o,l,!0)?1:Math.max(N,N*e,z,z*e),b=(D,N,z)=>tc(D,o,l,!0)?-1:Math.min(N,N*e,z,z*e),_=d(0,c,h),w=d(Sn,u,g),E=b(Si,c,h),A=b(Si+Sn,u,g);n=(_-E)/2,r=(w-A)/2,a=-(_+E)/2,s=-(w+A)/2}return{ratioX:n,ratioY:r,offsetX:a,offsetY:s}}var Fg=(()=>{class i extends ml{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let n=e.data,{labels:{pointStyle:r,textAlign:a,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((c,u)=>{let g=e.getDatasetMeta(0).controller.getStyle(u);return{text:c,fillStyle:g.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(u),lineDash:g.borderDash,lineDashOffset:g.borderDashOffset,lineJoin:g.borderJoinStyle,lineWidth:g.borderWidth,strokeStyle:g.borderColor,textAlign:a,pointStyle:r,borderRadius:o&&(l||g.borderRadius),index:u}}):[]}},onClick(e,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){let r=this.getDataset().data,a=this._cachedMeta;if(this._parsing===!1)a._parsed=r;else{let s=c=>+r[c];if(fi(r[e])){let{key:c="value"}=this._parsing;s=u=>+vo(r[u],c)}let o,l;for(o=e,l=e+n;o<l;++o)a._parsed[o]=s(o)}}_getRotation(){return Ga(this.options.rotation-90)}_getCircumference(){return Ga(this.options.circumference)}_getRotationExtents(){let e=sn,n=-sn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){let a=this.chart.getDatasetMeta(r).controller,s=a._getRotation(),o=a._getCircumference();e=Math.min(e,s),n=Math.max(n,s+o)}return{rotation:e,circumference:n-e}}update(e){let n=this.chart,{chartArea:r}=n,a=this._cachedMeta,s=a.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min(eb(this.options.cutout,l),1),u=this._getRingWeight(this.index),{circumference:h,rotation:g}=this._getRotationExtents(),{ratioX:d,ratioY:b,offsetX:_,offsetY:w}=U7(g,h,c),E=(r.width-o)/d,A=(r.height-o)/b,D=Math.max(Math.min(E,A)/2,0),N=Sm(this.options.radius,D),z=Math.max(N*c,0),J=(N-z)/this._getVisibleDatasetWeightTotal();this.offsetX=_*N,this.offsetY=w*N,a.total=this.calculateTotal(),this.outerRadius=N-J*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-J*u,0),this.updateElements(s,0,s.length,e)}_circumference(e,n){let r=this.options,a=this._cachedMeta,s=this._getCircumference();return n&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||a._parsed[e]===null||a.data[e].hidden?0:this.calculateCircumference(a._parsed[e]*s/sn)}updateElements(e,n,r,a){let s=a==="reset",o=this.chart,l=o.chartArea,u=o.options.animation,h=(l.left+l.right)/2,g=(l.top+l.bottom)/2,d=s&&u.animateScale,b=d?0:this.innerRadius,_=d?0:this.outerRadius,{sharedOptions:w,includeOptions:E}=this._getSharedOptions(n,a),A=this._getRotation(),D;for(D=0;D<n;++D)A+=this._circumference(D,s);for(D=n;D<n+r;++D){let N=this._circumference(D,s),z=e[D],J={x:h+this.offsetX,y:g+this.offsetY,startAngle:A,endAngle:A+N,circumference:N,outerRadius:_,innerRadius:b};E&&(J.options=w||this.resolveDataElementOptions(D,z.active?"active":a)),A+=N,this.updateElement(z,D,J,a)}}calculateTotal(){let e=this._cachedMeta,n=e.data,r=0,a;for(a=0;a<n.length;a++){let s=e._parsed[a];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(a)&&!n[a].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){let n=this._cachedMeta.total;return n>0&&!isNaN(e)?sn*(Math.abs(e)/n):0}getLabelAndValue(e){let n=this._cachedMeta,r=this.chart,a=r.data.labels||[],s=ic(n._parsed[e],r.options.locale);return{label:a[e]||"",value:s}}getMaxBorderWidth(e){let n=0,r=this.chart,a,s,o,l,c;if(!e){for(a=0,s=r.data.datasets.length;a<s;++a)if(r.isDatasetVisible(a)){o=r.getDatasetMeta(a),e=o.data,l=o.controller;break}}if(!e)return 0;for(a=0,s=e.length;a<s;++a)c=l.resolveDataElementOptions(a),c.borderAlign!=="inner"&&(n=Math.max(n,c.borderWidth||0,c.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let r=0,a=e.length;r<a;++r){let s=this.resolveDataElementOptions(r);n=Math.max(n,s.offset||0,s.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(n+=this._getRingWeight(r));return n}_getRingWeight(e){return Math.max(ei(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return i})(),z7=(()=>{class i extends ml{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){let n=this._cachedMeta,{dataset:r,data:a=[],_dataset:s}=n,o=this.chart._animationsDisabled,{start:l,count:c}=Mm(n,a,o);this._drawStart=l,this._drawCount=c,Lm(n)&&(l=0,c=a.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=a;let u=this.resolveDatasetElementOptions(e);this.options.showLine||(u.borderWidth=0),u.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:u},e),this.updateElements(a,l,c,e)}updateElements(e,n,r,a){let s=a==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,{sharedOptions:h,includeOptions:g}=this._getSharedOptions(n,a),d=o.axis,b=l.axis,{spanGaps:_,segment:w}=this.options,E=n0(_)?_:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||s||a==="none",D=n+r,N=e.length,z=n>0&&this.getParsed(n-1);for(let J=0;J<N;++J){let W=e[J],U=A?W:{};if(J<n||J>=D){U.skip=!0;continue}let M=this.getParsed(J),X=di(M[b]),F=U[d]=o.getPixelForValue(M[d],J),I=U[b]=s||X?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,M,c):M[b],J);U.skip=isNaN(F)||isNaN(I)||X,U.stop=J>0&&Math.abs(M[d]-z[d])>E,w&&(U.parsed=M,U.raw=u.data[J]),g&&(U.options=h||this.resolveDataElementOptions(J,W.active?"active":a)),A||this.updateElement(W,J,U,a),z=M}}getMaxOverflow(){let e=this._cachedMeta,n=e.dataset,r=n.options&&n.options.borderWidth||0,a=e.data||[];if(!a.length)return r;let s=a[0].size(this.resolveDataElementOptions(0)),o=a[a.length-1].size(this.resolveDataElementOptions(a.length-1));return Math.max(r,s,o)/2}draw(){let e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}return i})(),D5=(()=>{class i extends ml{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let n=e.data;if(n.labels.length&&n.datasets.length){let{labels:{pointStyle:r,color:a}}=e.legend.options;return n.labels.map((s,o)=>{let c=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:a,lineWidth:c.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){let n=this._cachedMeta,r=this.chart,a=r.data.labels||[],s=ic(n._parsed[e].r,r.options.locale);return{label:a[e]||"",value:s}}parseObjectData(e,n,r,a){return Hm.bind(this)(e,n,r,a)}update(e){let n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}getMinMax(){let e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((r,a)=>{let s=this.getParsed(a).r;!isNaN(s)&&this.chart.getDataVisibility(a)&&(s<n.min&&(n.min=s),s>n.max&&(n.max=s))}),n}_updateRadius(){let e=this.chart,n=e.chartArea,r=e.options,a=Math.min(n.right-n.left,n.bottom-n.top),s=Math.max(a/2,0),o=Math.max(r.cutoutPercentage?s/100*r.cutoutPercentage:1,0),l=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-l*this.index,this.innerRadius=this.outerRadius-l}updateElements(e,n,r,a){let s=a==="reset",o=this.chart,c=o.options.animation,u=this._cachedMeta.rScale,h=u.xCenter,g=u.yCenter,d=u.getIndexAngle(0)-.5*Si,b=d,_,w=360/this.countVisibleElements();for(_=0;_<n;++_)b+=this._computeAngle(_,a,w);for(_=n;_<n+r;_++){let E=e[_],A=b,D=b+this._computeAngle(_,a,w),N=o.getDataVisibility(_)?u.getDistanceFromCenterForValue(this.getParsed(_).r):0;b=D,s&&(c.animateScale&&(N=0),c.animateRotate&&(A=D=d));let z={x:h,y:g,innerRadius:0,outerRadius:N,startAngle:A,endAngle:D,options:this.resolveDataElementOptions(_,E.active?"active":a)};this.updateElement(E,_,z,a)}}countVisibleElements(){let e=this._cachedMeta,n=0;return e.data.forEach((r,a)=>{!isNaN(this.getParsed(a).r)&&this.chart.getDataVisibility(a)&&n++}),n}_computeAngle(e,n,r){return this.chart.getDataVisibility(e)?Ga(this.resolveDataElementOptions(e,n).angle||r):0}}return i})(),H7=(()=>{class i extends Fg{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}return i})(),W7=(()=>{class i extends ml{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){let n=this._cachedMeta.vScale,r=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(r[n.axis])}}parseObjectData(e,n,r,a){return Hm.bind(this)(e,n,r,a)}update(e){let n=this._cachedMeta,r=n.dataset,a=n.data||[],s=n.iScale.getLabels();if(r.points=a,e!=="resize"){let o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);let l={_loop:!0,_fullLoop:s.length===a.length,options:o};this.updateElement(r,void 0,l,e)}this.updateElements(a,0,a.length,e)}updateElements(e,n,r,a){let s=this._cachedMeta.rScale,o=a==="reset";for(let l=n;l<n+r;l++){let c=e[l],u=this.resolveDataElementOptions(l,c.active?"active":a),h=s.getPointPositionForValue(l,this.getParsed(l).r),g=o?s.xCenter:h.x,d=o?s.yCenter:h.y,b={x:g,y:d,angle:h.angle,skip:isNaN(g)||isNaN(d),options:u};this.updateElement(c,l,b,a)}}}return i})(),q7=(()=>{class i extends ml{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){let n=this._cachedMeta,r=this.chart.data.labels||[],{xScale:a,yScale:s}=n,o=this.getParsed(e),l=a.getLabelForValue(o.x),c=s.getLabelForValue(o.y);return{label:r[e]||"",value:"("+l+", "+c+")"}}update(e){let n=this._cachedMeta,{data:r=[]}=n,a=this.chart._animationsDisabled,{start:s,count:o}=Mm(n,r,a);if(this._drawStart=s,this._drawCount=o,Lm(n)&&(s=0,o=r.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:l,_dataset:c}=n;l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!c._decimated,l.points=r;let u=this.resolveDatasetElementOptions(e);u.segment=this.options.segment,this.updateElement(l,void 0,{animated:!a,options:u},e)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(r,s,o,e)}addElements(){let{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,n,r,a){let s=a==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:u}=this._cachedMeta,h=this.resolveDataElementOptions(n,a),g=this.getSharedOptions(h),d=this.includeOptions(a,g),b=o.axis,_=l.axis,{spanGaps:w,segment:E}=this.options,A=n0(w)?w:Number.POSITIVE_INFINITY,D=this.chart._animationsDisabled||s||a==="none",N=n>0&&this.getParsed(n-1);for(let z=n;z<n+r;++z){let J=e[z],W=this.getParsed(z),U=D?J:{},M=di(W[_]),X=U[b]=o.getPixelForValue(W[b],z),F=U[_]=s||M?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,W,c):W[_],z);U.skip=isNaN(X)||isNaN(F)||M,U.stop=z>0&&Math.abs(W[b]-N[b])>A,E&&(U.parsed=W,U.raw=u.data[z]),d&&(U.options=g||this.resolveDataElementOptions(z,J.active?"active":a)),D||this.updateElement(J,z,U,a),N=W}this.updateSharedOptions(g,a,h)}getMaxOverflow(){let e=this._cachedMeta,n=e.data||[];if(!this.options.showLine){let l=0;for(let c=n.length-1;c>=0;--c)l=Math.max(l,n[c].size(this.resolveDataElementOptions(c))/2);return l>0&&l}let r=e.dataset,a=r.options&&r.options.borderWidth||0;if(!n.length)return a;let s=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(a,s,o)/2}}return i})(),G7=Object.freeze({__proto__:null,BarController:j7,BubbleController:V7,DoughnutController:Fg,LineController:z7,PieController:H7,PolarAreaController:D5,RadarController:W7,ScatterController:q7});function a0(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var ug=class i{static override(t){Object.assign(i.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return a0()}parse(){return a0()}format(){return a0()}add(){return a0()}diff(){return a0()}startOf(){return a0()}endOf(){return a0()}},$7={_date:ug};function X7(i,t,e,n){let{controller:r,data:a,_sorted:s}=i,o=r._cachedMeta.iScale,l=i.dataset&&i.dataset.options?i.dataset.options.spanGaps:null;if(o&&t===o.axis&&t!=="r"&&s&&a.length){let c=o._reversePixels?sb:Ls;if(n){if(r._sharedOptions){let u=a[0],h=typeof u.getRange=="function"&&u.getRange(t);if(h){let g=c(a,t,e-h),d=c(a,t,e+h);return{lo:g.lo,hi:d.hi}}}}else{let u=c(a,t,e);if(l){let{vScale:h}=r._cachedMeta,{_parsed:g}=i,d=g.slice(0,u.lo+1).reverse().findIndex(_=>!di(_[h.axis]));u.lo-=Math.max(0,d);let b=g.slice(u.hi).findIndex(_=>!di(_[h.axis]));u.hi+=Math.max(0,b)}return u}}return{lo:0,hi:a.length-1}}function Xu(i,t,e,n,r){let a=i.getSortedVisibleDatasetMetas(),s=e[t];for(let o=0,l=a.length;o<l;++o){let{index:c,data:u}=a[o],{lo:h,hi:g}=X7(a[o],t,s,r);for(let d=h;d<=g;++d){let b=u[d];b.skip||n(b,c,d)}}}function Y7(i){let t=i.indexOf("x")!==-1,e=i.indexOf("y")!==-1;return function(n,r){let a=t?Math.abs(n.x-r.x):0,s=e?Math.abs(n.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(s,2))}}function tg(i,t,e,n,r){let a=[];return!r&&!i.isPointInArea(t)||Xu(i,e,t,function(o,l,c){!r&&!Is(o,i.chartArea,0)||o.inRange(t.x,t.y,n)&&a.push({element:o,datasetIndex:l,index:c})},!0),a}function K7(i,t,e,n){let r=[];function a(s,o,l){let{startAngle:c,endAngle:u}=s.getProps(["startAngle","endAngle"],n),{angle:h}=Am(s,{x:t.x,y:t.y});tc(h,c,u)&&r.push({element:s,datasetIndex:o,index:l})}return Xu(i,e,t,a),r}function Z7(i,t,e,n,r,a){let s=[],o=Y7(e),l=Number.POSITIVE_INFINITY;function c(u,h,g){let d=u.inRange(t.x,t.y,r);if(n&&!d)return;let b=u.getCenterPoint(r);if(!(!!a||i.isPointInArea(b))&&!d)return;let w=o(t,b);w<l?(s=[{element:u,datasetIndex:h,index:g}],l=w):w===l&&s.push({element:u,datasetIndex:h,index:g})}return Xu(i,e,t,c),s}function ig(i,t,e,n,r,a){return!a&&!i.isPointInArea(t)?[]:e==="r"&&!n?K7(i,t,e,r):Z7(i,t,e,n,r,a)}function Ob(i,t,e,n,r){let a=[],s=e==="x"?"inXRange":"inYRange",o=!1;return Xu(i,e,t,(l,c,u)=>{l[s]&&l[s](t[e],r)&&(a.push({element:l,datasetIndex:c,index:u}),o=o||l.inRange(t.x,t.y,r))}),n&&!o?[]:a}var J7={evaluateInteractionItems:Xu,modes:{index(i,t,e,n){let r=hl(t,i),a=e.axis||"x",s=e.includeInvisible||!1,o=e.intersect?tg(i,r,a,n,s):ig(i,r,a,!1,n,s),l=[];return o.length?(i.getSortedVisibleDatasetMetas().forEach(c=>{let u=o[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(i,t,e,n){let r=hl(t,i),a=e.axis||"xy",s=e.includeInvisible||!1,o=e.intersect?tg(i,r,a,n,s):ig(i,r,a,!1,n,s);if(o.length>0){let l=o[0].datasetIndex,c=i.getDatasetMeta(l).data;o=[];for(let u=0;u<c.length;++u)o.push({element:c[u],datasetIndex:l,index:u})}return o},point(i,t,e,n){let r=hl(t,i),a=e.axis||"xy",s=e.includeInvisible||!1;return tg(i,r,a,n,s)},nearest(i,t,e,n){let r=hl(t,i),a=e.axis||"xy",s=e.includeInvisible||!1;return ig(i,r,a,e.intersect,n,s)},x(i,t,e,n){let r=hl(t,i);return Ob(i,r,"x",e.intersect,n)},y(i,t,e,n){let r=hl(t,i);return Ob(i,r,"y",e.intersect,n)}}},N5=["left","top","right","bottom"];function ju(i,t){return i.filter(e=>e.pos===t)}function Bb(i,t){return i.filter(e=>N5.indexOf(e.pos)===-1&&e.box.axis===t)}function Vu(i,t){return i.sort((e,n)=>{let r=t?n:e,a=t?e:n;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function Q7(i){let t=[],e,n,r,a,s,o;for(e=0,n=(i||[]).length;e<n;++e)r=i[e],{position:a,options:{stack:s,stackWeight:o=1}}=r,t.push({index:e,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:s&&a+s,stackWeight:o});return t}function eF(i){let t={};for(let e of i){let{stack:n,pos:r,stackWeight:a}=e;if(!n||!N5.includes(r))continue;let s=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});s.count++,s.weight+=a}return t}function tF(i,t){let e=eF(i),{vBoxMaxWidth:n,hBoxMaxHeight:r}=t,a,s,o;for(a=0,s=i.length;a<s;++a){o=i[a];let{fullSize:l}=o.box,c=e[o.stack],u=c&&o.stackWeight/c.weight;o.horizontal?(o.width=u?u*n:l&&t.availableWidth,o.height=r):(o.width=n,o.height=u?u*r:l&&t.availableHeight)}return e}function iF(i){let t=Q7(i),e=Vu(t.filter(c=>c.box.fullSize),!0),n=Vu(ju(t,"left"),!0),r=Vu(ju(t,"right")),a=Vu(ju(t,"top"),!0),s=Vu(ju(t,"bottom")),o=Bb(t,"x"),l=Bb(t,"y");return{fullSize:e,leftAndTop:n.concat(a),rightAndBottom:r.concat(l).concat(s).concat(o),chartArea:ju(t,"chartArea"),vertical:n.concat(r).concat(l),horizontal:a.concat(s).concat(o)}}function jb(i,t,e,n){return Math.max(i[e],t[e])+Math.max(i[n],t[n])}function P5(i,t){i.top=Math.max(i.top,t.top),i.left=Math.max(i.left,t.left),i.bottom=Math.max(i.bottom,t.bottom),i.right=Math.max(i.right,t.right)}function nF(i,t,e,n){let{pos:r,box:a}=e,s=i.maxPadding;if(!fi(r)){e.size&&(i[r]-=e.size);let h=n[e.stack]||{size:0,count:1};h.size=Math.max(h.size,e.horizontal?a.height:a.width),e.size=h.size/h.count,i[r]+=e.size}a.getPadding&&P5(s,a.getPadding());let o=Math.max(0,t.outerWidth-jb(s,i,"left","right")),l=Math.max(0,t.outerHeight-jb(s,i,"top","bottom")),c=o!==i.w,u=l!==i.h;return i.w=o,i.h=l,e.horizontal?{same:c,other:u}:{same:u,other:c}}function rF(i){let t=i.maxPadding;function e(n){let r=Math.max(t[n]-i[n],0);return i[n]+=r,r}i.y+=e("top"),i.x+=e("left"),e("right"),e("bottom")}function aF(i,t){let e=t.maxPadding;function n(r){let a={left:0,top:0,right:0,bottom:0};return r.forEach(s=>{a[s]=Math.max(t[s],e[s])}),a}return n(i?["left","right"]:["top","bottom"])}function Hu(i,t,e,n){let r=[],a,s,o,l,c,u;for(a=0,s=i.length,c=0;a<s;++a){o=i[a],l=o.box,l.update(o.width||t.w,o.height||t.h,aF(o.horizontal,t));let{same:h,other:g}=nF(t,e,o,n);c|=h&&r.length,u=u||g,l.fullSize||r.push(o)}return c&&Hu(r,t,e,n)||u}function Rh(i,t,e,n,r){i.top=e,i.left=t,i.right=t+n,i.bottom=e+r,i.width=n,i.height=r}function Vb(i,t,e,n){let r=e.padding,{x:a,y:s}=t;for(let o of i){let l=o.box,c=n[o.stack]||{count:1,placed:0,weight:1},u=o.stackWeight/c.weight||1;if(o.horizontal){let h=t.w*u,g=c.size||l.height;Q0(c.start)&&(s=c.start),l.fullSize?Rh(l,r.left,s,e.outerWidth-r.right-r.left,g):Rh(l,t.left+c.placed,s,h,g),c.start=s,c.placed+=h,s=l.bottom}else{let h=t.h*u,g=c.size||l.width;Q0(c.start)&&(a=c.start),l.fullSize?Rh(l,a,r.top,g,e.outerHeight-r.bottom-r.top):Rh(l,a,t.top+c.placed,g,h),c.start=a,c.placed+=h,a=l.right}}t.x=a,t.y=s}var zr={addBox(i,t){i.boxes||(i.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},i.boxes.push(t)},removeBox(i,t){let e=i.boxes?i.boxes.indexOf(t):-1;e!==-1&&i.boxes.splice(e,1)},configure(i,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(i,t,e,n){if(!i)return;let r=Ar(i.options.layout.padding),a=Math.max(t-r.width,0),s=Math.max(e-r.height,0),o=iF(i.boxes),l=o.vertical,c=o.horizontal;Ii(i.boxes,_=>{typeof _.beforeLayout=="function"&&_.beforeLayout()});let u=l.reduce((_,w)=>w.box.options&&w.box.options.display===!1?_:_+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:e,padding:r,availableWidth:a,availableHeight:s,vBoxMaxWidth:a/2/u,hBoxMaxHeight:s/2}),g=Object.assign({},r);P5(g,Ar(n));let d=Object.assign({maxPadding:g,w:a,h:s,x:r.left,y:r.top},r),b=tF(l.concat(c),h);Hu(o.fullSize,d,h,b),Hu(l,d,h,b),Hu(c,d,h,b)&&Hu(l,d,h,b),rF(d),Vb(o.leftAndTop,d,h,b),d.x+=d.w,d.y+=d.h,Vb(o.rightAndBottom,d,h,b),i.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h,height:d.h,width:d.w},Ii(o.chartArea,_=>{let w=_.box;Object.assign(w,i.chartArea),w.update(d.w,d.h,{left:0,top:0,right:0,bottom:0})})}},qh=class{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,r){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,r?Math.floor(e/r):n)}}isAttached(t){return!0}updateConfig(t){}},dg=class extends qh{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}},zh="$chartjs",sF={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Ub=i=>i===null||i==="";function oF(i,t){let e=i.style,n=i.getAttribute("height"),r=i.getAttribute("width");if(i[zh]={initial:{height:n,width:r,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",Ub(r)){let a=qm(i,"width");a!==void 0&&(i.width=a)}if(Ub(n))if(i.style.height==="")i.height=i.width/(t||2);else{let a=qm(i,"height");a!==void 0&&(i.height=a)}return i}var M5=Sb?{passive:!0}:!1;function lF(i,t,e){i&&i.addEventListener(t,e,M5)}function cF(i,t,e){i&&i.canvas&&i.canvas.removeEventListener(t,e,M5)}function uF(i,t){let e=sF[i.type]||i.type,{x:n,y:r}=hl(i,t);return{type:e,chart:t,native:i,x:n!==void 0?n:null,y:r!==void 0?r:null}}function Gh(i,t){for(let e of i)if(e===t||e.contains(t))return!0}function dF(i,t,e){let n=i.canvas,r=new MutationObserver(a=>{let s=!1;for(let o of a)s=s||Gh(o.addedNodes,n),s=s&&!Gh(o.removedNodes,n);s&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}function fF(i,t,e){let n=i.canvas,r=new MutationObserver(a=>{let s=!1;for(let o of a)s=s||Gh(o.removedNodes,n),s=s&&!Gh(o.addedNodes,n);s&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}var qu=new Map,zb=0;function L5(){let i=window.devicePixelRatio;i!==zb&&(zb=i,qu.forEach((t,e)=>{e.currentDevicePixelRatio!==i&&t()}))}function hF(i,t){qu.size||window.addEventListener("resize",L5),qu.set(i,t)}function pF(i){qu.delete(i),qu.size||window.removeEventListener("resize",L5)}function mF(i,t,e){let n=i.canvas,r=n&&Lh(n);if(!r)return;let a=Pm((o,l)=>{let c=r.clientWidth;e(o,l),c<r.clientWidth&&e()},window),s=new ResizeObserver(o=>{let l=o[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||a(c,u)});return s.observe(r),hF(i,a),s}function ng(i,t,e){e&&e.disconnect(),t==="resize"&&pF(i)}function gF(i,t,e){let n=i.canvas,r=Pm(a=>{i.ctx!==null&&e(uF(a,i))},i);return lF(n,t,r),r}var fg=class extends qh{acquireContext(t,e){let n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(oF(t,e),n):null}releaseContext(t){let e=t.canvas;if(!e[zh])return!1;let n=e[zh].initial;["height","width"].forEach(a=>{let s=n[a];di(s)?e.removeAttribute(a):e.setAttribute(a,s)});let r=n.style||{};return Object.keys(r).forEach(a=>{e.style[a]=r[a]}),e.width=e.width,delete e[zh],!0}addEventListener(t,e,n){this.removeEventListener(t,e);let r=t.$proxies||(t.$proxies={}),s={attach:dF,detach:fF,resize:mF}[e]||gF;r[e]=s(t,e,n)}removeEventListener(t,e){let n=t.$proxies||(t.$proxies={}),r=n[e];if(!r)return;({attach:ng,detach:ng,resize:ng}[e]||cF)(t,e,r),n[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,r){return yb(t,e,n,r)}isAttached(t){let e=t&&Lh(t);return!!(e&&e.isConnected)}};function xF(i){return!Mh()||typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas?dg:fg}var hs=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){let{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return n0(this.x)&&n0(this.y)}getProps(t,e){let n=this.$animations;if(!e||!n)return this;let r={};return t.forEach(a=>{r[a]=n[a]&&n[a].active()?n[a]._to:this[a]}),r}};function vF(i,t){let e=i.options.ticks,n=_F(i),r=Math.min(e.maxTicksLimit||n,n),a=e.major.enabled?wF(t):[],s=a.length,o=a[0],l=a[s-1],c=[];if(s>r)return yF(t,c,a,s/r),c;let u=bF(a,t,r);if(s>0){let h,g,d=s>1?Math.round((l-o)/(s-1)):null;for(Oh(t,c,u,di(d)?0:o-d,o),h=0,g=s-1;h<g;h++)Oh(t,c,u,a[h],a[h+1]);return Oh(t,c,u,l,di(d)?t.length:l+d),c}return Oh(t,c,u),c}function _F(i){let t=i.options.offset,e=i._tickSize(),n=i._length/e+(t?0:1),r=i._maxLength/e;return Math.floor(Math.min(n,r))}function bF(i,t,e){let n=SF(i),r=t.length/e;if(!n)return Math.max(r,1);let a=nb(n);for(let s=0,o=a.length-1;s<o;s++){let l=a[s];if(l>r)return l}return Math.max(r,1)}function wF(i){let t=[],e,n;for(e=0,n=i.length;e<n;e++)i[e].major&&t.push(e);return t}function yF(i,t,e,n){let r=0,a=e[0],s;for(n=Math.ceil(n),s=0;s<i.length;s++)s===a&&(t.push(i[s]),r++,a=e[r*n])}function Oh(i,t,e,n,r){let a=ei(n,0),s=Math.min(ei(r,i.length),i.length),o=0,l,c,u;for(e=Math.ceil(e),r&&(l=r-n,e=l/Math.floor(l/e)),u=a;u<0;)o++,u=Math.round(a+o*e);for(c=Math.max(a,0);c<s;c++)c===u&&(t.push(i[c]),o++,u=Math.round(a+o*e))}function SF(i){let t=i.length,e,n;if(t<2)return!1;for(n=i[0],e=1;e<t;++e)if(i[e]-i[e-1]!==n)return!1;return n}var CF=i=>i==="left"?"right":i==="right"?"left":i,Hb=(i,t,e)=>t==="top"||t==="left"?i[t]+e:i[t]-e,Wb=(i,t)=>Math.min(t||i,i);function qb(i,t){let e=[],n=i.length/t,r=i.length,a=0;for(;a<r;a+=n)e.push(i[Math.floor(a)]);return e}function EF(i,t,e){let n=i.ticks.length,r=Math.min(t,n-1),a=i._startPixel,s=i._endPixel,o=1e-6,l=i.getPixelForTick(r),c;if(!(e&&(n===1?c=Math.max(l-a,s-l):t===0?c=(i.getPixelForTick(1)-l)/2:c=(l-i.getPixelForTick(r-1))/2,l+=r<t?c:-c,l<a-o||l>s+o)))return l}function kF(i,t){Ii(i,e=>{let n=e.gc,r=n.length/2,a;if(r>t){for(a=0;a<r;++a)delete e.data[n[a]];n.splice(0,r)}})}function Uu(i){return i.drawTicks?i.tickLength:0}function Gb(i,t){if(!i.display)return 0;let e=qn(i.font,t),n=Ar(i.padding);return(an(i.text)?i.text.length:1)*e.lineHeight+n.height}function TF(i,t){return _o(i,{scale:t,type:"scale"})}function AF(i,t,e){return _o(i,{tick:e,index:t,type:"tick"})}function FF(i,t,e){let n=Ah(i);return(e&&t!=="right"||!e&&t==="right")&&(n=CF(n)),n}function DF(i,t,e,n){let{top:r,left:a,bottom:s,right:o,chart:l}=i,{chartArea:c,scales:u}=l,h=0,g,d,b,_=s-r,w=o-a;if(i.isHorizontal()){if(d=Tr(n,a,o),fi(e)){let E=Object.keys(e)[0],A=e[E];b=u[E].getPixelForValue(A)+_-t}else e==="center"?b=(c.bottom+c.top)/2+_-t:b=Hb(i,e,t);g=o-a}else{if(fi(e)){let E=Object.keys(e)[0],A=e[E];d=u[E].getPixelForValue(A)-w+t}else e==="center"?d=(c.left+c.right)/2-w+t:d=Hb(i,e,t);b=Tr(n,s,r),h=e==="left"?-Sn:Sn}return{titleX:d,titleY:b,maxWidth:g,rotation:h}}var o0=class i extends hs{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:r}=this;return t=da(t,Number.POSITIVE_INFINITY),e=da(e,Number.NEGATIVE_INFINITY),n=da(n,Number.POSITIVE_INFINITY),r=da(r,Number.NEGATIVE_INFINITY),{min:da(t,n),max:da(e,r),minDefined:vn(t),maxDefined:vn(e)}}getMinMax(t){let{min:e,max:n,minDefined:r,maxDefined:a}=this.getUserBounds(),s;if(r&&a)return{min:e,max:n};let o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)s=o[l].controller.getMinMax(this,t),r||(e=Math.min(e,s.min)),a||(n=Math.max(n,s.max));return e=a&&e>n?n:e,n=r&&e>n?e:n,{min:da(e,da(n,e)),max:da(n,da(e,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Zi(this.options.beforeUpdate,[this])}update(t,e,n){let{beginAtZero:r,grace:a,ticks:s}=this.options,o=s.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=gb(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let l=o<this.ticks.length;this._convertTicksToLabels(l?qb(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),s.display&&(s.autoSkip||s.source==="auto")&&(this.ticks=vF(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,n;this.isHorizontal()?(e=this.left,n=this.right):(e=this.top,n=this.bottom,t=!t),this._startPixel=e,this._endPixel=n,this._reversePixels=t,this._length=n-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Zi(this.options.afterUpdate,[this])}beforeSetDimensions(){Zi(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Zi(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Zi(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Zi(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){let e=this.options.ticks,n,r,a;for(n=0,r=t.length;n<r;n++)a=t[n],a.label=Zi(e.callback,[a.value,n,t],this)}afterTickToLabelConversion(){Zi(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Zi(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let t=this.options,e=t.ticks,n=Wb(this.ticks.length,t.ticks.maxTicksLimit),r=e.minRotation||0,a=e.maxRotation,s=r,o,l,c;if(!this._isVisible()||!e.display||r>=a||n<=1||!this.isHorizontal()){this.labelRotation=r;return}let u=this._getLabelSizes(),h=u.widest.width,g=u.highest.height,d=rr(this.chart.width-h,0,this.maxWidth);o=t.offset?this.maxWidth/n:d/(n-1),h+6>o&&(o=d/(n-(t.offset?.5:1)),l=this.maxHeight-Uu(t.grid)-e.padding-Gb(t.title,this.chart.options.font),c=Math.sqrt(h*h+g*g),s=kh(Math.min(Math.asin(rr((u.highest.height+6)/o,-1,1)),Math.asin(rr(l/c,-1,1))-Math.asin(rr(g/c,-1,1)))),s=Math.max(r,Math.min(a,s))),this.labelRotation=s}afterCalculateLabelRotation(){Zi(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Zi(this.options.beforeFit,[this])}fit(){let t={width:0,height:0},{chart:e,options:{ticks:n,title:r,grid:a}}=this,s=this._isVisible(),o=this.isHorizontal();if(s){let l=Gb(r,e.options.font);if(o?(t.width=this.maxWidth,t.height=Uu(a)+l):(t.height=this.maxHeight,t.width=Uu(a)+l),n.display&&this.ticks.length){let{first:c,last:u,widest:h,highest:g}=this._getLabelSizes(),d=n.padding*2,b=Ga(this.labelRotation),_=Math.cos(b),w=Math.sin(b);if(o){let E=n.mirror?0:w*h.width+_*g.height;t.height=Math.min(this.maxHeight,t.height+E+d)}else{let E=n.mirror?0:_*h.width+w*g.height;t.width=Math.min(this.maxWidth,t.width+E+d)}this._calculatePadding(c,u,w,_)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,r){let{ticks:{align:a,padding:s},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){let u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1),g=0,d=0;l?c?(g=r*t.width,d=n*e.height):(g=n*t.height,d=r*e.width):a==="start"?d=e.width:a==="end"?g=t.width:a!=="inner"&&(g=t.width/2,d=e.width/2),this.paddingLeft=Math.max((g-u+s)*this.width/(this.width-u),0),this.paddingRight=Math.max((d-h+s)*this.width/(this.width-h),0)}else{let u=e.height/2,h=t.height/2;a==="start"?(u=0,h=t.height):a==="end"&&(u=e.height,h=0),this.paddingTop=u+s,this.paddingBottom=h+s}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Zi(this.options.afterFit,[this])}isHorizontal(){let{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,n;for(e=0,n=t.length;e<n;e++)di(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){let e=this.options.ticks.sampleSize,n=this.ticks;e<n.length&&(n=qb(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){let{ctx:r,_longestTextCache:a}=this,s=[],o=[],l=Math.floor(e/Wb(e,n)),c=0,u=0,h,g,d,b,_,w,E,A,D,N,z;for(h=0;h<e;h+=l){if(b=t[h].label,_=this._resolveTickFontOptions(h),r.font=w=_.string,E=a[w]=a[w]||{data:{},gc:[]},A=_.lineHeight,D=N=0,!di(b)&&!an(b))D=Mu(r,E.data,E.gc,D,b),N=A;else if(an(b))for(g=0,d=b.length;g<d;++g)z=b[g],!di(z)&&!an(z)&&(D=Mu(r,E.data,E.gc,D,z),N+=A);s.push(D),o.push(N),c=Math.max(D,c),u=Math.max(N,u)}kF(a,e);let J=s.indexOf(c),W=o.indexOf(u),U=M=>({width:s[M]||0,height:o[M]||0});return{first:U(0),last:U(e-1),widest:U(J),highest:U(W),widths:s,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){let e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);let e=this._startPixel+t*this._length;return ab(this._alignToPixels?ul(this.chart,e,0):e)}getDecimalForPixel(t){let e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){let e=this.ticks||[];if(t>=0&&t<e.length){let n=e[t];return n.$context||(n.$context=AF(this.getContext(),t,n))}return this.$context||(this.$context=TF(this.chart.getContext(),this))}_tickSize(){let t=this.options.ticks,e=Ga(this.labelRotation),n=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),a=this._getLabelSizes(),s=t.autoSkipPadding||0,o=a?a.widest.width+s:0,l=a?a.highest.height+s:0;return this.isHorizontal()?l*n>o*r?o/n:l/r:l*r<o*n?l/n:o/r}_isVisible(){let t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){let e=this.axis,n=this.chart,r=this.options,{grid:a,position:s,border:o}=r,l=a.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),g=Uu(a),d=[],b=o.setContext(this.getContext()),_=b.display?b.width:0,w=_/2,E=function(ke){return ul(n,ke,_)},A,D,N,z,J,W,U,M,X,F,I,ee;if(s==="top")A=E(this.bottom),W=this.bottom-g,M=A-w,F=E(t.top)+w,ee=t.bottom;else if(s==="bottom")A=E(this.top),F=t.top,ee=E(t.bottom)-w,W=A+w,M=this.top+g;else if(s==="left")A=E(this.right),J=this.right-g,U=A-w,X=E(t.left)+w,I=t.right;else if(s==="right")A=E(this.left),X=t.left,I=E(t.right)-w,J=A+w,U=this.left+g;else if(e==="x"){if(s==="center")A=E((t.top+t.bottom)/2+.5);else if(fi(s)){let ke=Object.keys(s)[0],Fe=s[ke];A=E(this.chart.scales[ke].getPixelForValue(Fe))}F=t.top,ee=t.bottom,W=A+w,M=W+g}else if(e==="y"){if(s==="center")A=E((t.left+t.right)/2);else if(fi(s)){let ke=Object.keys(s)[0],Fe=s[ke];A=E(this.chart.scales[ke].getPixelForValue(Fe))}J=A-w,U=J-g,X=t.left,I=t.right}let le=ei(r.ticks.maxTicksLimit,h),de=Math.max(1,Math.ceil(h/le));for(D=0;D<h;D+=de){let ke=this.getContext(D),Fe=a.setContext(ke),Se=o.setContext(ke),Oe=Fe.lineWidth,Ze=Fe.color,qe=Se.dash||[],k=Se.dashOffset,B=Fe.tickWidth,P=Fe.tickColor,O=Fe.tickBorderDash||[],Q=Fe.tickBorderDashOffset;N=EF(this,D,l),N!==void 0&&(z=ul(n,N,Oe),c?J=U=X=I=z:W=M=F=ee=z,d.push({tx1:J,ty1:W,tx2:U,ty2:M,x1:X,y1:F,x2:I,y2:ee,width:Oe,color:Ze,borderDash:qe,borderDashOffset:k,tickWidth:B,tickColor:P,tickBorderDash:O,tickBorderDashOffset:Q}))}return this._ticksLength=h,this._borderValue=A,d}_computeLabelItems(t){let e=this.axis,n=this.options,{position:r,ticks:a}=n,s=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=a,g=Uu(n.grid),d=g+u,b=h?-u:d,_=-Ga(this.labelRotation),w=[],E,A,D,N,z,J,W,U,M,X,F,I,ee="middle";if(r==="top")J=this.bottom-b,W=this._getXAxisLabelAlignment();else if(r==="bottom")J=this.top+b,W=this._getXAxisLabelAlignment();else if(r==="left"){let de=this._getYAxisLabelAlignment(g);W=de.textAlign,z=de.x}else if(r==="right"){let de=this._getYAxisLabelAlignment(g);W=de.textAlign,z=de.x}else if(e==="x"){if(r==="center")J=(t.top+t.bottom)/2+d;else if(fi(r)){let de=Object.keys(r)[0],ke=r[de];J=this.chart.scales[de].getPixelForValue(ke)+d}W=this._getXAxisLabelAlignment()}else if(e==="y"){if(r==="center")z=(t.left+t.right)/2-d;else if(fi(r)){let de=Object.keys(r)[0],ke=r[de];z=this.chart.scales[de].getPixelForValue(ke)}W=this._getYAxisLabelAlignment(g).textAlign}e==="y"&&(l==="start"?ee="top":l==="end"&&(ee="bottom"));let le=this._getLabelSizes();for(E=0,A=o.length;E<A;++E){D=o[E],N=D.label;let de=a.setContext(this.getContext(E));U=this.getPixelForTick(E)+a.labelOffset,M=this._resolveTickFontOptions(E),X=M.lineHeight,F=an(N)?N.length:1;let ke=F/2,Fe=de.color,Se=de.textStrokeColor,Oe=de.textStrokeWidth,Ze=W;s?(z=U,W==="inner"&&(E===A-1?Ze=this.options.reverse?"left":"right":E===0?Ze=this.options.reverse?"right":"left":Ze="center"),r==="top"?c==="near"||_!==0?I=-F*X+X/2:c==="center"?I=-le.highest.height/2-ke*X+X:I=-le.highest.height+X/2:c==="near"||_!==0?I=X/2:c==="center"?I=le.highest.height/2-ke*X:I=le.highest.height-F*X,h&&(I*=-1),_!==0&&!de.showLabelBackdrop&&(z+=X/2*Math.sin(_))):(J=U,I=(1-F)*X/2);let qe;if(de.showLabelBackdrop){let k=Ar(de.backdropPadding),B=le.heights[E],P=le.widths[E],O=I-k.top,Q=0-k.left;switch(ee){case"middle":O-=B/2;break;case"bottom":O-=B;break}switch(W){case"center":Q-=P/2;break;case"right":Q-=P;break;case"inner":E===A-1?Q-=P:E>0&&(Q-=P/2);break}qe={left:Q,top:O,width:P+k.width,height:B+k.height,color:de.backdropColor}}w.push({label:N,font:M,textOffset:I,options:{rotation:_,color:Fe,strokeColor:Se,strokeWidth:Oe,textAlign:Ze,textBaseline:ee,translation:[z,J],backdrop:qe}})}return w}_getXAxisLabelAlignment(){let{position:t,ticks:e}=this.options;if(-Ga(this.labelRotation))return t==="top"?"left":"right";let r="center";return e.align==="start"?r="left":e.align==="end"?r="right":e.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){let{position:e,ticks:{crossAlign:n,mirror:r,padding:a}}=this.options,s=this._getLabelSizes(),o=t+a,l=s.widest.width,c,u;return e==="left"?r?(u=this.right+a,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-o,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u=this.left)):e==="right"?r?(u=this.left+a,n==="near"?c="right":n==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+o,n==="near"?c="left":n==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;let t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){let{ctx:t,options:{backgroundColor:e},left:n,top:r,width:a,height:s}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,r,a,s),t.restore())}getLineWidthForValue(t){let e=this.options.grid;if(!this._isVisible()||!e.display)return 0;let r=this.ticks.findIndex(a=>a.value===t);return r>=0?e.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){let e=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t)),a,s,o=(l,c,u)=>{!u.width||!u.color||(n.save(),n.lineWidth=u.width,n.strokeStyle=u.color,n.setLineDash(u.borderDash||[]),n.lineDashOffset=u.borderDashOffset,n.beginPath(),n.moveTo(l.x,l.y),n.lineTo(c.x,c.y),n.stroke(),n.restore())};if(e.display)for(a=0,s=r.length;a<s;++a){let l=r[a];e.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),e.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){let{chart:t,ctx:e,options:{border:n,grid:r}}=this,a=n.setContext(this.getContext()),s=n.display?a.width:0;if(!s)return;let o=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue,c,u,h,g;this.isHorizontal()?(c=ul(t,this.left,s)-s/2,u=ul(t,this.right,o)+o/2,h=g=l):(h=ul(t,this.top,s)-s/2,g=ul(t,this.bottom,o)+o/2,c=u=l),e.save(),e.lineWidth=a.width,e.strokeStyle=a.color,e.beginPath(),e.moveTo(c,h),e.lineTo(u,g),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;let n=this.ctx,r=this._computeLabelArea();r&&Ru(n,r);let a=this.getLabelItems(t);for(let s of a){let o=s.options,l=s.font,c=s.label,u=s.textOffset;dl(n,c,0,u,l,o)}r&&Ou(n)}drawTitle(){let{ctx:t,options:{position:e,title:n,reverse:r}}=this;if(!n.display)return;let a=qn(n.font),s=Ar(n.padding),o=n.align,l=a.lineHeight/2;e==="bottom"||e==="center"||fi(e)?(l+=s.bottom,an(n.text)&&(l+=a.lineHeight*(n.text.length-1))):l+=s.top;let{titleX:c,titleY:u,maxWidth:h,rotation:g}=DF(this,l,e,o);dl(t,n.text,0,0,a,{color:n.color,maxWidth:h,rotation:g,textAlign:FF(o,e,r),textBaseline:"middle",translation:[c,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){let t=this.options,e=t.ticks&&t.ticks.z||0,n=ei(t.grid&&t.grid.z,-1),r=ei(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==i.prototype.draw?[{z:e,draw:a=>{this.draw(a)}}]:[{z:n,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(t){let e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[],a,s;for(a=0,s=e.length;a<s;++a){let o=e[a];o[n]===this.id&&(!t||o.type===t)&&r.push(o)}return r}_resolveTickFontOptions(t){let e=this.options.ticks.setContext(this.getContext(t));return qn(e.font)}_maxDigits(){let t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}},sc=class{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){let e=Object.getPrototypeOf(t),n;MF(e)&&(n=this.register(e));let r=this.items,a=t.id,s=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+t);return a in r||(r[a]=t,NF(t,s,n),this.override&&un.override(t.id,t.overrides)),s}get(t){return this.items[t]}unregister(t){let e=this.items,n=t.id,r=this.scope;n in e&&delete e[n],r&&n in un[r]&&(delete un[r][n],this.override&&delete cl[n])}};function NF(i,t,e){let n=K0(Object.create(null),[e?un.get(e):{},un.get(t),i.defaults]);un.set(t,n),i.defaultRoutes&&PF(t,i.defaultRoutes),i.descriptors&&un.describe(t,i.descriptors)}function PF(i,t){Object.keys(t).forEach(e=>{let n=e.split("."),r=n.pop(),a=[i].concat(n).join("."),s=t[e].split("."),o=s.pop(),l=s.join(".");un.route(a,r,l,o)})}function MF(i){return"id"in i&&"defaults"in i}var hg=class{constructor(){this.controllers=new sc(ml,"datasets",!0),this.elements=new sc(hs,"elements"),this.plugins=new sc(Object,"plugins"),this.scales=new sc(o0,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach(r=>{let a=n||this._getRegistryForType(r);n||a.isForType(r)||a===this.plugins&&r.id?this._exec(t,a,r):Ii(r,s=>{let o=n||this._getRegistryForType(s);this._exec(t,o,s)})})}_exec(t,e,n){let r=Eh(t);Zi(n["before"+r],[],n),e[t](n),Zi(n["after"+r],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){let n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){let r=e.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return r}},js=new hg,pg=class{constructor(){this._init=void 0}notify(t,e,n,r){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;let a=r?this._descriptors(t).filter(r):this._descriptors(t),s=this._notify(a,t,e,n);return e==="afterDestroy"&&(this._notify(a,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),s}_notify(t,e,n,r){r=r||{};for(let a of t){let s=a.plugin,o=s[n],l=[e,r,a.options];if(Zi(o,l,s)===!1&&r.cancelable)return!1}return!0}invalidate(){di(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;let e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){let n=t&&t.config,r=ei(n.options&&n.options.plugins,{}),a=LF(n);return r===!1&&!e?[]:RF(t,a,r,e)}_notifyStateChanges(t){let e=this._oldCache||[],n=this._cache,r=(a,s)=>a.filter(o=>!s.some(l=>o.plugin.id===l.plugin.id));this._notify(r(e,n),t,"stop"),this._notify(r(n,e),t,"start")}};function LF(i){let t={},e=[],n=Object.keys(js.plugins.items);for(let a=0;a<n.length;a++)e.push(js.getPlugin(n[a]));let r=i.plugins||[];for(let a=0;a<r.length;a++){let s=r[a];e.indexOf(s)===-1&&(e.push(s),t[s.id]=!0)}return{plugins:e,localIds:t}}function IF(i,t){return!t&&i===!1?null:i===!0?{}:i}function RF(i,{plugins:t,localIds:e},n,r){let a=[],s=i.getContext();for(let o of t){let l=o.id,c=IF(n[l],r);c!==null&&a.push({plugin:o,options:OF(i.config,{plugin:o,local:e[l]},c,s)})}return a}function OF(i,{plugin:t,local:e},n,r){let a=i.pluginScopeKeys(t),s=i.getOptionScopes(n,a);return e&&t.defaults&&s.push(t.defaults),i.createResolver(s,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function mg(i,t){let e=un.datasets[i]||{};return((t.datasets||{})[i]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function BF(i,t){let e=i;return i==="_index_"?e=t:i==="_value_"&&(e=t==="x"?"y":"x"),e}function jF(i,t){return i===t?"_index_":"_value_"}function $b(i){if(i==="x"||i==="y"||i==="r")return i}function VF(i){if(i==="top"||i==="bottom")return"x";if(i==="left"||i==="right")return"y"}function gg(i,...t){if($b(i))return i;for(let e of t){let n=e.axis||VF(e.position)||i.length>1&&$b(i[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${i}' axis. Please provide 'axis' or 'position' option.`)}function Xb(i,t,e){if(e[t+"AxisID"]===i)return{axis:t}}function UF(i,t){if(t.data&&t.data.datasets){let e=t.data.datasets.filter(n=>n.xAxisID===i||n.yAxisID===i);if(e.length)return Xb(i,"x",e[0])||Xb(i,"y",e[0])}return{}}function zF(i,t){let e=cl[i.type]||{scales:{}},n=t.scales||{},r=mg(i.type,t),a=Object.create(null);return Object.keys(n).forEach(s=>{let o=n[s];if(!fi(o))return console.error(`Invalid scale configuration for scale: ${s}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${s}`);let l=gg(s,o,UF(s,i),un.scales[o.type]),c=jF(l,r),u=e.scales||{};a[s]=J0(Object.create(null),[{axis:l},o,u[l],u[c]])}),i.data.datasets.forEach(s=>{let o=s.type||i.type,l=s.indexAxis||mg(o,t),u=(cl[o]||{}).scales||{};Object.keys(u).forEach(h=>{let g=BF(h,l),d=s[g+"AxisID"]||g;a[d]=a[d]||Object.create(null),J0(a[d],[{axis:g},n[d],u[h]])})}),Object.keys(a).forEach(s=>{let o=a[s];J0(o,[un.scales[o.type],un.scale])}),a}function I5(i){let t=i.options||(i.options={});t.plugins=ei(t.plugins,{}),t.scales=zF(i,t)}function R5(i){return i=i||{},i.datasets=i.datasets||[],i.labels=i.labels||[],i}function HF(i){return i=i||{},i.data=R5(i.data),I5(i),i}var Yb=new Map,O5=new Set;function Bh(i,t){let e=Yb.get(i);return e||(e=t(),Yb.set(i,e),O5.add(e)),e}var zu=(i,t,e)=>{let n=vo(t,e);n!==void 0&&i.add(n)},xg=class{constructor(t){this._config=HF(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=R5(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){let t=this._config;this.clearCache(),I5(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Bh(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Bh(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Bh(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){let e=t.id,n=this.type;return Bh(`${n}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){let n=this._scopeCache,r=n.get(t);return(!r||e)&&(r=new Map,n.set(t,r)),r}getOptionScopes(t,e,n){let{options:r,type:a}=this,s=this._cachedScopes(t,n),o=s.get(e);if(o)return o;let l=new Set;e.forEach(u=>{t&&(l.add(t),u.forEach(h=>zu(l,t,h))),u.forEach(h=>zu(l,r,h)),u.forEach(h=>zu(l,cl[a]||{},h)),u.forEach(h=>zu(l,un,h)),u.forEach(h=>zu(l,Fh,h))});let c=Array.from(l);return c.length===0&&c.push(Object.create(null)),O5.has(e)&&s.set(e,c),c}chartOptionScopes(){let{options:t,type:e}=this;return[t,cl[e]||{},un.datasets[e]||{},{type:e},un,Fh]}resolveNamedOptions(t,e,n,r=[""]){let a={$shared:!0},{resolver:s,subPrefixes:o}=Kb(this._resolverCache,t,r),l=s;if(qF(s,e)){a.$shared=!1,n=go(n)?n():n;let c=this.createResolver(t,n,o);l=i0(s,n,c)}for(let c of e)a[c]=l[c];return a}createResolver(t,e,n=[""],r){let{resolver:a}=Kb(this._resolverCache,t,n);return fi(e)?i0(a,e,void 0,r):a}};function Kb(i,t,e){let n=i.get(t);n||(n=new Map,i.set(t,n));let r=e.join(),a=n.get(r);return a||(a={resolver:Ph(t,e),subPrefixes:e.filter(o=>!o.toLowerCase().includes("hover"))},n.set(r,a)),a}var WF=i=>fi(i)&&Object.getOwnPropertyNames(i).some(t=>go(i[t]));function qF(i,t){let{isScriptable:e,isIndexable:n}=Vm(i);for(let r of t){let a=e(r),s=n(r),o=(s||a)&&i[r];if(a&&(go(o)||WF(o))||s&&an(o))return!0}return!1}var GF="4.5.1",$F=["top","bottom","left","right","chartArea"];function Zb(i,t){return i==="top"||i==="bottom"||$F.indexOf(i)===-1&&t==="x"}function Jb(i,t){return function(e,n){return e[i]===n[i]?e[t]-n[t]:e[i]-n[i]}}function Qb(i){let t=i.chart,e=t.options.animation;t.notifyPlugins("afterRender"),Zi(e&&e.onComplete,[i],t)}function XF(i){let t=i.chart,e=t.options.animation;Zi(e&&e.onProgress,[i],t)}function B5(i){return Mh()&&typeof i=="string"?i=document.getElementById(i):i&&i.length&&(i=i[0]),i&&i.canvas&&(i=i.canvas),i}var Hh={},e5=i=>{let t=B5(i);return Object.values(Hh).filter(e=>e.canvas===t).pop()};function YF(i,t,e){let n=Object.keys(i);for(let r of n){let a=+r;if(a>=t){let s=i[r];delete i[r],(e>0||a>t)&&(i[a+e]=s)}}}function KF(i,t,e,n){return!e||i.type==="mouseout"?null:n?t:i}var Kh=(()=>{class i{static defaults=un;static instances=Hh;static overrides=cl;static registry=js;static version=GF;static getChart=e5;static register(...e){js.add(...e),t5()}static unregister(...e){js.remove(...e),t5()}constructor(e,n){let r=this.config=new xg(n),a=B5(e),s=e5(a);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");let o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||xF(a)),this.platform.updateConfig(r);let l=this.platform.acquireContext(a,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,h=c&&c.width;if(this.id=Q_(),this.ctx=l,this.canvas=c,this.width=h,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new pg,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=ub(g=>this.update(g),o.resizeDelay||0),this._dataChanges=[],Hh[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}bo.listen(this,"complete",Qb),bo.listen(this,"progress",XF),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:a,_aspectRatio:s}=this;return di(e)?n&&s?s:a?r/a:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return js}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Wm(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Om(this.canvas,this.ctx),this}stop(){return bo.stop(this),this}resize(e,n){bo.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){let r=this.options,a=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(a,e,n,s),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Wm(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Zi(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){let n=this.options.scales||{};Ii(n,(r,a)=>{r.id=a})}buildOrUpdateScales(){let e=this.options,n=e.scales,r=this.scales,a=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{}),s=[];n&&(s=s.concat(Object.keys(n).map(o=>{let l=n[o],c=gg(o,l),u=c==="r",h=c==="x";return{options:l,dposition:u?"chartArea":h?"bottom":"left",dtype:u?"radialLinear":h?"category":"linear"}}))),Ii(s,o=>{let l=o.options,c=l.id,u=gg(c,l),h=ei(l.type,o.dtype);(l.position===void 0||Zb(l.position,u)!==Zb(o.dposition))&&(l.position=o.dposition),a[c]=!0;let g=null;if(c in r&&r[c].type===h)g=r[c];else{let d=js.getScale(h);g=new d({id:c,type:h,ctx:this.ctx,chart:this}),r[g.id]=g}g.init(l,e)}),Ii(a,(o,l)=>{o||delete r[l]}),Ii(r,o=>{zr.configure(this,o,o.options),zr.addBox(this,o)})}_updateMetasets(){let e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((a,s)=>a.index-s.index),r>n){for(let a=n;a<r;++a)this._destroyDatasetMeta(a);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(Jb("order","index"))}_removeUnreferencedMetasets(){let{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,a)=>{n.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(a)})}buildOrUpdateControllers(){let e=[],n=this.data.datasets,r,a;for(this._removeUnreferencedMetasets(),r=0,a=n.length;r<a;r++){let s=n[r],o=this.getDatasetMeta(r),l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=s.indexAxis||mg(l,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{let c=js.getController(l),{datasetElementType:u,dataElementType:h}=un.datasets[l];Object.assign(c,{dataElementType:js.getElement(h),datasetElementType:u&&js.getElement(u)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Ii(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){let n=this.config;n.update();let r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),a=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;let s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,h=this.data.datasets.length;u<h;u++){let{controller:g}=this.getDatasetMeta(u),d=!a&&s.indexOf(g)===-1;g.buildOrUpdateElements(d),o=Math.max(+g.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),a||Ii(s,u=>{u.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Jb("z","_idx"));let{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Ii(this.scales,e=>{zr.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Cm(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(let{method:r,start:a,count:s}of n){let o=r==="_removeElements"?-s:s;YF(e,a,o)}}_getUniformDataChanges(){let e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];let n=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),a=r(0);for(let s=1;s<n;s++)if(!Cm(a,r(s)))return;return Array.from(a).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;zr.update(this,this.width,this.height,e);let n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Ii(this.boxes,a=>{r&&a.position==="chartArea"||(a.configure&&a.configure(),this._layers.push(...a._layers()))},this),this._layers.forEach((a,s)=>{a._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,go(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){let r=this.getDatasetMeta(e),a={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",a)!==!1&&(r.controller._update(n),a.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",a))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(bo.has(this)?this.attached&&!bo.running(this)&&bo.start(this):(this.draw(),Qb({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){let{width:r,height:a}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,a)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){let n=this._sortedMetasets,r=[],a,s;for(a=0,s=n.length;a<s;++a){let o=n[a];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){let n=this.ctx,r={meta:e,index:e.index,cancelable:!0},a=Km(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(a&&Ru(n,a),e.controller.draw(),a&&Ou(n),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return Is(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,a){let s=J7.modes[n];return typeof s=="function"?s(this,e,r,a):[]}getDatasetMeta(e){let n=this.data.datasets[e],r=this._metasets,a=r.filter(s=>s&&s._dataset===n).pop();return a||(a={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(a)),a}getContext(){return this.$context||(this.$context=_o(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){let n=this.data.datasets[e];if(!n)return!1;let r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){let r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){let a=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,a);Q0(n)?(s.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(l=>l.datasetIndex===e?a:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){let n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),bo.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Om(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Hh[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let e=this._listeners,n=this.platform,r=(s,o)=>{n.addEventListener(this,s,o),e[s]=o},a=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};Ii(this.options.events,s=>r(s,a))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let e=this._responsiveListeners,n=this.platform,r=(c,u)=>{n.addEventListener(this,c,u),e[c]=u},a=(c,u)=>{e[c]&&(n.removeEventListener(this,c,u),delete e[c])},s=(c,u)=>{this.canvas&&this.resize(c,u)},o,l=()=>{a("attach",l),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,a("resize",s),this._stop(),this._resize(0,0),r("attach",l)},n.isAttached(this.canvas)?l():o()}unbindEvents(){Ii(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Ii(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){let a=r?"set":"remove",s,o,l,c;for(n==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+a+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];let u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[a+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){let n=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{let l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!Lu(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){let a=this.options.hover,s=(c,u)=>c.filter(h=>!u.some(g=>h.datasetIndex===g.datasetIndex&&h.index===g.index)),o=s(n,e),l=r?e:s(e,n);o.length&&this.updateHoverStyle(o,a.mode,!1),l.length&&a.mode&&this.updateHoverStyle(l,a.mode,!0)}_eventHandler(e,n){let r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},a=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,a)===!1)return;let s=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,a),(s||r.changed)&&this.render(),this}_handleEvent(e,n,r){let{_active:a=[],options:s}=this,o=n,l=this._getActiveElements(e,a,r,o),c=ib(e),u=KF(e,this._lastEvent,r,c);r&&(this._lastEvent=null,Zi(s.onHover,[e,l,this],this),c&&Zi(s.onClick,[e,l,this],this));let h=!Lu(l,a);return(h||n)&&(this._active=l,this._updateHoverStyles(l,a,n)),this._lastEvent=u,h}_getActiveElements(e,n,r,a){if(e.type==="mouseout")return[];if(!r)return n;let s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,a)}}return i})();function t5(){return Ii(Kh.instances,i=>i._plugins.invalidate())}function ZF(i,t,e){let{startAngle:n,x:r,y:a,outerRadius:s,innerRadius:o,options:l}=t,{borderWidth:c,borderJoinStyle:u}=l,h=Math.min(c/s,kr(n-e));if(i.beginPath(),i.arc(r,a,s-c/2,n+h/2,e-h/2),o>0){let g=Math.min(c/o,kr(n-e));i.arc(r,a,o+c/2,e-g/2,n+g/2,!0)}else{let g=Math.min(c/2,s*kr(n-e));if(u==="round")i.arc(r,a,g,e-Si/2,n+Si/2,!0);else if(u==="bevel"){let d=2*g*g,b=-d*Math.cos(e+Si/2)+r,_=-d*Math.sin(e+Si/2)+a,w=d*Math.cos(n+Si/2)+r,E=d*Math.sin(n+Si/2)+a;i.lineTo(b,_),i.lineTo(w,E)}}i.closePath(),i.moveTo(0,0),i.rect(0,0,i.canvas.width,i.canvas.height),i.clip("evenodd")}function JF(i,t,e){let{startAngle:n,pixelMargin:r,x:a,y:s,outerRadius:o,innerRadius:l}=t,c=r/o;i.beginPath(),i.arc(a,s,o,n-c,e+c),l>r?(c=r/l,i.arc(a,s,l,e+c,n-c,!0)):i.arc(a,s,r,e+Sn,n-Sn),i.closePath(),i.clip()}function QF(i){return Nh(i,["outerStart","outerEnd","innerStart","innerEnd"])}function eD(i,t,e,n){let r=QF(i.options.borderRadius),a=(e-t)/2,s=Math.min(a,n*t/2),o=l=>{let c=(e-Math.min(a,l))*n/2;return rr(l,0,Math.min(a,c))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:rr(r.innerStart,0,s),innerEnd:rr(r.innerEnd,0,s)}}function ac(i,t,e,n){return{x:e+i*Math.cos(t),y:n+i*Math.sin(t)}}function $h(i,t,e,n,r,a){let{x:s,y:o,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+n+e-c,0),g=u>0?u+n+e+c:0,d=0,b=r-l;if(n){let de=u>0?u-n:0,ke=h>0?h-n:0,Fe=(de+ke)/2,Se=Fe!==0?b*Fe/(Fe+n):b;d=(b-Se)/2}let _=Math.max(.001,b*h-e/Si)/h,w=(b-_)/2,E=l+w+d,A=r-w-d,{outerStart:D,outerEnd:N,innerStart:z,innerEnd:J}=eD(t,g,h,A-E),W=h-D,U=h-N,M=E+D/W,X=A-N/U,F=g+z,I=g+J,ee=E+z/F,le=A-J/I;if(i.beginPath(),a){let de=(M+X)/2;if(i.arc(s,o,h,M,de),i.arc(s,o,h,de,X),N>0){let Oe=ac(U,X,s,o);i.arc(Oe.x,Oe.y,N,X,A+Sn)}let ke=ac(I,A,s,o);if(i.lineTo(ke.x,ke.y),J>0){let Oe=ac(I,le,s,o);i.arc(Oe.x,Oe.y,J,A+Sn,le+Math.PI)}let Fe=(A-J/g+(E+z/g))/2;if(i.arc(s,o,g,A-J/g,Fe,!0),i.arc(s,o,g,Fe,E+z/g,!0),z>0){let Oe=ac(F,ee,s,o);i.arc(Oe.x,Oe.y,z,ee+Math.PI,E-Sn)}let Se=ac(W,E,s,o);if(i.lineTo(Se.x,Se.y),D>0){let Oe=ac(W,M,s,o);i.arc(Oe.x,Oe.y,D,E-Sn,M)}}else{i.moveTo(s,o);let de=Math.cos(M)*h+s,ke=Math.sin(M)*h+o;i.lineTo(de,ke);let Fe=Math.cos(X)*h+s,Se=Math.sin(X)*h+o;i.lineTo(Fe,Se)}i.closePath()}function tD(i,t,e,n,r){let{fullCircles:a,startAngle:s,circumference:o}=t,l=t.endAngle;if(a){$h(i,t,e,n,l,r);for(let c=0;c<a;++c)i.fill();isNaN(o)||(l=s+(o%sn||sn))}return $h(i,t,e,n,l,r),i.fill(),l}function iD(i,t,e,n,r){let{fullCircles:a,startAngle:s,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:g,borderRadius:d}=l,b=l.borderAlign==="inner";if(!c)return;i.setLineDash(h||[]),i.lineDashOffset=g,b?(i.lineWidth=c*2,i.lineJoin=u||"round"):(i.lineWidth=c,i.lineJoin=u||"bevel");let _=t.endAngle;if(a){$h(i,t,e,n,_,r);for(let w=0;w<a;++w)i.stroke();isNaN(o)||(_=s+(o%sn||sn))}b&&JF(i,t,_),l.selfJoin&&_-s>=Si&&d===0&&u!=="miter"&&ZF(i,t,_),a||($h(i,t,e,n,_,r),i.stroke())}var vg=class extends hs{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){let r=this.getProps(["x","y"],n),{angle:a,distance:s}=Am(r,{x:t,y:e}),{startAngle:o,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),g=(this.options.spacing+this.options.borderWidth)/2,d=ei(h,l-o),b=tc(a,o,l)&&o!==l,_=d>=sn||b,w=Os(s,c+g,u+g);return _&&w}getCenterPoint(t){let{x:e,y:n,startAngle:r,endAngle:a,innerRadius:s,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:l,spacing:c}=this.options,u=(r+a)/2,h=(s+o+c+l)/2;return{x:e+Math.cos(u)*h,y:n+Math.sin(u)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){let{options:e,circumference:n}=this,r=(e.offset||0)/4,a=(e.spacing||0)/2,s=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=n>sn?Math.floor(n/sn):0,n===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let o=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(o)*r,Math.sin(o)*r);let l=1-Math.sin(Math.min(Si,n||0)),c=r*l;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,tD(t,this,c,a,s),iD(t,this,c,a,s),t.restore()}};function j5(i,t,e=t){i.lineCap=ei(e.borderCapStyle,t.borderCapStyle),i.setLineDash(ei(e.borderDash,t.borderDash)),i.lineDashOffset=ei(e.borderDashOffset,t.borderDashOffset),i.lineJoin=ei(e.borderJoinStyle,t.borderJoinStyle),i.lineWidth=ei(e.borderWidth,t.borderWidth),i.strokeStyle=ei(e.borderColor,t.borderColor)}function nD(i,t,e){i.lineTo(e.x,e.y)}function rD(i){return i.stepped?pb:i.tension||i.cubicInterpolationMode==="monotone"?mb:nD}function V5(i,t,e={}){let n=i.length,{start:r=0,end:a=n-1}=e,{start:s,end:o}=t,l=Math.max(r,s),c=Math.min(a,o),u=r<s&&a<s||r>o&&a>o;return{count:n,start:l,loop:t.loop,ilen:c<l&&!u?n+c-l:c-l}}function aD(i,t,e,n){let{points:r,options:a}=t,{count:s,start:o,loop:l,ilen:c}=V5(r,e,n),u=rD(a),{move:h=!0,reverse:g}=n||{},d,b,_;for(d=0;d<=c;++d)b=r[(o+(g?c-d:d))%s],!b.skip&&(h?(i.moveTo(b.x,b.y),h=!1):u(i,_,b,g,a.stepped),_=b);return l&&(b=r[(o+(g?c:0))%s],u(i,_,b,g,a.stepped)),!!l}function sD(i,t,e,n){let r=t.points,{count:a,start:s,ilen:o}=V5(r,e,n),{move:l=!0,reverse:c}=n||{},u=0,h=0,g,d,b,_,w,E,A=N=>(s+(c?o-N:N))%a,D=()=>{_!==w&&(i.lineTo(u,w),i.lineTo(u,_),i.lineTo(u,E))};for(l&&(d=r[A(0)],i.moveTo(d.x,d.y)),g=0;g<=o;++g){if(d=r[A(g)],d.skip)continue;let N=d.x,z=d.y,J=N|0;J===b?(z<_?_=z:z>w&&(w=z),u=(h*u+N)/++h):(D(),i.lineTo(N,z),b=J,h=0,_=w=z),E=z}D()}function _g(i){let t=i.options,e=t.borderDash&&t.borderDash.length;return!i._decimated&&!i._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?sD:aD}function oD(i){return i.stepped?Cb:i.tension||i.cubicInterpolationMode==="monotone"?Eb:ol}function lD(i,t,e,n){let r=t._path;r||(r=t._path=new Path2D,t.path(r,e,n)&&r.closePath()),j5(i,t.options),i.stroke(r)}function cD(i,t,e,n){let{segments:r,options:a}=t,s=_g(t);for(let o of r)j5(i,a,o.style),i.beginPath(),s(i,t,o,{start:e,end:e+n-1})&&i.closePath(),i.stroke()}var uD=typeof Path2D=="function";function dD(i,t,e,n){uD&&!t.options.segment?lD(i,t,e,n):cD(i,t,e,n)}var Zh=(()=>{class i extends hs{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){let r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){let a=r.spanGaps?this._loop:this._fullLoop;wb(this._points,r,e,a,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Tb(this,this.options.segment))}first(){let e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){let e=this.segments,n=this.points,r=e.length;return r&&n[e[r-1].end]}interpolate(e,n){let r=this.options,a=e[n],s=this.points,o=Ym(this,{property:n,start:a,end:a});if(!o.length)return;let l=[],c=oD(r),u,h;for(u=0,h=o.length;u<h;++u){let{start:g,end:d}=o[u],b=s[g],_=s[d];if(b===_){l.push(b);continue}let w=Math.abs((a-b[n])/(_[n]-b[n])),E=c(b,_,w,r.stepped);E[n]=e[n],l.push(E)}return l.length===1?l[0]:l}pathSegment(e,n,r){return _g(this)(e,this,n,r)}path(e,n,r){let a=this.segments,s=_g(this),o=this._loop;n=n||0,r=r||this.points.length-n;for(let l of a)o&=s(e,this,l,{start:n,end:n+r-1});return!!o}draw(e,n,r,a){let s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),dD(e,this,r,a),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return i})();function i5(i,t,e,n){let r=i.options,{[e]:a}=i.getProps([e],n);return Math.abs(t-a)<r.radius+r.hitRadius}var fD=(()=>{class i extends hs{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,r){let a=this.options,{x:s,y:o}=this.getProps(["x","y"],r);return Math.pow(e-s,2)+Math.pow(n-o,2)<Math.pow(a.hitRadius+a.radius,2)}inXRange(e,n){return i5(this,e,"x",n)}inYRange(e,n){return i5(this,e,"y",n)}getCenterPoint(e){let{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);let r=n&&e.borderWidth||0;return(n+r)*2}draw(e,n){let r=this.options;this.skip||r.radius<.1||!Is(this,n,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Dh(e,r,this.x,this.y))}getRange(){let e=this.options||{};return e.radius+e.hitRadius}}return i})();function U5(i,t){let{x:e,y:n,base:r,width:a,height:s}=i.getProps(["x","y","base","width","height"],t),o,l,c,u,h;return i.horizontal?(h=s/2,o=Math.min(e,r),l=Math.max(e,r),c=n-h,u=n+h):(h=a/2,o=e-h,l=e+h,c=Math.min(n,r),u=Math.max(n,r)),{left:o,top:c,right:l,bottom:u}}function pl(i,t,e,n){return i?0:rr(t,e,n)}function hD(i,t,e){let n=i.options.borderWidth,r=i.borderSkipped,a=jm(n);return{t:pl(r.top,a.top,0,e),r:pl(r.right,a.right,0,t),b:pl(r.bottom,a.bottom,0,e),l:pl(r.left,a.left,0,t)}}function pD(i,t,e){let{enableBorderRadius:n}=i.getProps(["enableBorderRadius"]),r=i.options.borderRadius,a=fl(r),s=Math.min(t,e),o=i.borderSkipped,l=n||fi(r);return{topLeft:pl(!l||o.top||o.left,a.topLeft,0,s),topRight:pl(!l||o.top||o.right,a.topRight,0,s),bottomLeft:pl(!l||o.bottom||o.left,a.bottomLeft,0,s),bottomRight:pl(!l||o.bottom||o.right,a.bottomRight,0,s)}}function mD(i){let t=U5(i),e=t.right-t.left,n=t.bottom-t.top,r=hD(i,e/2,n/2),a=pD(i,e/2,n/2);return{outer:{x:t.left,y:t.top,w:e,h:n,radius:a},inner:{x:t.left+r.l,y:t.top+r.t,w:e-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function rg(i,t,e,n){let r=t===null,a=e===null,o=i&&!(r&&a)&&U5(i,n);return o&&(r||Os(t,o.left,o.right))&&(a||Os(e,o.top,o.bottom))}function gD(i){return i.topLeft||i.topRight||i.bottomLeft||i.bottomRight}function xD(i,t){i.rect(t.x,t.y,t.w,t.h)}function ag(i,t,e={}){let n=i.x!==e.x?-t:0,r=i.y!==e.y?-t:0,a=(i.x+i.w!==e.x+e.w?t:0)-n,s=(i.y+i.h!==e.y+e.h?t:0)-r;return{x:i.x+n,y:i.y+r,w:i.w+a,h:i.h+s,radius:i.radius}}var bg=class extends hs{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){let{inflateAmount:e,options:{borderColor:n,backgroundColor:r}}=this,{inner:a,outer:s}=mD(this),o=gD(s.radius)?nc:xD;t.save(),(s.w!==a.w||s.h!==a.h)&&(t.beginPath(),o(t,ag(s,e,a)),t.clip(),o(t,ag(a,-e,s)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),o(t,ag(a,e)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,e,n){return rg(this,t,e,n)}inXRange(t,e){return rg(this,t,null,e)}inYRange(t,e){return rg(this,null,t,e)}getCenterPoint(t){let{x:e,y:n,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],t);return{x:a?(e+r)/2:e,y:a?n:(n+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}},vD=Object.freeze({__proto__:null,ArcElement:vg,BarElement:bg,LineElement:Zh,PointElement:fD}),wg=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],n5=wg.map(i=>i.replace("rgb(","rgba(").replace(")",", 0.5)"));function z5(i){return wg[i%wg.length]}function H5(i){return n5[i%n5.length]}function _D(i,t){return i.borderColor=z5(t),i.backgroundColor=H5(t),++t}function bD(i,t){return i.backgroundColor=i.data.map(()=>z5(t++)),t}function wD(i,t){return i.backgroundColor=i.data.map(()=>H5(t++)),t}function yD(i){let t=0;return(e,n)=>{let r=i.getDatasetMeta(n).controller;r instanceof Fg?t=bD(e,t):r instanceof D5?t=wD(e,t):r&&(t=_D(e,t))}}function r5(i){let t;for(t in i)if(i[t].borderColor||i[t].backgroundColor)return!0;return!1}function SD(i){return i&&(i.borderColor||i.backgroundColor)}function CD(){return un.borderColor!=="rgba(0,0,0,0.1)"||un.backgroundColor!=="rgba(0,0,0,0.1)"}var ED={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(i,t,e){if(!e.enabled)return;let{data:{datasets:n},options:r}=i.config,{elements:a}=r,s=r5(n)||SD(r)||a&&r5(a)||CD();if(!e.forceOverride&&s)return;let o=yD(i);n.forEach(o)}};function kD(i,t,e,n,r){let a=r.samples||n;if(a>=e)return i.slice(t,t+e);let s=[],o=(e-2)/(a-2),l=0,c=t+e-1,u=t,h,g,d,b,_;for(s[l++]=i[u],h=0;h<a-2;h++){let w=0,E=0,A,D=Math.floor((h+1)*o)+1+t,N=Math.min(Math.floor((h+2)*o)+1,e)+t,z=N-D;for(A=D;A<N;A++)w+=i[A].x,E+=i[A].y;w/=z,E/=z;let J=Math.floor(h*o)+1+t,W=Math.min(Math.floor((h+1)*o)+1,e)+t,{x:U,y:M}=i[u];for(d=b=-1,A=J;A<W;A++)b=.5*Math.abs((U-w)*(i[A].y-M)-(U-i[A].x)*(E-M)),b>d&&(d=b,g=i[A],_=A);s[l++]=g,u=_}return s[l++]=i[c],s}function TD(i,t,e,n){let r=0,a=0,s,o,l,c,u,h,g,d,b,_,w=[],E=t+e-1,A=i[t].x,N=i[E].x-A;for(s=t;s<t+e;++s){o=i[s],l=(o.x-A)/N*n,c=o.y;let z=l|0;if(z===u)c<b?(b=c,h=s):c>_&&(_=c,g=s),r=(a*r+o.x)/++a;else{let J=s-1;if(!di(h)&&!di(g)){let W=Math.min(h,g),U=Math.max(h,g);W!==d&&W!==J&&w.push(It(At({},i[W]),{x:r})),U!==d&&U!==J&&w.push(It(At({},i[U]),{x:r}))}s>0&&J!==d&&w.push(i[J]),w.push(o),u=z,a=0,b=_=c,h=g=d=s}}return w}function W5(i){if(i._decimated){let t=i._data;delete i._decimated,delete i._data,Object.defineProperty(i,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function a5(i){i.data.datasets.forEach(t=>{W5(t)})}function AD(i,t){let e=t.length,n=0,r,{iScale:a}=i,{min:s,max:o,minDefined:l,maxDefined:c}=a.getUserBounds();return l&&(n=rr(Ls(t,a.axis,s).lo,0,e-1)),c?r=rr(Ls(t,a.axis,o).hi+1,n,e)-n:r=e-n,{start:n,count:r}}var FD={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(i,t,e)=>{if(!e.enabled){a5(i);return}let n=i.width;i.data.datasets.forEach((r,a)=>{let{_data:s,indexAxis:o}=r,l=i.getDatasetMeta(a),c=s||r.data;if(rc([o,i.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;let u=i.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||i.options.parsing)return;let{start:h,count:g}=AD(l,c),d=e.threshold||4*n;if(g<=d){W5(r);return}di(s)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(_){this._data=_}}));let b;switch(e.algorithm){case"lttb":b=kD(c,h,g,n,e);break;case"min-max":b=TD(c,h,g,n);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}r._decimated=b})},destroy(i){a5(i)}};function DD(i,t,e){let n=i.segments,r=i.points,a=t.points,s=[];for(let o of n){let{start:l,end:c}=o;c=Jh(l,c,r);let u=yg(e,r[l],r[c],o.loop);if(!t.segments){s.push({source:o,target:u,start:r[l],end:r[c]});continue}let h=Ym(t,u);for(let g of h){let d=yg(e,a[g.start],a[g.end],g.loop),b=Xm(o,r,d);for(let _ of b)s.push({source:_,target:g,start:{[e]:s5(u,d,"start",Math.max)},end:{[e]:s5(u,d,"end",Math.min)}})}}return s}function yg(i,t,e,n){if(n)return;let r=t[i],a=e[i];return i==="angle"&&(r=kr(r),a=kr(a)),{property:i,start:r,end:a}}function ND(i,t){let{x:e=null,y:n=null}=i||{},r=t.points,a=[];return t.segments.forEach(({start:s,end:o})=>{o=Jh(s,o,r);let l=r[s],c=r[o];n!==null?(a.push({x:l.x,y:n}),a.push({x:c.x,y:n})):e!==null&&(a.push({x:e,y:l.y}),a.push({x:e,y:c.y}))}),a}function Jh(i,t,e){for(;t>i;t--){let n=e[t];if(!isNaN(n.x)&&!isNaN(n.y))break}return t}function s5(i,t,e,n){return i&&t?n(i[e],t[e]):i?i[e]:t?t[e]:0}function q5(i,t){let e=[],n=!1;return an(i)?(n=!0,e=i):e=ND(i,t),e.length?new Zh({points:e,options:{tension:0},_loop:n,_fullLoop:n}):null}function o5(i){return i&&i.fill!==!1}function PD(i,t,e){let r=i[t].fill,a=[t],s;if(!e)return r;for(;r!==!1&&a.indexOf(r)===-1;){if(!vn(r))return r;if(s=i[r],!s)return!1;if(s.visible)return r;a.push(r),r=s.fill}return!1}function MD(i,t,e){let n=OD(i);if(fi(n))return isNaN(n.value)?!1:n;let r=parseFloat(n);return vn(r)&&Math.floor(r)===r?LD(n[0],t,r,e):["origin","start","end","stack","shape"].indexOf(n)>=0&&n}function LD(i,t,e,n){return(i==="-"||i==="+")&&(e=t+e),e===t||e<0||e>=n?!1:e}function ID(i,t){let e=null;return i==="start"?e=t.bottom:i==="end"?e=t.top:fi(i)?e=t.getPixelForValue(i.value):t.getBasePixel&&(e=t.getBasePixel()),e}function RD(i,t,e){let n;return i==="start"?n=e:i==="end"?n=t.options.reverse?t.min:t.max:fi(i)?n=i.value:n=t.getBaseValue(),n}function OD(i){let t=i.options,e=t.fill,n=ei(e&&e.target,e);return n===void 0&&(n=!!t.backgroundColor),n===!1||n===null?!1:n===!0?"origin":n}function BD(i){let{scale:t,index:e,line:n}=i,r=[],a=n.segments,s=n.points,o=jD(t,e);o.push(q5({x:null,y:t.bottom},n));for(let l=0;l<a.length;l++){let c=a[l];for(let u=c.start;u<=c.end;u++)VD(r,s[u],o)}return new Zh({points:r,options:{}})}function jD(i,t){let e=[],n=i.getMatchingVisibleMetas("line");for(let r=0;r<n.length;r++){let a=n[r];if(a.index===t)break;a.hidden||e.unshift(a.dataset)}return e}function VD(i,t,e){let n=[];for(let r=0;r<e.length;r++){let a=e[r],{first:s,last:o,point:l}=UD(a,t,"x");if(!(!l||s&&o)){if(s)n.unshift(l);else if(i.push(l),!o)break}}i.push(...n)}function UD(i,t,e){let n=i.interpolate(t,e);if(!n)return{};let r=n[e],a=i.segments,s=i.points,o=!1,l=!1;for(let c=0;c<a.length;c++){let u=a[c],h=s[u.start][e],g=s[u.end][e];if(Os(r,h,g)){o=r===h,l=r===g;break}}return{first:o,last:l,point:n}}var Xh=class{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){let{x:r,y:a,radius:s}=this;return e=e||{start:0,end:sn},t.arc(r,a,s,e.end,e.start,!0),!n.bounds}interpolate(t){let{x:e,y:n,radius:r}=this,a=t.angle;return{x:e+Math.cos(a)*r,y:n+Math.sin(a)*r,angle:a}}};function zD(i){let{chart:t,fill:e,line:n}=i;if(vn(e))return HD(t,e);if(e==="stack")return BD(i);if(e==="shape")return!0;let r=WD(i);return r instanceof Xh?r:q5(r,n)}function HD(i,t){let e=i.getDatasetMeta(t);return e&&i.isDatasetVisible(t)?e.dataset:null}function WD(i){return(i.scale||{}).getPointPositionForValue?GD(i):qD(i)}function qD(i){let{scale:t={},fill:e}=i,n=ID(e,t);if(vn(n)){let r=t.isHorizontal();return{x:r?n:null,y:r?null:n}}return null}function GD(i){let{scale:t,fill:e}=i,n=t.options,r=t.getLabels().length,a=n.reverse?t.max:t.min,s=RD(e,t,a),o=[];if(n.grid.circular){let l=t.getPointPositionForValue(0,a);return new Xh({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(s)})}for(let l=0;l<r;++l)o.push(t.getPointPositionForValue(l,s));return o}function sg(i,t,e){let n=zD(t),{chart:r,index:a,line:s,scale:o,axis:l}=t,c=s.options,u=c.fill,h=c.backgroundColor,{above:g=h,below:d=h}=u||{},b=r.getDatasetMeta(a),_=Km(r,b);n&&s.points.length&&(Ru(i,e),$D(i,{line:s,target:n,above:g,below:d,area:e,scale:o,axis:l,clip:_}),Ou(i))}function $D(i,t){let{line:e,target:n,above:r,below:a,area:s,scale:o,clip:l}=t,c=e._loop?"angle":t.axis;i.save();let u=a;a!==r&&(c==="x"?(l5(i,n,s.top),og(i,{line:e,target:n,color:r,scale:o,property:c,clip:l}),i.restore(),i.save(),l5(i,n,s.bottom)):c==="y"&&(c5(i,n,s.left),og(i,{line:e,target:n,color:a,scale:o,property:c,clip:l}),i.restore(),i.save(),c5(i,n,s.right),u=r)),og(i,{line:e,target:n,color:u,scale:o,property:c,clip:l}),i.restore()}function l5(i,t,e){let{segments:n,points:r}=t,a=!0,s=!1;i.beginPath();for(let o of n){let{start:l,end:c}=o,u=r[l],h=r[Jh(l,c,r)];a?(i.moveTo(u.x,u.y),a=!1):(i.lineTo(u.x,e),i.lineTo(u.x,u.y)),s=!!t.pathSegment(i,o,{move:s}),s?i.closePath():i.lineTo(h.x,e)}i.lineTo(t.first().x,e),i.closePath(),i.clip()}function c5(i,t,e){let{segments:n,points:r}=t,a=!0,s=!1;i.beginPath();for(let o of n){let{start:l,end:c}=o,u=r[l],h=r[Jh(l,c,r)];a?(i.moveTo(u.x,u.y),a=!1):(i.lineTo(e,u.y),i.lineTo(u.x,u.y)),s=!!t.pathSegment(i,o,{move:s}),s?i.closePath():i.lineTo(e,h.y)}i.lineTo(e,t.first().y),i.closePath(),i.clip()}function og(i,t){let{line:e,target:n,property:r,color:a,scale:s,clip:o}=t,l=DD(e,n,r);for(let{source:c,target:u,start:h,end:g}of l){let{style:{backgroundColor:d=a}={}}=c,b=n!==!0;i.save(),i.fillStyle=d,XD(i,s,o,b&&yg(r,h,g)),i.beginPath();let _=!!e.pathSegment(i,c),w;if(b){_?i.closePath():u5(i,n,g,r);let E=!!n.pathSegment(i,u,{move:_,reverse:!0});w=_&&E,w||u5(i,n,h,r)}i.closePath(),i.fill(w?"evenodd":"nonzero"),i.restore()}}function XD(i,t,e,n){let r=t.chart.chartArea,{property:a,start:s,end:o}=n||{};if(a==="x"||a==="y"){let l,c,u,h;a==="x"?(l=s,c=r.top,u=o,h=r.bottom):(l=r.left,c=s,u=r.right,h=o),i.beginPath(),e&&(l=Math.max(l,e.left),u=Math.min(u,e.right),c=Math.max(c,e.top),h=Math.min(h,e.bottom)),i.rect(l,c,u-l,h-c),i.clip()}}function u5(i,t,e,n){let r=t.interpolate(e,n);r&&i.lineTo(r.x,r.y)}var YD={id:"filler",afterDatasetsUpdate(i,t,e){let n=(i.data.datasets||[]).length,r=[],a,s,o,l;for(s=0;s<n;++s)a=i.getDatasetMeta(s),o=a.dataset,l=null,o&&o.options&&o instanceof Zh&&(l={visible:i.isDatasetVisible(s),index:s,fill:MD(o,s,n),chart:i,axis:a.controller.options.indexAxis,scale:a.vScale,line:o}),a.$filler=l,r.push(l);for(s=0;s<n;++s)l=r[s],!(!l||l.fill===!1)&&(l.fill=PD(r,s,e.propagate))},beforeDraw(i,t,e){let n=e.drawTime==="beforeDraw",r=i.getSortedVisibleDatasetMetas(),a=i.chartArea;for(let s=r.length-1;s>=0;--s){let o=r[s].$filler;o&&(o.line.updateControlPoints(a,o.axis),n&&o.fill&&sg(i.ctx,o,a))}},beforeDatasetsDraw(i,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;let n=i.getSortedVisibleDatasetMetas();for(let r=n.length-1;r>=0;--r){let a=n[r].$filler;o5(a)&&sg(i.ctx,a,i.chartArea)}},beforeDatasetDraw(i,t,e){let n=t.meta.$filler;!o5(n)||e.drawTime!=="beforeDatasetDraw"||sg(i.ctx,n,i.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},d5=(i,t)=>{let{boxHeight:e=t,boxWidth:n=t}=i;return i.usePointStyle&&(e=Math.min(e,t),n=i.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:e,itemHeight:Math.max(t,e)}},KD=(i,t)=>i!==null&&t!==null&&i.datasetIndex===t.datasetIndex&&i.index===t.index,Yh=class extends hs{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let t=this.options.labels||{},e=Zi(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(n=>t.filter(n,this.chart.data))),t.sort&&(e=e.sort((n,r)=>t.sort(n,r,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){let{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}let n=t.labels,r=qn(n.font),a=r.size,s=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=d5(n,a),c,u;e.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(s,a,o,l)+10):(u=this.maxHeight,c=this._fitCols(s,r,o,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,r){let{ctx:a,maxWidth:s,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+o,h=t;a.textAlign="left",a.textBaseline="middle";let g=-1,d=-u;return this.legendItems.forEach((b,_)=>{let w=n+e/2+a.measureText(b.text).width;(_===0||c[c.length-1]+w+2*o>s)&&(h+=u,c[c.length-(_>0?0:1)]=0,d+=u,g++),l[_]={left:0,top:d,row:g,width:w,height:r},c[c.length-1]+=w+o}),h}_fitCols(t,e,n,r){let{ctx:a,maxHeight:s,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=s-t,h=o,g=0,d=0,b=0,_=0;return this.legendItems.forEach((w,E)=>{let{itemWidth:A,itemHeight:D}=ZD(n,e,a,w,r);E>0&&d+D+2*o>u&&(h+=g+o,c.push({width:g,height:d}),b+=g+o,_++,g=d=0),l[E]={left:b,top:d,col:_,width:A,height:D},g=Math.max(g,A),d+=D+o}),h+=g,c.push({width:g,height:d}),h}adjustHitBoxes(){if(!this.options.display)return;let t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:r},rtl:a}}=this,s=r0(a,this.left,this.width);if(this.isHorizontal()){let o=0,l=Tr(n,this.left+r,this.right-this.lineWidths[o]);for(let c of e)o!==c.row&&(o=c.row,l=Tr(n,this.left+r,this.right-this.lineWidths[o])),c.top+=this.top+t+r,c.left=s.leftForLtr(s.x(l),c.width),l+=c.width+r}else{let o=0,l=Tr(n,this.top+t+r,this.bottom-this.columnSizes[o].height);for(let c of e)c.col!==o&&(o=c.col,l=Tr(n,this.top+t+r,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+r,c.left=s.leftForLtr(s.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let t=this.ctx;Ru(t,this),this._draw(),Ou(t)}}_draw(){let{options:t,columnSizes:e,lineWidths:n,ctx:r}=this,{align:a,labels:s}=t,o=un.color,l=r0(t.rtl,this.left,this.width),c=qn(s.font),{padding:u}=s,h=c.size,g=h/2,d;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;let{boxWidth:b,boxHeight:_,itemHeight:w}=d5(s,h),E=function(J,W,U){if(isNaN(b)||b<=0||isNaN(_)||_<0)return;r.save();let M=ei(U.lineWidth,1);if(r.fillStyle=ei(U.fillStyle,o),r.lineCap=ei(U.lineCap,"butt"),r.lineDashOffset=ei(U.lineDashOffset,0),r.lineJoin=ei(U.lineJoin,"miter"),r.lineWidth=M,r.strokeStyle=ei(U.strokeStyle,o),r.setLineDash(ei(U.lineDash,[])),s.usePointStyle){let X={radius:_*Math.SQRT2/2,pointStyle:U.pointStyle,rotation:U.rotation,borderWidth:M},F=l.xPlus(J,b/2),I=W+g;Bm(r,X,F,I,s.pointStyleWidth&&b)}else{let X=W+Math.max((h-_)/2,0),F=l.leftForLtr(J,b),I=fl(U.borderRadius);r.beginPath(),Object.values(I).some(ee=>ee!==0)?nc(r,{x:F,y:X,w:b,h:_,radius:I}):r.rect(F,X,b,_),r.fill(),M!==0&&r.stroke()}r.restore()},A=function(J,W,U){dl(r,U.text,J,W+w/2,c,{strikethrough:U.hidden,textAlign:l.textAlign(U.textAlign)})},D=this.isHorizontal(),N=this._computeTitleHeight();D?d={x:Tr(a,this.left+u,this.right-n[0]),y:this.top+u+N,line:0}:d={x:this.left+u,y:Tr(a,this.top+N+u,this.bottom-e[0].height),line:0},Gm(this.ctx,t.textDirection);let z=w+u;this.legendItems.forEach((J,W)=>{r.strokeStyle=J.fontColor,r.fillStyle=J.fontColor;let U=r.measureText(J.text).width,M=l.textAlign(J.textAlign||(J.textAlign=s.textAlign)),X=b+g+U,F=d.x,I=d.y;l.setWidth(this.width),D?W>0&&F+X+u>this.right&&(I=d.y+=z,d.line++,F=d.x=Tr(a,this.left+u,this.right-n[d.line])):W>0&&I+z>this.bottom&&(F=d.x=F+e[d.line].width+u,d.line++,I=d.y=Tr(a,this.top+N+u,this.bottom-e[d.line].height));let ee=l.x(F);if(E(ee,I,J),F=db(M,F+b+g,D?F+X:this.right,t.rtl),A(l.x(F),I,J),D)d.x+=X+u;else if(typeof J.text!="string"){let le=c.lineHeight;d.y+=G5(J,le)+u}else d.y+=z}),$m(this.ctx,t.textDirection)}drawTitle(){let t=this.options,e=t.title,n=qn(e.font),r=Ar(e.padding);if(!e.display)return;let a=r0(t.rtl,this.left,this.width),s=this.ctx,o=e.position,l=n.size/2,c=r.top+l,u,h=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),u=this.top+c,h=Tr(t.align,h,this.right-g);else{let b=this.columnSizes.reduce((_,w)=>Math.max(_,w.height),0);u=c+Tr(t.align,this.top,this.bottom-b-t.labels.padding-this._computeTitleHeight())}let d=Tr(o,h,h+g);s.textAlign=a.textAlign(Ah(o)),s.textBaseline="middle",s.strokeStyle=e.color,s.fillStyle=e.color,s.font=n.string,dl(s,e.text,d,u,n)}_computeTitleHeight(){let t=this.options.title,e=qn(t.font),n=Ar(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,r,a;if(Os(t,this.left,this.right)&&Os(e,this.top,this.bottom)){for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(r=a[n],Os(t,r.left,r.left+r.width)&&Os(e,r.top,r.top+r.height))return this.legendItems[n]}return null}handleEvent(t){let e=this.options;if(!eN(t.type,e))return;let n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){let r=this._hoveredItem,a=KD(r,n);r&&!a&&Zi(e.onLeave,[t,r,this],this),this._hoveredItem=n,n&&!a&&Zi(e.onHover,[t,n,this],this)}else n&&Zi(e.onClick,[t,n,this],this)}};function ZD(i,t,e,n,r){let a=JD(n,i,t,e),s=QD(r,n,t.lineHeight);return{itemWidth:a,itemHeight:s}}function JD(i,t,e,n){let r=i.text;return r&&typeof r!="string"&&(r=r.reduce((a,s)=>a.length>s.length?a:s)),t+e.size/2+n.measureText(r).width}function QD(i,t,e){let n=i;return typeof t.text!="string"&&(n=G5(t,e)),n}function G5(i,t){let e=i.text?i.text.length:0;return t*e}function eN(i,t){return!!((i==="mousemove"||i==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(i==="click"||i==="mouseup"))}var tN={id:"legend",_element:Yh,start(i,t,e){let n=i.legend=new Yh({ctx:i.ctx,options:e,chart:i});zr.configure(i,n,e),zr.addBox(i,n)},stop(i){zr.removeBox(i,i.legend),delete i.legend},beforeUpdate(i,t,e){let n=i.legend;zr.configure(i,n,e),n.options=e},afterUpdate(i){let t=i.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(i,t){t.replay||i.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(i,t,e){let n=t.datasetIndex,r=e.chart;r.isDatasetVisible(n)?(r.hide(n),t.hidden=!0):(r.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:i=>i.chart.options.color,boxWidth:40,padding:10,generateLabels(i){let t=i.data.datasets,{labels:{usePointStyle:e,pointStyle:n,textAlign:r,color:a,useBorderRadius:s,borderRadius:o}}=i.legend.options;return i._getSortedDatasetMetas().map(l=>{let c=l.controller.getStyle(e?0:void 0),u=Ar(c.borderWidth);return{text:t[l.index].label,fillStyle:c.backgroundColor,fontColor:a,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:n||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:s&&(o||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:i=>i.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:i=>!i.startsWith("on"),labels:{_scriptable:i=>!["generateLabels","filter","sort"].includes(i)}}},Gu=class extends hs{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){let n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;let r=an(n.text)?n.text.length:1;this._padding=Ar(n.padding);let a=r*qn(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){let t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){let{top:e,left:n,bottom:r,right:a,options:s}=this,o=s.align,l=0,c,u,h;return this.isHorizontal()?(u=Tr(o,n,a),h=e+t,c=a-n):(s.position==="left"?(u=n+t,h=Tr(o,r,e),l=Si*-.5):(u=a-t,h=Tr(o,e,r),l=Si*.5),c=r-e),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){let t=this.ctx,e=this.options;if(!e.display)return;let n=qn(e.font),a=n.lineHeight/2+this._padding.top,{titleX:s,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(a);dl(t,e.text,0,0,n,{color:e.color,maxWidth:l,rotation:c,textAlign:Ah(e.align),textBaseline:"middle",translation:[s,o]})}};function iN(i,t){let e=new Gu({ctx:i.ctx,options:t,chart:i});zr.configure(i,e,t),zr.addBox(i,e),i.titleBlock=e}var nN={id:"title",_element:Gu,start(i,t,e){iN(i,e)},stop(i){let t=i.titleBlock;zr.removeBox(i,t),delete i.titleBlock},beforeUpdate(i,t,e){let n=i.titleBlock;zr.configure(i,n,e),n.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},jh=new WeakMap,rN={id:"subtitle",start(i,t,e){let n=new Gu({ctx:i.ctx,options:e,chart:i});zr.configure(i,n,e),zr.addBox(i,n),jh.set(i,n)},stop(i){zr.removeBox(i,jh.get(i)),jh.delete(i)},beforeUpdate(i,t,e){let n=jh.get(i);zr.configure(i,n,e),n.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Wu={average(i){if(!i.length)return!1;let t,e,n=new Set,r=0,a=0;for(t=0,e=i.length;t<e;++t){let o=i[t].element;if(o&&o.hasValue()){let l=o.tooltipPosition();n.add(l.x),r+=l.y,++a}}return a===0||n.size===0?!1:{x:[...n].reduce((o,l)=>o+l)/n.size,y:r/a}},nearest(i,t){if(!i.length)return!1;let e=t.x,n=t.y,r=Number.POSITIVE_INFINITY,a,s,o;for(a=0,s=i.length;a<s;++a){let l=i[a].element;if(l&&l.hasValue()){let c=l.getCenterPoint(),u=Sh(t,c);u<r&&(r=u,o=l)}}if(o){let l=o.tooltipPosition();e=l.x,n=l.y}return{x:e,y:n}}};function Bs(i,t){return t&&(an(t)?Array.prototype.push.apply(i,t):i.push(t)),i}function wo(i){return(typeof i=="string"||i instanceof String)&&i.indexOf(`
`)>-1?i.split(`
`):i}function aN(i,t){let{element:e,datasetIndex:n,index:r}=t,a=i.getDatasetMeta(n).controller,{label:s,value:o}=a.getLabelAndValue(r);return{chart:i,label:s,parsed:a.getParsed(r),raw:i.data.datasets[n].data[r],formattedValue:o,dataset:a.getDataset(),dataIndex:r,datasetIndex:n,element:e}}function f5(i,t){let e=i.chart.ctx,{body:n,footer:r,title:a}=i,{boxWidth:s,boxHeight:o}=t,l=qn(t.bodyFont),c=qn(t.titleFont),u=qn(t.footerFont),h=a.length,g=r.length,d=n.length,b=Ar(t.padding),_=b.height,w=0,E=n.reduce((N,z)=>N+z.before.length+z.lines.length+z.after.length,0);if(E+=i.beforeBody.length+i.afterBody.length,h&&(_+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),E){let N=t.displayColors?Math.max(o,l.lineHeight):l.lineHeight;_+=d*N+(E-d)*l.lineHeight+(E-1)*t.bodySpacing}g&&(_+=t.footerMarginTop+g*u.lineHeight+(g-1)*t.footerSpacing);let A=0,D=function(N){w=Math.max(w,e.measureText(N).width+A)};return e.save(),e.font=c.string,Ii(i.title,D),e.font=l.string,Ii(i.beforeBody.concat(i.afterBody),D),A=t.displayColors?s+2+t.boxPadding:0,Ii(n,N=>{Ii(N.before,D),Ii(N.lines,D),Ii(N.after,D)}),A=0,e.font=u.string,Ii(i.footer,D),e.restore(),w+=b.width,{width:w,height:_}}function sN(i,t){let{y:e,height:n}=t;return e<n/2?"top":e>i.height-n/2?"bottom":"center"}function oN(i,t,e,n){let{x:r,width:a}=n,s=e.caretSize+e.caretPadding;if(i==="left"&&r+a+s>t.width||i==="right"&&r-a-s<0)return!0}function lN(i,t,e,n){let{x:r,width:a}=e,{width:s,chartArea:{left:o,right:l}}=i,c="center";return n==="center"?c=r<=(o+l)/2?"left":"right":r<=a/2?c="left":r>=s-a/2&&(c="right"),oN(c,i,t,e)&&(c="center"),c}function h5(i,t,e){let n=e.yAlign||t.yAlign||sN(i,e);return{xAlign:e.xAlign||t.xAlign||lN(i,t,e,n),yAlign:n}}function cN(i,t){let{x:e,width:n}=i;return t==="right"?e-=n:t==="center"&&(e-=n/2),e}function uN(i,t,e){let{y:n,height:r}=i;return t==="top"?n+=e:t==="bottom"?n-=r+e:n-=r/2,n}function p5(i,t,e,n){let{caretSize:r,caretPadding:a,cornerRadius:s}=i,{xAlign:o,yAlign:l}=e,c=r+a,{topLeft:u,topRight:h,bottomLeft:g,bottomRight:d}=fl(s),b=cN(t,o),_=uN(t,l,c);return l==="center"?o==="left"?b+=c:o==="right"&&(b-=c):o==="left"?b-=Math.max(u,g)+r:o==="right"&&(b+=Math.max(h,d)+r),{x:rr(b,0,n.width-t.width),y:rr(_,0,n.height-t.height)}}function Vh(i,t,e){let n=Ar(e.padding);return t==="center"?i.x+i.width/2:t==="right"?i.x+i.width-n.right:i.x+n.left}function m5(i){return Bs([],wo(i))}function dN(i,t,e){return _o(i,{tooltip:t,tooltipItems:e,type:"tooltip"})}function g5(i,t){let e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?i.override(e):i}var $5={beforeTitle:Rs,title(i){if(i.length>0){let t=i[0],e=t.chart.data.labels,n=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return e[t.dataIndex]}return""},afterTitle:Rs,beforeBody:Rs,beforeLabel:Rs,label(i){if(this&&this.options&&this.options.mode==="dataset")return i.label+": "+i.formattedValue||i.formattedValue;let t=i.dataset.label||"";t&&(t+=": ");let e=i.formattedValue;return di(e)||(t+=e),t},labelColor(i){let e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(i){let e=i.chart.getDatasetMeta(i.datasetIndex).controller.getStyle(i.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Rs,afterBody:Rs,beforeFooter:Rs,footer:Rs,afterFooter:Rs};function fa(i,t,e,n){let r=i[t].call(e,n);return typeof r>"u"?$5[t].call(e,n):r}var x5=(()=>{class i extends hs{static positioners=Wu;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let e=this._cachedAnimations;if(e)return e;let n=this.chart,r=this.options.setContext(this.getContext()),a=r.enabled&&n.options.animation&&r.animations,s=new Wh(this.chart,a);return a._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=dN(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){let{callbacks:r}=n,a=fa(r,"beforeTitle",this,e),s=fa(r,"title",this,e),o=fa(r,"afterTitle",this,e),l=[];return l=Bs(l,wo(a)),l=Bs(l,wo(s)),l=Bs(l,wo(o)),l}getBeforeBody(e,n){return m5(fa(n.callbacks,"beforeBody",this,e))}getBody(e,n){let{callbacks:r}=n,a=[];return Ii(e,s=>{let o={before:[],lines:[],after:[]},l=g5(r,s);Bs(o.before,wo(fa(l,"beforeLabel",this,s))),Bs(o.lines,fa(l,"label",this,s)),Bs(o.after,wo(fa(l,"afterLabel",this,s))),a.push(o)}),a}getAfterBody(e,n){return m5(fa(n.callbacks,"afterBody",this,e))}getFooter(e,n){let{callbacks:r}=n,a=fa(r,"beforeFooter",this,e),s=fa(r,"footer",this,e),o=fa(r,"afterFooter",this,e),l=[];return l=Bs(l,wo(a)),l=Bs(l,wo(s)),l=Bs(l,wo(o)),l}_createItems(e){let n=this._active,r=this.chart.data,a=[],s=[],o=[],l=[],c,u;for(c=0,u=n.length;c<u;++c)l.push(aN(this.chart,n[c]));return e.filter&&(l=l.filter((h,g,d)=>e.filter(h,g,d,r))),e.itemSort&&(l=l.sort((h,g)=>e.itemSort(h,g,r))),Ii(l,h=>{let g=g5(e.callbacks,h);a.push(fa(g,"labelColor",this,h)),s.push(fa(g,"labelPointStyle",this,h)),o.push(fa(g,"labelTextColor",this,h))}),this.labelColors=a,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,n){let r=this.options.setContext(this.getContext()),a=this._active,s,o=[];if(!a.length)this.opacity!==0&&(s={opacity:0});else{let l=Wu[r.position].call(this,a,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);let c=this._size=f5(this,r),u=Object.assign({},l,c),h=h5(this.chart,r,u),g=p5(r,u,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,s={opacity:1,x:g.x,y:g.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,a){let s=this.getCaretPosition(e,r,a);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(e,n,r){let{xAlign:a,yAlign:s}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:u,bottomLeft:h,bottomRight:g}=fl(l),{x:d,y:b}=e,{width:_,height:w}=n,E,A,D,N,z,J;return s==="center"?(z=b+w/2,a==="left"?(E=d,A=E-o,N=z+o,J=z-o):(E=d+_,A=E+o,N=z-o,J=z+o),D=E):(a==="left"?A=d+Math.max(c,h)+o:a==="right"?A=d+_-Math.max(u,g)-o:A=this.caretX,s==="top"?(N=b,z=N-o,E=A-o,D=A+o):(N=b+w,z=N+o,E=A+o,D=A-o),J=N),{x1:E,x2:A,x3:D,y1:N,y2:z,y3:J}}drawTitle(e,n,r){let a=this.title,s=a.length,o,l,c;if(s){let u=r0(r.rtl,this.x,this.width);for(e.x=Vh(this,r.titleAlign,r),n.textAlign=u.textAlign(r.titleAlign),n.textBaseline="middle",o=qn(r.titleFont),l=r.titleSpacing,n.fillStyle=r.titleColor,n.font=o.string,c=0;c<s;++c)n.fillText(a[c],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===s&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,n,r,a,s){let o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:u}=s,h=qn(s.bodyFont),g=Vh(this,"left",s),d=a.x(g),b=c<h.lineHeight?(h.lineHeight-c)/2:0,_=n.y+b;if(s.usePointStyle){let w={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},E=a.leftForLtr(d,u)+u/2,A=_+c/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Dh(e,w,E,A),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Dh(e,w,E,A)}else{e.lineWidth=fi(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;let w=a.leftForLtr(d,u),E=a.leftForLtr(a.xPlus(d,1),u-2),A=fl(o.borderRadius);Object.values(A).some(D=>D!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,nc(e,{x:w,y:_,w:u,h:c,radius:A}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),nc(e,{x:E,y:_+1,w:u-2,h:c-2,radius:A}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(w,_,u,c),e.strokeRect(w,_,u,c),e.fillStyle=o.backgroundColor,e.fillRect(E,_+1,u-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){let{body:a}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:h}=r,g=qn(r.bodyFont),d=g.lineHeight,b=0,_=r0(r.rtl,this.x,this.width),w=function(M){n.fillText(M,_.x(e.x+b),e.y+d/2),e.y+=d+s},E=_.textAlign(o),A,D,N,z,J,W,U;for(n.textAlign=o,n.textBaseline="middle",n.font=g.string,e.x=Vh(this,E,r),n.fillStyle=r.bodyColor,Ii(this.beforeBody,w),b=l&&E!=="right"?o==="center"?u/2+h:u+2+h:0,z=0,W=a.length;z<W;++z){for(A=a[z],D=this.labelTextColors[z],n.fillStyle=D,Ii(A.before,w),N=A.lines,l&&N.length&&(this._drawColorBox(n,e,z,_,r),d=Math.max(g.lineHeight,c)),J=0,U=N.length;J<U;++J)w(N[J]),d=g.lineHeight;Ii(A.after,w)}b=0,d=g.lineHeight,Ii(this.afterBody,w),e.y-=s}drawFooter(e,n,r){let a=this.footer,s=a.length,o,l;if(s){let c=r0(r.rtl,this.x,this.width);for(e.x=Vh(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=c.textAlign(r.footerAlign),n.textBaseline="middle",o=qn(r.footerFont),n.fillStyle=r.footerColor,n.font=o.string,l=0;l<s;++l)n.fillText(a[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,n,r,a){let{xAlign:s,yAlign:o}=this,{x:l,y:c}=e,{width:u,height:h}=r,{topLeft:g,topRight:d,bottomLeft:b,bottomRight:_}=fl(a.cornerRadius);n.fillStyle=a.backgroundColor,n.strokeStyle=a.borderColor,n.lineWidth=a.borderWidth,n.beginPath(),n.moveTo(l+g,c),o==="top"&&this.drawCaret(e,n,r,a),n.lineTo(l+u-d,c),n.quadraticCurveTo(l+u,c,l+u,c+d),o==="center"&&s==="right"&&this.drawCaret(e,n,r,a),n.lineTo(l+u,c+h-_),n.quadraticCurveTo(l+u,c+h,l+u-_,c+h),o==="bottom"&&this.drawCaret(e,n,r,a),n.lineTo(l+b,c+h),n.quadraticCurveTo(l,c+h,l,c+h-b),o==="center"&&s==="left"&&this.drawCaret(e,n,r,a),n.lineTo(l,c+g),n.quadraticCurveTo(l,c,l+g,c),n.closePath(),n.fill(),a.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){let n=this.chart,r=this.$animations,a=r&&r.x,s=r&&r.y;if(a||s){let o=Wu[e.position].call(this,this._active,this._eventPosition);if(!o)return;let l=this._size=f5(this,e),c=Object.assign({},o,this._size),u=h5(n,e,c),h=p5(e,c,u,n);(a._to!==h.x||s._to!==h.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){let n=this.options.setContext(this.getContext()),r=this.opacity;if(!r)return;this._updateAnimationTarget(n);let a={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;let o=Ar(n.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,a,n),Gm(e,n.textDirection),s.y+=o.top,this.drawTitle(s,e,n),this.drawBody(s,e,n),this.drawFooter(s,e,n),$m(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){let r=this._active,a=e.map(({datasetIndex:l,index:c})=>{let u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),s=!Lu(r,a),o=this._positionChanged(a,n);(s||o)&&(this._active=a,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let a=this.options,s=this._active||[],o=this._getActiveElements(e,s,n,r),l=this._positionChanged(o,e),c=n||!Lu(o,s)||l;return c&&(this._active=o,(a.enabled||a.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),c}_getActiveElements(e,n,r,a){let s=this.options;if(e.type==="mouseout")return[];if(!a)return n.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);let o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,n){let{caretX:r,caretY:a,options:s}=this,o=Wu[s.position].call(this,e,n);return o!==!1&&(r!==o.x||a!==o.y)}}return i})(),fN={id:"tooltip",_element:x5,positioners:Wu,afterInit(i,t,e){e&&(i.tooltip=new x5({chart:i,options:e}))},beforeUpdate(i,t,e){i.tooltip&&i.tooltip.initialize(e)},reset(i,t,e){i.tooltip&&i.tooltip.initialize(e)},afterDraw(i){let t=i.tooltip;if(t&&t._willRender()){let e={tooltip:t};if(i.notifyPlugins("beforeTooltipDraw",It(At({},e),{cancelable:!0}))===!1)return;t.draw(i.ctx),i.notifyPlugins("afterTooltipDraw",e)}},afterEvent(i,t){if(i.tooltip){let e=t.replay;i.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(i,t)=>t.bodyFont.size,boxWidth:(i,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:$5},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:i=>i!=="filter"&&i!=="itemSort"&&i!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},hN=Object.freeze({__proto__:null,Colors:ED,Decimation:FD,Filler:YD,Legend:tN,SubTitle:rN,Title:nN,Tooltip:fN}),pN=(i,t,e,n)=>(typeof t=="string"?(e=i.push(t)-1,n.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function mN(i,t,e,n){let r=i.indexOf(t);if(r===-1)return pN(i,t,e,n);let a=i.lastIndexOf(t);return r!==a?e:r}var gN=(i,t)=>i===null?null:rr(Math.round(i),0,t);function v5(i){let t=this.getLabels();return i>=0&&i<t.length?t[i]:i}var xN=(()=>{class i extends o0{static id="category";static defaults={ticks:{callback:v5}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){let n=this._addedLabels;if(n.length){let r=this.getLabels();for(let{index:a,label:s}of n)r[a]===s&&r.splice(a,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(di(e))return null;let r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:mN(r,e,ei(n,e),this._addedLabels),gN(n,r.length-1)}determineDataLimits(){let{minDefined:e,maxDefined:n}=this.getUserBounds(),{min:r,max:a}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(a=this.getLabels().length-1)),this.min=r,this.max=a}buildTicks(){let e=this.min,n=this.max,r=this.options.offset,a=[],s=this.getLabels();s=e===0&&n===s.length-1?s:s.slice(e,n+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=n;o++)a.push({value:o});return a}getLabelForValue(e){return v5.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){let n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}return i})();function vN(i,t){let e=[],{bounds:r,step:a,min:s,max:o,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:g}=i,d=a||1,b=u-1,{min:_,max:w}=t,E=!di(s),A=!di(o),D=!di(c),N=(w-_)/(h+1),z=Em((w-_)/b/d)*d,J,W,U,M;if(z<1e-14&&!E&&!A)return[{value:_},{value:w}];M=Math.ceil(w/z)-Math.floor(_/z),M>b&&(z=Em(M*z/b/d)*d),di(l)||(J=Math.pow(10,l),z=Math.ceil(z*J)/J),r==="ticks"?(W=Math.floor(_/z)*z,U=Math.ceil(w/z)*z):(W=_,U=w),E&&A&&a&&rb((o-s)/a,z/1e3)?(M=Math.round(Math.min((o-s)/z,u)),z=(o-s)/M,W=s,U=o):D?(W=E?s:W,U=A?o:U,M=c-1,z=(U-W)/M):(M=(U-W)/z,ec(M,Math.round(M),z/1e3)?M=Math.round(M):M=Math.ceil(M));let X=Math.max(Tm(z),Tm(W));J=Math.pow(10,di(l)?X:l),W=Math.round(W*J)/J,U=Math.round(U*J)/J;let F=0;for(E&&(g&&W!==s?(e.push({value:s}),W<s&&F++,ec(Math.round((W+F*z)*J)/J,s,_5(s,N,i))&&F++):W<s&&F++);F<M;++F){let I=Math.round((W+F*z)*J)/J;if(A&&I>o)break;e.push({value:I})}return A&&g&&U!==o?e.length&&ec(e[e.length-1].value,o,_5(o,N,i))?e[e.length-1].value=o:e.push({value:o}):(!A||U===o)&&e.push({value:U}),e}function _5(i,t,{horizontal:e,minRotation:n}){let r=Ga(n),a=(e?Math.sin(r):Math.cos(r))||.001,s=.75*t*(""+i).length;return Math.min(t/a,s)}var oc=class extends o0{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return di(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){let{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds(),{min:r,max:a}=this,s=l=>r=e?r:l,o=l=>a=n?a:l;if(t){let l=fs(r),c=fs(a);l<0&&c<0?o(0):l>0&&c>0&&s(0)}if(r===a){let l=a===0?1:Math.abs(a*.05);o(a+l),t||s(r-l)}this.min=r,this.max=a}getTickLimit(){let t=this.options.ticks,{maxTicksLimit:e,stepSize:n}=t,r;return n?(r=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),e=e||11),e&&(r=Math.min(e,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let t=this.options,e=t.ticks,n=this.getTickLimit();n=Math.max(2,n);let r={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},a=this._range||this,s=vN(r,a);return t.bounds==="ticks"&&km(s,this,"value"),t.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}configure(){let t=this.ticks,e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){let r=(n-e)/Math.max(t.length-1,1)/2;e-=r,n+=r}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return ic(t,this.chart.options.locale,this.options.ticks.format)}},Sg=class extends oc{static id="linear";static defaults={ticks:{callback:Iu.formatters.numeric}};determineDataLimits(){let{min:t,max:e}=this.getMinMax(!0);this.min=vn(t)?t:0,this.max=vn(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){let t=this.isHorizontal(),e=t?this.width:this.height,n=Ga(this.options.ticks.minRotation),r=(t?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,a.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}},$u=i=>Math.floor(xo(i)),s0=(i,t)=>Math.pow(10,$u(i)+t);function b5(i){return i/Math.pow(10,$u(i))===1}function w5(i,t,e){let n=Math.pow(10,e),r=Math.floor(i/n);return Math.ceil(t/n)-r}function _N(i,t){let e=t-i,n=$u(e);for(;w5(i,t,n)>10;)n++;for(;w5(i,t,n)<10;)n--;return Math.min(n,$u(i))}function bN(i,{min:t,max:e}){t=da(i.min,t);let n=[],r=$u(t),a=_N(t,e),s=a<0?Math.pow(10,Math.abs(a)):1,o=Math.pow(10,a),l=r>a?Math.pow(10,r):0,c=Math.round((t-l)*s)/s,u=Math.floor((t-l)/o/10)*o*10,h=Math.floor((c-u)/Math.pow(10,a)),g=da(i.min,Math.round((l+u+h*Math.pow(10,a))*s)/s);for(;g<e;)n.push({value:g,major:b5(g),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(a++,h=2,s=a>=0?1:s),g=Math.round((l+u+h*Math.pow(10,a))*s)/s;let d=da(i.max,g);return n.push({value:d,major:b5(d),significand:h}),n}var Cg=class extends o0{static id="logarithmic";static defaults={ticks:{callback:Iu.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){let n=oc.prototype.parse.apply(this,[t,e]);if(n===0){this._zero=!0;return}return vn(n)&&n>0?n:null}determineDataLimits(){let{min:t,max:e}=this.getMinMax(!0);this.min=vn(t)?Math.max(0,t):null,this.max=vn(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!vn(this._userMin)&&(this.min=t===s0(this.min,0)?s0(this.min,-1):s0(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:t,maxDefined:e}=this.getUserBounds(),n=this.min,r=this.max,a=o=>n=t?n:o,s=o=>r=e?r:o;n===r&&(n<=0?(a(1),s(10)):(a(s0(n,-1)),s(s0(r,1)))),n<=0&&a(s0(r,-1)),r<=0&&s(s0(n,1)),this.min=n,this.max=r}buildTicks(){let t=this.options,e={min:this._userMin,max:this._userMax},n=bN(e,this);return t.bounds==="ticks"&&km(n,this,"value"),t.reverse?(n.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),n}getLabelForValue(t){return t===void 0?"0":ic(t,this.chart.options.locale,this.options.ticks.format)}configure(){let t=this.min;super.configure(),this._startValue=xo(t),this._valueRange=xo(this.max)-xo(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(xo(t)-this._startValue)/this._valueRange)}getValueForPixel(t){let e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}};function Eg(i){let t=i.ticks;if(t.display&&i.display){let e=Ar(t.backdropPadding);return ei(t.font&&t.font.size,un.font.size)+e.height}return 0}function wN(i,t,e){return e=an(e)?e:[e],{w:hb(i,t.string,e),h:e.length*t.lineHeight}}function y5(i,t,e,n,r){return i===n||i===r?{start:t-e/2,end:t+e/2}:i<n||i>r?{start:t-e,end:t}:{start:t,end:t+e}}function yN(i){let t={l:i.left+i._padding.left,r:i.right-i._padding.right,t:i.top+i._padding.top,b:i.bottom-i._padding.bottom},e=Object.assign({},t),n=[],r=[],a=i._pointLabels.length,s=i.options.pointLabels,o=s.centerPointLabels?Si/a:0;for(let l=0;l<a;l++){let c=s.setContext(i.getPointLabelContext(l));r[l]=c.padding;let u=i.getPointPosition(l,i.drawingArea+r[l],o),h=qn(c.font),g=wN(i.ctx,h,i._pointLabels[l]);n[l]=g;let d=kr(i.getIndexAngle(l)+o),b=Math.round(kh(d)),_=y5(b,u.x,g.w,0,180),w=y5(b,u.y,g.h,90,270);SN(e,t,d,_,w)}i.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),i._pointLabelItems=kN(i,n,r)}function SN(i,t,e,n,r){let a=Math.abs(Math.sin(e)),s=Math.abs(Math.cos(e)),o=0,l=0;n.start<t.l?(o=(t.l-n.start)/a,i.l=Math.min(i.l,t.l-o)):n.end>t.r&&(o=(n.end-t.r)/a,i.r=Math.max(i.r,t.r+o)),r.start<t.t?(l=(t.t-r.start)/s,i.t=Math.min(i.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/s,i.b=Math.max(i.b,t.b+l))}function CN(i,t,e){let n=i.drawingArea,{extra:r,additionalAngle:a,padding:s,size:o}=e,l=i.getPointPosition(t,n+r+s,a),c=Math.round(kh(kr(l.angle+Sn))),u=FN(l.y,o.h,c),h=TN(c),g=AN(l.x,o.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:g,top:u,right:g+o.w,bottom:u+o.h}}function EN(i,t){if(!t)return!0;let{left:e,top:n,right:r,bottom:a}=i;return!(Is({x:e,y:n},t)||Is({x:e,y:a},t)||Is({x:r,y:n},t)||Is({x:r,y:a},t))}function kN(i,t,e){let n=[],r=i._pointLabels.length,a=i.options,{centerPointLabels:s,display:o}=a.pointLabels,l={extra:Eg(a)/2,additionalAngle:s?Si/r:0},c;for(let u=0;u<r;u++){l.padding=e[u],l.size=t[u];let h=CN(i,u,l);n.push(h),o==="auto"&&(h.visible=EN(h,c),h.visible&&(c=h))}return n}function TN(i){return i===0||i===180?"center":i<180?"left":"right"}function AN(i,t,e){return e==="right"?i-=t:e==="center"&&(i-=t/2),i}function FN(i,t,e){return e===90||e===270?i-=t/2:(e>270||e<90)&&(i-=t),i}function DN(i,t,e){let{left:n,top:r,right:a,bottom:s}=e,{backdropColor:o}=t;if(!di(o)){let l=fl(t.borderRadius),c=Ar(t.backdropPadding);i.fillStyle=o;let u=n-c.left,h=r-c.top,g=a-n+c.width,d=s-r+c.height;Object.values(l).some(b=>b!==0)?(i.beginPath(),nc(i,{x:u,y:h,w:g,h:d,radius:l}),i.fill()):i.fillRect(u,h,g,d)}}function NN(i,t){let{ctx:e,options:{pointLabels:n}}=i;for(let r=t-1;r>=0;r--){let a=i._pointLabelItems[r];if(!a.visible)continue;let s=n.setContext(i.getPointLabelContext(r));DN(e,s,a);let o=qn(s.font),{x:l,y:c,textAlign:u}=a;dl(e,i._pointLabels[r],l,c+o.lineHeight/2,o,{color:s.color,textAlign:u,textBaseline:"middle"})}}function X5(i,t,e,n){let{ctx:r}=i;if(e)r.arc(i.xCenter,i.yCenter,t,0,sn);else{let a=i.getPointPosition(0,t);r.moveTo(a.x,a.y);for(let s=1;s<n;s++)a=i.getPointPosition(s,t),r.lineTo(a.x,a.y)}}function PN(i,t,e,n,r){let a=i.ctx,s=t.circular,{color:o,lineWidth:l}=t;!s&&!n||!o||!l||e<0||(a.save(),a.strokeStyle=o,a.lineWidth=l,a.setLineDash(r.dash||[]),a.lineDashOffset=r.dashOffset,a.beginPath(),X5(i,e,s,n),a.closePath(),a.stroke(),a.restore())}function MN(i,t,e){return _o(i,{label:e,index:t,type:"pointLabel"})}var kg=class extends oc{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Iu.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let t=this._padding=Ar(Eg(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){let{min:t,max:e}=this.getMinMax(!1);this.min=vn(t)&&!isNaN(t)?t:0,this.max=vn(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Eg(this.options))}generateTickLabels(t){oc.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,n)=>{let r=Zi(this.options.pointLabels.callback,[e,n],this);return r||r===0?r:""}).filter((e,n)=>this.chart.getDataVisibility(n))}fit(){let t=this.options;t.display&&t.pointLabels.display?yN(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,r){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,r))}getIndexAngle(t){let e=sn/(this._pointLabels.length||1),n=this.options.startAngle||0;return kr(t*e+Ga(n))}getDistanceFromCenterForValue(t){if(di(t))return NaN;let e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(di(t))return NaN;let e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){let e=this._pointLabels||[];if(t>=0&&t<e.length){let n=e[t];return MN(this.getContext(),t,n)}}getPointPosition(t,e,n=0){let r=this.getIndexAngle(t)-Sn+n;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){let{left:e,top:n,right:r,bottom:a}=this._pointLabelItems[t];return{left:e,top:n,right:r,bottom:a}}drawBackground(){let{backgroundColor:t,grid:{circular:e}}=this.options;if(t){let n=this.ctx;n.save(),n.beginPath(),X5(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){let t=this.ctx,e=this.options,{angleLines:n,grid:r,border:a}=e,s=this._pointLabels.length,o,l,c;if(e.pointLabels.display&&NN(this,s),r.display&&this.ticks.forEach((u,h)=>{if(h!==0||h===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);let g=this.getContext(h),d=r.setContext(g),b=a.setContext(g);PN(this,d,l,s,b)}}),n.display){for(t.save(),o=s-1;o>=0;o--){let u=n.setContext(this.getPointLabelContext(o)),{color:h,lineWidth:g}=u;!g||!h||(t.lineWidth=g,t.strokeStyle=h,t.setLineDash(u.borderDash),t.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),c=this.getPointPosition(o,l),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(c.x,c.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){let t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;let r=this.getIndexAngle(0),a,s;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,l)=>{if(l===0&&this.min>=0&&!e.reverse)return;let c=n.setContext(this.getContext(l)),u=qn(c.font);if(a=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,s=t.measureText(o.label).width,t.fillStyle=c.backdropColor;let h=Ar(c.backdropPadding);t.fillRect(-s/2-h.left,-a-u.size/2-h.top,s+h.width,u.size+h.height)}dl(t,o.label,0,-a,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),t.restore()}drawTitle(){}},Qh={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ha=Object.keys(Qh);function S5(i,t){return i-t}function C5(i,t){if(di(t))return null;let e=i._adapter,{parser:n,round:r,isoWeekday:a}=i._parseOpts,s=t;return typeof n=="function"&&(s=n(s)),vn(s)||(s=typeof n=="string"?e.parse(s,n):e.parse(s)),s===null?null:(r&&(s=r==="week"&&(n0(a)||a===!0)?e.startOf(s,"isoWeek",a):e.startOf(s,r)),+s)}function E5(i,t,e,n){let r=ha.length;for(let a=ha.indexOf(i);a<r-1;++a){let s=Qh[ha[a]],o=s.steps?s.steps:Number.MAX_SAFE_INTEGER;if(s.common&&Math.ceil((e-t)/(o*s.size))<=n)return ha[a]}return ha[r-1]}function LN(i,t,e,n,r){for(let a=ha.length-1;a>=ha.indexOf(e);a--){let s=ha[a];if(Qh[s].common&&i._adapter.diff(r,n,s)>=t-1)return s}return ha[e?ha.indexOf(e):0]}function IN(i){for(let t=ha.indexOf(i)+1,e=ha.length;t<e;++t)if(Qh[ha[t]].common)return ha[t]}function k5(i,t,e){if(!e)i[t]=!0;else if(e.length){let{lo:n,hi:r}=Th(e,t),a=e[n]>=t?e[n]:e[r];i[a]=!0}}function RN(i,t,e,n){let r=i._adapter,a=+r.startOf(t[0].value,n),s=t[t.length-1].value,o,l;for(o=a;o<=s;o=+r.add(o,1,n))l=e[o],l>=0&&(t[l].major=!0);return t}function T5(i,t,e){let n=[],r={},a=t.length,s,o;for(s=0;s<a;++s)o=t[s],r[o]=s,n.push({value:o,major:!1});return a===0||!e?n:RN(i,n,r,e)}var Tg=(()=>{class i extends o0{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){let r=e.time||(e.time={}),a=this._adapter=new $7._date(e.adapters.date);a.init(n),J0(r.displayFormats,a.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:C5(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let e=this.options,n=this._adapter,r=e.time.unit||"day",{min:a,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(a=Math.min(a,u.min)),!l&&!isNaN(u.max)&&(s=Math.max(s,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),a=vn(a)&&!isNaN(a)?a:+n.startOf(Date.now(),r),s=vn(s)&&!isNaN(s)?s:+n.endOf(Date.now(),r)+1,this.min=Math.min(a,s-1),this.max=Math.max(a+1,s)}_getLabelBounds(){let e=this.getLabelTimestamps(),n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){let e=this.options,n=e.time,r=e.ticks,a=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&a.length&&(this.min=this._userMin||a[0],this.max=this._userMax||a[a.length-1]);let s=this.min,o=this.max,l=ob(a,s,o);return this._unit=n.unit||(r.autoSkip?E5(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):LN(this,l.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:IN(this._unit),this.initOffsets(a),e.reverse&&l.reverse(),T5(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,a,s;this.options.offset&&e.length&&(a=this.getDecimalForValue(e[0]),e.length===1?n=1-a:n=(this.getDecimalForValue(e[1])-a)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);let o=e.length<3?.5:.25;n=rr(n,0,o),r=rr(r,0,o),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){let e=this._adapter,n=this.min,r=this.max,a=this.options,s=a.time,o=s.unit||E5(s.minUnit,n,r,this._getLabelCapacity(n)),l=ei(a.ticks.stepSize,1),c=o==="week"?s.isoWeekday:!1,u=n0(c)||c===!0,h={},g=n,d,b;if(u&&(g=+e.startOf(g,"isoWeek",c)),g=+e.startOf(g,u?"day":o),e.diff(r,n,o)>1e5*l)throw new Error(n+" and "+r+" are too far apart with stepSize of "+l+" "+o);let _=a.ticks.source==="data"&&this.getDataTimestamps();for(d=g,b=0;d<r;d=+e.add(d,l,o),b++)k5(h,d,_);return(d===r||a.bounds==="ticks"||b===1)&&k5(h,d,_),Object.keys(h).sort(S5).map(w=>+w)}getLabelForValue(e){let n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){let a=this.options.time.displayFormats,s=this._unit,o=n||a[s];return this._adapter.format(e,o)}_tickFormatFunction(e,n,r,a){let s=this.options,o=s.ticks.callback;if(o)return Zi(o,[e,n,r],this);let l=s.time.displayFormats,c=this._unit,u=this._majorUnit,h=c&&l[c],g=u&&l[u],d=r[n],b=u&&g&&d&&d.major;return this._adapter.format(e,a||(b?g:h))}generateTickLabels(e){let n,r,a;for(n=0,r=e.length;n<r;++n)a=e[n],a.label=this._tickFormatFunction(a.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){let n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){let n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){let n=this.options.ticks,r=this.ctx.measureText(e).width,a=Ga(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(a),o=Math.sin(a),l=this._resolveTickFontOptions(0).size;return{w:r*s+l*o,h:r*o+l*s}}_getLabelCapacity(e){let n=this.options.time,r=n.displayFormats,a=r[n.unit]||r.millisecond,s=this._tickFormatFunction(e,0,T5(this,[e],this._majorUnit),a),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;let a=this.getMatchingVisibleMetas();if(this._normalized&&a.length)return this._cache.data=a[0].controller.getAllParsedValues(this);for(n=0,r=a.length;n<r;++n)e=e.concat(a[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){let e=this._cache.labels||[],n,r;if(e.length)return e;let a=this.getLabels();for(n=0,r=a.length;n<r;++n)e.push(C5(this,a[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Dm(e.sort(S5))}}return i})();function Uh(i,t,e){let n=0,r=i.length-1,a,s,o,l;e?(t>=i[n].pos&&t<=i[r].pos&&({lo:n,hi:r}=Ls(i,"pos",t)),{pos:a,time:o}=i[n],{pos:s,time:l}=i[r]):(t>=i[n].time&&t<=i[r].time&&({lo:n,hi:r}=Ls(i,"time",t)),{time:a,pos:o}=i[n],{time:s,pos:l}=i[r]);let c=s-a;return c?o+(l-o)*(t-a)/c:o}var Ag=class extends Tg{static id="timeseries";static defaults=Tg.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Uh(e,this.min),this._tableRange=Uh(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){let{min:e,max:n}=this,r=[],a=[],s,o,l,c,u;for(s=0,o=t.length;s<o;++s)c=t[s],c>=e&&c<=n&&r.push(c);if(r.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(s=0,o=r.length;s<o;++s)u=r[s+1],l=r[s-1],c=r[s],Math.round((u+l)/2)!==c&&a.push({time:c,pos:s/(o-1)});return a}_generate(){let t=this.min,e=this.max,n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(e)||n.length===1)&&n.push(e),n.sort((r,a)=>r-a)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;let e=this.getDataTimestamps(),n=this.getLabelTimestamps();return e.length&&n.length?t=this.normalize(e.concat(n)):t=e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Uh(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){let e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return Uh(this._table,n*this._tableRange+this._minPos,!0)}},ON=Object.freeze({__proto__:null,CategoryScale:xN,LinearScale:Sg,LogarithmicScale:Cg,RadialLinearScale:kg,TimeScale:Tg,TimeSeriesScale:Ag}),Y5=[G7,vD,hN,ON];var $a=class i{constructor(t,e){this.http=t;this.authService=e}apiUrl=`${$t.url}reports`;getHeaders(){let t=this.authService.token();return new Av({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}getIncomeByPeriod(t="month"){let e=new Un().set("period",t);return this.http.get(`${this.apiUrl}/sales/income-by-period`,{headers:this.getHeaders(),params:e})}getTopProducts(t=10){let e=new Un().set("limit",t.toString());return this.http.get(`${this.apiUrl}/sales/top-products`,{headers:this.getHeaders(),params:e})}getSalesByCategory(){return this.http.get(`${this.apiUrl}/sales/by-category`,{headers:this.getHeaders()})}getPaymentMethods(){return this.http.get(`${this.apiUrl}/sales/payment-methods`,{headers:this.getHeaders()})}getPeriodComparison(t="month"){let e=new Un().set("period",t);return this.http.get(`${this.apiUrl}/sales/period-comparison`,{headers:this.getHeaders(),params:e})}getSalesList(t,e,n){let r=new Un;return t&&(r=r.set("start_date",t)),e&&(r=r.set("end_date",e)),n&&(r=r.set("product_type",n)),this.http.get(`${this.apiUrl}/sales/list`,{headers:this.getHeaders(),params:r})}getStudentGrowth(t="month"){let e=new Un().set("period",t);return this.http.get(`${this.apiUrl}/students/growth`,{headers:this.getHeaders(),params:e})}getActiveStudents(){return this.http.get(`${this.apiUrl}/students/active`,{headers:this.getHeaders()})}getStudentsByCourse(){return this.http.get(`${this.apiUrl}/students/by-course`,{headers:this.getHeaders()})}getTopStudents(t=10){let e=new Un().set("limit",t.toString());return this.http.get(`${this.apiUrl}/students/top`,{headers:this.getHeaders(),params:e})}getProductsAnalysis(t){let e=new Un;return t&&(e=e.set("product_type",t)),this.http.get(`${this.apiUrl}/products/analysis`,{headers:this.getHeaders(),params:e})}getLowPerformingProducts(t=5,e=3){let n=new Un().set("min_sales",t.toString()).set("min_rating",e.toString());return this.http.get(`${this.apiUrl}/products/low-performing`,{headers:this.getHeaders(),params:n})}getReviewsAnalysis(t){let e=new Un;return t&&(e=e.set("product_id",t)),this.http.get(`${this.apiUrl}/products/reviews`,{headers:this.getHeaders(),params:e})}getCouponEffectiveness(){return this.http.get(`${this.apiUrl}/discounts/coupon-effectiveness`,{headers:this.getHeaders()})}getDiscountsImpact(t,e){let n=new Un;return t&&(n=n.set("start_date",t)),e&&(n=n.set("end_date",e)),this.http.get(`${this.apiUrl}/discounts/impact`,{headers:this.getHeaders(),params:n})}getCampaignPerformance(){return this.http.get(`${this.apiUrl}/discounts/campaign-performance`,{headers:this.getHeaders()})}getInstructorRanking(){return this.http.get(`${this.apiUrl}/instructors/ranking`,{headers:this.getHeaders()})}getInstructorDetail(t){let e=new Un;return t&&(e=e.set("instructor_id",t)),this.http.get(`${this.apiUrl}/instructors/detail`,{headers:this.getHeaders(),params:e})}getRevenueDistribution(){return this.http.get(`${this.apiUrl}/instructors/revenue-distribution`,{headers:this.getHeaders()})}getCommissionsSummary(t,e,n,r){let a=new Un;return t&&(a=a.set("period",t)),e&&(a=a.set("start_date",e)),n&&(a=a.set("end_date",n)),r&&(a=a.set("instructor_id",r)),this.http.get(`${this.apiUrl}/commissions/summary`,{headers:this.getHeaders(),params:a})}getCommissionsByPeriod(t="month",e,n){let r=new Un().set("period",t);return e&&(r=r.set("start_date",e)),n&&(r=r.set("end_date",n)),this.http.get(`${this.apiUrl}/commissions/by-period`,{headers:this.getHeaders(),params:r})}getCommissionsByInstructor(t,e){let n=new Un;return t&&(n=n.set("start_date",t)),e&&(n=n.set("end_date",e)),this.http.get(`${this.apiUrl}/commissions/by-instructor`,{headers:this.getHeaders(),params:n})}getCommissionsByProduct(t,e,n){let r=new Un;return t&&(r=r.set("start_date",t)),e&&(r=r.set("end_date",e)),n&&(r=r.set("product_type",n)),this.http.get(`${this.apiUrl}/commissions/by-product`,{headers:this.getHeaders(),params:r})}getRefundsReport(t,e,n){let r=new Un;return t&&(r=r.set("start_date",t)),e&&(r=r.set("end_date",e)),n&&(r=r.set("status",n)),this.http.get(`${this.apiUrl}/refunds`,{headers:this.getHeaders(),params:r})}getSalesReport(t,e,n){let r=new Un;return t&&(r=r.set("start_date",t)),e&&(r=r.set("end_date",e)),n&&(r=r.set("product_type",n)),this.http.get(`${this.apiUrl}/sales/report`,{headers:this.getHeaders(),params:r})}getStudentsReport(t,e){let n=new Un;return t&&(n=n.set("start_date",t)),e&&(n=n.set("end_date",e)),this.http.get(`${this.apiUrl}/students/report`,{headers:this.getHeaders(),params:n})}getProductsReport(t){let e=new Un;return t&&(e=e.set("product_type",t)),this.http.get(`${this.apiUrl}/products/report`,{headers:this.getHeaders(),params:e})}static \u0275fac=function(e){return new(e||i)(Qp(ur),Qp(pn))};static \u0275prov=cr({token:i,factory:i.\u0275fac,providedIn:"root"})};var nd={};nd.version="0.18.5";var c0=1200,vc=1252,BN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jN={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Rw=function(i){BN.indexOf(i)!=-1&&(vc=jN[0]=i)};function VN(){Rw(1252)}var rd=function(i){c0=i,Rw(i)};function UN(){rd(1200),VN()}function zN(i){for(var t=[],e=0;e<i.length>>1;++e)t[e]=String.fromCharCode(i.charCodeAt(2*e+1)+(i.charCodeAt(2*e)<<8));return t.join("")}var e1=function(t){return String.fromCharCode(t)},K5=function(t){return String.fromCharCode(t)},Ji;var zs=null,Yu=!0,xl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ad(i){for(var t="",e=0,n=0,r=0,a=0,s=0,o=0,l=0,c=0;c<i.length;)e=i.charCodeAt(c++),a=e>>2,n=i.charCodeAt(c++),s=(e&3)<<4|n>>4,r=i.charCodeAt(c++),o=(n&15)<<2|r>>6,l=r&63,isNaN(n)?o=l=64:isNaN(r)&&(l=64),t+=xl.charAt(a)+xl.charAt(s)+xl.charAt(o)+xl.charAt(l);return t}function ko(i){var t="",e=0,n=0,r=0,a=0,s=0,o=0,l=0;i=i.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<i.length;)a=xl.indexOf(i.charAt(c++)),s=xl.indexOf(i.charAt(c++)),e=a<<2|s>>4,t+=String.fromCharCode(e),o=xl.indexOf(i.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=xl.indexOf(i.charAt(c++)),r=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(r));return t}var Fi=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ao=(function(){if(typeof Buffer<"u"){var i=!Buffer.from;if(!i)try{Buffer.from("foo","utf8")}catch{i=!0}return i?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function d0(i){return Fi?Buffer.alloc?Buffer.alloc(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}function Z5(i){return Fi?Buffer.allocUnsafe?Buffer.allocUnsafe(i):new Buffer(i):typeof Uint8Array<"u"?new Uint8Array(i):new Array(i)}var gs=function(t){return Fi?Ao(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function y1(i){if(typeof ArrayBuffer>"u")return gs(i);for(var t=new ArrayBuffer(i.length),e=new Uint8Array(t),n=0;n!=i.length;++n)e[n]=i.charCodeAt(n)&255;return t}function ud(i){if(Array.isArray(i))return i.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],e=0;e<i.length;++e)t[e]=String.fromCharCode(i[e]);return t.join("")}function HN(i){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(i)}var Nr=Fi?function(i){return Buffer.concat(i.map(function(t){return Buffer.isBuffer(t)?t:Ao(t)}))}:function(i){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<i.length;++t)e+=i[t].length;var n=new Uint8Array(e),r=0;for(t=0,e=0;t<i.length;e+=r,++t)if(r=i[t].length,i[t]instanceof Uint8Array)n.set(i[t],e);else{if(typeof i[t]=="string")throw"wtf";n.set(new Uint8Array(i[t]),e)}return n}return[].concat.apply([],i.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function WN(i){for(var t=[],e=0,n=i.length+250,r=d0(i.length+255),a=0;a<i.length;++a){var s=i.charCodeAt(a);if(s<128)r[e++]=s;else if(s<2048)r[e++]=192|s>>6&31,r[e++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=i.charCodeAt(++a)&1023;r[e++]=240|s>>8&7,r[e++]=128|s>>2&63,r[e++]=128|o>>6&15|(s&3)<<4,r[e++]=128|o&63}else r[e++]=224|s>>12&15,r[e++]=128|s>>6&63,r[e++]=128|s&63;e>n&&(t.push(r.slice(0,e)),e=0,r=d0(65535),n=65530)}return t.push(r.slice(0,e)),Nr(t)}var hc=/\u0000/g,t1=/[\u0001-\u0006]/g;function pc(i){for(var t="",e=i.length-1;e>=0;)t+=i.charAt(e--);return t}function xs(i,t){var e=""+i;return e.length>=t?e:Cn("0",t-e.length)+e}function zg(i,t){var e=""+i;return e.length>=t?e:Cn(" ",t-e.length)+e}function c1(i,t){var e=""+i;return e.length>=t?e:e+Cn(" ",t-e.length)}function qN(i,t){var e=""+Math.round(i);return e.length>=t?e:Cn("0",t-e.length)+e}function GN(i,t){var e=""+i;return e.length>=t?e:Cn("0",t-e.length)+e}var J5=Math.pow(2,32);function lc(i,t){if(i>J5||i<-J5)return qN(i,t);var e=Math.round(i);return GN(e,t)}function u1(i,t){return t=t||0,i.length>=7+t&&(i.charCodeAt(t)|32)===103&&(i.charCodeAt(t+1)|32)===101&&(i.charCodeAt(t+2)|32)===110&&(i.charCodeAt(t+3)|32)===101&&(i.charCodeAt(t+4)|32)===114&&(i.charCodeAt(t+5)|32)===97&&(i.charCodeAt(t+6)|32)===108}var Q5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Dg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $N(i){return i||(i={}),i[0]="General",i[1]="0",i[2]="0.00",i[3]="#,##0",i[4]="#,##0.00",i[9]="0%",i[10]="0.00%",i[11]="0.00E+00",i[12]="# ?/?",i[13]="# ??/??",i[14]="m/d/yy",i[15]="d-mmm-yy",i[16]="d-mmm",i[17]="mmm-yy",i[18]="h:mm AM/PM",i[19]="h:mm:ss AM/PM",i[20]="h:mm",i[21]="h:mm:ss",i[22]="m/d/yy h:mm",i[37]="#,##0 ;(#,##0)",i[38]="#,##0 ;[Red](#,##0)",i[39]="#,##0.00;(#,##0.00)",i[40]="#,##0.00;[Red](#,##0.00)",i[45]="mm:ss",i[46]="[h]:mm:ss",i[47]="mmss.0",i[48]="##0.0E+0",i[49]="@",i[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',i}var En={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},ew={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},XN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function d1(i,t,e){for(var n=i<0?-1:1,r=i*n,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(r);c<t&&(h=Math.floor(r),o=h*s+a,u=h*c+l,!(r-h<5e-8));)r=1/(r-h),a=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=s)),!e)return[0,n*o,u];var g=Math.floor(n*o/u);return[g,n*o-g*u,u]}function i1(i,t,e){if(i>2958465||i<0)return null;var n=i|0,r=Math.floor(86400*(i-n)),a=0,s=[],o={D:n,T:r,u:86400*(i-n)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++r==86400&&(o.T=r=0,++n,++o.D)),n===60)s=e?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=e?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),e&&(a=tP(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=r%60,r=Math.floor(r/60),o.M=r%60,r=Math.floor(r/60),o.H=r,o.q=a,o}var Ow=new Date(1899,11,31,0,0,0),YN=Ow.getTime(),KN=new Date(1900,2,1,0,0,0);function Bw(i,t){var e=i.getTime();return t?e-=1461*24*60*60*1e3:i>=KN&&(e+=1440*60*1e3),(e-(YN+(i.getTimezoneOffset()-Ow.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Hg(i){return i.indexOf(".")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ZN(i){return i.indexOf("E")==-1?i:i.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function JN(i){var t=i<0?12:11,e=Hg(i.toFixed(12));return e.length<=t||(e=i.toPrecision(10),e.length<=t)?e:i.toExponential(5)}function QN(i){var t=Hg(i.toFixed(11));return t.length>(i<0?12:11)||t==="0"||t==="-0"?i.toPrecision(6):t}function eP(i){var t=Math.floor(Math.log(Math.abs(i))*Math.LOG10E),e;return t>=-4&&t<=-1?e=i.toPrecision(10+t):Math.abs(t)<=9?e=JN(i):t===10?e=i.toFixed(10).substr(0,12):e=QN(i),Hg(ZN(e.toUpperCase()))}function Bg(i,t){switch(typeof i){case"string":return i;case"boolean":return i?"TRUE":"FALSE";case"number":return(i|0)===i?i.toString(10):eP(i);case"undefined":return"";case"object":if(i==null)return"";if(i instanceof Date)return _l(14,Bw(i,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+i)}function tP(i,t){t[0]-=581;var e=i.getDay();return i<60&&(e=(e+6)%7),e}function iP(i,t,e,n){var r="",a=0,s=0,o=e.y,l,c=0;switch(i){case 98:o=e.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=e.m,c=t.length;break;case 3:return Dg[e.m-1][1];case 5:return Dg[e.m-1][0];default:return Dg[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=e.d,c=t.length;break;case 3:return Q5[e.q][0];default:return Q5[e.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(e.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=e.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=e.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?xs(e.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(e.S+e.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(r=xs(a,2+n),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=e.D*24+e.H;break;case"[m]":case"[mm]":l=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":l=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?xs(l,c):"";return u}function vl(i){var t=3;if(i.length<=t)return i;for(var e=i.length%t,n=i.substr(0,e);e!=i.length;e+=t)n+=(n.length>0?",":"")+i.substr(e,t);return n}var jw=/%/g;function nP(i,t,e){var n=t.replace(jw,""),r=t.length-n.length;return So(i,n,e*Math.pow(10,2*r))+Cn("%",r)}function rP(i,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return So(i,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function Vw(i,t){var e,n=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Vw(i,-t);var r=i.indexOf(".");r===-1&&(r=i.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(t/Math.pow(10,a)).toPrecision(n+1+(r+a)%r),e.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(r+a)%r)+"."+u.substr(a)+"E"})}else e=t.toExponential(n);return i.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),i.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Uw=/# (\?+)( ?)\/( ?)(\d+)/;function aP(i,t,e){var n=parseInt(i[4],10),r=Math.round(t*n),a=Math.floor(r/n),s=r-a*n,o=n;return e+(a===0?"":""+a)+" "+(s===0?Cn(" ",i[1].length+1+i[4].length):zg(s,i[1].length)+i[2]+"/"+i[3]+xs(o,i[4].length))}function sP(i,t,e){return e+(t===0?"":""+t)+Cn(" ",i[1].length+2+i[4].length)}var zw=/^#*0*\.([0#]+)/,Hw=/\).*[0#]/,Ww=/\(###\) ###\\?-####/;function ta(i){for(var t="",e,n=0;n!=i.length;++n)switch(e=i.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function tw(i,t){var e=Math.pow(10,t);return""+Math.round(i*e)/e}function iw(i,t){var e=i-Math.floor(i),n=Math.pow(10,t);return t<(""+Math.round(e*n)).length?0:Math.round(e*n)}function oP(i,t){return t<(""+Math.round((i-Math.floor(i))*Math.pow(10,t))).length?1:0}function lP(i){return i<2147483647&&i>-2147483648?""+(i>=0?i|0:i-1|0):""+Math.floor(i)}function Xa(i,t,e){if(i.charCodeAt(0)===40&&!t.match(Hw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Xa("n",n,e):"("+Xa("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return rP(i,t,e);if(t.indexOf("%")!==-1)return nP(i,t,e);if(t.indexOf("E")!==-1)return Vw(t,e);if(t.charCodeAt(0)===36)return"$"+Xa(i,t.substr(t.charAt(1)==" "?2:1),e);var r,a,s,o,l=Math.abs(e),c=e<0?"-":"";if(t.match(/^00+$/))return c+lc(l,t.length);if(t.match(/^[#?]+$/))return r=lc(e,0),r==="0"&&(r=""),r.length>t.length?r:ta(t.substr(0,t.length-r.length))+r;if(a=t.match(Uw))return aP(a,l,c);if(t.match(/^#+0+$/))return c+lc(l,t.length-t.indexOf("0"));if(a=t.match(zw))return r=tw(e,a[1].length).replace(/^([^\.]+)$/,"$1."+ta(a[1])).replace(/\.$/,"."+ta(a[1])).replace(/\.(\d*)$/,function(b,_){return"."+_+Cn("0",ta(a[1]).length-_.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+tw(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+vl(lc(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Xa(i,t,-e):vl(""+(Math.floor(e)+oP(e,a[1].length)))+"."+xs(iw(e,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Xa(i,t.replace(/^#,#*,/,""),e);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=pc(Xa(i,t.replace(/[\\-]/g,""),e)),s=0,pc(pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<r.length?r.charAt(s++):b==="0"?"0":""}));if(t.match(Ww))return r=Xa(i,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=d1(l,Math.pow(10,s)-1,!1),r=""+c,u=So("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),r+=u+a[2]+"/"+a[3],u=c1(o[2],s),u.length<a[4].length&&(u=ta(a[4].substr(a[4].length-u.length))+u),r+=u,r;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=d1(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zg(o[1],s)+a[2]+"/"+a[3]+c1(o[2],s):Cn(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return r=lc(e,0),t.length<=r.length?r:ta(t.substr(0,t.length-r.length))+r;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var h=t.indexOf(".")-s,g=t.length-r.length-h;return ta(t.substr(0,h)+r+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=iw(e,a[1].length),e<0?"-"+Xa(i,t,-e):vl(lP(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?xs(0,3-b.length):"")+b})+"."+xs(s,a[1].length);switch(t){case"###,##0.00":return Xa(i,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var d=vl(lc(l,0));return d!=="0"?c+d:"";case"###,###.00":return Xa(i,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Xa(i,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+t+"|")}function cP(i,t,e){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return So(i,t.substr(0,n),e/Math.pow(10,3*(t.length-n)))}function uP(i,t,e){var n=t.replace(jw,""),r=t.length-n.length;return So(i,n,e*Math.pow(10,2*r))+Cn("%",r)}function qw(i,t){var e,n=i.indexOf("E")-i.indexOf(".")-1;if(i.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qw(i,-t);var r=i.indexOf(".");r===-1&&(r=i.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(t/Math.pow(10,a)).toPrecision(n+1+(r+a)%r),!e.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(s-e.length+a):e+="E+"+(s-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(r+a)%r)+"."+u.substr(a)+"E"})}else e=t.toExponential(n);return i.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),i.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Vs(i,t,e){if(i.charCodeAt(0)===40&&!t.match(Hw)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Vs("n",n,e):"("+Vs("n",n,-e)+")"}if(t.charCodeAt(t.length-1)===44)return cP(i,t,e);if(t.indexOf("%")!==-1)return uP(i,t,e);if(t.indexOf("E")!==-1)return qw(t,e);if(t.charCodeAt(0)===36)return"$"+Vs(i,t.substr(t.charAt(1)==" "?2:1),e);var r,a,s,o,l=Math.abs(e),c=e<0?"-":"";if(t.match(/^00+$/))return c+xs(l,t.length);if(t.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>t.length?r:ta(t.substr(0,t.length-r.length))+r;if(a=t.match(Uw))return sP(a,l,c);if(t.match(/^#+0+$/))return c+xs(l,t.length-t.indexOf("0"));if(a=t.match(zw))return r=(""+e).replace(/^([^\.]+)$/,"$1."+ta(a[1])).replace(/\.$/,"."+ta(a[1])),r=r.replace(/\.(\d*)$/,function(b,_){return"."+_+Cn("0",ta(a[1]).length-_.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+vl(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Vs(i,t,-e):vl(""+e)+"."+Cn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Vs(i,t.replace(/^#,#*,/,""),e);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=pc(Vs(i,t.replace(/[\\-]/g,""),e)),s=0,pc(pc(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<r.length?r.charAt(s++):b==="0"?"0":""}));if(t.match(Ww))return r=Vs(i,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=d1(l,Math.pow(10,s)-1,!1),r=""+c,u=So("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),r+=u+a[2]+"/"+a[3],u=c1(o[2],s),u.length<a[4].length&&(u=ta(a[4].substr(a[4].length-u.length))+u),r+=u,r;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=d1(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?zg(o[1],s)+a[2]+"/"+a[3]+c1(o[2],s):Cn(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return r=""+e,t.length<=r.length?r:ta(t.substr(0,t.length-r.length))+r;if(a=t.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=r.indexOf(".");var h=t.indexOf(".")-s,g=t.length-r.length-h;return ta(t.substr(0,h)+r+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Vs(i,t,-e):vl(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?xs(0,3-b.length):"")+b})+"."+xs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=vl(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Vs(i,t.slice(0,t.lastIndexOf(".")),e)+ta(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function So(i,t,e){return(e|0)===e?Vs(i,t,e):Xa(i,t,e)}function dP(i){for(var t=[],e=!1,n=0,r=0;n<i.length;++n)switch(i.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=i.substr(r,n-r),r=n+1}if(t[t.length]=i.substr(r),e===!0)throw new Error("Format |"+i+"| unterminated string ");return t}var Gw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function $w(i){for(var t=0,e="",n="";t<i.length;)switch(e=i.charAt(t)){case"G":u1(i,t)&&(t+=6),t++;break;case'"':for(;i.charCodeAt(++t)!==34&&t<i.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(i.charAt(t+1)==="1"||i.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(i.substr(t,3).toUpperCase()==="A/P"||i.substr(t,5).toUpperCase()==="AM/PM"||i.substr(t,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++t;break;case"[":for(n=e;i.charAt(t++)!=="]"&&t<i.length;)n+=i.charAt(t);if(n.match(Gw))return!0;break;case".":case"0":case"#":for(;t<i.length&&("0#?.,E+-%".indexOf(e=i.charAt(++t))>-1||e=="\\"&&i.charAt(t+1)=="-"&&"0#".indexOf(i.charAt(t+2))>-1););break;case"?":for(;i.charAt(++t)===e;);break;case"*":++t,(i.charAt(t)==" "||i.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<i.length&&"0123456789".indexOf(i.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function fP(i,t,e,n){for(var r=[],a="",s=0,o="",l="t",c,u,h,g="H";s<i.length;)switch(o=i.charAt(s)){case"G":if(!u1(i,s))throw new Error("unrecognized character "+o+" in "+i);r[r.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=i.charCodeAt(++s))!==34&&s<i.length;)a+=String.fromCharCode(h);r[r.length]={t:"t",v:a},++s;break;case"\\":var d=i.charAt(++s),b=d==="("||d===")"?d:"t";r[r.length]={t:b,v:d},++s;break;case"_":r[r.length]={t:"t",v:" "},s+=2;break;case"@":r[r.length]={t:"T",v:t},++s;break;case"B":case"b":if(i.charAt(s+1)==="1"||i.charAt(s+1)==="2"){if(c==null&&(c=i1(t,e,i.charAt(s+1)==="2"),c==null))return"";r[r.length]={t:"X",v:i.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=i1(t,e),c==null))return"";for(a=o;++s<i.length&&i.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),r[r.length]={t:o,v:a},l=o;break;case"A":case"a":case"\u4E0A":var _={t:o,v:o};if(c==null&&(c=i1(t,e)),i.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(_.v=c.H>=12?"P":"A"),_.t="T",g="h",s+=3):i.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(_.v=c.H>=12?"PM":"AM"),_.t="T",s+=5,g="h"):i.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(_.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),_.t="T",s+=5,g="h"):(_.t="t",++s),c==null&&_.t==="T")return"";r[r.length]=_,l=o;break;case"[":for(a=o;i.charAt(s++)!=="]"&&s<i.length;)a+=i.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(Gw)){if(c==null&&(c=i1(t,e),c==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",$w(i)||(r[r.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<i.length&&(o=i.charAt(s))==="0";)a+=o;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<i.length&&"0#?.,E+-%".indexOf(o=i.charAt(s))>-1;)a+=o;r[r.length]={t:"n",v:a};break;case"?":for(a=o;i.charAt(++s)===o;)a+=o;r[r.length]={t:o,v:a},l=o;break;case"*":++s,(i.charAt(s)==" "||i.charAt(s)=="*")&&++s;break;case"(":case")":r[r.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<i.length&&"0123456789".indexOf(i.charAt(++s))>-1;)a+=i.charAt(s);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:o,v:o},++s;break;case"$":r[r.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+i);r[r.length]={t:"t",v:o},++s;break}var w=0,E=0,A;for(s=r.length-1,l="t";s>=0;--s)switch(r[s].t){case"h":case"H":r[s].t=g,l="h",w<1&&(w=1);break;case"s":(A=r[s].v.match(/\.0+$/))&&(E=Math.max(E,A[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=r[s].t;break;case"m":l==="s"&&(r[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&r[s].v.match(/[Hh]/)&&(w=1),w<2&&r[s].v.match(/[Mm]/)&&(w=2),w<3&&r[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var D="",N;for(s=0;s<r.length;++s)switch(r[s].t){case"t":case"T":case" ":case"D":break;case"X":r[s].v="",r[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[s].v=iP(r[s].t.charCodeAt(0),r[s].v,c,E),r[s].t="t";break;case"n":case"?":for(N=s+1;r[N]!=null&&((o=r[N].t)==="?"||o==="D"||(o===" "||o==="t")&&r[N+1]!=null&&(r[N+1].t==="?"||r[N+1].t==="t"&&r[N+1].v==="/")||r[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(r[N].v==="/"||r[N].v===" "&&r[N+1]!=null&&r[N+1].t=="?"));)r[s].v+=r[N].v,r[N]={v:"",t:";"},++N;D+=r[s].v,s=N-1;break;case"G":r[s].t="t",r[s].v=Bg(t,e);break}var z="",J,W;if(D.length>0){D.charCodeAt(0)==40?(J=t<0&&D.charCodeAt(0)===45?-t:t,W=So("n",D,J)):(J=t<0&&n>1?-t:t,W=So("n",D,J),J<0&&r[0]&&r[0].t=="t"&&(W=W.substr(1),r[0].v="-"+r[0].v)),N=W.length-1;var U=r.length;for(s=0;s<r.length;++s)if(r[s]!=null&&r[s].t!="t"&&r[s].v.indexOf(".")>-1){U=s;break}var M=r.length;if(U===r.length&&W.indexOf("E")===-1){for(s=r.length-1;s>=0;--s)r[s]==null||"n?".indexOf(r[s].t)===-1||(N>=r[s].v.length-1?(N-=r[s].v.length,r[s].v=W.substr(N+1,r[s].v.length)):N<0?r[s].v="":(r[s].v=W.substr(0,N+1),N=-1),r[s].t="t",M=s);N>=0&&M<r.length&&(r[M].v=W.substr(0,N+1)+r[M].v)}else if(U!==r.length&&W.indexOf("E")===-1){for(N=W.indexOf(".")-1,s=U;s>=0;--s)if(!(r[s]==null||"n?".indexOf(r[s].t)===-1)){for(u=r[s].v.indexOf(".")>-1&&s===U?r[s].v.indexOf(".")-1:r[s].v.length-1,z=r[s].v.substr(u+1);u>=0;--u)N>=0&&(r[s].v.charAt(u)==="0"||r[s].v.charAt(u)==="#")&&(z=W.charAt(N--)+z);r[s].v=z,r[s].t="t",M=s}for(N>=0&&M<r.length&&(r[M].v=W.substr(0,N+1)+r[M].v),N=W.indexOf(".")+1,s=U;s<r.length;++s)if(!(r[s]==null||"n?(".indexOf(r[s].t)===-1&&s!==U)){for(u=r[s].v.indexOf(".")>-1&&s===U?r[s].v.indexOf(".")+1:0,z=r[s].v.substr(0,u);u<r[s].v.length;++u)N<W.length&&(z+=W.charAt(N++));r[s].v=z,r[s].t="t",M=s}}}for(s=0;s<r.length;++s)r[s]!=null&&"n?".indexOf(r[s].t)>-1&&(J=n>1&&t<0&&s>0&&r[s-1].v==="-"?-t:t,r[s].v=So(r[s].t,r[s].v,J),r[s].t="t");var X="";for(s=0;s!==r.length;++s)r[s]!=null&&(X+=r[s].v);return X}var nw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rw(i,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(i==e)return!0;break;case">":if(i>e)return!0;break;case"<":if(i<e)return!0;break;case"<>":if(i!=e)return!0;break;case">=":if(i>=e)return!0;break;case"<=":if(i<=e)return!0;break}return!1}function hP(i,t){var e=dP(i),n=e.length,r=e[n-1].indexOf("@");if(n<4&&r>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var a=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var s=e[0].match(nw),o=e[1].match(nw);return rw(t,s)?[n,e[0]]:rw(t,o)?[n,e[1]]:[n,e[s!=null&&o!=null?2:1]]}return[n,a]}function _l(i,t,e){e==null&&(e={});var n="";switch(typeof i){case"string":i=="m/d/yy"&&e.dateNF?n=e.dateNF:n=i;break;case"number":i==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:En)[i],n==null&&(n=e.table&&e.table[ew[i]]||En[ew[i]]),n==null&&(n=XN[i]||"General");break}if(u1(n,0))return Bg(t,e);t instanceof Date&&(t=Bw(t,e.date1904));var r=hP(n,t);if(u1(r[1]))return Bg(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return fP(r[1],t,e,r[0])}function Xw(i,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(En[e]==null){t<0&&(t=e);continue}if(En[e]==i){t=e;break}}t<0&&(t=391)}return En[t]=i,t}function S1(i){for(var t=0;t!=392;++t)i[t]!==void 0&&Xw(i[t],t)}function C1(){En=$N()}var Yw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pP(i){var t=typeof i=="number"?En[i]:i;return t=t.replace(Yw,"(\\d+)"),new RegExp("^"+t+"$")}function mP(i,t,e){var n=-1,r=-1,a=-1,s=-1,o=-1,l=-1;(t.match(Yw)||[]).forEach(function(h,g){var d=parseInt(e[g+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:r=d;break}}),l>=0&&o==-1&&r>=0&&(o=r,r=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&r==-1&&a==-1?u:c+"T"+u}var gP=(function(){var i={};i.version="1.2.0";function t(){for(var W=0,U=new Array(256),M=0;M!=256;++M)W=M,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,W=W&1?-306674912^W>>>1:W>>>1,U[M]=W;return typeof Int32Array<"u"?new Int32Array(U):U}var e=t();function n(W){var U=0,M=0,X=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)F[X]=W[X];for(X=0;X!=256;++X)for(M=W[X],U=256+X;U<4096;U+=256)M=F[U]=M>>>8^W[M&255];var I=[];for(X=1;X!=16;++X)I[X-1]=typeof Int32Array<"u"?F.subarray(X*256,X*256+256):F.slice(X*256,X*256+256);return I}var r=n(e),a=r[0],s=r[1],o=r[2],l=r[3],c=r[4],u=r[5],h=r[6],g=r[7],d=r[8],b=r[9],_=r[10],w=r[11],E=r[12],A=r[13],D=r[14];function N(W,U){for(var M=U^-1,X=0,F=W.length;X<F;)M=M>>>8^e[(M^W.charCodeAt(X++))&255];return~M}function z(W,U){for(var M=U^-1,X=W.length-15,F=0;F<X;)M=D[W[F++]^M&255]^A[W[F++]^M>>8&255]^E[W[F++]^M>>16&255]^w[W[F++]^M>>>24]^_[W[F++]]^b[W[F++]]^d[W[F++]]^g[W[F++]]^h[W[F++]]^u[W[F++]]^c[W[F++]]^l[W[F++]]^o[W[F++]]^s[W[F++]]^a[W[F++]]^e[W[F++]];for(X+=15;F<X;)M=M>>>8^e[(M^W[F++])&255];return~M}function J(W,U){for(var M=U^-1,X=0,F=W.length,I=0,ee=0;X<F;)I=W.charCodeAt(X++),I<128?M=M>>>8^e[(M^I)&255]:I<2048?(M=M>>>8^e[(M^(192|I>>6&31))&255],M=M>>>8^e[(M^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,ee=W.charCodeAt(X++)&1023,M=M>>>8^e[(M^(240|I>>8&7))&255],M=M>>>8^e[(M^(128|I>>2&63))&255],M=M>>>8^e[(M^(128|ee>>6&15|(I&3)<<4))&255],M=M>>>8^e[(M^(128|ee&63))&255]):(M=M>>>8^e[(M^(224|I>>12&15))&255],M=M>>>8^e[(M^(128|I>>6&63))&255],M=M>>>8^e[(M^(128|I&63))&255]);return~M}return i.table=e,i.bstr=N,i.buf=z,i.str=J,i})(),$i=(function(){var t={};t.version="1.2.1";function e(j,ne){for(var Y=j.split("/"),Z=ne.split("/"),re=0,se=0,De=Math.min(Y.length,Z.length);re<De;++re){if(se=Y[re].length-Z[re].length)return se;if(Y[re]!=Z[re])return Y[re]<Z[re]?-1:1}return Y.length-Z.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var ne=j.lastIndexOf("/");return ne===-1?j:j.slice(0,ne+1)}function r(j){if(j.charAt(j.length-1)=="/")return r(j.slice(0,-1));var ne=j.lastIndexOf("/");return ne===-1?j:j.slice(ne+1)}function a(j,ne){typeof ne=="string"&&(ne=new Date(ne));var Y=ne.getHours();Y=Y<<6|ne.getMinutes(),Y=Y<<5|ne.getSeconds()>>>1,j.write_shift(2,Y);var Z=ne.getFullYear()-1980;Z=Z<<4|ne.getMonth()+1,Z=Z<<5|ne.getDate(),j.write_shift(2,Z)}function s(j){var ne=j.read_shift(2)&65535,Y=j.read_shift(2)&65535,Z=new Date,re=Y&31;Y>>>=5;var se=Y&15;Y>>>=4,Z.setMilliseconds(0),Z.setFullYear(Y+1980),Z.setMonth(se-1),Z.setDate(re);var De=ne&31;ne>>>=5;var ze=ne&63;return ne>>>=6,Z.setHours(ne),Z.setMinutes(ze),Z.setSeconds(De<<1),Z}function o(j){Da(j,0);for(var ne={},Y=0;j.l<=j.length-4;){var Z=j.read_shift(2),re=j.read_shift(2),se=j.l+re,De={};switch(Z){case 21589:Y=j.read_shift(1),Y&1&&(De.mtime=j.read_shift(4)),re>5&&(Y&2&&(De.atime=j.read_shift(4)),Y&4&&(De.ctime=j.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}j.l=se,ne[Z]=De}return ne}var l;function c(){return l||(l={})}function u(j,ne){if(j[0]==80&&j[1]==75)return fn(j,ne);if((j[0]|32)==109&&(j[1]|32)==105)return Ot(j,ne);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var Y=3,Z=512,re=0,se=0,De=0,ze=0,Le=0,Pe=[],Be=j.slice(0,512);Da(Be,0);var at=h(Be);switch(Y=at[0],Y){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(at[1]==0)return fn(j,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}Z!==512&&(Be=j.slice(0,Z),Da(Be,28));var ct=j.slice(0,Z);g(Be,Y);var vt=Be.read_shift(4,"i");if(Y===3&&vt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+vt);Be.l+=4,De=Be.read_shift(4,"i"),Be.l+=4,Be.chk("00100000","Mini Stream Cutoff Size: "),ze=Be.read_shift(4,"i"),re=Be.read_shift(4,"i"),Le=Be.read_shift(4,"i"),se=Be.read_shift(4,"i");for(var dt=-1,ht=0;ht<109&&(dt=Be.read_shift(4,"i"),!(dt<0));++ht)Pe[ht]=dt;var Wt=d(j,Z);w(Le,se,Wt,Z,Pe);var Pi=A(Wt,De,Pe,Z);Pi[De].name="!Directory",re>0&&ze!==ee&&(Pi[ze].name="!MiniFAT"),Pi[Pe[0]].name="!FAT",Pi.fat_addrs=Pe,Pi.ssz=Z;var Xi={},en=[],or=[],is=[];D(De,Pi,Wt,en,re,Xi,or,ze),b(or,is,en),en.shift();var Cs={FileIndex:or,FullPaths:is};return ne&&ne.raw&&(Cs.raw={header:ct,sectors:Wt}),Cs}function h(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(le,"Header Signature: "),j.l+=16;var ne=j.read_shift(2,"u");return[j.read_shift(2,"u"),ne]}function g(j,ne){var Y=9;switch(j.l+=2,Y=j.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function d(j,ne){for(var Y=Math.ceil(j.length/ne)-1,Z=[],re=1;re<Y;++re)Z[re-1]=j.slice(re*ne,(re+1)*ne);return Z[Y-1]=j.slice(Y*ne),Z}function b(j,ne,Y){for(var Z=0,re=0,se=0,De=0,ze=0,Le=Y.length,Pe=[],Be=[];Z<Le;++Z)Pe[Z]=Be[Z]=Z,ne[Z]=Y[Z];for(;ze<Be.length;++ze)Z=Be[ze],re=j[Z].L,se=j[Z].R,De=j[Z].C,Pe[Z]===Z&&(re!==-1&&Pe[re]!==re&&(Pe[Z]=Pe[re]),se!==-1&&Pe[se]!==se&&(Pe[Z]=Pe[se])),De!==-1&&(Pe[De]=Z),re!==-1&&Z!=Pe[Z]&&(Pe[re]=Pe[Z],Be.lastIndexOf(re)<ze&&Be.push(re)),se!==-1&&Z!=Pe[Z]&&(Pe[se]=Pe[Z],Be.lastIndexOf(se)<ze&&Be.push(se));for(Z=1;Z<Le;++Z)Pe[Z]===Z&&(se!==-1&&Pe[se]!==se?Pe[Z]=Pe[se]:re!==-1&&Pe[re]!==re&&(Pe[Z]=Pe[re]));for(Z=1;Z<Le;++Z)if(j[Z].type!==0){if(ze=Z,ze!=Pe[ze])do ze=Pe[ze],ne[Z]=ne[ze]+"/"+ne[Z];while(ze!==0&&Pe[ze]!==-1&&ze!=Pe[ze]);Pe[Z]=-1}for(ne[0]+="/",Z=1;Z<Le;++Z)j[Z].type!==2&&(ne[Z]+="/")}function _(j,ne,Y){for(var Z=j.start,re=j.size,se=[],De=Z;Y&&re>0&&De>=0;)se.push(ne.slice(De*I,De*I+I)),re-=I,De=l0(Y,De*4);return se.length===0?He(0):Nr(se).slice(0,j.size)}function w(j,ne,Y,Z,re){var se=ee;if(j===ee){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var De=Y[j],ze=(Z>>>2)-1;if(!De)return;for(var Le=0;Le<ze&&(se=l0(De,Le*4))!==ee;++Le)re.push(se);w(l0(De,Z-4),ne-1,Y,Z,re)}}function E(j,ne,Y,Z,re){var se=[],De=[];re||(re=[]);var ze=Z-1,Le=0,Pe=0;for(Le=ne;Le>=0;){re[Le]=!0,se[se.length]=Le,De.push(j[Le]);var Be=Y[Math.floor(Le*4/Z)];if(Pe=Le*4&ze,Z<4+Pe)throw new Error("FAT boundary crossed: "+Le+" 4 "+Z);if(!j[Be])break;Le=l0(j[Be],Pe)}return{nodes:se,data:fw([De])}}function A(j,ne,Y,Z){var re=j.length,se=[],De=[],ze=[],Le=[],Pe=Z-1,Be=0,at=0,ct=0,vt=0;for(Be=0;Be<re;++Be)if(ze=[],ct=Be+ne,ct>=re&&(ct-=re),!De[ct]){Le=[];var dt=[];for(at=ct;at>=0;){dt[at]=!0,De[at]=!0,ze[ze.length]=at,Le.push(j[at]);var ht=Y[Math.floor(at*4/Z)];if(vt=at*4&Pe,Z<4+vt)throw new Error("FAT boundary crossed: "+at+" 4 "+Z);if(!j[ht]||(at=l0(j[ht],vt),dt[at]))break}se[ct]={nodes:ze,data:fw([Le])}}return se}function D(j,ne,Y,Z,re,se,De,ze){for(var Le=0,Pe=Z.length?2:0,Be=ne[j].data,at=0,ct=0,vt;at<Be.length;at+=128){var dt=Be.slice(at,at+128);Da(dt,64),ct=dt.read_shift(2),vt=T1(dt,0,ct-Pe),Z.push(vt);var ht={name:vt,type:dt.read_shift(1),color:dt.read_shift(1),L:dt.read_shift(4,"i"),R:dt.read_shift(4,"i"),C:dt.read_shift(4,"i"),clsid:dt.read_shift(16),state:dt.read_shift(4,"i"),start:0,size:0},Wt=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);Wt!==0&&(ht.ct=N(dt,dt.l-8));var Pi=dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2)+dt.read_shift(2);Pi!==0&&(ht.mt=N(dt,dt.l-8)),ht.start=dt.read_shift(4,"i"),ht.size=dt.read_shift(4,"i"),ht.size<0&&ht.start<0&&(ht.size=ht.type=0,ht.start=ee,ht.name=""),ht.type===5?(Le=ht.start,re>0&&Le!==ee&&(ne[Le].name="!StreamData")):ht.size>=4096?(ht.storage="fat",ne[ht.start]===void 0&&(ne[ht.start]=E(Y,ht.start,ne.fat_addrs,ne.ssz)),ne[ht.start].name=ht.name,ht.content=ne[ht.start].data.slice(0,ht.size)):(ht.storage="minifat",ht.size<0?ht.size=0:Le!==ee&&ht.start!==ee&&ne[Le]&&(ht.content=_(ht,ne[Le].data,(ne[ze]||{}).data))),ht.content&&Da(ht.content,0),se[vt]=ht,De.push(ht)}}function N(j,ne){return new Date((mr(j,ne+4)/1e7*Math.pow(2,32)+mr(j,ne)/1e7-11644473600)*1e3)}function z(j,ne){return c(),u(l.readFileSync(j),ne)}function J(j,ne){var Y=ne&&ne.type;switch(Y||Fi&&Buffer.isBuffer(j)&&(Y="buffer"),Y||"base64"){case"file":return z(j,ne);case"base64":return u(gs(ko(j)),ne);case"binary":return u(gs(j),ne)}return u(j,ne)}function W(j,ne){var Y=ne||{},Z=Y.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=Z+"/",j.FileIndex[0]={name:Z,type:5}),Y.CLSID&&(j.FileIndex[0].clsid=Y.CLSID),U(j)}function U(j){var ne="Sh33tJ5";if(!$i.find(j,"/"+ne)){var Y=He(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,j.FileIndex.push({name:ne,type:2,content:Y,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+ne),M(j)}}function M(j,ne){W(j);for(var Y=!1,Z=!1,re=j.FullPaths.length-1;re>=0;--re){var se=j.FileIndex[re];switch(se.type){case 0:Z?Y=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(se.R*se.L*se.C)&&(Y=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!ne)){var De=new Date(1987,1,19),ze=0,Le=Object.create?Object.create(null):{},Pe=[];for(re=0;re<j.FullPaths.length;++re)Le[j.FullPaths[re]]=!0,j.FileIndex[re].type!==0&&Pe.push([j.FullPaths[re],j.FileIndex[re]]);for(re=0;re<Pe.length;++re){var Be=n(Pe[re][0]);Z=Le[Be],Z||(Pe.push([Be,{name:r(Be).replace("/",""),type:1,clsid:ke,ct:De,mt:De,content:null}]),Le[Be]=!0)}for(Pe.sort(function(vt,dt){return e(vt[0],dt[0])}),j.FullPaths=[],j.FileIndex=[],re=0;re<Pe.length;++re)j.FullPaths[re]=Pe[re][0],j.FileIndex[re]=Pe[re][1];for(re=0;re<Pe.length;++re){var at=j.FileIndex[re],ct=j.FullPaths[re];if(at.name=r(ct).replace("/",""),at.L=at.R=at.C=-(at.color=1),at.size=at.content?at.content.length:0,at.start=0,at.clsid=at.clsid||ke,re===0)at.C=Pe.length>1?1:-1,at.size=0,at.type=5;else if(ct.slice(-1)=="/"){for(ze=re+1;ze<Pe.length&&n(j.FullPaths[ze])!=ct;++ze);for(at.C=ze>=Pe.length?-1:ze,ze=re+1;ze<Pe.length&&n(j.FullPaths[ze])!=n(ct);++ze);at.R=ze>=Pe.length?-1:ze,at.type=1}else n(j.FullPaths[re+1]||"")==n(ct)&&(at.R=re+1),at.type=2}}}function X(j,ne){var Y=ne||{};if(Y.fileType=="mad")return es(j,Y);switch(M(j),Y.fileType){case"zip":return Bi(j,Y)}var Z=(function(vt){for(var dt=0,ht=0,Wt=0;Wt<vt.FileIndex.length;++Wt){var Pi=vt.FileIndex[Wt];if(Pi.content){var Xi=Pi.content.length;Xi>0&&(Xi<4096?dt+=Xi+63>>6:ht+=Xi+511>>9)}}for(var en=vt.FullPaths.length+3>>2,or=dt+7>>3,is=dt+127>>7,Cs=or+ht+en+is,Oa=Cs+127>>7,Ro=Oa<=109?0:Math.ceil((Oa-109)/127);Cs+Oa+Ro+127>>7>Oa;)Ro=++Oa<=109?0:Math.ceil((Oa-109)/127);var Or=[1,Ro,Oa,is,en,ht,dt,0];return vt.FileIndex[0].size=dt<<6,Or[7]=(vt.FileIndex[0].start=Or[0]+Or[1]+Or[2]+Or[3]+Or[4]+Or[5])+(Or[6]+7>>3),Or})(j),re=He(Z[7]<<9),se=0,De=0;{for(se=0;se<8;++se)re.write_shift(1,de[se]);for(se=0;se<8;++se)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),se=0;se<3;++se)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,Z[2]),re.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),re.write_shift(4,0),re.write_shift(4,4096),re.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:ee),re.write_shift(4,Z[3]),re.write_shift(-4,Z[1]?Z[0]-1:ee),re.write_shift(4,Z[1]),se=0;se<109;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1)}if(Z[1])for(De=0;De<Z[1];++De){for(;se<236+De*127;++se)re.write_shift(-4,se<Z[2]?Z[1]+se:-1);re.write_shift(-4,De===Z[1]-1?ee:De+1)}var ze=function(vt){for(De+=vt;se<De-1;++se)re.write_shift(-4,se+1);vt&&(++se,re.write_shift(-4,ee))};for(De=se=0,De+=Z[1];se<De;++se)re.write_shift(-4,Fe.DIFSECT);for(De+=Z[2];se<De;++se)re.write_shift(-4,Fe.FATSECT);ze(Z[3]),ze(Z[4]);for(var Le=0,Pe=0,Be=j.FileIndex[0];Le<j.FileIndex.length;++Le)Be=j.FileIndex[Le],Be.content&&(Pe=Be.content.length,!(Pe<4096)&&(Be.start=De,ze(Pe+511>>9)));for(ze(Z[6]+7>>3);re.l&511;)re.write_shift(-4,Fe.ENDOFCHAIN);for(De=se=0,Le=0;Le<j.FileIndex.length;++Le)Be=j.FileIndex[Le],Be.content&&(Pe=Be.content.length,!(!Pe||Pe>=4096)&&(Be.start=De,ze(Pe+63>>6)));for(;re.l&511;)re.write_shift(-4,Fe.ENDOFCHAIN);for(se=0;se<Z[4]<<2;++se){var at=j.FullPaths[se];if(!at||at.length===0){for(Le=0;Le<17;++Le)re.write_shift(4,0);for(Le=0;Le<3;++Le)re.write_shift(4,-1);for(Le=0;Le<12;++Le)re.write_shift(4,0);continue}Be=j.FileIndex[se],se===0&&(Be.start=Be.size?Be.start-1:ee);var ct=se===0&&Y.root||Be.name;if(Pe=2*(ct.length+1),re.write_shift(64,ct,"utf16le"),re.write_shift(2,Pe),re.write_shift(1,Be.type),re.write_shift(1,Be.color),re.write_shift(-4,Be.L),re.write_shift(-4,Be.R),re.write_shift(-4,Be.C),Be.clsid)re.write_shift(16,Be.clsid,"hex");else for(Le=0;Le<4;++Le)re.write_shift(4,0);re.write_shift(4,Be.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,Be.start),re.write_shift(4,Be.size),re.write_shift(4,0)}for(se=1;se<j.FileIndex.length;++se)if(Be=j.FileIndex[se],Be.size>=4096)if(re.l=Be.start+1<<9,Fi&&Buffer.isBuffer(Be.content))Be.content.copy(re,re.l,0,Be.size),re.l+=Be.size+511&-512;else{for(Le=0;Le<Be.size;++Le)re.write_shift(1,Be.content[Le]);for(;Le&511;++Le)re.write_shift(1,0)}for(se=1;se<j.FileIndex.length;++se)if(Be=j.FileIndex[se],Be.size>0&&Be.size<4096)if(Fi&&Buffer.isBuffer(Be.content))Be.content.copy(re,re.l,0,Be.size),re.l+=Be.size+63&-64;else{for(Le=0;Le<Be.size;++Le)re.write_shift(1,Be.content[Le]);for(;Le&63;++Le)re.write_shift(1,0)}if(Fi)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function F(j,ne){var Y=j.FullPaths.map(function(Le){return Le.toUpperCase()}),Z=Y.map(function(Le){var Pe=Le.split("/");return Pe[Pe.length-(Le.slice(-1)=="/"?2:1)]}),re=!1;ne.charCodeAt(0)===47?(re=!0,ne=Y[0].slice(0,-1)+ne):re=ne.indexOf("/")!==-1;var se=ne.toUpperCase(),De=re===!0?Y.indexOf(se):Z.indexOf(se);if(De!==-1)return j.FileIndex[De];var ze=!se.match(t1);for(se=se.replace(hc,""),ze&&(se=se.replace(t1,"!")),De=0;De<Y.length;++De)if((ze?Y[De].replace(t1,"!"):Y[De]).replace(hc,"")==se||(ze?Z[De].replace(t1,"!"):Z[De]).replace(hc,"")==se)return j.FileIndex[De];return null}var I=64,ee=-2,le="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],ke="00000000000000000000000000000000",Fe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:le,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ke,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(j,ne,Y){c();var Z=X(j,Y);l.writeFileSync(ne,Z)}function Oe(j){for(var ne=new Array(j.length),Y=0;Y<j.length;++Y)ne[Y]=String.fromCharCode(j[Y]);return ne.join("")}function Ze(j,ne){var Y=X(j,ne);switch(ne&&ne.type||"buffer"){case"file":return c(),l.writeFileSync(ne.filename,Y),Y;case"binary":return typeof Y=="string"?Y:Oe(Y);case"base64":return ad(typeof Y=="string"?Y:Oe(Y));case"buffer":if(Fi)return Buffer.isBuffer(Y)?Y:Ao(Y);case"array":return typeof Y=="string"?gs(Y):Y}return Y}var qe;function k(j){try{var ne=j.InflateRaw,Y=new ne;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)qe=j;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function B(j,ne){if(!qe)return ci(j,ne);var Y=qe.InflateRaw,Z=new Y,re=Z._processChunk(j.slice(j.l),Z._finishFlushFlag);return j.l+=Z.bytesRead,re}function P(j){return qe?qe.deflateRawSync(j):Vt(j)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(j){var ne=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var pe=typeof Uint8Array<"u",ge=pe?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)ge[Xe]=ye(Xe);function Je(j,ne){var Y=ge[j&255];return ne<=8?Y>>>8-ne:(Y=Y<<8|ge[j>>8&255],ne<=16?Y>>>16-ne:(Y=Y<<8|ge[j>>16&255],Y>>>24-ne))}function ut(j,ne){var Y=ne&7,Z=ne>>>3;return(j[Z]|(Y<=6?0:j[Z+1]<<8))>>>Y&3}function Ne(j,ne){var Y=ne&7,Z=ne>>>3;return(j[Z]|(Y<=5?0:j[Z+1]<<8))>>>Y&7}function oe(j,ne){var Y=ne&7,Z=ne>>>3;return(j[Z]|(Y<=4?0:j[Z+1]<<8))>>>Y&15}function Ft(j,ne){var Y=ne&7,Z=ne>>>3;return(j[Z]|(Y<=3?0:j[Z+1]<<8))>>>Y&31}function et(j,ne){var Y=ne&7,Z=ne>>>3;return(j[Z]|(Y<=1?0:j[Z+1]<<8))>>>Y&127}function bt(j,ne,Y){var Z=ne&7,re=ne>>>3,se=(1<<Y)-1,De=j[re]>>>Z;return Y<8-Z||(De|=j[re+1]<<8-Z,Y<16-Z)||(De|=j[re+2]<<16-Z,Y<24-Z)||(De|=j[re+3]<<24-Z),De&se}function rt(j,ne,Y){var Z=ne&7,re=ne>>>3;return Z<=5?j[re]|=(Y&7)<<Z:(j[re]|=Y<<Z&255,j[re+1]=(Y&7)>>8-Z),ne+3}function yt(j,ne,Y){var Z=ne&7,re=ne>>>3;return Y=(Y&1)<<Z,j[re]|=Y,ne+1}function mt(j,ne,Y){var Z=ne&7,re=ne>>>3;return Y<<=Z,j[re]|=Y&255,Y>>>=8,j[re+1]=Y,ne+8}function Jt(j,ne,Y){var Z=ne&7,re=ne>>>3;return Y<<=Z,j[re]|=Y&255,Y>>>=8,j[re+1]=Y&255,j[re+2]=Y>>>8,ne+16}function Nt(j,ne){var Y=j.length,Z=2*Y>ne?2*Y:ne+5,re=0;if(Y>=ne)return j;if(Fi){var se=Z5(Z);if(j.copy)j.copy(se);else for(;re<j.length;++re)se[re]=j[re];return se}else if(pe){var De=new Uint8Array(Z);if(De.set)De.set(j);else for(;re<Y;++re)De[re]=j[re];return De}return j.length=Z,j}function ri(j){for(var ne=new Array(j),Y=0;Y<j;++Y)ne[Y]=0;return ne}function qt(j,ne,Y){var Z=1,re=0,se=0,De=0,ze=0,Le=j.length,Pe=pe?new Uint16Array(32):ri(32);for(se=0;se<32;++se)Pe[se]=0;for(se=Le;se<Y;++se)j[se]=0;Le=j.length;var Be=pe?new Uint16Array(Le):ri(Le);for(se=0;se<Le;++se)Pe[re=j[se]]++,Z<re&&(Z=re),Be[se]=0;for(Pe[0]=0,se=1;se<=Z;++se)Pe[se+16]=ze=ze+Pe[se-1]<<1;for(se=0;se<Le;++se)ze=j[se],ze!=0&&(Be[se]=Pe[ze+16]++);var at=0;for(se=0;se<Le;++se)if(at=j[se],at!=0)for(ze=Je(Be[se],Z)>>Z-at,De=(1<<Z+4-at)-1;De>=0;--De)ne[ze|De<<at]=at&15|se<<4;return Z}var Gt=pe?new Uint16Array(512):ri(512),Ci=pe?new Uint16Array(32):ri(32);if(!pe){for(var jt=0;jt<512;++jt)Gt[jt]=0;for(jt=0;jt<32;++jt)Ci[jt]=0}(function(){for(var j=[],ne=0;ne<32;ne++)j.push(5);qt(j,Ci,32);var Y=[];for(ne=0;ne<=143;ne++)Y.push(8);for(;ne<=255;ne++)Y.push(9);for(;ne<=279;ne++)Y.push(7);for(;ne<=287;ne++)Y.push(8);qt(Y,Gt,288)})();var Lt=(function(){for(var ne=pe?new Uint8Array(32768):[],Y=0,Z=0;Y<fe.length-1;++Y)for(;Z<fe[Y+1];++Z)ne[Z]=Y;for(;Z<32768;++Z)ne[Z]=29;var re=pe?new Uint8Array(259):[];for(Y=0,Z=0;Y<Q.length-1;++Y)for(;Z<Q[Y+1];++Z)re[Z]=Y;function se(ze,Le){for(var Pe=0;Pe<ze.length;){var Be=Math.min(65535,ze.length-Pe),at=Pe+Be==ze.length;for(Le.write_shift(1,+at),Le.write_shift(2,Be),Le.write_shift(2,~Be&65535);Be-- >0;)Le[Le.l++]=ze[Pe++]}return Le.l}function De(ze,Le){for(var Pe=0,Be=0,at=pe?new Uint16Array(32768):[];Be<ze.length;){var ct=Math.min(65535,ze.length-Be);if(ct<10){for(Pe=rt(Le,Pe,+(Be+ct==ze.length)),Pe&7&&(Pe+=8-(Pe&7)),Le.l=Pe/8|0,Le.write_shift(2,ct),Le.write_shift(2,~ct&65535);ct-- >0;)Le[Le.l++]=ze[Be++];Pe=Le.l*8;continue}Pe=rt(Le,Pe,+(Be+ct==ze.length)+2);for(var vt=0;ct-- >0;){var dt=ze[Be];vt=(vt<<5^dt)&32767;var ht=-1,Wt=0;if((ht=at[vt])&&(ht|=Be&-32768,ht>Be&&(ht-=32768),ht<Be))for(;ze[ht+Wt]==ze[Be+Wt]&&Wt<250;)++Wt;if(Wt>2){dt=re[Wt],dt<=22?Pe=mt(Le,Pe,ge[dt+1]>>1)-1:(mt(Le,Pe,3),Pe+=5,mt(Le,Pe,ge[dt-23]>>5),Pe+=3);var Pi=dt<8?0:dt-4>>2;Pi>0&&(Jt(Le,Pe,Wt-Q[dt]),Pe+=Pi),dt=ne[Be-ht],Pe=mt(Le,Pe,ge[dt]>>3),Pe-=3;var Xi=dt<4?0:dt-2>>1;Xi>0&&(Jt(Le,Pe,Be-ht-fe[dt]),Pe+=Xi);for(var en=0;en<Wt;++en)at[vt]=Be&32767,vt=(vt<<5^ze[Be])&32767,++Be;ct-=Wt-1}else dt<=143?dt=dt+48:Pe=yt(Le,Pe,1),Pe=mt(Le,Pe,ge[dt]),at[vt]=Be&32767,++Be}Pe=mt(Le,Pe,0)-1}return Le.l=(Pe+7)/8|0,Le.l}return function(Le,Pe){return Le.length<8?se(Le,Pe):De(Le,Pe)}})();function Vt(j){var ne=He(50+Math.floor(j.length*1.1)),Y=Lt(j,ne);return ne.slice(0,Y)}var Pt=pe?new Uint16Array(32768):ri(32768),Ri=pe?new Uint16Array(32768):ri(32768),vi=pe?new Uint16Array(128):ri(128),Et=1,Yt=1;function Oi(j,ne){var Y=Ft(j,ne)+257;ne+=5;var Z=Ft(j,ne)+1;ne+=5;var re=oe(j,ne)+4;ne+=4;for(var se=0,De=pe?new Uint8Array(19):ri(19),ze=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Le=1,Pe=pe?new Uint8Array(8):ri(8),Be=pe?new Uint8Array(8):ri(8),at=De.length,ct=0;ct<re;++ct)De[O[ct]]=se=Ne(j,ne),Le<se&&(Le=se),Pe[se]++,ne+=3;var vt=0;for(Pe[0]=0,ct=1;ct<=Le;++ct)Be[ct]=vt=vt+Pe[ct-1]<<1;for(ct=0;ct<at;++ct)(vt=De[ct])!=0&&(ze[ct]=Be[vt]++);var dt=0;for(ct=0;ct<at;++ct)if(dt=De[ct],dt!=0){vt=ge[ze[ct]]>>8-dt;for(var ht=(1<<7-dt)-1;ht>=0;--ht)vi[vt|ht<<dt]=dt&7|ct<<3}var Wt=[];for(Le=1;Wt.length<Y+Z;)switch(vt=vi[et(j,ne)],ne+=vt&7,vt>>>=3){case 16:for(se=3+ut(j,ne),ne+=2,vt=Wt[Wt.length-1];se-- >0;)Wt.push(vt);break;case 17:for(se=3+Ne(j,ne),ne+=3;se-- >0;)Wt.push(0);break;case 18:for(se=11+et(j,ne),ne+=7;se-- >0;)Wt.push(0);break;default:Wt.push(vt),Le<vt&&(Le=vt);break}var Pi=Wt.slice(0,Y),Xi=Wt.slice(Y);for(ct=Y;ct<286;++ct)Pi[ct]=0;for(ct=Z;ct<30;++ct)Xi[ct]=0;return Et=qt(Pi,Pt,286),Yt=qt(Xi,Ri,30),ne}function Rt(j,ne){if(j[0]==3&&!(j[1]&3))return[d0(ne),2];for(var Y=0,Z=0,re=Z5(ne||1<<18),se=0,De=re.length>>>0,ze=0,Le=0;(Z&1)==0;){if(Z=Ne(j,Y),Y+=3,Z>>>1)Z>>1==1?(ze=9,Le=5):(Y=Oi(j,Y),ze=Et,Le=Yt);else{Y&7&&(Y+=8-(Y&7));var Pe=j[Y>>>3]|j[(Y>>>3)+1]<<8;if(Y+=32,Pe>0)for(!ne&&De<se+Pe&&(re=Nt(re,se+Pe),De=re.length);Pe-- >0;)re[se++]=j[Y>>>3],Y+=8;continue}for(;;){!ne&&De<se+32767&&(re=Nt(re,se+32767),De=re.length);var Be=bt(j,Y,ze),at=Z>>>1==1?Gt[Be]:Pt[Be];if(Y+=at&15,at>>>=4,(at>>>8&255)===0)re[se++]=at;else{if(at==256)break;at-=257;var ct=at<8?0:at-4>>2;ct>5&&(ct=0);var vt=se+Q[at];ct>0&&(vt+=bt(j,Y,ct),Y+=ct),Be=bt(j,Y,Le),at=Z>>>1==1?Ci[Be]:Ri[Be],Y+=at&15,at>>>=4;var dt=at<4?0:at-2>>1,ht=fe[at];for(dt>0&&(ht+=bt(j,Y,dt),Y+=dt),!ne&&De<vt&&(re=Nt(re,vt+100),De=re.length);se<vt;)re[se]=re[se-ht],++se}}}return ne?[re,Y+7>>>3]:[re.slice(0,se),Y+7>>>3]}function ci(j,ne){var Y=j.slice(j.l||0),Z=Rt(Y,ne);return j.l+=Z[1],Z[0]}function Kt(j,ne){if(j)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function fn(j,ne){var Y=j;Da(Y,0);var Z=[],re=[],se={FileIndex:Z,FullPaths:re};W(se,{root:ne.root});for(var De=Y.length-4;(Y[De]!=80||Y[De+1]!=75||Y[De+2]!=5||Y[De+3]!=6)&&De>=0;)--De;Y.l=De+4,Y.l+=4;var ze=Y.read_shift(2);Y.l+=6;var Le=Y.read_shift(4);for(Y.l=Le,De=0;De<ze;++De){Y.l+=20;var Pe=Y.read_shift(4),Be=Y.read_shift(4),at=Y.read_shift(2),ct=Y.read_shift(2),vt=Y.read_shift(2);Y.l+=8;var dt=Y.read_shift(4),ht=o(Y.slice(Y.l+at,Y.l+at+ct));Y.l+=at+ct+vt;var Wt=Y.l;Y.l=dt+4,Tn(Y,Pe,Be,se,ht),Y.l=Wt}return se}function Tn(j,ne,Y,Z,re){j.l+=2;var se=j.read_shift(2),De=j.read_shift(2),ze=s(j);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Le=j.read_shift(4),Pe=j.read_shift(4),Be=j.read_shift(4),at=j.read_shift(2),ct=j.read_shift(2),vt="",dt=0;dt<at;++dt)vt+=String.fromCharCode(j[j.l++]);if(ct){var ht=o(j.slice(j.l,j.l+ct));(ht[21589]||{}).mt&&(ze=ht[21589].mt),((re||{})[21589]||{}).mt&&(ze=re[21589].mt)}j.l+=ct;var Wt=j.slice(j.l,j.l+Pe);switch(De){case 8:Wt=B(j,Be);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var Pi=!1;se&8&&(Le=j.read_shift(4),Le==134695760&&(Le=j.read_shift(4),Pi=!0),Pe=j.read_shift(4),Be=j.read_shift(4)),Pe!=ne&&Kt(Pi,"Bad compressed size: "+ne+" != "+Pe),Be!=Y&&Kt(Pi,"Bad uncompressed size: "+Y+" != "+Be),Rr(Z,vt,Wt,{unsafe:!0,mt:ze})}function Bi(j,ne){var Y=ne||{},Z=[],re=[],se=He(1),De=Y.compression?8:0,ze=0,Le=!1;Le&&(ze|=8);var Pe=0,Be=0,at=0,ct=0,vt=j.FullPaths[0],dt=vt,ht=j.FileIndex[0],Wt=[],Pi=0;for(Pe=1;Pe<j.FullPaths.length;++Pe)if(dt=j.FullPaths[Pe].slice(vt.length),ht=j.FileIndex[Pe],!(!ht.size||!ht.content||dt=="Sh33tJ5")){var Xi=at,en=He(dt.length);for(Be=0;Be<dt.length;++Be)en.write_shift(1,dt.charCodeAt(Be)&127);en=en.slice(0,en.l),Wt[ct]=gP.buf(ht.content,0);var or=ht.content;De==8&&(or=P(or)),se=He(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,ze),se.write_shift(2,De),ht.mt?a(se,ht.mt):se.write_shift(4,0),se.write_shift(-4,ze&8?0:Wt[ct]),se.write_shift(4,ze&8?0:or.length),se.write_shift(4,ze&8?0:ht.content.length),se.write_shift(2,en.length),se.write_shift(2,0),at+=se.length,Z.push(se),at+=en.length,Z.push(en),at+=or.length,Z.push(or),ze&8&&(se=He(12),se.write_shift(-4,Wt[ct]),se.write_shift(4,or.length),se.write_shift(4,ht.content.length),at+=se.l,Z.push(se)),se=He(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,ze),se.write_shift(2,De),se.write_shift(4,0),se.write_shift(-4,Wt[ct]),se.write_shift(4,or.length),se.write_shift(4,ht.content.length),se.write_shift(2,en.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Xi),Pi+=se.l,re.push(se),Pi+=en.length,re.push(en),++ct}return se=He(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,ct),se.write_shift(2,ct),se.write_shift(4,Pi),se.write_shift(4,at),se.write_shift(2,0),Nr([Nr(Z),Nr(re),se])}var Ut={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ei(j,ne){if(j.ctype)return j.ctype;var Y=j.name||"",Z=Y.match(/\.([^\.]+)$/);return Z&&Ut[Z[1]]||ne&&(Z=(Y=ne).match(/[\.\\]([^\.\\])+$/),Z&&Ut[Z[1]])?Ut[Z[1]]:"application/octet-stream"}function Js(j){for(var ne=ad(j),Y=[],Z=0;Z<ne.length;Z+=76)Y.push(ne.slice(Z,Z+76));return Y.join(`\r
`)+`\r
`}function sr(j){var ne=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Pe){var Be=Pe.charCodeAt(0).toString(16).toUpperCase();return"="+(Be.length==1?"0"+Be:Be)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],Z=ne.split(`\r
`),re=0;re<Z.length;++re){var se=Z[re];if(se.length==0){Y.push("");continue}for(var De=0;De<se.length;){var ze=76,Le=se.slice(De,De+ze);Le.charAt(ze-1)=="="?ze--:Le.charAt(ze-2)=="="?ze-=2:Le.charAt(ze-3)=="="&&(ze-=3),Le=se.slice(De,De+ze),De+=ze,De<se.length&&(Le+="="),Y.push(Le)}}return Y.join(`\r
`)}function Qa(j){for(var ne=[],Y=0;Y<j.length;++Y){for(var Z=j[Y];Y<=j.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+j[++Y];ne.push(Z)}for(var re=0;re<ne.length;++re)ne[re]=ne[re].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return gs(ne.join(`\r
`))}function Ra(j,ne,Y){for(var Z="",re="",se="",De,ze=0;ze<10;++ze){var Le=ne[ze];if(!Le||Le.match(/^\s*$/))break;var Pe=Le.match(/^(.*?):\s*([^\s].*)$/);if(Pe)switch(Pe[1].toLowerCase()){case"content-location":Z=Pe[2].trim();break;case"content-type":se=Pe[2].trim();break;case"content-transfer-encoding":re=Pe[2].trim();break}}switch(++ze,re.toLowerCase()){case"base64":De=gs(ko(ne.slice(ze).join("")));break;case"quoted-printable":De=Qa(ne.slice(ze));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var Be=Rr(j,Z.slice(Y.length),De,{unsafe:!0});se&&(Be.ctype=se)}function Ot(j,ne){if(Oe(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=ne&&ne.root||"",Z=(Fi&&Buffer.isBuffer(j)?j.toString("binary"):Oe(j)).split(`\r
`),re=0,se="";for(re=0;re<Z.length;++re)if(se=Z[re],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),Y||(Y=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),se.slice(0,Y.length)!=Y););var De=(Z[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var ze="--"+(De[1]||""),Le=[],Pe=[],Be={FileIndex:Le,FullPaths:Pe};W(Be);var at,ct=0;for(re=0;re<Z.length;++re){var vt=Z[re];vt!==ze&&vt!==ze+"--"||(ct++&&Ra(Be,Z.slice(at,re),Y),at=re)}return Be}function es(j,ne){var Y=ne||{},Z=Y.boundary||"SheetJS";Z="------="+Z;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],se=j.FullPaths[0],De=se,ze=j.FileIndex[0],Le=1;Le<j.FullPaths.length;++Le)if(De=j.FullPaths[Le].slice(se.length),ze=j.FileIndex[Le],!(!ze.size||!ze.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Wt){return"_x"+Wt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Wt){return"_u"+Wt.charCodeAt(0).toString(16)+"_"});for(var Pe=ze.content,Be=Fi&&Buffer.isBuffer(Pe)?Pe.toString("binary"):Oe(Pe),at=0,ct=Math.min(1024,Be.length),vt=0,dt=0;dt<=ct;++dt)(vt=Be.charCodeAt(dt))>=32&&vt<128&&++at;var ht=at>=ct*4/5;re.push(Z),re.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+De),re.push("Content-Transfer-Encoding: "+(ht?"quoted-printable":"base64")),re.push("Content-Type: "+Ei(ze,De)),re.push(""),re.push(ht?sr(Be):Js(Be))}return re.push(Z+`--\r
`),re.join(`\r
`)}function ts(j){var ne={};return W(ne,j),ne}function Rr(j,ne,Y,Z){var re=Z&&Z.unsafe;re||W(j);var se=!re&&$i.find(j,ne);if(!se){var De=j.FullPaths[0];ne.slice(0,De.length)==De?De=ne:(De.slice(-1)!="/"&&(De+="/"),De=(De+ne).replace("//","/")),se={name:r(ne),type:2},j.FileIndex.push(se),j.FullPaths.push(De),re||$i.utils.cfb_gc(j)}return se.content=Y,se.size=Y?Y.length:0,Z&&(Z.CLSID&&(se.clsid=Z.CLSID),Z.mt&&(se.mt=Z.mt),Z.ct&&(se.ct=Z.ct)),se}function sa(j,ne){W(j);var Y=$i.find(j,ne);if(Y){for(var Z=0;Z<j.FileIndex.length;++Z)if(j.FileIndex[Z]==Y)return j.FileIndex.splice(Z,1),j.FullPaths.splice(Z,1),!0}return!1}function hn(j,ne,Y){W(j);var Z=$i.find(j,ne);if(Z){for(var re=0;re<j.FileIndex.length;++re)if(j.FileIndex[re]==Z)return j.FileIndex[re].name=r(Y),j.FullPaths[re]=Y,!0}return!1}function On(j){M(j,!0)}return t.find=F,t.read=J,t.parse=u,t.write=Ze,t.writeFile=Se,t.utils={cfb_new:ts,cfb_add:Rr,cfb_del:sa,cfb_mov:hn,cfb_gc:On,ReadShift:Qu,CheckField:ly,prep_blob:Da,bconcat:Nr,use_zlib:k,_deflateRaw:Vt,_inflateRaw:ci,consts:Fe},t})(),n1;function xP(i){return typeof i=="string"?y1(i):Array.isArray(i)?HN(i):i}function dd(i,t,e){if(typeof n1<"u"&&n1.writeFileSync)return e?n1.writeFileSync(i,t,e):n1.writeFileSync(i,t);if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=y1(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(i,t)}var n=e=="utf8"?yo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,i);if(typeof Blob<"u"){var r=new Blob([xP(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,i);if(typeof saveAs<"u")return saveAs(r,i);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:i,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=i,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(i);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=ud(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+i)}function Lr(i){for(var t=Object.keys(i),e=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(i,t[n])&&e.push(t[n]);return e}function aw(i,t){for(var e=[],n=Lr(i),r=0;r!==n.length;++r)e[i[n[r]][t]]==null&&(e[i[n[r]][t]]=n[r]);return e}function Wg(i){for(var t=[],e=Lr(i),n=0;n!==e.length;++n)t[i[e[n]]]=e[n];return t}function E1(i){for(var t=[],e=Lr(i),n=0;n!==e.length;++n)t[i[e[n]]]=parseInt(e[n],10);return t}function vP(i){for(var t=[],e=Lr(i),n=0;n!==e.length;++n)t[i[e[n]]]==null&&(t[i[e[n]]]=[]),t[i[e[n]]].push(e[n]);return t}var f1=new Date(1899,11,30,0,0,0);function ma(i,t){var e=i.getTime();t&&(e-=1462*24*60*60*1e3);var n=f1.getTime()+(i.getTimezoneOffset()-f1.getTimezoneOffset())*6e4;return(e-n)/(1440*60*1e3)}var Kw=new Date,_P=f1.getTime()+(Kw.getTimezoneOffset()-f1.getTimezoneOffset())*6e4,sw=Kw.getTimezoneOffset();function Zw(i){var t=new Date;return t.setTime(i*24*60*60*1e3+_P),t.getTimezoneOffset()!==sw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sw)*6e4),t}var ow=new Date("2017-02-19T19:06:09.000Z"),Jw=isNaN(ow.getFullYear())?new Date("2/19/17"):ow,bP=Jw.getFullYear()==2017;function na(i,t){var e=new Date(i);if(bP)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(i instanceof Date)return i;if(Jw.getFullYear()==1917&&!isNaN(e.getFullYear())){var n=e.getFullYear();return i.indexOf(""+n)>-1||e.setFullYear(e.getFullYear()+100),e}var r=i.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return i.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function k1(i,t){if(Fi&&Buffer.isBuffer(i)){if(t){if(i[0]==255&&i[1]==254)return yo(i.slice(2).toString("utf16le"));if(i[1]==254&&i[2]==255)return yo(zN(i.slice(2).toString("binary")))}return i.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(i[0]==255&&i[1]==254)return yo(new TextDecoder("utf-16le").decode(i.slice(2)));if(i[0]==254&&i[1]==255)return yo(new TextDecoder("utf-16be").decode(i.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(i)&&(i=new Uint8Array(i)),new TextDecoder("latin1").decode(i).replace(/[]/g,function(a){return e[a]||a})}catch{}for(var n=[],r=0;r!=i.length;++r)n.push(String.fromCharCode(i[r]));return n.join("")}function ga(i){if(typeof JSON<"u"&&!Array.isArray(i))return JSON.parse(JSON.stringify(i));if(typeof i!="object"||i==null)return i;if(i instanceof Date)return new Date(i.getTime());var t={};for(var e in i)Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=ga(i[e]));return t}function Cn(i,t){for(var e="";e.length<t;)e+=i;return e}function Co(i){var t=Number(i);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(i))return t;var e=1,n=i.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(r,a){return e=-e,a}),!isNaN(t=Number(n)))?t/e:t}var wP=["january","february","march","april","may","june","july","august","september","october","november","december"];function sd(i){var t=new Date(i),e=new Date(NaN),n=t.getYear(),r=t.getMonth(),a=t.getDate();if(isNaN(a))return e;var s=i.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&wP.indexOf(s)==-1)return e}else if(s.match(/[a-z]/))return e;return n<0||n>8099?e:(r>0||a>1)&&n!=101?t:i.match(/[^-0-9:,\/\\]/)?e:t}function li(i,t,e){if(i.FullPaths){if(typeof e=="string"){var n;return Fi?n=Ao(e):n=WN(e),$i.utils.cfb_add(i,t,n)}$i.utils.cfb_add(i,t,e)}else i.file(t,e)}function qg(){return $i.utils.cfb_new()}var Xn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var yP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Gg=Wg(yP);var $g=/[&<>'"]/g,SP=/[\u0000-\u0008\u000b-\u001f]/g;function Wi(i){var t=i+"";return t.replace($g,function(e){return Gg[e]}).replace(SP,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lw(i){return Wi(i).replace(/ /g,"_x0020_")}var Qw=/[\u0000-\u001f]/g;function CP(i){var t=i+"";return t.replace($g,function(e){return Gg[e]}).replace(/\n/g,"<br/>").replace(Qw,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function EP(i){var t=i+"";return t.replace($g,function(e){return Gg[e]}).replace(Qw,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function kP(i){return i.replace(/(\r\n|[\r\n])/g,"&#10;")}function TP(i){switch(i){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ng(i){for(var t="",e=0,n=0,r=0,a=0,s=0,o=0;e<i.length;){if(n=i.charCodeAt(e++),n<128){t+=String.fromCharCode(n);continue}if(r=i.charCodeAt(e++),n>191&&n<224){s=(n&31)<<6,s|=r&63,t+=String.fromCharCode(s);continue}if(a=i.charCodeAt(e++),n<240){t+=String.fromCharCode((n&15)<<12|(r&63)<<6|a&63);continue}s=i.charCodeAt(e++),o=((n&7)<<18|(r&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function cw(i){var t=d0(2*i.length),e,n,r=1,a=0,s=0,o;for(n=0;n<i.length;n+=r)r=1,(o=i.charCodeAt(n))<128?e=o:o<224?(e=(o&31)*64+(i.charCodeAt(n+1)&63),r=2):o<240?(e=(o&15)*4096+(i.charCodeAt(n+1)&63)*64+(i.charCodeAt(n+2)&63),r=3):(r=4,e=(o&7)*262144+(i.charCodeAt(n+1)&63)*4096+(i.charCodeAt(n+2)&63)*64+(i.charCodeAt(n+3)&63),e-=65536,s=55296+(e>>>10&1023),e=56320+(e&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=e%256,t[a++]=e>>>8;return t.slice(0,a).toString("ucs2")}function uw(i){return Ao(i,"binary").toString("utf8")}var r1="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Ju=Fi&&(uw(r1)==Ng(r1)&&uw||cw(r1)==Ng(r1)&&cw)||Ng,yo=Fi?function(i){return Ao(i,"utf8").toString("binary")}:function(i){for(var t=[],e=0,n=0,r=0;e<i.length;)switch(n=i.charCodeAt(e++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,r=i.charCodeAt(e++)-56320+(n<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")};var AP=(function(){var i=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<i.length;++r)n=n.replace(i[r][0],i[r][1]);return n}})();var ey=/(^\s|\s$|\n)/;function Pr(i,t){return"<"+i+(t.match(ey)?' xml:space="preserve"':"")+">"+t+"</"+i+">"}function od(i){return Lr(i).map(function(t){return" "+t+'="'+i[t]+'"'}).join("")}function ft(i,t,e){return"<"+i+(e!=null?od(e):"")+(t!=null?(t.match(ey)?' xml:space="preserve"':"")+">"+t+"</"+i:"/")+">"}function jg(i,t){try{return i.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function FP(i,t){switch(typeof i){case"string":var e=ft("vt:lpwstr",Wi(i));return t&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return ft((i|0)==i?"vt:i4":"vt:r8",Wi(String(i)));case"boolean":return ft("vt:bool",i?"true":"false")}if(i instanceof Date)return ft("vt:filetime",jg(i));throw new Error("Unable to serialize "+i)}var gr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},bc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Na={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function DP(i,t){for(var e=1-2*(i[t+7]>>>7),n=((i[t+7]&127)<<4)+(i[t+6]>>>4&15),r=i[t+6]&15,a=5;a>=0;--a)r=r*256+i[t+a];return n==2047?r==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,r+=Math.pow(2,52)),e*Math.pow(2,n-52)*r)}function NP(i,t,e){var n=(t<0||1/t==-1/0?1:0)<<7,r=0,a=0,s=n?-t:t;isFinite(s)?s==0?r=a=0:(r=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)i[e+o]=a&255;i[e+6]=(r&15)<<4|a&15,i[e+7]=r>>4|n}var dw=function(i){for(var t=[],e=10240,n=0;n<i[0].length;++n)if(i[0][n])for(var r=0,a=i[0][n].length;r<a;r+=e)t.push.apply(t,i[0][n].slice(r,r+e));return t},fw=Fi?function(i){return i[0].length>0&&Buffer.isBuffer(i[0][0])?Buffer.concat(i[0].map(function(t){return Buffer.isBuffer(t)?t:Ao(t)})):dw(i)}:dw,hw=function(i,t,e){for(var n=[],r=t;r<e;r+=2)n.push(String.fromCharCode(Zu(i,r)));return n.join("").replace(hc,"")},T1=Fi?function(i,t,e){return Buffer.isBuffer(i)?i.toString("utf16le",t,e).replace(hc,""):hw(i,t,e)}:hw,pw=function(i,t,e){for(var n=[],r=t;r<t+e;++r)n.push(("0"+i[r].toString(16)).slice(-2));return n.join("")},ty=Fi?function(i,t,e){return Buffer.isBuffer(i)?i.toString("hex",t,t+e):pw(i,t,e)}:pw,mw=function(i,t,e){for(var n=[],r=t;r<e;r++)n.push(String.fromCharCode(dc(i,r)));return n.join("")},wc=Fi?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf8",e,n):mw(t,e,n)}:mw,iy=function(i,t){var e=mr(i,t);return e>0?wc(i,t+4,t+4+e-1):""},Xg=iy,ny=function(i,t){var e=mr(i,t);return e>0?wc(i,t+4,t+4+e-1):""},Yg=ny,ry=function(i,t){var e=2*mr(i,t);return e>0?wc(i,t+4,t+4+e-1):""},Kg=ry,ay=function(t,e){var n=mr(t,e);return n>0?T1(t,e+4,e+4+n):""},Zg=ay,sy=function(i,t){var e=mr(i,t);return e>0?wc(i,t+4,t+4+e):""},Jg=sy,oy=function(i,t){return DP(i,t)},h1=oy,Qg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Fi&&(Xg=function(t,e){if(!Buffer.isBuffer(t))return iy(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},Yg=function(t,e){if(!Buffer.isBuffer(t))return ny(t,e);var n=t.readUInt32LE(e);return n>0?t.toString("utf8",e+4,e+4+n-1):""},Kg=function(t,e){if(!Buffer.isBuffer(t))return ry(t,e);var n=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n-1)},Zg=function(t,e){if(!Buffer.isBuffer(t))return ay(t,e);var n=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+n)},Jg=function(t,e){if(!Buffer.isBuffer(t))return sy(t,e);var n=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+n)},h1=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):oy(t,e)},Qg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function PP(){T1=function(i,t,e){return Ji.utils.decode(1200,i.slice(t,e)).replace(hc,"")},wc=function(i,t,e){return Ji.utils.decode(65001,i.slice(t,e))},Xg=function(i,t){var e=mr(i,t);return e>0?Ji.utils.decode(vc,i.slice(t+4,t+4+e-1)):""},Yg=function(i,t){var e=mr(i,t);return e>0?Ji.utils.decode(c0,i.slice(t+4,t+4+e-1)):""},Kg=function(i,t){var e=2*mr(i,t);return e>0?Ji.utils.decode(1200,i.slice(t+4,t+4+e-1)):""},Zg=function(i,t){var e=mr(i,t);return e>0?Ji.utils.decode(1200,i.slice(t+4,t+4+e)):""},Jg=function(i,t){var e=mr(i,t);return e>0?Ji.utils.decode(65001,i.slice(t+4,t+4+e)):""}}typeof Ji<"u"&&PP();var dc=function(i,t){return i[t]},Zu=function(i,t){return i[t+1]*256+i[t]},MP=function(i,t){var e=i[t+1]*256+i[t];return e<32768?e:(65535-e+1)*-1},mr=function(i,t){return i[t+3]*(1<<24)+(i[t+2]<<16)+(i[t+1]<<8)+i[t]},l0=function(i,t){return i[t+3]<<24|i[t+2]<<16|i[t+1]<<8|i[t]},LP=function(i,t){return i[t]<<24|i[t+1]<<16|i[t+2]<<8|i[t+3]};function Qu(i,t){var e="",n,r,a=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,Fi&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*i).toString("utf16le");else for(l=0;l<i;++l)e+=String.fromCharCode(Zu(this,c)),c+=2;i*=2;break;case"utf8":e=wc(this,this.l,this.l+i);break;case"utf16le":i*=2,e=T1(this,this.l,this.l+i);break;case"wstr":if(typeof Ji<"u")e=Ji.utils.decode(c0,this.slice(this.l,this.l+2*i));else return Qu.call(this,i,"dbcs");i=2*i;break;case"lpstr-ansi":e=Xg(this,this.l),i=4+mr(this,this.l);break;case"lpstr-cp":e=Yg(this,this.l),i=4+mr(this,this.l);break;case"lpwstr":e=Kg(this,this.l),i=4+2*mr(this,this.l);break;case"lpp4":i=4+mr(this,this.l),e=Zg(this,this.l),i&2&&(i+=2);break;case"8lpp4":i=4+mr(this,this.l),e=Jg(this,this.l),i&3&&(i+=4-(i&3));break;case"cstr":for(i=0,e="";(s=dc(this,this.l+i++))!==0;)a.push(e1(s));e=a.join("");break;case"_wstr":for(i=0,e="";(s=Zu(this,this.l+i))!==0;)a.push(e1(s)),i+=2;i+=2,e=a.join("");break;case"dbcs-cont":for(e="",c=this.l,l=0;l<i;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=dc(this,c),this.l=c+1,o=Qu.call(this,i-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(e1(Zu(this,c))),c+=2}e=a.join(""),i*=2;break;case"cpstr":if(typeof Ji<"u"){e=Ji.utils.decode(c0,this.slice(this.l,this.l+i));break}case"sbcs-cont":for(e="",c=this.l,l=0;l!=i;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=dc(this,c),this.l=c+1,o=Qu.call(this,i-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(e1(dc(this,c))),c+=1}e=a.join("");break;default:switch(i){case 1:return n=dc(this,this.l),this.l++,n;case 2:return n=(t==="i"?MP:Zu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(i>0?l0:LP)(this,this.l),this.l+=4,n):(r=mr(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return i==8?r=h1(this,this.l):r=h1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;i=8;case 16:e=ty(this,this.l,i);break}}return this.l+=i,e}var IP=function(i,t,e){i[e]=t&255,i[e+1]=t>>>8&255,i[e+2]=t>>>16&255,i[e+3]=t>>>24&255},RP=function(i,t,e){i[e]=t&255,i[e+1]=t>>8&255,i[e+2]=t>>16&255,i[e+3]=t>>24&255},OP=function(i,t,e){i[e]=t&255,i[e+1]=t>>>8&255};function BP(i,t,e){var n=0,r=0;if(e==="dbcs"){for(r=0;r!=t.length;++r)OP(this,t.charCodeAt(r),this.l+2*r);n=2*t.length}else if(e==="sbcs"){if(typeof Ji<"u"&&vc==874)for(r=0;r!=t.length;++r){var a=Ji.utils.encode(vc,t.charAt(r));this[this.l+r]=a[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;n=t.length}else if(e==="hex"){for(;r<i;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+i,this.length);for(r=0;r<Math.min(t.length,i);++r){var o=t.charCodeAt(r);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(i){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,IP(this,t,this.l);break;case 8:if(n=8,e==="f"){NP(this,t,this.l);break}case 16:break;case-4:n=4,RP(this,t,this.l);break}return this.l+=n,this}function ly(i,t){var e=ty(this,this.l,i.length>>1);if(e!==i)throw new Error(t+"Expected "+i+" saw "+e);this.l+=i.length>>1}function Da(i,t){i.l=t,i.read_shift=Qu,i.chk=ly,i.write_shift=BP}function Hs(i,t){i.l+=t}function He(i){var t=d0(i);return Da(t,0),t}function pa(){var i=[],t=Fi?256:2048,e=function(c){var u=He(c);return Da(u,0),u},n=e(t),r=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&i.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(r(),n=e(Math.max(c+1,t)))},s=function(){return r(),Nr(i)},o=function(c){r(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:i}}function Qe(i,t,e,n){var r=+t,a;if(!isNaN(r)){n||(n=NO[r].p||(e||[]).length||0),a=1+(r>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=i.next(a);r<=127?s.write_shift(1,r):(s.write_shift(1,(r&127)+128),s.write_shift(1,r>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Qg(e)&&i.push(e)}}function ed(i,t,e){var n=ga(i);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function gw(i,t,e){var n=ga(i);return n.s=ed(n.s,t.s,e),n.e=ed(n.e,t.s,e),n}function td(i,t){if(i.cRel&&i.c<0)for(i=ga(i);i.c<0;)i.c+=t>8?16384:256;if(i.rRel&&i.r<0)for(i=ga(i);i.r<0;)i.r+=t>8?1048576:t>5?65536:16384;var e=qi(i);return!i.cRel&&i.cRel!=null&&(e=UP(e)),!i.rRel&&i.rRel!=null&&(e=jP(e)),e}function Pg(i,t){return i.s.r==0&&!i.s.rRel&&i.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!i.e.rRel?(i.s.cRel?"":"$")+Hr(i.s.c)+":"+(i.e.cRel?"":"$")+Hr(i.e.c):i.s.c==0&&!i.s.cRel&&i.e.c==(t.biff>=12?16383:255)&&!i.e.cRel?(i.s.rRel?"":"$")+Mr(i.s.r)+":"+(i.e.rRel?"":"$")+Mr(i.e.r):td(i.s,t.biff)+":"+td(i.e,t.biff)}function e2(i){return parseInt(VP(i),10)-1}function Mr(i){return""+(i+1)}function jP(i){return i.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function VP(i){return i.replace(/\$(\d+)$/,"$1")}function t2(i){for(var t=zP(i),e=0,n=0;n!==t.length;++n)e=26*e+t.charCodeAt(n)-64;return e-1}function Hr(i){if(i<0)throw new Error("invalid column "+i);var t="";for(++i;i;i=Math.floor((i-1)/26))t=String.fromCharCode((i-1)%26+65)+t;return t}function UP(i){return i.replace(/^([A-Z])/,"$$$1")}function zP(i){return i.replace(/^\$([A-Z])/,"$1")}function HP(i){return i.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function xr(i){for(var t=0,e=0,n=0;n<i.length;++n){var r=i.charCodeAt(n);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:t-1}}function qi(i){for(var t=i.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(i.r+1)}function Pa(i){var t=i.indexOf(":");return t==-1?{s:xr(i),e:xr(i)}:{s:xr(i.slice(0,t)),e:xr(i.slice(t+1))}}function $n(i,t){return typeof t>"u"||typeof t=="number"?$n(i.s,i.e):(typeof i!="string"&&(i=qi(i)),typeof t!="string"&&(t=qi(t)),i==t?i:i+":"+t)}function dn(i){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,r=0,a=i.length;for(e=0;n<a&&!((r=i.charCodeAt(n)-64)<1||r>26);++n)e=26*e+r;for(t.s.c=--e,e=0;n<a&&!((r=i.charCodeAt(n)-48)<0||r>9);++n)e=10*e+r;if(t.s.r=--e,n===a||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,e=0;n!=a&&!((r=i.charCodeAt(n)-64)<1||r>26);++n)e=26*e+r;for(t.e.c=--e,e=0;n!=a&&!((r=i.charCodeAt(n)-48)<0||r>9);++n)e=10*e+r;return t.e.r=--e,t}function xw(i,t){var e=i.t=="d"&&t instanceof Date;if(i.z!=null)try{return i.w=_l(i.z,e?ma(t):t)}catch{}try{return i.w=_l((i.XF||{}).numFmtId||(e?14:0),e?ma(t):t)}catch{return""+t}}function To(i,t,e){return i==null||i.t==null||i.t=="z"?"":i.w!==void 0?i.w:(i.t=="d"&&!i.z&&e&&e.dateNF&&(i.z=e.dateNF),i.t=="e"?fd[i.v]||i.v:t==null?xw(i,i.v):xw(i,t))}function p0(i,t){var e=t&&t.sheet?t.sheet:"Sheet1",n={};return n[e]=i,{SheetNames:[e],Sheets:n}}function cy(i,t,e){var n=e||{},r=i?Array.isArray(i):n.dense;zs!=null&&r==null&&(r=zs);var a=i||(r?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=dn(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[h].length;++g)if(!(typeof t[h][g]>"u")){var d={v:t[h][g]},b=s+h,_=o+g;if(c.s.r>b&&(c.s.r=b),c.s.c>_&&(c.s.c=_),c.e.r<b&&(c.e.r=b),c.e.c<_&&(c.e.c=_),t[h][g]&&typeof t[h][g]=="object"&&!Array.isArray(t[h][g])&&!(t[h][g]instanceof Date))d=t[h][g];else if(Array.isArray(d.v)&&(d.f=t[h][g][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||En[14],n.cellDates?(d.t="d",d.w=_l(d.z,ma(d.v))):(d.t="n",d.v=ma(d.v),d.w=_l(d.z,d.v))):d.t="s";if(r)a[b]||(a[b]=[]),a[b][_]&&a[b][_].z&&(d.z=a[b][_].z),a[b][_]=d;else{var w=qi({c:_,r:b});a[w]&&a[w].z&&(d.z=a[w].z),a[w]=d}}}return c.s.c<1e7&&(a["!ref"]=$n(c)),a}function yc(i,t){return cy(null,i,t)}function WP(i){return i.read_shift(4,"i")}function vs(i,t){return t||(t=He(4)),t.write_shift(4,i),t}function Wr(i){var t=i.read_shift(4);return t===0?"":i.read_shift(t,"dbcs")}function vr(i,t){var e=!1;return t==null&&(e=!0,t=He(4+2*i.length)),t.write_shift(4,i.length),i.length>0&&t.write_shift(0,i,"dbcs"),e?t.slice(0,t.l):t}function qP(i){return{ich:i.read_shift(2),ifnt:i.read_shift(2)}}function GP(i,t){return t||(t=He(4)),t.write_shift(2,i.ich||0),t.write_shift(2,i.ifnt||0),t}function i2(i,t){var e=i.l,n=i.read_shift(1),r=Wr(i),a=[],s={t:r,h:r};if((n&1)!==0){for(var o=i.read_shift(4),l=0;l!=o;++l)a.push(qP(i));s.r=a}else s.r=[{ich:0,ifnt:0}];return i.l=e+t,s}function $P(i,t){var e=!1;return t==null&&(e=!0,t=He(15+4*i.t.length)),t.write_shift(1,0),vr(i.t,t),e?t.slice(0,t.l):t}var XP=i2;function YP(i,t){var e=!1;return t==null&&(e=!0,t=He(23+4*i.t.length)),t.write_shift(1,1),vr(i.t,t),t.write_shift(4,1),GP({ich:0,ifnt:0},t),e?t.slice(0,t.l):t}function Ka(i){var t=i.read_shift(4),e=i.read_shift(2);return e+=i.read_shift(1)<<16,i.l++,{c:t,iStyleRef:e}}function m0(i,t){return t==null&&(t=He(8)),t.write_shift(-4,i.c),t.write_shift(3,i.iStyleRef||i.s),t.write_shift(1,0),t}function g0(i){var t=i.read_shift(2);return t+=i.read_shift(1)<<16,i.l++,{c:-1,iStyleRef:t}}function x0(i,t){return t==null&&(t=He(4)),t.write_shift(3,i.iStyleRef||i.s),t.write_shift(1,0),t}var KP=Wr,uy=vr;function n2(i){var t=i.read_shift(4);return t===0||t===4294967295?"":i.read_shift(t,"dbcs")}function p1(i,t){var e=!1;return t==null&&(e=!0,t=He(127)),t.write_shift(4,i.length>0?i.length:4294967295),i.length>0&&t.write_shift(0,i,"dbcs"),e?t.slice(0,t.l):t}var ZP=Wr,Vg=n2,r2=p1;function dy(i){var t=i.slice(i.l,i.l+4),e=t[0]&1,n=t[0]&2;i.l+=4;var r=n===0?h1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):l0(t,0)>>2;return e?r/100:r}function fy(i,t){t==null&&(t=He(4));var e=0,n=0,r=i*100;if(i==(i|0)&&i>=-(1<<29)&&i<1<<29?n=1:r==(r|0)&&r>=-(1<<29)&&r<1<<29&&(n=1,e=1),n)t.write_shift(-4,((e?r:i)<<2)+(e+2));else throw new Error("unsupported RkNumber "+i)}function hy(i){var t={s:{},e:{}};return t.s.r=i.read_shift(4),t.e.r=i.read_shift(4),t.s.c=i.read_shift(4),t.e.c=i.read_shift(4),t}function JP(i,t){return t||(t=He(16)),t.write_shift(4,i.s.r),t.write_shift(4,i.e.r),t.write_shift(4,i.s.c),t.write_shift(4,i.e.c),t}var v0=hy,Sc=JP;function Cc(i){if(i.length-i.l<8)throw"XLS Xnum Buffer underflow";return i.read_shift(8,"f")}function f0(i,t){return(t||He(8)).write_shift(8,i,"f")}function QP(i){var t={},e=i.read_shift(1),n=e>>>1,r=i.read_shift(1),a=i.read_shift(2,"i"),s=i.read_shift(1),o=i.read_shift(1),l=i.read_shift(1);switch(i.l++,n){case 0:t.auto=1;break;case 1:t.index=r;var c=lM[r];c&&(t.rgb=Aw(c));break;case 2:t.rgb=Aw([s,o,l]);break;case 3:t.theme=r;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function m1(i,t){if(t||(t=He(8)),!i||i.auto)return t.write_shift(4,0),t.write_shift(4,0),t;i.index!=null?(t.write_shift(1,2),t.write_shift(1,i.index)):i.theme!=null?(t.write_shift(1,6),t.write_shift(1,i.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=i.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!i.rgb||i.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=i.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function eM(i){var t=i.read_shift(1);i.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function tM(i,t){t||(t=He(2));var e=(i.italic?2:0)|(i.strike?8:0)|(i.outline?16:0)|(i.shadow?32:0)|(i.condense?64:0)|(i.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var py=2,Fa=3,a1=11;var g1=19;var s1=64,iM=65,nM=71;var rM=4108,aM=4126,Dr=80;var vw={1:{n:"CodePage",t:py},2:{n:"Category",t:Dr},3:{n:"PresentationFormat",t:Dr},4:{n:"ByteCount",t:Fa},5:{n:"LineCount",t:Fa},6:{n:"ParagraphCount",t:Fa},7:{n:"SlideCount",t:Fa},8:{n:"NoteCount",t:Fa},9:{n:"HiddenCount",t:Fa},10:{n:"MultimediaClipCount",t:Fa},11:{n:"ScaleCrop",t:a1},12:{n:"HeadingPairs",t:rM},13:{n:"TitlesOfParts",t:aM},14:{n:"Manager",t:Dr},15:{n:"Company",t:Dr},16:{n:"LinksUpToDate",t:a1},17:{n:"CharacterCount",t:Fa},19:{n:"SharedDoc",t:a1},22:{n:"HyperlinksChanged",t:a1},23:{n:"AppVersion",t:Fa,p:"version"},24:{n:"DigSig",t:iM},26:{n:"ContentType",t:Dr},27:{n:"ContentStatus",t:Dr},28:{n:"Language",t:Dr},29:{n:"Version",t:Dr},255:{},2147483648:{n:"Locale",t:g1},2147483651:{n:"Behavior",t:g1},1919054434:{}},_w={1:{n:"CodePage",t:py},2:{n:"Title",t:Dr},3:{n:"Subject",t:Dr},4:{n:"Author",t:Dr},5:{n:"Keywords",t:Dr},6:{n:"Comments",t:Dr},7:{n:"Template",t:Dr},8:{n:"LastAuthor",t:Dr},9:{n:"RevNumber",t:Dr},10:{n:"EditTime",t:s1},11:{n:"LastPrinted",t:s1},12:{n:"CreatedDate",t:s1},13:{n:"ModifiedDate",t:s1},14:{n:"PageCount",t:Fa},15:{n:"WordCount",t:Fa},16:{n:"CharCount",t:Fa},17:{n:"Thumbnail",t:nM},18:{n:"Application",t:Dr},19:{n:"DocSecurity",t:Fa},255:{},2147483648:{n:"Locale",t:g1},2147483651:{n:"Behavior",t:g1},1919054434:{}};function sM(i){return i.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var oM=sM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),lM=ga(oM),fd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"};var cM={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},o1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function my(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function gy(i,t){var e=vP(cM),n=[],r;n[n.length]=Xn,n[n.length]=ft("Types",null,{xmlns:gr.CT,"xmlns:xsd":gr.xsd,"xmlns:xsi":gr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ft("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){i[l]&&i[l].length>0&&(r=i[l][0],n[n.length]=ft("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:o1[l][t.bookType]||o1[l].xlsx}))},s=function(l){(i[l]||[]).forEach(function(c){n[n.length]=ft("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:o1[l][t.bookType]||o1[l].xlsx})})},o=function(l){(i[l]||[]).forEach(function(c){n[n.length]=ft("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:e[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ti={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function xy(i){var t=i.lastIndexOf("/");return i.slice(0,t+1)+"_rels/"+i.slice(t+1)+".rels"}function mc(i){var t=[Xn,ft("Relationships",null,{xmlns:gr.RELS})];return Lr(i["!id"]).forEach(function(e){t[t.length]=ft("Relationship",null,i["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Hi(i,t,e,n,r,a){if(r||(r={}),i["!id"]||(i["!id"]={}),i["!idx"]||(i["!idx"]=1),t<0)for(t=i["!idx"];i["!id"]["rId"+t];++t);if(i["!idx"]=t+1,r.Id="rId"+t,r.Type=n,r.Target=e,a?r.TargetMode=a:[Ti.HLINK,Ti.XPATH,Ti.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),i["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return i["!id"][r.Id]=r,i[("/"+r.Target).replace("//","/")]=r,t}function uM(i){var t=[Xn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<i.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+i[e][0]+'" manifest:media-type="'+i[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function bw(i,t,e){return['  <rdf:Description rdf:about="'+i+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function dM(i,t){return['  <rdf:Description rdf:about="'+i+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function fM(i){var t=[Xn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=i.length;++e)t.push(bw(i[e][0],i[e][1])),t.push(dM("",i[e][0]));return t.push(bw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function vy(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+nd.version+"</meta:generator></office:meta></office:document-meta>"}var u0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Mg(i,t,e,n,r){r[i]!=null||t==null||t===""||(r[i]=t,t=Wi(t),n[n.length]=e?ft(i,t,e):Pr(i,t))}function _y(i,t){var e=t||{},n=[Xn,ft("cp:coreProperties",null,{"xmlns:cp":gr.CORE_PROPS,"xmlns:dc":gr.dc,"xmlns:dcterms":gr.dcterms,"xmlns:dcmitype":gr.dcmitype,"xmlns:xsi":gr.xsi})],r={};if(!i&&!e.Props)return n.join("");i&&(i.CreatedDate!=null&&Mg("dcterms:created",typeof i.CreatedDate=="string"?i.CreatedDate:jg(i.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r),i.ModifiedDate!=null&&Mg("dcterms:modified",typeof i.ModifiedDate=="string"?i.ModifiedDate:jg(i.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,r));for(var a=0;a!=u0.length;++a){var s=u0[a],o=e.Props&&e.Props[s[1]]!=null?e.Props[s[1]]:i?i[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Mg(s[0],o,null,n,r)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var gc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],by=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wy(i){var t=[],e=ft;return i||(i={}),i.Application="SheetJS",t[t.length]=Xn,t[t.length]=ft("Properties",null,{xmlns:gr.EXT_PROPS,"xmlns:vt":gr.vt}),gc.forEach(function(n){if(i[n[1]]!==void 0){var r;switch(n[2]){case"string":r=Wi(String(i[n[1]]));break;case"bool":r=i[n[1]]?"true":"false";break}r!==void 0&&(t[t.length]=e(n[0],r))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(i.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",i.SheetNames.map(function(n){return"<vt:lpstr>"+Wi(n)+"</vt:lpstr>"}).join(""),{size:i.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function yy(i){var t=[Xn,ft("Properties",null,{xmlns:gr.CUST_PROPS,"xmlns:vt":gr.vt})];if(!i)return t.join("");var e=1;return Lr(i).forEach(function(r){++e,t[t.length]=ft("property",FP(i[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Wi(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ww={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hM(i,t){var e=[];return Lr(ww).map(function(n){for(var r=0;r<u0.length;++r)if(u0[r][1]==n)return u0[r];for(r=0;r<gc.length;++r)if(gc[r][1]==n)return gc[r];throw n}).forEach(function(n){if(i[n[1]]!=null){var r=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:i[n[1]];switch(n[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(Pr(ww[n[1]]||n[1],r))}}),ft("DocumentProperties",e.join(""),{xmlns:Na.o})}function pM(i,t){var e=["Worksheets","SheetNames"],n="CustomDocumentProperties",r=[];return i&&Lr(i).forEach(function(a){if(Object.prototype.hasOwnProperty.call(i,a)){for(var s=0;s<u0.length;++s)if(a==u0[s][1])return;for(s=0;s<gc.length;++s)if(a==gc[s][1])return;for(s=0;s<e.length;++s)if(a==e[s])return;var o=i[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),r.push(ft(lw(a),o,{"dt:dt":l}))}}),t&&Lr(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(i&&Object.prototype.hasOwnProperty.call(i,a))){var s=t[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),r.push(ft(lw(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Na.o+'">'+r.join("")+"</"+n+">"}function mM(i){var t=typeof i=="string"?new Date(Date.parse(i)):i,e=t.getTime()/1e3+11644473600,n=e%Math.pow(2,32),r=(e-n)/Math.pow(2,32);n*=1e7,r*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),r+=a);var s=He(8);return s.write_shift(4,n),s.write_shift(4,r),s}function yw(i,t){var e=He(4),n=He(4);switch(e.write_shift(4,i==80?31:i),i){case 3:n.write_shift(-4,t);break;case 5:n=He(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=mM(t);break;case 31:case 80:for(n=He(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+i+" "+t)}return Nr([e,n])}var Sy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function gM(i){switch(typeof i){case"boolean":return 11;case"number":return(i|0)==i?3:5;case"string":return 31;case"object":if(i instanceof Date)return 64;break}return-1}function Sw(i,t,e){var n=He(8),r=[],a=[],s=8,o=0,l=He(8),c=He(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),r.push(c),s+=8+l.length,!t){c=He(8),c.write_shift(4,0),r.unshift(c);var u=[He(4)];for(u[0].write_shift(4,i.length),o=0;o<i.length;++o){var h=i[o][0];for(l=He(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Nr(u),a.unshift(l),s+=8+l.length}for(o=0;o<i.length;++o)if(!(t&&!t[i[o][0]])&&!(Sy.indexOf(i[o][0])>-1||by.indexOf(i[o][0])>-1)&&i[o][1]!=null){var g=i[o][1],d=0;if(t){d=+t[i[o][0]];var b=e[d];if(b.p=="version"&&typeof g=="string"){var _=g.split(".");g=(+_[0]<<16)+(+_[1]||0)}l=yw(b.t,g)}else{var w=gM(g);w==-1&&(w=31,g=String(g)),l=yw(w,g)}a.push(l),c=He(8),c.write_shift(4,t?d:2+o),r.push(c),s+=8+l.length}var E=8*(a.length+1);for(o=0;o<a.length;++o)r[o].write_shift(4,E),E+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),Nr([n].concat(r).concat(a))}function Cw(i,t,e,n,r,a){var s=He(r?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,$i.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,r?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,r?68:48);var l=Sw(i,e,n);if(o.push(l),r){var c=Sw(r,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Nr(o)}function xM(i,t){t||(t=He(i));for(var e=0;e<i;++e)t.write_shift(1,0);return t}function vM(i,t){return i.read_shift(t)===1}function ia(i,t){return t||(t=He(2)),t.write_shift(2,+!!i),t}function Cy(i){return i.read_shift(2,"u")}function Ya(i,t){return t||(t=He(2)),t.write_shift(2,i),t}function Ey(i,t,e){return e||(e=He(2)),e.write_shift(1,t=="e"?+i:+!!i),e.write_shift(1,t=="e"?1:0),e}function ky(i,t,e){var n=i.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont",a=c0;if(e&&e.biff>=8&&(c0=1200),!e||e.biff==8){var s=i.read_shift(1);s&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var o=n?i.read_shift(n,r):"";return c0=a,o}function _M(i){var t=i.t||"",e=1,n=He(3+(e>1?2:0));n.write_shift(2,t.length),n.write_shift(1,(e>1?8:0)|1),e>1&&n.write_shift(2,e);var r=He(2*t.length);r.write_shift(2*t.length,t,"utf16le");var a=[n,r];return Nr(a)}function bM(i,t,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return i.read_shift(t,"cpstr");if(e.biff>=12)return i.read_shift(t,"dbcs-cont")}var r=i.read_shift(1);return r===0?n=i.read_shift(t,"sbcs-cont"):n=i.read_shift(t,"dbcs-cont"),n}function wM(i,t,e){var n=i.read_shift(e&&e.biff==2?1:2);return n===0?(i.l++,""):bM(i,n,e)}function yM(i,t,e){if(e.biff>5)return wM(i,t,e);var n=i.read_shift(1);return n===0?(i.l++,""):i.read_shift(n,e.biff<=4||!i.lens?"cpstr":"sbcs-cont")}function Ty(i,t,e){return e||(e=He(3+2*i.length)),e.write_shift(2,i.length),e.write_shift(1,1),e.write_shift(31,i,"utf16le"),e}function Ew(i,t){t||(t=He(6+i.length*2)),t.write_shift(4,1+i.length);for(var e=0;e<i.length;++e)t.write_shift(2,i.charCodeAt(e));return t.write_shift(2,0),t}function SM(i){var t=He(512),e=0,n=i.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var r=n.indexOf("#"),a=r>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(e=0;e<s.length;++e)t.write_shift(4,s[e]);if(a==28)n=n.slice(1),Ew(n,t);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<s.length;++e)t.write_shift(1,parseInt(s[e],16));var o=r>-1?n.slice(0,r):n;for(t.write_shift(4,2*(o.length+1)),e=0;e<o.length;++e)t.write_shift(2,o.charCodeAt(e));t.write_shift(2,0),a&8&&Ew(r>-1?n.slice(r+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<s.length;++e)t.write_shift(1,parseInt(s[e],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),e=0;e<n.length-3*l;++e)t.write_shift(1,n.charCodeAt(e+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function h0(i,t,e,n){return n||(n=He(6)),n.write_shift(2,i),n.write_shift(2,t),n.write_shift(2,e||0),n}function CM(i,t,e){var n=e.biff>8?4:2,r=i.read_shift(n),a=i.read_shift(n,"i"),s=i.read_shift(n,"i");return[r,a,s]}function EM(i){var t=i.read_shift(2),e=i.read_shift(2),n=i.read_shift(2),r=i.read_shift(2);return{s:{c:n,r:t},e:{c:r,r:e}}}function Ay(i,t){return t||(t=He(8)),t.write_shift(2,i.s.r),t.write_shift(2,i.e.r),t.write_shift(2,i.s.c),t.write_shift(2,i.e.c),t}function a2(i,t,e){var n=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":n=1280,r=8;break;case"biff4":n=4,r=6;break;case"biff3":n=3,r=6;break;case"biff2":n=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=He(r);return a.write_shift(2,n),a.write_shift(2,t),r>4&&a.write_shift(2,29282),r>6&&a.write_shift(2,1997),r>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function kM(i,t){var e=!t||t.biff==8,n=He(e?112:54);for(n.write_shift(t.biff==8?2:1,7),e&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(e?0:536870912));n.l<n.length;)n.write_shift(1,e?0:32);return n}function TM(i,t){var e=!t||t.biff>=8?2:1,n=He(8+e*i.name.length);n.write_shift(4,i.pos),n.write_shift(1,i.hs||0),n.write_shift(1,i.dt),n.write_shift(1,i.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(e*i.name.length,i.name,t.biff<8?"sbcs":"utf16le");var r=n.slice(0,n.l);return r.l=n.l,r}function AM(i,t){var e=He(8);e.write_shift(4,i.Count),e.write_shift(4,i.Unique);for(var n=[],r=0;r<i.length;++r)n[r]=_M(i[r],t);var a=Nr([e].concat(n));return a.parts=[e.length].concat(n.map(function(s){return s.length})),a}function FM(){var i=He(18);return i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,29280),i.write_shift(2,17600),i.write_shift(2,56),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,1),i.write_shift(2,500),i}function DM(i){var t=He(18),e=1718;return i&&i.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function NM(i,t){var e=i.name||"Arial",n=t&&t.biff==5,r=n?15+e.length:16+2*e.length,a=He(r);return a.write_shift(2,(i.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,e.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le"),a}function PM(i,t,e,n){var r=He(10);return h0(i,t,n,r),r.write_shift(4,e),r}function MM(i,t,e,n,r){var a=!r||r.biff==8,s=He(8+ +a+(1+a)*e.length);return h0(i,t,n,s),s.write_shift(2,e.length),a&&s.write_shift(1,1),s.write_shift((1+a)*e.length,e,a?"utf16le":"sbcs"),s}function LM(i,t,e,n){var r=e&&e.biff==5;n||(n=He(r?3+t.length:5+2*t.length)),n.write_shift(2,i),n.write_shift(r?1:2,t.length),r||n.write_shift(1,1),n.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function IM(i,t){var e=t.biff==8||!t.biff?4:2,n=He(2*e+6);return n.write_shift(e,i.s.r),n.write_shift(e,i.e.r+1),n.write_shift(2,i.s.c),n.write_shift(2,i.e.c+1),n.write_shift(2,0),n}function kw(i,t,e,n){var r=e&&e.biff==5;n||(n=He(r?16:20)),n.write_shift(2,0),i.style?(n.write_shift(2,i.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,i.numFmtId||0),n.write_shift(2,t<<4));var a=0;return i.numFmtId>0&&r&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),r||n.write_shift(4,0),n.write_shift(2,0),n}function RM(i){var t=He(8);return t.write_shift(4,0),t.write_shift(2,i[0]?i[0]+1:0),t.write_shift(2,i[1]?i[1]+1:0),t}function OM(i,t,e,n,r,a){var s=He(8);return h0(i,t,n,s),Ey(e,a,s),s}function BM(i,t,e,n){var r=He(14);return h0(i,t,n,r),f0(e,r),r}function jM(i,t,e){if(e.biff<8)return VM(i,t,e);for(var n=[],r=i.l+t,a=i.read_shift(e.biff>8?4:2);a--!==0;)n.push(CM(i,e.biff>8?12:6,e));if(i.l!=r)throw new Error("Bad ExternSheet: "+i.l+" != "+r);return n}function VM(i,t,e){i[i.l+1]==3&&i[i.l]++;var n=ky(i,t,e);return n.charCodeAt(0)==3?n.slice(1):n}function UM(i){var t=He(2+i.length*8);t.write_shift(2,i.length);for(var e=0;e<i.length;++e)Ay(i[e],t);return t}function zM(i){var t=He(24),e=xr(i[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(n[r],16));return Nr([t,SM(i[1])])}function HM(i){var t=i[1].Tooltip,e=He(10+2*(t.length+1));e.write_shift(2,2048);var n=xr(i[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function WM(i){return i||(i=He(4)),i.write_shift(2,1),i.write_shift(2,1),i}function qM(i,t,e){if(!e.cellStyles)return Hs(i,t);var n=e&&e.biff>=12?4:2,r=i.read_shift(n),a=i.read_shift(n),s=i.read_shift(n),o=i.read_shift(n),l=i.read_shift(2);n==2&&(i.l+=2);var c={s:r,e:a,w:s,ixfe:o,flags:l};return(e.biff>=5||!e.biff)&&(c.level=l>>8&7),c}function GM(i,t){var e=He(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,i.width*256),e.write_shift(2,0);var n=0;return i.hidden&&(n|=1),e.write_shift(1,n),n=i.level||0,e.write_shift(1,n),e.write_shift(2,0),e}function $M(i){for(var t=He(2*i),e=0;e<i;++e)t.write_shift(2,e+1);return t}function XM(i,t,e){var n=He(15);return pd(n,i,t),n.write_shift(8,e,"f"),n}function YM(i,t,e){var n=He(9);return pd(n,i,t),n.write_shift(2,e),n}var KM=(function(){var i={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Wg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(o,l){var c=[],u=d0(1);switch(l.type){case"base64":u=gs(ko(o));break;case"binary":u=gs(o);break;case"buffer":case"array":u=o;break}Da(u,0);var h=u.read_shift(1),g=!!(h&136),d=!1,b=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,g=!0;break;case 49:d=!0,g=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var _=0,w=521;h==2&&(_=u.read_shift(2)),u.l+=3,h!=2&&(_=u.read_shift(4)),_>1048576&&(_=1e6),h!=2&&(w=u.read_shift(2));var E=u.read_shift(2),A=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(A=i[u[u.l]]),u.l+=1,u.l+=2),b&&(u.l+=36);for(var D=[],N={},z=Math.min(u.length,h==2?521:w-10-(d?264:0)),J=b?32:11;u.l<z&&u[u.l]!=13;)switch(N={},N.name=Ji.utils.decode(A,u.slice(u.l,u.l+J)).replace(/[\u0000\r\n].*$/g,""),u.l+=J,N.type=String.fromCharCode(u.read_shift(1)),h!=2&&!b&&(N.offset=u.read_shift(4)),N.len=u.read_shift(1),h==2&&(N.offset=u.read_shift(2)),N.dec=u.read_shift(1),N.name.length&&D.push(N),h!=2&&(u.l+=b?13:14),N.type){case"B":(!d||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var W=0,U=0;for(c[0]=[],U=0;U!=D.length;++U)c[0][U]=D[U].name;for(;_-- >0;){if(u[u.l]===42){u.l+=E;continue}for(++u.l,c[++W]=[],U=0,U=0;U!=D.length;++U){var M=u.slice(u.l,u.l+D[U].len);u.l+=D[U].len,Da(M,0);var X=Ji.utils.decode(A,M);switch(D[U].type){case"C":X.trim().length&&(c[W][U]=X.replace(/\s+$/,""));break;case"D":X.length===8?c[W][U]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):c[W][U]=X;break;case"F":c[W][U]=parseFloat(X.trim());break;case"+":case"I":c[W][U]=b?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":c[W][U]=!0;break;case"N":case"F":c[W][U]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[W][U]="##MEMO##"+(b?parseInt(X.trim(),10):M.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(c[W][U]=+X||0);break;case"@":c[W][U]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":c[W][U]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":c[W][U]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[W][U]=-M.read_shift(-8,"f");break;case"B":if(d&&D[U].len==8){c[W][U]=M.read_shift(8,"f");break}case"G":case"P":M.l+=D[U].len;break;case"0":if(D[U].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+D[U].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=D,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=yc(e(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function r(o,l){try{return p0(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&rd(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=pa(),h=w1(o,{header:1,raw:!0,cellDates:!0}),g=h[0],d=h.slice(1),b=o["!cols"]||[],_=0,w=0,E=0,A=1;for(_=0;_<g.length;++_){if(((b[_]||{}).DBF||{}).name){g[_]=b[_].DBF.name,++E;continue}if(g[_]!=null){if(++E,typeof g[_]=="number"&&(g[_]=g[_].toString(10)),typeof g[_]!="string")throw new Error("DBF Invalid column name "+g[_]+" |"+typeof g[_]+"|");if(g.indexOf(g[_])!==_){for(w=0;w<1024;++w)if(g.indexOf(g[_]+"_"+w)==-1){g[_]+="_"+w;break}}}}var D=dn(o["!ref"]),N=[],z=[],J=[];for(_=0;_<=D.e.c-D.s.c;++_){var W="",U="",M=0,X=[];for(w=0;w<d.length;++w)d[w][_]!=null&&X.push(d[w][_]);if(X.length==0||g[_]==null){N[_]="?";continue}for(w=0;w<X.length;++w){switch(typeof X[w]){case"number":U="B";break;case"string":U="C";break;case"boolean":U="L";break;case"object":U=X[w]instanceof Date?"D":"C";break;default:U="C"}M=Math.max(M,String(X[w]).length),W=W&&W!=U?"C":U}M>250&&(M=250),U=((b[_]||{}).DBF||{}).type,U=="C"&&b[_].DBF.len>M&&(M=b[_].DBF.len),W=="B"&&U=="N"&&(W="N",J[_]=b[_].DBF.dec,M=b[_].DBF.len),z[_]=W=="C"||U=="N"?M:a[W]||0,A+=z[_],N[_]=W}var F=u.next(32);for(F.write_shift(4,318902576),F.write_shift(4,d.length),F.write_shift(2,296+32*E),F.write_shift(2,A),_=0;_<4;++_)F.write_shift(4,0);for(F.write_shift(4,0|(+t[vc]||3)<<8),_=0,w=0;_<g.length;++_)if(g[_]!=null){var I=u.next(32),ee=(g[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,ee,"sbcs"),I.write_shift(1,N[_]=="?"?"C":N[_],"sbcs"),I.write_shift(4,w),I.write_shift(1,z[_]||a[N[_]]||0),I.write_shift(1,J[_]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),w+=z[_]||a[N[_]]||0}var le=u.next(264);for(le.write_shift(4,13),_=0;_<65;++_)le.write_shift(4,0);for(_=0;_<d.length;++_){var de=u.next(A);for(de.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(N[w]){case"L":de.write_shift(1,d[_][w]==null?63:d[_][w]?84:70);break;case"B":de.write_shift(8,d[_][w]||0,"f");break;case"N":var ke="0";for(typeof d[_][w]=="number"&&(ke=d[_][w].toFixed(J[w]||0)),E=0;E<z[w]-ke.length;++E)de.write_shift(1,32);de.write_shift(1,ke,"sbcs");break;case"D":d[_][w]?(de.write_shift(4,("0000"+d[_][w].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(d[_][w].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+d[_][w].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var Fe=String(d[_][w]!=null?d[_][w]:"").slice(0,z[w]);for(de.write_shift(1,Fe,"sbcs"),E=0;E<z[w]-Fe.length;++E)de.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:r,to_sheet:n,from_sheet:s}})(),ZM=(function(){var i={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Lr(i).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(g,d){var b=i[d];return typeof b=="number"?K5(b):b},n=function(g,d,b){var _=d.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return _==59?g:K5(_)};i["|"]=254;function r(g,d){switch(d.type){case"base64":return a(ko(g),d);case"binary":return a(g,d);case"buffer":return a(Fi&&Buffer.isBuffer(g)?g.toString("binary"):ud(g),d);case"array":return a(k1(g),d)}throw new Error("Unrecognized type "+d.type)}function a(g,d){var b=g.split(/[\n\r]+/),_=-1,w=-1,E=0,A=0,D=[],N=[],z=null,J={},W=[],U=[],M=[],X=0,F;for(+d.codepage>=0&&rd(+d.codepage);E!==b.length;++E){X=0;var I=b[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,e),ee=I.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),le=ee[0],de;if(I.length>0)switch(le){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&N.push(I.slice(3).replace(/;;/g,";"));break;case"C":var ke=!1,Fe=!1,Se=!1,Oe=!1,Ze=-1,qe=-1;for(A=1;A<ee.length;++A)switch(ee[A].charAt(0)){case"A":break;case"X":w=parseInt(ee[A].slice(1))-1,Fe=!0;break;case"Y":for(_=parseInt(ee[A].slice(1))-1,Fe||(w=0),F=D.length;F<=_;++F)D[F]=[];break;case"K":de=ee[A].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(Co(de))?isNaN(sd(de).getDate())||(de=na(de)):(de=Co(de),z!==null&&$w(z)&&(de=Zw(de))),typeof Ji<"u"&&typeof de=="string"&&(d||{}).type!="string"&&(d||{}).codepage&&(de=Ji.utils.decode(d.codepage,de)),ke=!0;break;case"E":Oe=!0;var k=YL(ee[A].slice(1),{r:_,c:w});D[_][w]=[D[_][w],k];break;case"S":Se=!0,D[_][w]=[D[_][w],"S5S"];break;case"G":break;case"R":Ze=parseInt(ee[A].slice(1))-1;break;case"C":qe=parseInt(ee[A].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+I)}if(ke&&(D[_][w]&&D[_][w].length==2?D[_][w][0]=de:D[_][w]=de,z=null),Se){if(Oe)throw new Error("SYLK shared formula cannot have own formula");var B=Ze>-1&&D[Ze][qe];if(!B||!B[1])throw new Error("SYLK shared formula cannot find base");D[_][w][1]=KL(B[1],{r:_-Ze,c:w-qe})}break;case"F":var P=0;for(A=1;A<ee.length;++A)switch(ee[A].charAt(0)){case"X":w=parseInt(ee[A].slice(1))-1,++P;break;case"Y":for(_=parseInt(ee[A].slice(1))-1,F=D.length;F<=_;++F)D[F]=[];break;case"M":X=parseInt(ee[A].slice(1))/20;break;case"F":break;case"G":break;case"P":z=N[parseInt(ee[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ee[A].slice(1).split(" "),F=parseInt(M[0],10);F<=parseInt(M[1],10);++F)X=parseInt(M[2],10),U[F-1]=X===0?{hidden:!0}:{wch:X},s2(U[F-1]);break;case"C":w=parseInt(ee[A].slice(1))-1,U[w]||(U[w]={});break;case"R":_=parseInt(ee[A].slice(1))-1,W[_]||(W[_]={}),X>0?(W[_].hpt=X,W[_].hpx=My(X)):X===0&&(W[_].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+I)}P<1&&(z=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+I)}}return W.length>0&&(J["!rows"]=W),U.length>0&&(J["!cols"]=U),d&&d.sheetRows&&(D=D.slice(0,d.sheetRows)),[D,J]}function s(g,d){var b=r(g,d),_=b[0],w=b[1],E=yc(_,d);return Lr(w).forEach(function(A){E[A]=w[A]}),E}function o(g,d){return p0(s(g,d),d)}function l(g,d,b,_){var w="C;Y"+(b+1)+";X"+(_+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+l2(g.f,{r:b,c:_}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(g,d){d.forEach(function(b,_){var w="F;W"+(_+1)+" "+(_+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=x1(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=v1(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function u(g,d){d.forEach(function(b,_){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*_1(b.hpx)+";"),w.length>2&&g.push(w+"R"+(_+1))})}function h(g,d){var b=["ID;PWXL;N;E"],_=[],w=dn(g["!ref"]),E,A=Array.isArray(g),D=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),g["!cols"]&&c(b,g["!cols"]),g["!rows"]&&u(b,g["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var z=w.s.c;z<=w.e.c;++z){var J=qi({r:N,c:z});E=A?(g[N]||[])[z]:g[J],!(!E||E.v==null&&(!E.f||E.F))&&_.push(l(E,g,N,z,d))}return b.join(D)+D+_.join(D)+D+"E"+D}return{to_workbook:o,to_sheet:s,from_sheet:h}})(),JM=(function(){function i(a,s){switch(s.type){case"base64":return t(ko(a),s);case"binary":return t(a,s);case"buffer":return t(Fi&&Buffer.isBuffer(a)?a.toString("binary"):ud(a),s);case"array":return t(k1(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var g=o[u].trim().split(","),d=g[0],b=g[1];++u;for(var _=o[u]||"";(_.match(/["]/g)||[]).length&1&&u<o.length-1;)_+=`
`+o[++u];switch(_=_.trim(),+d){case-1:if(_==="BOT"){h[++l]=[],c=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?h[l][c]=!0:_==="FALSE"?h[l][c]=!1:isNaN(Co(b))?isNaN(sd(b).getDate())?h[l][c]=b:h[l][c]=na(b):h[l][c]=Co(b),++c;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),Yu&&_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),h[l][c++]=_!==""?_:null;break}if(_==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function e(a,s){return yc(i(a,s),s)}function n(a,s){return p0(e(a,s),s)}var r=(function(){var a=function(l,c,u,h,g){l.push(c),l.push(u+","+h),l.push('"'+g.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=dn(l["!ref"]),h,g=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){s(c,-1,0,"BOT");for(var b=u.s.c;b<=u.e.c;++b){var _=qi({r:d,c:b});if(h=g?(l[d]||[])[b]:l[_],!h){s(c,1,0,"");continue}switch(h.t){case"n":var w=Yu?h.w:h.v;!w&&h.v!=null&&(w=h.v),w==null?Yu&&h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,w,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,!Yu||isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=_l(h.z||En[14],ma(na(h.v)))),Yu?s(c,0,h.w,"V"):s(c,1,0,h.w);break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var E=`\r
`,A=c.join(E);return A}})();return{to_workbook:n,to_sheet:e,from_sheet:r}})(),Fy=(function(){function i(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(h,g){for(var d=h.split(`
`),b=-1,_=-1,w=0,E=[];w!==d.length;++w){var A=d[w].trim().split(":");if(A[0]==="cell"){var D=xr(A[1]);if(E.length<=D.r)for(b=E.length;b<=D.r;++b)E[b]||(E[b]=[]);switch(b=D.r,_=D.c,A[2]){case"t":E[b][_]=i(A[3]);break;case"v":E[b][_]=+A[3];break;case"vtf":var N=A[A.length-1];case"vtc":switch(A[3]){case"nl":E[b][_]=!!+A[4];break;default:E[b][_]=+A[4];break}A[2]=="vtf"&&(E[b][_]=[E[b][_],N])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function n(h,g){return yc(e(h,g),g)}function r(h,g){return p0(n(h,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var g=[],d=[],b,_="",w=Pa(h["!ref"]),E=Array.isArray(h),A=w.s.r;A<=w.e.r;++A)for(var D=w.s.c;D<=w.e.c;++D)if(_=qi({r:A,c:D}),b=E?(h[A]||[])[D]:h[_],!(!b||b.v==null||b.t==="z")){switch(d=["cell",_,"t"],b.t){case"s":case"str":d.push(t(b.v));break;case"n":b.f?(d[2]="vtf",d[3]="n",d[4]=b.v,d[5]=t(b.f)):(d[2]="v",d[3]=b.v);break;case"b":d[2]="vt"+(b.f?"f":"c"),d[3]="nl",d[4]=b.v?"1":"0",d[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var N=ma(na(b.v));d[2]="vtc",d[3]="nd",d[4]=""+N,d[5]=b.w||_l(b.z||En[14],N);break;case"e":continue}g.push(d.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function u(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:r,to_sheet:n,from_sheet:u}})(),QM=(function(){function i(u,h,g,d,b){b.raw?h[g][d]=u:u===""||(u==="TRUE"?h[g][d]=!0:u==="FALSE"?h[g][d]=!1:isNaN(Co(u))?isNaN(sd(u).getDate())?h[g][d]=u:h[g][d]=na(u):h[g][d]=Co(u))}function t(u,h){var g=h||{},d=[];if(!u||u.length===0)return d;for(var b=u.split(/[\r\n]/),_=b.length-1;_>=0&&b[_].length===0;)--_;for(var w=10,E=0,A=0;A<=_;++A)E=b[A].indexOf(" "),E==-1?E=b[A].length:E++,w=Math.max(w,E);for(A=0;A<=_;++A){d[A]=[];var D=0;for(i(b[A].slice(0,w).trim(),d,A,D,g),D=1;D<=(b[A].length-w)/10+1;++D)i(b[A].slice(w+(D-1)*10,w+D*10).trim(),d,A,D,g)}return g.sheetRows&&(d=d.slice(0,g.sheetRows)),d}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(u){for(var h={},g=!1,d=0,b=0;d<u.length;++d)(b=u.charCodeAt(d))==34?g=!g:!g&&b in e&&(h[b]=(h[b]||0)+1);b=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&b.push([h[d],d]);if(!b.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&b.push([h[d],d])}return b.sort(function(_,w){return _[0]-w[0]||n[_[1]]-n[w[1]]}),e[b.pop()[1]]||44}function a(u,h){var g=h||{},d="";zs!=null&&g.dense==null&&(g.dense=zs);var b=g.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=r(u.slice(0,1024)):g&&g.FS?d=g.FS:d=r(u.slice(0,1024));var w=0,E=0,A=0,D=0,N=0,z=d.charCodeAt(0),J=!1,W=0,U=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var M=g.dateNF!=null?pP(g.dateNF):null;function X(){var F=u.slice(D,N),I={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)I.t="z";else if(g.raw)I.t="s",I.v=F;else if(F.trim().length===0)I.t="s",I.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(I.t="s",I.v=F.slice(2,-1).replace(/""/g,'"')):ZL(F)?(I.t="n",I.f=F.slice(1)):(I.t="s",I.v=F);else if(F=="TRUE")I.t="b",I.v=!0;else if(F=="FALSE")I.t="b",I.v=!1;else if(!isNaN(A=Co(F)))I.t="n",g.cellText!==!1&&(I.w=F),I.v=A;else if(!isNaN(sd(F).getDate())||M&&F.match(M)){I.z=g.dateNF||En[14];var ee=0;M&&F.match(M)&&(F=mP(F,g.dateNF,F.match(M)||[]),ee=1),g.cellDates?(I.t="d",I.v=na(F,ee)):(I.t="n",I.v=ma(na(F,ee))),g.cellText!==!1&&(I.w=_l(I.z,I.v instanceof Date?ma(I.v):I.v)),g.cellNF||delete I.z}else I.t="s",I.v=F;if(I.t=="z"||(g.dense?(b[w]||(b[w]=[]),b[w][E]=I):b[qi({c:E,r:w})]=I),D=N+1,U=u.charCodeAt(D),_.e.c<E&&(_.e.c=E),_.e.r<w&&(_.e.r=w),W==z)++E;else if(E=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;N<u.length;++N)switch(W=u.charCodeAt(N)){case 34:U===34&&(J=!J);break;case z:case 10:case 13:if(!J&&X())break e;break;default:break}return N-D>0&&X(),b["!ref"]=$n(_),b}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):yc(t(u,h),h)}function o(u,h){var g="",d=h.type=="string"?[0,0,0,0]:dB(u,h);switch(h.type){case"base64":g=ko(u);break;case"binary":g=u;break;case"buffer":h.codepage==65001?g=u.toString("utf8"):h.codepage&&typeof Ji<"u"?g=Ji.utils.decode(h.codepage,u):g=Fi&&Buffer.isBuffer(u)?u.toString("binary"):ud(u);break;case"array":g=k1(u);break;case"string":g=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?g=Ju(g.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?g=Ju(g):h.type=="binary"&&typeof Ji<"u"&&h.codepage&&(g=Ji.utils.decode(h.codepage,Ji.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?Fy.to_sheet(h.type=="string"?g:Ju(g),h):s(g,h)}function l(u,h){return p0(o(u,h),h)}function c(u){for(var h=[],g=dn(u["!ref"]),d,b=Array.isArray(u),_=g.s.r;_<=g.e.r;++_){for(var w=[],E=g.s.c;E<=g.e.c;++E){var A=qi({r:_,c:E});if(d=b?(u[_]||[])[E]:u[A],!d||d.v==null){w.push("          ");continue}for(var D=(d.w||(To(d),d.w)||"").slice(0,10);D.length<10;)D+=" ";w.push(D+(E===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}})();var Tw=(function(){function i(k,B,P){if(k){Da(k,k.l||0);for(var O=P.Enum||Ze;k.l<k.length;){var Q=k.read_shift(2),fe=O[Q]||O[65535],ye=k.read_shift(2),pe=k.l+ye,ge=fe.f&&fe.f(k,ye,P);if(k.l=pe,B(ge,fe,Q))return}}}function t(k,B){switch(B.type){case"base64":return e(gs(ko(k)),B);case"binary":return e(gs(k),B);case"buffer":case"array":return e(k,B)}throw"Unsupported type "+B.type}function e(k,B){if(!k)return k;var P=B||{};zs!=null&&P.dense==null&&(P.dense=zs);var O=P.dense?[]:{},Q="Sheet1",fe="",ye=0,pe={},ge=[],Xe=[],Je={s:{r:0,c:0},e:{r:0,c:0}},ut=P.sheetRows||0;if(k[2]==0&&(k[3]==8||k[3]==9)&&k.length>=16&&k[14]==5&&k[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(k[2]==2)P.Enum=Ze,i(k,function(et,bt,rt){switch(rt){case 0:P.vers=et,et>=4096&&(P.qpro=!0);break;case 6:Je=et;break;case 204:et&&(fe=et);break;case 222:fe=et;break;case 15:case 51:P.qpro||(et[1].v=et[1].v.slice(1));case 13:case 14:case 16:rt==14&&(et[2]&112)==112&&(et[2]&15)>1&&(et[2]&15)<15&&(et[1].z=P.dateNF||En[14],P.cellDates&&(et[1].t="d",et[1].v=Zw(et[1].v))),P.qpro&&et[3]>ye&&(O["!ref"]=$n(Je),pe[Q]=O,ge.push(Q),O=P.dense?[]:{},Je={s:{r:0,c:0},e:{r:0,c:0}},ye=et[3],Q=fe||"Sheet"+(ye+1),fe="");var yt=P.dense?(O[et[0].r]||[])[et[0].c]:O[qi(et[0])];if(yt){yt.t=et[1].t,yt.v=et[1].v,et[1].z!=null&&(yt.z=et[1].z),et[1].f!=null&&(yt.f=et[1].f);break}P.dense?(O[et[0].r]||(O[et[0].r]=[]),O[et[0].r][et[0].c]=et[1]):O[qi(et[0])]=et[1];break;default:}},P);else if(k[2]==26||k[2]==14)P.Enum=qe,k[2]==14&&(P.qpro=!0,k.l=0),i(k,function(et,bt,rt){switch(rt){case 204:Q=et;break;case 22:et[1].v=et[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(et[3]>ye&&(O["!ref"]=$n(Je),pe[Q]=O,ge.push(Q),O=P.dense?[]:{},Je={s:{r:0,c:0},e:{r:0,c:0}},ye=et[3],Q="Sheet"+(ye+1)),ut>0&&et[0].r>=ut)break;P.dense?(O[et[0].r]||(O[et[0].r]=[]),O[et[0].r][et[0].c]=et[1]):O[qi(et[0])]=et[1],Je.e.c<et[0].c&&(Je.e.c=et[0].c),Je.e.r<et[0].r&&(Je.e.r=et[0].r);break;case 27:et[14e3]&&(Xe[et[14e3][0]]=et[14e3][1]);break;case 1537:Xe[et[0]]=et[1],et[0]==ye&&(Q=et[1]);break;default:break}},P);else throw new Error("Unrecognized LOTUS BOF "+k[2]);if(O["!ref"]=$n(Je),pe[fe||Q]=O,ge.push(fe||Q),!Xe.length)return{SheetNames:ge,Sheets:pe};for(var Ne={},oe=[],Ft=0;Ft<Xe.length;++Ft)pe[ge[Ft]]?(oe.push(Xe[Ft]||ge[Ft]),Ne[Xe[Ft]]=pe[Xe[Ft]]||pe[ge[Ft]]):(oe.push(Xe[Ft]),Ne[Xe[Ft]]={"!ref":"A1"});return{SheetNames:oe,Sheets:Ne}}function n(k,B){var P=B||{};if(+P.codepage>=0&&rd(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var O=pa(),Q=dn(k["!ref"]),fe=Array.isArray(k),ye=[];pt(O,0,a(1030)),pt(O,6,l(Q));for(var pe=Math.min(Q.e.r,8191),ge=Q.s.r;ge<=pe;++ge)for(var Xe=Mr(ge),Je=Q.s.c;Je<=Q.e.c;++Je){ge===Q.s.r&&(ye[Je]=Hr(Je));var ut=ye[Je]+Xe,Ne=fe?(k[ge]||[])[Je]:k[ut];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?pt(O,13,d(ge,Je,Ne.v)):pt(O,14,_(ge,Je,Ne.v));else{var oe=To(Ne);pt(O,15,h(ge,Je,oe.slice(0,239)))}}return pt(O,1),O.end()}function r(k,B){var P=B||{};if(+P.codepage>=0&&rd(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var O=pa();pt(O,0,s(k));for(var Q=0,fe=0;Q<k.SheetNames.length;++Q)(k.Sheets[k.SheetNames[Q]]||{})["!ref"]&&pt(O,27,Oe(k.SheetNames[Q],fe++));var ye=0;for(Q=0;Q<k.SheetNames.length;++Q){var pe=k.Sheets[k.SheetNames[Q]];if(!(!pe||!pe["!ref"])){for(var ge=dn(pe["!ref"]),Xe=Array.isArray(pe),Je=[],ut=Math.min(ge.e.r,8191),Ne=ge.s.r;Ne<=ut;++Ne)for(var oe=Mr(Ne),Ft=ge.s.c;Ft<=ge.e.c;++Ft){Ne===ge.s.r&&(Je[Ft]=Hr(Ft));var et=Je[Ft]+oe,bt=Xe?(pe[Ne]||[])[Ft]:pe[et];if(!(!bt||bt.t=="z"))if(bt.t=="n")pt(O,23,X(Ne,Ft,ye,bt.v));else{var rt=To(bt);pt(O,22,W(Ne,Ft,ye,rt.slice(0,239)))}}++ye}}return pt(O,1),O.end()}function a(k){var B=He(2);return B.write_shift(2,k),B}function s(k){var B=He(26);B.write_shift(2,4096),B.write_shift(2,4),B.write_shift(4,0);for(var P=0,O=0,Q=0,fe=0;fe<k.SheetNames.length;++fe){var ye=k.SheetNames[fe],pe=k.Sheets[ye];if(!(!pe||!pe["!ref"])){++Q;var ge=Pa(pe["!ref"]);P<ge.e.r&&(P=ge.e.r),O<ge.e.c&&(O=ge.e.c)}}return P>8191&&(P=8191),B.write_shift(2,P),B.write_shift(1,Q),B.write_shift(1,O),B.write_shift(2,0),B.write_shift(2,0),B.write_shift(1,1),B.write_shift(1,2),B.write_shift(4,0),B.write_shift(4,0),B}function o(k,B,P){var O={s:{c:0,r:0},e:{c:0,r:0}};return B==8&&P.qpro?(O.s.c=k.read_shift(1),k.l++,O.s.r=k.read_shift(2),O.e.c=k.read_shift(1),k.l++,O.e.r=k.read_shift(2),O):(O.s.c=k.read_shift(2),O.s.r=k.read_shift(2),B==12&&P.qpro&&(k.l+=2),O.e.c=k.read_shift(2),O.e.r=k.read_shift(2),B==12&&P.qpro&&(k.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function l(k){var B=He(8);return B.write_shift(2,k.s.c),B.write_shift(2,k.s.r),B.write_shift(2,k.e.c),B.write_shift(2,k.e.r),B}function c(k,B,P){var O=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(O[0].c=k.read_shift(1),O[3]=k.read_shift(1),O[0].r=k.read_shift(2),k.l+=2):(O[2]=k.read_shift(1),O[0].c=k.read_shift(2),O[0].r=k.read_shift(2)),O}function u(k,B,P){var O=k.l+B,Q=c(k,B,P);if(Q[1].t="s",P.vers==20768){k.l++;var fe=k.read_shift(1);return Q[1].v=k.read_shift(fe,"utf8"),Q}return P.qpro&&k.l++,Q[1].v=k.read_shift(O-k.l,"cstr"),Q}function h(k,B,P){var O=He(7+P.length);O.write_shift(1,255),O.write_shift(2,B),O.write_shift(2,k),O.write_shift(1,39);for(var Q=0;Q<O.length;++Q){var fe=P.charCodeAt(Q);O.write_shift(1,fe>=128?95:fe)}return O.write_shift(1,0),O}function g(k,B,P){var O=c(k,B,P);return O[1].v=k.read_shift(2,"i"),O}function d(k,B,P){var O=He(7);return O.write_shift(1,255),O.write_shift(2,B),O.write_shift(2,k),O.write_shift(2,P,"i"),O}function b(k,B,P){var O=c(k,B,P);return O[1].v=k.read_shift(8,"f"),O}function _(k,B,P){var O=He(13);return O.write_shift(1,255),O.write_shift(2,B),O.write_shift(2,k),O.write_shift(8,P,"f"),O}function w(k,B,P){var O=k.l+B,Q=c(k,B,P);if(Q[1].v=k.read_shift(8,"f"),P.qpro)k.l=O;else{var fe=k.read_shift(2);N(k.slice(k.l,k.l+fe),Q),k.l+=fe}return Q}function E(k,B,P){var O=B&32768;return B&=-32769,B=(O?k:0)+(B>=8192?B-16384:B),(O?"":"$")+(P?Hr(B):Mr(B))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},D=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(k,B){Da(k,0);for(var P=[],O=0,Q="",fe="",ye="",pe="";k.l<k.length;){var ge=k[k.l++];switch(ge){case 0:P.push(k.read_shift(8,"f"));break;case 1:fe=E(B[0].c,k.read_shift(2),!0),Q=E(B[0].r,k.read_shift(2),!1),P.push(fe+Q);break;case 2:{var Xe=E(B[0].c,k.read_shift(2),!0),Je=E(B[0].r,k.read_shift(2),!1);fe=E(B[0].c,k.read_shift(2),!0),Q=E(B[0].r,k.read_shift(2),!1),P.push(Xe+Je+":"+fe+Q)}break;case 3:if(k.l<k.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(k.read_shift(2));break;case 6:{for(var ut="";ge=k[k.l++];)ut+=String.fromCharCode(ge);P.push('"'+ut.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:pe=P.pop(),ye=P.pop(),P.push(["AND","OR"][ge-20]+"("+ye+","+pe+")");break;default:if(ge<32&&D[ge])pe=P.pop(),ye=P.pop(),P.push(ye+D[ge]+pe);else if(A[ge]){if(O=A[ge][1],O==69&&(O=k[k.l++]),O>P.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+P.join("|")+"|");return}var Ne=P.slice(-O);P.length-=O,P.push(A[ge][0]+"("+Ne.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}P.length==1?B[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function z(k){var B=[{c:0,r:0},{t:"n",v:0},0];return B[0].r=k.read_shift(2),B[3]=k[k.l++],B[0].c=k[k.l++],B}function J(k,B){var P=z(k,B);return P[1].t="s",P[1].v=k.read_shift(B-4,"cstr"),P}function W(k,B,P,O){var Q=He(6+O.length);Q.write_shift(2,k),Q.write_shift(1,P),Q.write_shift(1,B),Q.write_shift(1,39);for(var fe=0;fe<O.length;++fe){var ye=O.charCodeAt(fe);Q.write_shift(1,ye>=128?95:ye)}return Q.write_shift(1,0),Q}function U(k,B){var P=z(k,B);P[1].v=k.read_shift(2);var O=P[1].v>>1;if(P[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return P[1].v=O,P}function M(k,B){var P=z(k,B),O=k.read_shift(4),Q=k.read_shift(4),fe=k.read_shift(2);if(fe==65535)return O===0&&Q===3221225472?(P[1].t="e",P[1].v=15):O===0&&Q===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var ye=fe&32768;return fe=(fe&32767)-16446,P[1].v=(1-ye*2)*(Q*Math.pow(2,fe+32)+O*Math.pow(2,fe)),P}function X(k,B,P,O){var Q=He(14);if(Q.write_shift(2,k),Q.write_shift(1,P),Q.write_shift(1,B),O==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var fe=0,ye=0,pe=0,ge=0;return O<0&&(fe=1,O=-O),ye=Math.log2(O)|0,O/=Math.pow(2,ye-31),ge=O>>>0,(ge&2147483648)==0&&(O/=2,++ye,ge=O>>>0),O-=ge,ge|=2147483648,ge>>>=0,O*=Math.pow(2,32),pe=O>>>0,Q.write_shift(4,pe),Q.write_shift(4,ge),ye+=16383+(fe?32768:0),Q.write_shift(2,ye),Q}function F(k,B){var P=M(k,14);return k.l+=B-14,P}function I(k,B){var P=z(k,B),O=k.read_shift(4);return P[1].v=O>>6,P}function ee(k,B){var P=z(k,B),O=k.read_shift(8,"f");return P[1].v=O,P}function le(k,B){var P=ee(k,14);return k.l+=B-10,P}function de(k,B){return k[k.l+B-1]==0?k.read_shift(B,"cstr"):""}function ke(k,B){var P=k[k.l++];P>B-1&&(P=B-1);for(var O="";O.length<P;)O+=String.fromCharCode(k[k.l++]);return O}function Fe(k,B,P){if(!(!P.qpro||B<21)){var O=k.read_shift(1);k.l+=17,k.l+=1,k.l+=2;var Q=k.read_shift(B-21,"cstr");return[O,Q]}}function Se(k,B){for(var P={},O=k.l+B;k.l<O;){var Q=k.read_shift(2);if(Q==14e3){for(P[Q]=[0,""],P[Q][0]=k.read_shift(2);k[k.l];)P[Q][1]+=String.fromCharCode(k[k.l]),k.l++;k.l++}}return P}function Oe(k,B){var P=He(5+k.length);P.write_shift(2,14e3),P.write_shift(2,B);for(var O=0;O<k.length;++O){var Q=k.charCodeAt(O);P[P.l++]=Q>127?95:Q}return P[P.l++]=0,P}var Ze={0:{n:"BOF",f:Cy},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:ke},65535:{n:""}},qe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:J},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:U},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:le},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Fe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:r,to_workbook:t}})();var eL=/^\s|\s$|[\t\n\r]/;function Dy(i,t){if(!t.bookSST)return"";var e=[Xn];e[e.length]=ft("sst",null,{xmlns:bc[0],count:i.Count,uniqueCount:i.Unique});for(var n=0;n!=i.length;++n)if(i[n]!=null){var r=i[n],a="<si>";r.r?a+=r.r:(a+="<t",r.t||(r.t=""),r.t.match(eL)&&(a+=' xml:space="preserve"'),a+=">"+Wi(r.t)+"</t>"),a+="</si>",e[e.length]=a}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function tL(i){return[i.read_shift(4),i.read_shift(4)]}function iL(i,t){return t||(t=He(8)),t.write_shift(4,i.Count),t.write_shift(4,i.Unique),t}var nL=$P;function rL(i){var t=pa();Qe(t,159,iL(i));for(var e=0;e<i.length;++e)Qe(t,19,nL(i[e]));return Qe(t,160),t.end()}function aL(i){if(typeof Ji<"u")return Ji.utils.encode(vc,i);for(var t=[],e=i.split(""),n=0;n<e.length;++n)t[n]=e[n].charCodeAt(0);return t}function Ny(i){var t=0,e,n=aL(i),r=n.length+1,a,s,o,l,c;for(e=d0(r),e[0]=n.length,a=1;a!=r;++a)e[a]=n[a-1];for(a=r-1;a>=0;--a)s=e[a],o=(t&16384)===0?0:1,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var sL=(function(){function i(r,a){switch(a.type){case"base64":return t(ko(r),a);case"binary":return t(r,a);case"buffer":return t(Fi&&Buffer.isBuffer(r)?r.toString("binary"):ud(r),a);case"array":return t(k1(r),a)}throw new Error("Unrecognized type "+a.type)}function t(r,a){var s=a||{},o=s.dense?[]:{},l=r.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var g=/\\\w+\b/g,d=0,b,_=-1;b=g.exec(u);){switch(b[0]){case"\\cell":var w=u.slice(d,g.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++_,w.length){var E={v:w,t:"s"};Array.isArray(o)?o[h][_]=E:o[qi({r:h,c:_})]=E}break}d=g.lastIndex}_>c.e.c&&(c.e.c=_)}),o["!ref"]=$n(c),o}function e(r,a){return p0(i(r,a),a)}function n(r){for(var a=["{\\rtf1\\ansi"],s=dn(r["!ref"]),o,l=Array.isArray(r),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=qi({r:c,c:u});o=l?(r[c]||[])[u]:r[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(To(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:i,from_sheet:n}})();function Aw(i){for(var t=0,e=1;t!=3;++t)e=e*256+(i[t]>255?255:i[t]<0?0:i[t]);return e.toString(16).toUpperCase().slice(1)}var oL=6;var Eo=oL;function x1(i){return Math.floor((i+Math.round(128/Eo)/256)*Eo)}function v1(i){return Math.floor((i-5)/Eo*100+.5)/100}function Ug(i){return Math.round((i*Eo+5)/Eo*256)/256}function s2(i){i.width?(i.wpx=x1(i.width),i.wch=v1(i.wpx),i.MDW=Eo):i.wpx?(i.wch=v1(i.wpx),i.width=Ug(i.wch),i.MDW=Eo):typeof i.wch=="number"&&(i.width=Ug(i.wch),i.wpx=x1(i.width),i.MDW=Eo),i.customWidth&&delete i.customWidth}var lL=96,Py=lL;function _1(i){return i*96/Py}function My(i){return i*Py/96}function cL(i){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)i[n]!=null&&(t[t.length]=ft("numFmt",null,{numFmtId:n,formatCode:Wi(i[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ft("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function uL(i){var t=[];return t[t.length]=ft("cellXfs",null),i.forEach(function(e){t[t.length]=ft("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ft("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ly(i,t){var e=[Xn,ft("styleSheet",null,{xmlns:bc[0],"xmlns:vt":gr.vt})],n;return i.SSF&&(n=cL(i.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=uL(t.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function dL(i,t){var e=i.read_shift(2),n=Wr(i,t-2);return[e,n]}function fL(i,t,e){e||(e=He(6+4*t.length)),e.write_shift(2,i),vr(t,e);var n=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),n}function hL(i,t,e){var n={};n.sz=i.read_shift(2)/20;var r=eM(i,2,e);r.fItalic&&(n.italic=1),r.fCondense&&(n.condense=1),r.fExtend&&(n.extend=1),r.fShadow&&(n.shadow=1),r.fOutline&&(n.outline=1),r.fStrikeout&&(n.strike=1);var a=i.read_shift(2);switch(a===700&&(n.bold=1),i.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=i.read_shift(1);s!=0&&(n.underline=s);var o=i.read_shift(1);o>0&&(n.family=o);var l=i.read_shift(1);switch(l>0&&(n.charset=l),i.l++,n.color=QP(i,8),i.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wr(i,t-21),n}function pL(i,t){t||(t=He(153)),t.write_shift(2,i.sz*20),tM(i,t),t.write_shift(2,i.bold?700:400);var e=0;i.vertAlign=="superscript"?e=1:i.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,i.underline||0),t.write_shift(1,i.family||0),t.write_shift(1,i.charset||0),t.write_shift(1,0),m1(i.color,t);var n=0;return i.scheme=="major"&&(n=1),i.scheme=="minor"&&(n=2),t.write_shift(1,n),vr(i.name,t),t.length>t.l?t.slice(0,t.l):t}var mL=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lg,gL=Hs;function Fw(i,t){t||(t=He(84)),Lg||(Lg=Wg(mL));var e=Lg[i.patternType];e==null&&(e=40),t.write_shift(4,e);var n=0;if(e!=40)for(m1({auto:1},t),m1({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function xL(i,t){var e=i.l+t,n=i.read_shift(2),r=i.read_shift(2);return i.l=e,{ixfe:n,numFmtId:r}}function Iy(i,t,e){e||(e=He(16)),e.write_shift(2,t||0),e.write_shift(2,i.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var n=0;return e.write_shift(1,n),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Ku(i,t){return t||(t=He(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var vL=Hs;function _L(i,t){return t||(t=He(51)),t.write_shift(1,0),Ku(null,t),Ku(null,t),Ku(null,t),Ku(null,t),Ku(null,t),t.length>t.l?t.slice(0,t.l):t}function bL(i,t){return t||(t=He(52)),t.write_shift(4,i.xfId),t.write_shift(2,1),t.write_shift(1,+i.builtinId),t.write_shift(1,0),p1(i.name||"",t),t.length>t.l?t.slice(0,t.l):t}function wL(i,t,e){var n=He(2052);return n.write_shift(4,i),p1(t,n),p1(e,n),n.length>n.l?n.slice(0,n.l):n}function yL(i,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&++e}),e!=0&&(Qe(i,615,vs(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&Qe(i,44,fL(r,t[r]))}),Qe(i,616))}}function SL(i){var t=1;t!=0&&(Qe(i,611,vs(t)),Qe(i,43,pL({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Qe(i,612))}function CL(i){var t=2;t!=0&&(Qe(i,603,vs(t)),Qe(i,45,Fw({patternType:"none"})),Qe(i,45,Fw({patternType:"gray125"})),Qe(i,604))}function EL(i){var t=1;t!=0&&(Qe(i,613,vs(t)),Qe(i,46,_L({})),Qe(i,614))}function kL(i){var t=1;Qe(i,626,vs(t)),Qe(i,47,Iy({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Qe(i,627)}function TL(i,t){Qe(i,617,vs(t.length)),t.forEach(function(e){Qe(i,47,Iy(e,0))}),Qe(i,618)}function AL(i){var t=1;Qe(i,619,vs(t)),Qe(i,48,bL({xfId:0,builtinId:0,name:"Normal"})),Qe(i,620)}function FL(i){var t=0;Qe(i,505,vs(t)),Qe(i,506)}function DL(i){var t=0;Qe(i,508,wL(t,"TableStyleMedium9","PivotStyleMedium4")),Qe(i,509)}function NL(i,t){var e=pa();return Qe(e,278),yL(e,i.SSF),SL(e,i),CL(e,i),EL(e,i),kL(e,i),TL(e,t.cellXfs),AL(e,i),FL(e,i),DL(e,i),Qe(e,279),e.end()}function Ry(i,t){if(t&&t.themeXLSX)return t.themeXLSX;if(i&&typeof i.raw=="string")return i.raw;var e=[Xn];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function PL(i,t){return{flags:i.read_shift(4),version:i.read_shift(4),name:Wr(i,t-8)}}function ML(i){var t=He(12+2*i.name.length);return t.write_shift(4,i.flags),t.write_shift(4,i.version),vr(i.name,t),t.slice(0,t.l)}function LL(i){for(var t=[],e=i.read_shift(4);e-- >0;)t.push([i.read_shift(4),i.read_shift(4)]);return t}function IL(i){var t=He(4+8*i.length);t.write_shift(4,i.length);for(var e=0;e<i.length;++e)t.write_shift(4,i[e][0]),t.write_shift(4,i[e][1]);return t}function RL(i,t){var e=He(8+2*t.length);return e.write_shift(4,i),vr(t,e),e.slice(0,e.l)}function OL(i){return i.l+=4,i.read_shift(4)!=0}function BL(i,t){var e=He(8);return e.write_shift(4,i),e.write_shift(4,t?1:0),e}function jL(){var i=pa();return Qe(i,332),Qe(i,334,vs(1)),Qe(i,335,ML({name:"XLDAPR",version:12e4,flags:3496657072})),Qe(i,336),Qe(i,339,RL(1,"XLDAPR")),Qe(i,52),Qe(i,35,vs(514)),Qe(i,4096,vs(0)),Qe(i,4097,Ya(1)),Qe(i,36),Qe(i,53),Qe(i,340),Qe(i,337,BL(1,!0)),Qe(i,51,IL([[1,0]])),Qe(i,338),Qe(i,333),i.end()}function Oy(){var i=[Xn];return i.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),i.join("")}function VL(i){var t={};t.i=i.read_shift(4);var e={};e.r=i.read_shift(4),e.c=i.read_shift(4),t.r=qi(e);var n=i.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var fc=1024;function By(i,t){for(var e=[21600,21600],n=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),r=[ft("xml",null,{"xmlns:v":Na.v,"xmlns:o":Na.o,"xmlns:x":Na.x,"xmlns:mv":Na.mv}).replace(/\/>/,">"),ft("o:shapelayout",ft("o:idmap",null,{"v:ext":"edit",data:i}),{"v:ext":"edit"}),ft("v:shapetype",[ft("v:stroke",null,{joinstyle:"miter"}),ft("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:n})];fc<i*1e3;)fc+=1e3;return t.forEach(function(a){var s=xr(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?ft("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ft("v:fill",l,o),u={on:"t",obscured:"t"};++fc,r=r.concat(["<v:shape"+od({id:"_x0000_s"+fc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ft("v:shadow",null,u),ft("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Pr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Pr("x:AutoFill","False"),Pr("x:Row",String(s.r)),Pr("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function jy(i){var t=[Xn,ft("comments",null,{xmlns:bc[0]})],e=[];return t.push("<authors>"),i.forEach(function(n){n[1].forEach(function(r){var a=Wi(r.a);e.indexOf(a)==-1&&(e.push(a),t.push("<author>"+a+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),i.forEach(function(n){var r=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?r=e.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(r=e.indexOf(Wi(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(Pr("t",Wi(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;t.push(Pr("t",Wi(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function UL(i,t,e){var n=[Xn,ft("ThreadedComments",null,{xmlns:gr.TCMNT}).replace(/[\/]>/,">")];return i.forEach(function(r){var a="";(r[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(ft("threadedComment",Pr("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function zL(i){var t=[Xn,ft("personList",null,{xmlns:gr.TCMNT,"xmlns:x":bc[0]}).replace(/[\/]>/,">")];return i.forEach(function(e,n){t.push(ft("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function HL(i){var t={};t.iauthor=i.read_shift(4);var e=v0(i,16);return t.rfx=e.s,t.ref=qi(e.s),i.l+=16,t}function WL(i,t){return t==null&&(t=He(36)),t.write_shift(4,i[1].iauthor),Sc(i[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var qL=Wr;function GL(i){return vr(i.slice(0,54))}function $L(i){var t=pa(),e=[];return Qe(t,628),Qe(t,630),i.forEach(function(n){n[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),Qe(t,632,GL(r.a)))})}),Qe(t,631),Qe(t,633),i.forEach(function(n){n[1].forEach(function(r){r.iauthor=e.indexOf(r.a);var a={s:xr(n[0]),e:xr(n[0])};Qe(t,635,WL([a,r])),r.t&&r.t.length>0&&Qe(t,637,YP(r)),Qe(t,636),delete r.iauthor})}),Qe(t,634),Qe(t,629),t.end()}function XL(i,t){t.FullPaths.forEach(function(e,n){if(n!=0){var r=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&$i.utils.cfb_add(i,r,t.FileIndex[n].content)}})}var Vy=["xlsb","xlsm","xlam","biff8","xla"];var YL=(function(){var i=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(n,r,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,r+(o?"":"$")+Hr(u)+(l?"":"$")+Mr(c)}return function(r,a){return t=a,r.replace(i,e)}})(),o2=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,l2=(function(){return function(t,e){return t.replace(o2,function(n,r,a,s,o,l){var c=t2(s)-(a?0:e.c),u=e2(l)-(o?0:e.r),h=u==0?"":o?u+1:"["+u+"]",g=c==0?"":a?c+1:"["+c+"]";return r+"R"+h+"C"+g})}})();function KL(i,t){return i.replace(o2,function(e,n,r,a,s,o){return n+(r=="$"?r+a:Hr(t2(a)+t.c))+(s=="$"?s+o:Mr(e2(o)+t.r))})}function ZL(i){return i.length!=1}function Gn(i){i.l+=1}function bl(i,t){var e=i.read_shift(t==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function Uy(i,t,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return zy(i,t,e);e.biff==12&&(n=4)}var r=i.read_shift(n),a=i.read_shift(n),s=bl(i,2),o=bl(i,2);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function zy(i){var t=bl(i,2),e=bl(i,2),n=i.read_shift(1),r=i.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function JL(i,t,e){if(e.biff<8)return zy(i,t,e);var n=i.read_shift(e.biff==12?4:2),r=i.read_shift(e.biff==12?4:2),a=bl(i,2),s=bl(i,2);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:s[0],cRel:s[1],rRel:s[2]}}}function Hy(i,t,e){if(e&&e.biff>=2&&e.biff<=5)return QL(i,t,e);var n=i.read_shift(e&&e.biff==12?4:2),r=bl(i,2);return{r:n,c:r[0],cRel:r[1],rRel:r[2]}}function QL(i){var t=bl(i,2),e=i.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function e9(i){var t=i.read_shift(2),e=i.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function t9(i,t,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return i9(i,t,e);var r=i.read_shift(n>=12?4:2),a=i.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;r>524287;)r-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:s,rRel:o}}function i9(i){var t=i.read_shift(2),e=i.read_shift(1),n=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),r==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:r,rRel:n}}function n9(i,t,e){var n=(i[i.l++]&96)>>5,r=Uy(i,e.biff>=2&&e.biff<=5?6:8,e);return[n,r]}function r9(i,t,e){var n=(i[i.l++]&96)>>5,r=i.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:i.l+=12,a=6;break;case 12:a=12;break}var s=Uy(i,a,e);return[n,r,s]}function a9(i,t,e){var n=(i[i.l++]&96)>>5;return i.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function s9(i,t,e){var n=(i[i.l++]&96)>>5,r=i.read_shift(2),a=8;if(e)switch(e.biff){case 5:i.l+=12,a=6;break;case 12:a=12;break}return i.l+=a,[n,r]}function o9(i,t,e){var n=(i[i.l++]&96)>>5,r=JL(i,t-1,e);return[n,r]}function l9(i,t,e){var n=(i[i.l++]&96)>>5;return i.l+=e.biff==2?6:e.biff==12?14:7,[n]}function Dw(i){var t=i[i.l+1]&1,e=1;return i.l+=4,[t,e]}function c9(i,t,e){i.l+=2;for(var n=i.read_shift(e&&e.biff==2?1:2),r=[],a=0;a<=n;++a)r.push(i.read_shift(e&&e.biff==2?1:2));return r}function u9(i,t,e){var n=i[i.l+1]&255?1:0;return i.l+=2,[n,i.read_shift(e&&e.biff==2?1:2)]}function d9(i,t,e){var n=i[i.l+1]&255?1:0;return i.l+=2,[n,i.read_shift(e&&e.biff==2?1:2)]}function f9(i){var t=i[i.l+1]&255?1:0;return i.l+=2,[t,i.read_shift(2)]}function h9(i,t,e){var n=i[i.l+1]&255?1:0;return i.l+=e&&e.biff==2?3:4,[n]}function Wy(i){var t=i.read_shift(1),e=i.read_shift(1);return[t,e]}function p9(i){return i.read_shift(2),Wy(i,2)}function m9(i){return i.read_shift(2),Wy(i,2)}function g9(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=Hy(i,0,e);return[n,r]}function x9(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=t9(i,0,e);return[n,r]}function v9(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=i.read_shift(2);e&&e.biff==5&&(i.l+=12);var a=Hy(i,0,e);return[n,r,a]}function _9(i,t,e){var n=(i[i.l]&96)>>5;i.l+=1;var r=i.read_shift(e&&e.biff<=3?1:2);return[_I[r],$y[r],n]}function b9(i,t,e){var n=i[i.l++],r=i.read_shift(1),a=e&&e.biff<=3?[n==88?-1:0,i.read_shift(1)]:w9(i);return[r,(a[0]===0?$y:vI)[a[1]]]}function w9(i){return[i[i.l+1]>>7,i.read_shift(2)&32767]}function y9(i,t,e){i.l+=e&&e.biff==2?3:4}function S9(i,t,e){if(i.l++,e&&e.biff==12)return[i.read_shift(4,"i"),0];var n=i.read_shift(2),r=i.read_shift(e&&e.biff==2?1:2);return[n,r]}function C9(i){return i.l++,fd[i.read_shift(1)]}function E9(i){return i.l++,i.read_shift(2)}function k9(i){return i.l++,i.read_shift(1)!==0}function T9(i){return i.l++,Cc(i,8)}function A9(i,t,e){return i.l++,ky(i,t-1,e)}function F9(i,t){var e=[i.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=vM(i,1)?"TRUE":"FALSE",t!=12&&(i.l+=7);break;case 37:case 16:e[1]=fd[i[i.l]],i.l+=t==12?4:8;break;case 0:i.l+=8;break;case 1:e[1]=Cc(i,8);break;case 2:e[1]=yM(i,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function D9(i,t,e){for(var n=i.read_shift(e.biff==12?4:2),r=[],a=0;a!=n;++a)r.push((e.biff==12?v0:EM)(i,8));return r}function N9(i,t,e){var n=0,r=0;e.biff==12?(n=i.read_shift(4),r=i.read_shift(4)):(r=1+i.read_shift(1),n=1+i.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--r==0&&(r=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=r;++o)s[a][o]=F9(i,e.biff);return s}function P9(i,t,e){var n=i.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,a=i.read_shift(r);switch(e.biff){case 2:i.l+=5;break;case 3:case 4:i.l+=8;break;case 5:i.l+=12;break}return[n,0,a]}function M9(i,t,e){if(e.biff==5)return L9(i,t,e);var n=i.read_shift(1)>>>5&3,r=i.read_shift(2),a=i.read_shift(4);return[n,r,a]}function L9(i){var t=i.read_shift(1)>>>5&3,e=i.read_shift(2,"i");i.l+=8;var n=i.read_shift(2);return i.l+=12,[t,e,n]}function I9(i,t,e){var n=i.read_shift(1)>>>5&3;i.l+=e&&e.biff==2?3:4;var r=i.read_shift(e&&e.biff==2?1:2);return[n,r]}function R9(i,t,e){var n=i.read_shift(1)>>>5&3,r=i.read_shift(e&&e.biff==2?1:2);return[n,r]}function O9(i,t,e){var n=i.read_shift(1)>>>5&3;return i.l+=4,e.biff<8&&i.l--,e.biff==12&&(i.l+=2),[n]}function B9(i,t,e){var n=(i[i.l++]&96)>>5,r=i.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return i.l+=a,[n,r]}var j9=Hs,V9=Hs,U9=Hs;function hd(i,t,e){return i.l+=2,[e9(i,4,e)]}function c2(i){return i.l+=6,[]}var z9=hd,H9=c2,W9=c2,q9=hd;function qy(i){return i.l+=2,[Cy(i),i.read_shift(2)&1]}var G9=hd,$9=qy,X9=c2,Y9=hd,K9=hd,Z9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function J9(i){i.l+=2;var t=i.read_shift(2),e=i.read_shift(2),n=i.read_shift(4),r=i.read_shift(2),a=i.read_shift(2),s=Z9[e>>2&31];return{ixti:t,coltype:e&3,rt:s,idx:n,c:r,C:a}}function Q9(i){return i.l+=2,[i.read_shift(4)]}function eI(i,t,e){return i.l+=5,i.l+=2,i.l+=e.biff==2?1:4,["PTGSHEET"]}function tI(i,t,e){return i.l+=e.biff==2?4:5,["PTGENDSHEET"]}function iI(i){var t=i.read_shift(1)>>>5&3,e=i.read_shift(2);return[t,e]}function nI(i){var t=i.read_shift(1)>>>5&3,e=i.read_shift(2);return[t,e]}function rI(i){return i.l+=4,[0,0]}var Nw={1:{n:"PtgExp",f:S9},2:{n:"PtgTbl",f:U9},3:{n:"PtgAdd",f:Gn},4:{n:"PtgSub",f:Gn},5:{n:"PtgMul",f:Gn},6:{n:"PtgDiv",f:Gn},7:{n:"PtgPower",f:Gn},8:{n:"PtgConcat",f:Gn},9:{n:"PtgLt",f:Gn},10:{n:"PtgLe",f:Gn},11:{n:"PtgEq",f:Gn},12:{n:"PtgGe",f:Gn},13:{n:"PtgGt",f:Gn},14:{n:"PtgNe",f:Gn},15:{n:"PtgIsect",f:Gn},16:{n:"PtgUnion",f:Gn},17:{n:"PtgRange",f:Gn},18:{n:"PtgUplus",f:Gn},19:{n:"PtgUminus",f:Gn},20:{n:"PtgPercent",f:Gn},21:{n:"PtgParen",f:Gn},22:{n:"PtgMissArg",f:Gn},23:{n:"PtgStr",f:A9},26:{n:"PtgSheet",f:eI},27:{n:"PtgEndSheet",f:tI},28:{n:"PtgErr",f:C9},29:{n:"PtgBool",f:k9},30:{n:"PtgInt",f:E9},31:{n:"PtgNum",f:T9},32:{n:"PtgArray",f:l9},33:{n:"PtgFunc",f:_9},34:{n:"PtgFuncVar",f:b9},35:{n:"PtgName",f:P9},36:{n:"PtgRef",f:g9},37:{n:"PtgArea",f:n9},38:{n:"PtgMemArea",f:I9},39:{n:"PtgMemErr",f:j9},40:{n:"PtgMemNoMem",f:V9},41:{n:"PtgMemFunc",f:R9},42:{n:"PtgRefErr",f:O9},43:{n:"PtgAreaErr",f:a9},44:{n:"PtgRefN",f:x9},45:{n:"PtgAreaN",f:o9},46:{n:"PtgMemAreaN",f:iI},47:{n:"PtgMemNoMemN",f:nI},57:{n:"PtgNameX",f:M9},58:{n:"PtgRef3d",f:v9},59:{n:"PtgArea3d",f:r9},60:{n:"PtgRefErr3d",f:B9},61:{n:"PtgAreaErr3d",f:s9},255:{}},aI={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},sI={1:{n:"PtgElfLel",f:qy},2:{n:"PtgElfRw",f:Y9},3:{n:"PtgElfCol",f:z9},6:{n:"PtgElfRwV",f:K9},7:{n:"PtgElfColV",f:q9},10:{n:"PtgElfRadical",f:G9},11:{n:"PtgElfRadicalS",f:X9},13:{n:"PtgElfColS",f:H9},15:{n:"PtgElfColSV",f:W9},16:{n:"PtgElfRadicalLel",f:$9},25:{n:"PtgList",f:J9},29:{n:"PtgSxName",f:Q9},255:{}},oI={0:{n:"PtgAttrNoop",f:rI},1:{n:"PtgAttrSemi",f:h9},2:{n:"PtgAttrIf",f:d9},4:{n:"PtgAttrChoose",f:c9},8:{n:"PtgAttrGoto",f:u9},16:{n:"PtgAttrSum",f:y9},32:{n:"PtgAttrBaxcel",f:Dw},33:{n:"PtgAttrBaxcel",f:Dw},64:{n:"PtgAttrSpace",f:p9},65:{n:"PtgAttrSpaceSemi",f:m9},128:{n:"PtgAttrIfError",f:f9},255:{}};function lI(i,t,e,n){if(n.biff<8)return Hs(i,t);for(var r=i.l+t,a=[],s=0;s!==e.length;++s)switch(e[s][0]){case"PtgArray":e[s][1]=N9(i,0,n),a.push(e[s][1]);break;case"PtgMemArea":e[s][2]=D9(i,e[s][1],n),a.push(e[s][2]);break;case"PtgExp":n&&n.biff==12&&(e[s][1][1]=i.read_shift(4),a.push(e[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[s][0];default:break}return t=r-i.l,t!==0&&a.push(Hs(i,t)),a}function cI(i,t,e){for(var n=i.l+t,r,a,s=[];n!=i.l;)t=n-i.l,a=i[i.l],r=Nw[a]||Nw[aI[a]],(a===24||a===25)&&(r=(a===24?sI:oI)[i[i.l+1]]),!r||!r.f?Hs(i,t):s.push([r.n,r.f(i,t,e)]);return s}function uI(i){for(var t=[],e=0;e<i.length;++e){for(var n=i[e],r=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:r.push('"'+s[1].replace(/"/g,'""')+'"');break;default:r.push(s[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var dI={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fI(i,t){if(!i&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(i)?"'"+i+"'":i}function Gy(i,t,e){if(!i)return"SH33TJSERR0";if(e.biff>8&&(!i.XTI||!i.XTI[t]))return i.SheetNames[t];if(!i.XTI)return"SH33TJSERR6";var n=i.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":i.XTI[t-1];if(!n)return"SH33TJSERR1";var r="";if(e.biff>8)switch(i[n[0]][0]){case 357:return r=n[1]==-1?"#REF":i.SheetNames[n[1]],n[1]==n[2]?r:r+":"+i.SheetNames[n[2]];case 358:return e.SID!=null?i.SheetNames[e.SID]:"SH33TJSSAME"+i[n[0]][0];case 355:default:return"SH33TJSSRC"+i[n[0]][0]}switch(i[n[0]][0][0]){case 1025:return r=n[1]==-1?"#REF":i.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?r:r+":"+i.SheetNames[n[2]];case 14849:return i[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return i[n[0]][0][3]?(r=n[1]==-1?"#REF":i[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?r:r+":"+i[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Pw(i,t,e){var n=Gy(i,t,e);return n=="#REF"?n:fI(n,e)}function _c(i,t,e,n,r){var a=r&&r.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,g=0,d,b="";if(!i[0]||!i[0][0])return"";for(var _=-1,w="",E=0,A=i[0].length;E<A;++E){var D=i[0][E];switch(D[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),_>=0){switch(i[0][_][1][0]){case 0:w=Cn(" ",i[0][_][1][1]);break;case 1:w=Cn("\r",i[0][_][1][1]);break;default:if(w="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][_][1][0])}c=c+w,_=-1}o.push(c+dI[D[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=ed(D[1][1],s,r),o.push(td(u,a));break;case"PtgRefN":u=e?ed(D[1][1],e,r):D[1][1],o.push(td(u,a));break;case"PtgRef3d":h=D[1][1],u=ed(D[1][2],s,r),b=Pw(n,h,r);var N=b;o.push(b+"!"+td(u,a));break;case"PtgFunc":case"PtgFuncVar":var z=D[1][0],J=D[1][1];z||(z=0),z&=127;var W=z==0?[]:o.slice(-z);o.length-=z,J==="User"&&(J=W.shift()),o.push(J+"("+W.join(",")+")");break;case"PtgBool":o.push(D[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(D[1]);break;case"PtgNum":o.push(String(D[1]));break;case"PtgStr":o.push('"'+D[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(D[1]);break;case"PtgAreaN":d=gw(D[1][1],e?{s:e}:s,r),o.push(Pg(d,r));break;case"PtgArea":d=gw(D[1][1],s,r),o.push(Pg(d,r));break;case"PtgArea3d":h=D[1][1],d=D[1][2],b=Pw(n,h,r),o.push(b+"!"+Pg(d,r));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=D[1][2];var U=(n.names||[])[g-1]||(n[0]||[])[g],M=U?U.Name:"SH33TJSNAME"+String(g);M&&M.slice(0,6)=="_xlfn."&&!r.xlfn&&(M=M.slice(6)),o.push(M);break;case"PtgNameX":var X=D[1][1];g=D[1][2];var F;if(r.biff<=5)X<0&&(X=-X),n[X]&&(F=n[X][g]);else{var I="";if(((n[X]||[])[0]||[])[0]==14849||(((n[X]||[])[0]||[])[0]==1025?n[X][g]&&n[X][g].itab>0&&(I=n.SheetNames[n[X][g].itab-1]+"!"):I=n.SheetNames[g-1]+"!"),n[X]&&n[X][g])I+=n[X][g].Name;else if(n[0]&&n[0][g])I+=n[0][g].Name;else{var ee=(Gy(n,X,r)||"").split(";;");ee[g-1]?I=ee[g-1]:I+="SH33TJSERRX"}o.push(I);break}F||(F={Name:"SH33TJSERRY"}),o.push(F.Name);break;case"PtgParen":var le="(",de=")";if(_>=0){switch(w="",i[0][_][1][0]){case 2:le=Cn(" ",i[0][_][1][1])+le;break;case 3:le=Cn("\r",i[0][_][1][1])+le;break;case 4:de=Cn(" ",i[0][_][1][1])+de;break;case 5:de=Cn("\r",i[0][_][1][1])+de;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+i[0][_][1][0])}_=-1}o.push(le+o.pop()+de);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:D[1][1],r:D[1][0]};var ke={c:e.c,r:e.r};if(n.sharedf[qi(u)]){var Fe=n.sharedf[qi(u)];o.push(_c(Fe,s,ke,n,r))}else{var Se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(_c(c[1],s,ke,n,r)),Se=!0;break}Se||o.push(D[1])}break;case"PtgArray":o.push("{"+uI(D[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+D[1].idx+"[#"+D[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(D));default:throw new Error("Unrecognized Formula Token: "+String(D))}var Oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&_>=0&&Oe.indexOf(i[0][E][0])==-1){D=i[0][_];var Ze=!0;switch(D[1][0]){case 4:Ze=!1;case 0:w=Cn(" ",D[1][1]);break;case 5:Ze=!1;case 1:w=Cn("\r",D[1][1]);break;default:if(w="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+D[1][0])}o.push((Ze?w:"")+o.pop()+(Ze?"":w)),_=-1}}if(o.length>1&&r.WTF)throw new Error("bad formula stack");return o[0]}function hI(i){if(i==null){var t=He(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof i=="number")return f0(i);return f0(0)}function pI(i,t,e,n,r){var a=h0(t,e,r),s=hI(i.v),o=He(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=He(i.bf.length),u=0;u<i.bf.length;++u)c[u]=i.bf[u];var h=Nr([a,s,o,c]);return h}function A1(i,t,e){var n=i.read_shift(4),r=cI(i,n,e),a=i.read_shift(4),s=a>0?lI(i,a,r,e):null;return[r,s]}var mI=A1,F1=A1,gI=A1,xI=A1,vI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$y={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},_I={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bI(i){var t="of:="+i.replace(o2,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function wI(i){return i.replace(/\./,"!")}var id=typeof Map<"u";function u2(i,t,e){var n=0,r=i.length;if(e){if(id?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var a=id?e.get(t):e[t];n<a.length;++n)if(i[a[n]].t===t)return i.Count++,a[n]}}else for(;n<r;++n)if(i[n].t===t)return i.Count++,n;return i[r]={t},i.Count++,i.Unique++,e&&(id?(e.has(t)||e.set(t,[]),e.get(t).push(r)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(r))),r}function D1(i,t){var e={min:i+1,max:i+1},n=-1;return t.MDW&&(Eo=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?n=v1(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(e.width=Ug(n),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function Xy(i,t){if(i){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),i.left==null&&(i.left=e[0]),i.right==null&&(i.right=e[1]),i.top==null&&(i.top=e[2]),i.bottom==null&&(i.bottom=e[3]),i.header==null&&(i.header=e[4]),i.footer==null&&(i.footer=e[5])}}function yl(i,t,e){var n=e.revssf[t.z!=null?t.z:"General"],r=60,a=i.length;if(n==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){Xw(t.z,r),e.ssf[r]=t.z,e.revssf[t.z]=n=r;break}}for(r=0;r!=a;++r)if(i[r].numFmtId===n)return r;return i[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function yI(i,t,e){if(i&&i["!ref"]){var n=dn(i["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+i["!ref"])}}function SI(i){if(i.length===0)return"";for(var t='<mergeCells count="'+i.length+'">',e=0;e!=i.length;++e)t+='<mergeCell ref="'+$n(i[e])+'"/>';return t+"</mergeCells>"}function CI(i,t,e,n,r){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[e];try{t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch{}a=!0,s.codeName=yo(Wi(l))}if(i&&i["!outline"]){var c={summaryBelow:1,summaryRight:1};i["!outline"].above&&(c.summaryBelow=0),i["!outline"].left&&(c.summaryRight=0),o=(o||"")+ft("outlinePr",null,c)}!a&&!o||(r[r.length]=ft("sheetPr",o,s))}var EI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],kI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function TI(i){var t={sheet:1};return EI.forEach(function(e){i[e]!=null&&i[e]&&(t[e]="1")}),kI.forEach(function(e){i[e]!=null&&!i[e]&&(t[e]="0")}),i.password&&(t.password=Ny(i.password).toString(16).toUpperCase()),ft("sheetProtection",null,t)}function AI(i){return Xy(i),ft("pageMargins",null,i)}function FI(i,t){for(var e=["<cols>"],n,r=0;r!=t.length;++r)(n=t[r])&&(e[e.length]=ft("col",null,D1(r,n)));return e[e.length]="</cols>",e.join("")}function DI(i,t,e,n){var r=typeof i.ref=="string"?i.ref:$n(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,s=Pa(r);s.s.r==s.e.r&&(s.e.r=Pa(t["!ref"]).e.r,r=$n(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+e.SheetNames[n]+"'!"+r;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+r}),ft("autoFilter",null,{ref:r})}function NI(i,t,e,n){var r={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ft("sheetViews",ft("sheetView",null,r),{})}function PI(i,t,e,n){if(i.c&&e["!comments"].push([t,i.c]),i.v===void 0&&typeof i.f!="string"||i.t==="z"&&!i.f)return"";var r="",a=i.t,s=i.v;if(i.t!=="z")switch(i.t){case"b":r=i.v?"1":"0";break;case"n":r=""+i.v;break;case"e":r=fd[i.v];break;case"d":n&&n.cellDates?r=na(i.v,-1).toISOString():(i=ga(i),i.t="n",r=""+(i.v=ma(na(i.v)))),typeof i.z>"u"&&(i.z=En[14]);break;default:r=i.v;break}var o=Pr("v",Wi(r)),l={r:t},c=yl(n.cellXfs,i,n);switch(c!==0&&(l.s=c),i.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(i.v==null){delete i.t;break}if(i.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Pr("v",""+u2(n.Strings,i.v,n.revStrings)),l.t="s";break}l.t="str";break}if(i.t!=a&&(i.t=a,i.v=s),typeof i.f=="string"&&i.f){var u=i.F&&i.F.slice(0,t.length)==t?{t:"array",ref:i.F}:null;o=ft("f",Wi(i.f),u)+(i.v!=null?o:"")}return i.l&&e["!links"].push([t,i.l]),i.D&&(l.cm=1),ft("c",o,l)}function MI(i,t,e,n){var r=[],a=[],s=dn(i["!ref"]),o="",l,c="",u=[],h=0,g=0,d=i["!rows"],b=Array.isArray(i),_={r:c},w,E=-1;for(g=s.s.c;g<=s.e.c;++g)u[g]=Hr(g);for(h=s.s.r;h<=s.e.r;++h){for(a=[],c=Mr(h),g=s.s.c;g<=s.e.c;++g){l=u[g]+c;var A=b?(i[h]||[])[g]:i[l];A!==void 0&&(o=PI(A,l,i,t,e,n))!=null&&a.push(o)}(a.length>0||d&&d[h])&&(_={r:c},d&&d[h]&&(w=d[h],w.hidden&&(_.hidden=1),E=-1,w.hpx?E=_1(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(_.ht=E,_.customHeight=1),w.level&&(_.outlineLevel=w.level)),r[r.length]=ft("row",a.join(""),_))}if(d)for(;h<d.length;++h)d&&d[h]&&(_={r:h+1},w=d[h],w.hidden&&(_.hidden=1),E=-1,w.hpx?E=_1(w.hpx):w.hpt&&(E=w.hpt),E>-1&&(_.ht=E,_.customHeight=1),w.level&&(_.outlineLevel=w.level),r[r.length]=ft("row","",_));return r.join("")}function Yy(i,t,e,n){var r=[Xn,ft("worksheet",null,{xmlns:bc[0],"xmlns:r":gr.r})],a=e.SheetNames[i],s=0,o="",l=e.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",u=dn(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=$n(u)}n||(n={}),l["!comments"]=[];var h=[];CI(l,e,i,t,r),r[r.length]=ft("dimension",null,{ref:c}),r[r.length]=NI(l,t,i,e),t.sheetFormat&&(r[r.length]=ft("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(r[r.length]=FI(l,l["!cols"])),r[s=r.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=MI(l,t,i,e,n),o.length>0&&(r[r.length]=o)),r.length>s+1&&(r[r.length]="</sheetData>",r[s]=r[s].replace("/>",">")),l["!protect"]&&(r[r.length]=TI(l["!protect"])),l["!autofilter"]!=null&&(r[r.length]=DI(l["!autofilter"],l,e,i)),l["!merges"]!=null&&l["!merges"].length>0&&(r[r.length]=SI(l["!merges"]));var g=-1,d,b=-1;return l["!links"].length>0&&(r[r.length]="<hyperlinks>",l["!links"].forEach(function(_){_[1].Target&&(d={ref:_[0]},_[1].Target.charAt(0)!="#"&&(b=Hi(n,-1,Wi(_[1].Target).replace(/#.*$/,""),Ti.HLINK),d["r:id"]="rId"+b),(g=_[1].Target.indexOf("#"))>-1&&(d.location=Wi(_[1].Target.slice(g+1))),_[1].Tooltip&&(d.tooltip=Wi(_[1].Tooltip)),r[r.length]=ft("hyperlink",null,d))}),r[r.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(r[r.length]=AI(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=Pr("ignoredErrors",ft("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(b=Hi(n,-1,"../drawings/drawing"+(i+1)+".xml",Ti.DRAW),r[r.length]=ft("drawing",null,{"r:id":"rId"+b}),l["!drawing"]=h),l["!comments"].length>0&&(b=Hi(n,-1,"../drawings/vmlDrawing"+(i+1)+".vml",Ti.VML),r[r.length]=ft("legacyDrawing",null,{"r:id":"rId"+b}),l["!legacy"]=b),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function LI(i,t){var e={},n=i.l+t;e.r=i.read_shift(4),i.l+=4;var r=i.read_shift(2);i.l+=1;var a=i.read_shift(1);return i.l=n,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=r/20),e}function II(i,t,e){var n=He(145),r=(e["!rows"]||[])[i]||{};n.write_shift(4,i),n.write_shift(4,0);var a=320;r.hpx?a=_1(r.hpx)*20:r.hpt&&(a=r.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;r.level&&(s|=r.level),r.hidden&&(s|=16),(r.hpx||r.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:i,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,g=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var b=Array.isArray(e)?(e[c.r]||[])[c.c]:e[qi(c)];b&&(h<0&&(h=d),g=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,g))}var _=n.l;return n.l=l,n.write_shift(4,o),n.l=_,n.length>n.l?n.slice(0,n.l):n}function RI(i,t,e,n){var r=II(n,e,t);(r.length>17||(t["!rows"]||[])[n])&&Qe(i,0,r)}var OI=v0,BI=Sc;function jI(){}function VI(i,t){var e={},n=i[i.l];return++i.l,e.above=!(n&64),e.left=!(n&128),i.l+=18,e.name=KP(i,t-19),e}function UI(i,t,e){e==null&&(e=He(84+4*i.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),e.write_shift(1,n);for(var r=1;r<3;++r)e.write_shift(1,0);return m1({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),uy(i,e),e.slice(0,e.l)}function zI(i){var t=Ka(i);return[t]}function HI(i,t,e){return e==null&&(e=He(8)),m0(t,e)}function WI(i){var t=g0(i);return[t]}function qI(i,t,e){return e==null&&(e=He(4)),x0(t,e)}function GI(i){var t=Ka(i),e=i.read_shift(1);return[t,e,"b"]}function $I(i,t,e){return e==null&&(e=He(9)),m0(t,e),e.write_shift(1,i.v?1:0),e}function XI(i){var t=g0(i),e=i.read_shift(1);return[t,e,"b"]}function YI(i,t,e){return e==null&&(e=He(5)),x0(t,e),e.write_shift(1,i.v?1:0),e}function KI(i){var t=Ka(i),e=i.read_shift(1);return[t,e,"e"]}function ZI(i,t,e){return e==null&&(e=He(9)),m0(t,e),e.write_shift(1,i.v),e}function JI(i){var t=g0(i),e=i.read_shift(1);return[t,e,"e"]}function QI(i,t,e){return e==null&&(e=He(8)),x0(t,e),e.write_shift(1,i.v),e.write_shift(2,0),e.write_shift(1,0),e}function eR(i){var t=Ka(i),e=i.read_shift(4);return[t,e,"s"]}function tR(i,t,e){return e==null&&(e=He(12)),m0(t,e),e.write_shift(4,t.v),e}function iR(i){var t=g0(i),e=i.read_shift(4);return[t,e,"s"]}function nR(i,t,e){return e==null&&(e=He(8)),x0(t,e),e.write_shift(4,t.v),e}function rR(i){var t=Ka(i),e=Cc(i);return[t,e,"n"]}function aR(i,t,e){return e==null&&(e=He(16)),m0(t,e),f0(i.v,e),e}function sR(i){var t=g0(i),e=Cc(i);return[t,e,"n"]}function oR(i,t,e){return e==null&&(e=He(12)),x0(t,e),f0(i.v,e),e}function lR(i){var t=Ka(i),e=dy(i);return[t,e,"n"]}function cR(i,t,e){return e==null&&(e=He(12)),m0(t,e),fy(i.v,e),e}function uR(i){var t=g0(i),e=dy(i);return[t,e,"n"]}function dR(i,t,e){return e==null&&(e=He(8)),x0(t,e),fy(i.v,e),e}function fR(i){var t=Ka(i),e=i2(i);return[t,e,"is"]}function hR(i){var t=Ka(i),e=Wr(i);return[t,e,"str"]}function pR(i,t,e){return e==null&&(e=He(12+4*i.v.length)),m0(t,e),vr(i.v,e),e.length>e.l?e.slice(0,e.l):e}function mR(i){var t=g0(i),e=Wr(i);return[t,e,"str"]}function gR(i,t,e){return e==null&&(e=He(8+4*i.v.length)),x0(t,e),vr(i.v,e),e.length>e.l?e.slice(0,e.l):e}function xR(i,t,e){var n=i.l+t,r=Ka(i);r.r=e["!row"];var a=i.read_shift(1),s=[r,a,"b"];if(e.cellFormula){i.l+=2;var o=F1(i,n-i.l,e);s[3]=_c(o,null,r,e.supbooks,e)}else i.l=n;return s}function vR(i,t,e){var n=i.l+t,r=Ka(i);r.r=e["!row"];var a=i.read_shift(1),s=[r,a,"e"];if(e.cellFormula){i.l+=2;var o=F1(i,n-i.l,e);s[3]=_c(o,null,r,e.supbooks,e)}else i.l=n;return s}function _R(i,t,e){var n=i.l+t,r=Ka(i);r.r=e["!row"];var a=Cc(i),s=[r,a,"n"];if(e.cellFormula){i.l+=2;var o=F1(i,n-i.l,e);s[3]=_c(o,null,r,e.supbooks,e)}else i.l=n;return s}function bR(i,t,e){var n=i.l+t,r=Ka(i);r.r=e["!row"];var a=Wr(i),s=[r,a,"str"];if(e.cellFormula){i.l+=2;var o=F1(i,n-i.l,e);s[3]=_c(o,null,r,e.supbooks,e)}else i.l=n;return s}var wR=v0,yR=Sc;function SR(i,t){return t==null&&(t=He(4)),t.write_shift(4,i),t}function CR(i,t){var e=i.l+t,n=v0(i,16),r=n2(i),a=Wr(i),s=Wr(i),o=Wr(i);i.l=e;var l={rfx:n,relId:r,loc:a,display:o};return s&&(l.Tooltip=s),l}function ER(i,t){var e=He(50+4*(i[1].Target.length+(i[1].Tooltip||"").length));Sc({s:xr(i[0]),e:xr(i[0])},e),r2("rId"+t,e);var n=i[1].Target.indexOf("#"),r=n==-1?"":i[1].Target.slice(n+1);return vr(r||"",e),vr(i[1].Tooltip||"",e),vr("",e),e.slice(0,e.l)}function kR(){}function TR(i,t,e){var n=i.l+t,r=hy(i,16),a=i.read_shift(1),s=[r];if(s[2]=a,e.cellFormula){var o=mI(i,n-i.l,e);s[1]=o}else i.l=n;return s}function AR(i,t,e){var n=i.l+t,r=v0(i,16),a=[r];if(e.cellFormula){var s=xI(i,n-i.l,e);a[1]=s,i.l=n}else i.l=n;return a}function FR(i,t,e){e==null&&(e=He(18));var n=D1(i,t);e.write_shift(-4,i),e.write_shift(-4,i),e.write_shift(4,(n.width||10)*256),e.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof n.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),e.write_shift(2,r),e}var Ky=["left","right","top","bottom","header","footer"];function DR(i){var t={};return Ky.forEach(function(e){t[e]=Cc(i,8)}),t}function NR(i,t){return t==null&&(t=He(48)),Xy(i),Ky.forEach(function(e){f0(i[e],t)}),t}function PR(i){var t=i.read_shift(2);return i.l+=28,{RTL:t&32}}function MR(i,t,e){e==null&&(e=He(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function LR(i){var t=He(24);return t.write_shift(4,4),t.write_shift(4,1),Sc(i,t),t}function IR(i,t){return t==null&&(t=He(66)),t.write_shift(2,i.password?Ny(i.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,i[e[0]]!=null&&!i[e[0]]?1:0):t.write_shift(4,i[e[0]]!=null&&i[e[0]]?0:1)}),t}function RR(){}function OR(){}function BR(i,t,e,n,r,a,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ga(t),t.z=t.z||En[14],t.v=ma(na(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r:e,c:n};switch(l.s=yl(r.cellXfs,t,r),t.l&&a["!links"].push([qi(l),t.l]),t.c&&a["!comments"].push([qi(l),t.c]),t.t){case"s":case"str":return r.bookSST?(o=u2(r.Strings,t.v,r.revStrings),l.t="s",l.v=o,s?Qe(i,18,nR(t,l)):Qe(i,7,tR(t,l))):(l.t="str",s?Qe(i,17,gR(t,l)):Qe(i,6,pR(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Qe(i,13,dR(t,l)):Qe(i,2,cR(t,l)):s?Qe(i,16,oR(t,l)):Qe(i,5,aR(t,l)),!0;case"b":return l.t="b",s?Qe(i,15,YI(t,l)):Qe(i,4,$I(t,l)),!0;case"e":return l.t="e",s?Qe(i,14,QI(t,l)):Qe(i,3,ZI(t,l)),!0}return s?Qe(i,12,qI(t,l)):Qe(i,1,HI(t,l)),!0}function jR(i,t,e,n){var r=dn(t["!ref"]||"A1"),a,s="",o=[];Qe(i,145);var l=Array.isArray(t),c=r.e.r;t["!rows"]&&(c=Math.max(r.e.r,t["!rows"].length-1));for(var u=r.s.r;u<=c;++u){s=Mr(u),RI(i,t,r,u);var h=!1;if(u<=r.e.r)for(var g=r.s.c;g<=r.e.c;++g){u===r.s.r&&(o[g]=Hr(g)),a=o[g]+s;var d=l?(t[u]||[])[g]:t[a];if(!d){h=!1;continue}h=BR(i,d,u,g,n,t,h)}}Qe(i,146)}function VR(i,t){!t||!t["!merges"]||(Qe(i,177,SR(t["!merges"].length)),t["!merges"].forEach(function(e){Qe(i,176,yR(e))}),Qe(i,178))}function UR(i,t){!t||!t["!cols"]||(Qe(i,390),t["!cols"].forEach(function(e,n){e&&Qe(i,60,FR(n,e))}),Qe(i,391))}function zR(i,t){!t||!t["!ref"]||(Qe(i,648),Qe(i,649,LR(dn(t["!ref"]))),Qe(i,650))}function HR(i,t,e){t["!links"].forEach(function(n){if(n[1].Target){var r=Hi(e,-1,n[1].Target.replace(/#.*$/,""),Ti.HLINK);Qe(i,494,ER(n,r))}}),delete t["!links"]}function WR(i,t,e,n){if(t["!comments"].length>0){var r=Hi(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ti.VML);Qe(i,551,r2("rId"+r)),t["!legacy"]=r}}function qR(i,t,e,n){if(t["!autofilter"]){var r=t["!autofilter"],a=typeof r.ref=="string"?r.ref:$n(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var s=e.Workbook.Names,o=Pa(a);o.s.r==o.e.r&&(o.e.r=Pa(t["!ref"]).e.r,a=$n(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+e.SheetNames[n]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+a}),Qe(i,161,Sc(dn(a))),Qe(i,162)}}function GR(i,t,e){Qe(i,133),Qe(i,137,MR(t,e)),Qe(i,138),Qe(i,134)}function $R(i,t){t["!protect"]&&Qe(i,535,IR(t["!protect"]))}function XR(i,t,e,n){var r=pa(),a=e.SheetNames[i],s=e.Sheets[a]||{},o=a;try{e&&e.Workbook&&(o=e.Workbook.Sheets[i].CodeName||o)}catch{}var l=dn(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Qe(r,129),(e.vbaraw||s["!outline"])&&Qe(r,147,UI(o,s["!outline"])),Qe(r,148,BI(l)),GR(r,s,e.Workbook),UR(r,s,i,t,e),jR(r,s,i,t,e),$R(r,s),qR(r,s,e,i),VR(r,s),HR(r,s,n),s["!margins"]&&Qe(r,476,NR(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&zR(r,s),WR(r,s,i,n),Qe(r,130),r.end()}function YR(i,t){i.l+=10;var e=Wr(i,t-10);return{name:e}}var KR=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function ZR(i){return!i.Workbook||!i.Workbook.WBProps?"false":TP(i.Workbook.WBProps.date1904)?"true":"false"}var JR="][*?/\\".split("");function Zy(i,t){if(i.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var e=!0;return JR.forEach(function(n){if(i.indexOf(n)!=-1){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");e=!1}}),e}function QR(i,t,e){i.forEach(function(n,r){Zy(n);for(var a=0;a<r;++a)if(n==i[a])throw new Error("Duplicate Sheet Name: "+n);if(e){var s=t&&t[r]&&t[r].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function eO(i){if(!i||!i.SheetNames||!i.Sheets)throw new Error("Invalid Workbook");if(!i.SheetNames.length)throw new Error("Workbook is empty");var t=i.Workbook&&i.Workbook.Sheets||[];QR(i.SheetNames,t,!!i.vbaraw);for(var e=0;e<i.SheetNames.length;++e)yI(i.Sheets[i.SheetNames[e]],i.SheetNames[e],e)}function Jy(i){var t=[Xn];t[t.length]=ft("workbook",null,{xmlns:bc[0],"xmlns:r":gr.r});var e=i.Workbook&&(i.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};i.Workbook&&i.Workbook.WBProps&&(KR.forEach(function(o){i.Workbook.WBProps[o[0]]!=null&&i.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=i.Workbook.WBProps[o[0]])}),i.Workbook.WBProps.CodeName&&(n.codeName=i.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ft("workbookPr",null,n);var r=i.Workbook&&i.Workbook.Sheets||[],a=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=i.SheetNames.length&&!(!r[a]||!r[a].Hidden);++a);a==i.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=i.SheetNames.length;++a){var s={name:Wi(i.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=ft("sheet",null,s)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",i.Workbook&&i.Workbook.Names&&i.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=ft("definedName",Wi(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function tO(i,t){var e={};return e.Hidden=i.read_shift(4),e.iTabID=i.read_shift(4),e.strRelID=Vg(i,t-8),e.name=Wr(i),e}function iO(i,t){return t||(t=He(127)),t.write_shift(4,i.Hidden),t.write_shift(4,i.iTabID),r2(i.strRelID,t),vr(i.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function nO(i,t){var e={},n=i.read_shift(4);e.defaultThemeVersion=i.read_shift(4);var r=t>8?Wr(i):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function rO(i,t){t||(t=He(72));var e=0;return i&&i.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),uy(i&&i.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function aO(i,t,e){var n=i.l+t;i.l+=4,i.l+=1;var r=i.read_shift(4),a=ZP(i),s=gI(i,0,e),o=n2(i);i.l=n;var l={Name:a,Ptg:s};return r<268435455&&(l.Sheet=r),o&&(l.Comment=o),l}function sO(i,t){Qe(i,143);for(var e=0;e!=t.SheetNames.length;++e){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,r={Hidden:n,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};Qe(i,156,iO(r))}Qe(i,144)}function oO(i,t){t||(t=He(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return vr("SheetJS",t),vr(nd.version,t),vr(nd.version,t),vr("7262",t),t.length>t.l?t.slice(0,t.l):t}function lO(i,t){t||(t=He(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,i),t.write_shift(4,i);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function cO(i,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,n=0,r=-1,a=-1;n<e.length;++n)!e[n]||!e[n].Hidden&&r==-1?r=n:e[n].Hidden==1&&a==-1&&(a=n);a>r||(Qe(i,135),Qe(i,158,lO(r)),Qe(i,136))}}function uO(i,t){var e=pa();return Qe(e,131),Qe(e,128,oO()),Qe(e,153,rO(i.Workbook&&i.Workbook.WBProps||null)),cO(e,i,t),sO(e,i,t),Qe(e,132),e.end()}function dO(i,t,e){return(t.slice(-4)===".bin"?uO:Jy)(i,e)}function fO(i,t,e,n,r){return(t.slice(-4)===".bin"?XR:Yy)(i,e,n,r)}function hO(i,t,e){return(t.slice(-4)===".bin"?NL:Ly)(i,e)}function pO(i,t,e){return(t.slice(-4)===".bin"?rL:Dy)(i,e)}function mO(i,t,e){return(t.slice(-4)===".bin"?$L:jy)(i,e)}function gO(i){return(i.slice(-4)===".bin"?jL:Oy)()}function xO(i,t){var e=[];return i.Props&&e.push(hM(i.Props,t)),i.Custprops&&e.push(pM(i.Props,i.Custprops,t)),e.join("")}function vO(){return""}function _O(i,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,r){var a=[];a.push(ft("NumberFormat",null,{"ss:Format":Wi(En[n.numFmtId])}));var s={"ss:ID":"s"+(21+r)};e.push(ft("Style",a.join(""),s))}),ft("Styles",e.join(""))}function Qy(i){return ft("NamedRange",null,{"ss:Name":i.Name,"ss:RefersTo":"="+l2(i.Ref,{r:0,c:0})})}function bO(i){if(!((i||{}).Workbook||{}).Names)return"";for(var t=i.Workbook.Names,e=[],n=0;n<t.length;++n){var r=t[n];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push(Qy(r)))}return ft("Names",e.join(""))}function wO(i,t,e,n){if(!i||!((n||{}).Workbook||{}).Names)return"";for(var r=n.Workbook.Names,a=[],s=0;s<r.length;++s){var o=r[s];o.Sheet==e&&(o.Name.match(/^_xlfn\./)||a.push(Qy(o)))}return a.join("")}function yO(i,t,e,n){if(!i)return"";var r=[];if(i["!margins"]&&(r.push("<PageSetup>"),i["!margins"].header&&r.push(ft("Header",null,{"x:Margin":i["!margins"].header})),i["!margins"].footer&&r.push(ft("Footer",null,{"x:Margin":i["!margins"].footer})),r.push(ft("PageMargins",null,{"x:Bottom":i["!margins"].bottom||"0.75","x:Left":i["!margins"].left||"0.7","x:Right":i["!margins"].right||"0.7","x:Top":i["!margins"].top||"0.75"})),r.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)r.push(ft("Visible",n.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<e&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==e&&r.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),i["!protect"]&&(r.push(Pr("ProtectContents","True")),i["!protect"].objects&&r.push(Pr("ProtectObjects","True")),i["!protect"].scenarios&&r.push(Pr("ProtectScenarios","True")),i["!protect"].selectLockedCells!=null&&!i["!protect"].selectLockedCells?r.push(Pr("EnableSelection","NoSelection")):i["!protect"].selectUnlockedCells!=null&&!i["!protect"].selectUnlockedCells&&r.push(Pr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){i["!protect"][s[0]]&&r.push("<"+s[1]+"/>")})),r.length==0?"":ft("WorksheetOptions",r.join(""),{xmlns:Na.x})}function SO(i){return i.map(function(t){var e=kP(t.t||""),n=ft("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ft("Comment",n,{"ss:Author":t.a})}).join("")}function CO(i,t,e,n,r,a,s){if(!i||i.v==null&&i.f==null)return"";var o={};if(i.f&&(o["ss:Formula"]="="+Wi(l2(i.f,s))),i.F&&i.F.slice(0,t.length)==t){var l=xr(i.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(i.l&&i.l.Target&&(o["ss:HRef"]=Wi(i.l.Target),i.l.Tooltip&&(o["x:HRefScreenTip"]=Wi(i.l.Tooltip))),e["!merges"])for(var c=e["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",g="";switch(i.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",g=String(i.v);break;case"b":h="Boolean",g=i.v?"1":"0";break;case"e":h="Error",g=fd[i.v];break;case"d":h="DateTime",g=new Date(i.v).toISOString(),i.z==null&&(i.z=i.z||En[14]);break;case"s":h="String",g=EP(i.v||"");break}var d=yl(n.cellXfs,i,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var b=i.v!=null?g:"",_=i.t=="z"?"":'<Data ss:Type="'+h+'">'+b+"</Data>";return(i.c||[]).length>0&&(_+=SO(i.c)),ft("Cell",_,o)}function EO(i,t){var e='<Row ss:Index="'+(i+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=My(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function kO(i,t,e,n){if(!i["!ref"])return"";var r=dn(i["!ref"]),a=i["!merges"]||[],s=0,o=[];i["!cols"]&&i["!cols"].forEach(function(w,E){s2(w);var A=!!w.width,D=D1(E,w),N={"ss:Index":E+1};A&&(N["ss:Width"]=x1(D.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(ft("Column",null,N))});for(var l=Array.isArray(i),c=r.s.r;c<=r.e.r;++c){for(var u=[EO(c,(i["!rows"]||[])[c])],h=r.s.c;h<=r.e.c;++h){var g=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h)&&!(a[s].s.r>c)&&!(a[s].e.c<h)&&!(a[s].e.r<c)){(a[s].s.c!=h||a[s].s.r!=c)&&(g=!0);break}if(!g){var d={r:c,c:h},b=qi(d),_=l?(i[c]||[])[h]:i[b];u.push(CO(_,b,i,t,e,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function TO(i,t,e){var n=[],r=e.SheetNames[i],a=e.Sheets[r],s=a?wO(a,t,i,e):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?kO(a,t,i,e):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(yO(a,t,i,e)),n.join("")}function AO(i,t){t||(t={}),i.SSF||(i.SSF=ga(En)),i.SSF&&(C1(),S1(i.SSF),t.revssf=E1(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF,t.cellXfs=[],yl(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(xO(i,t)),e.push(vO(i,t)),e.push(""),e.push("");for(var n=0;n<i.SheetNames.length;++n)e.push(ft("Worksheet",TO(n,t,i),{"ss:Name":Wi(i.SheetNames[n])}));return e[2]=_O(i,t),e[3]=bO(i,t),Xn+ft("Workbook",e.join(""),{xmlns:Na.ss,"xmlns:o":Na.o,"xmlns:x":Na.x,"xmlns:ss":Na.ss,"xmlns:dt":Na.dt,"xmlns:html":Na.html})}var Ig={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function FO(i,t){var e=[],n=[],r=[],a=0,s,o=aw(vw,"n"),l=aw(_w,"n");if(i.Props)for(s=Lr(i.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?e:Object.prototype.hasOwnProperty.call(l,s[a])?n:r).push([s[a],i.Props[s[a]]]);if(i.Custprops)for(s=Lr(i.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(i.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?e:Object.prototype.hasOwnProperty.call(l,s[a])?n:r).push([s[a],i.Custprops[s[a]]]);var c=[];for(a=0;a<r.length;++a)Sy.indexOf(r[a][0])>-1||by.indexOf(r[a][0])>-1||r[a][1]!=null&&c.push(r[a]);n.length&&$i.utils.cfb_add(t,"/SummaryInformation",Cw(n,Ig.SI,l,_w)),(e.length||c.length)&&$i.utils.cfb_add(t,"/DocumentSummaryInformation",Cw(e,Ig.DSI,o,vw,c.length?c:null,Ig.UDI))}function DO(i,t){var e=t||{},n=$i.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return $i.utils.cfb_add(n,r,e4(i,e)),e.biff==8&&(i.Props||i.Custprops)&&FO(i,n),e.biff==8&&i.vbaraw&&XL(n,$i.read(i.vbaraw,{type:typeof i.vbaraw=="string"?"binary":"buffer"})),n}var NO={0:{f:LI},1:{f:zI},2:{f:lR},3:{f:KI},4:{f:GI},5:{f:rR},6:{f:hR},7:{f:eR},8:{f:bR},9:{f:_R},10:{f:xR},11:{f:vR},12:{f:WI},13:{f:uR},14:{f:JI},15:{f:XI},16:{f:sR},17:{f:mR},18:{f:iR},19:{f:i2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:aO},40:{},42:{},43:{f:hL},44:{f:dL},45:{f:gL},46:{f:vL},47:{f:xL},48:{},49:{f:WP},50:{},51:{f:LL},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qM},62:{f:fR},63:{f:VL},64:{f:RR},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:PR},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:VI},148:{f:OI,p:16},151:{f:kR},152:{},153:{f:nO},154:{},155:{},156:{f:tO},157:{},158:{},159:{T:1,f:tL},160:{T:-1},161:{T:1,f:v0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wR},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:PL},336:{T:-1},337:{f:OL,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jM},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:TR},427:{f:AR},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DR},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:CR},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qL},633:{T:1},634:{T:-1},635:{T:1,f:HL},636:{T:-1},637:{f:XP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:YR},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OR},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function pt(i,t,e,n){var r=t;if(!isNaN(r)){var a=n||(e||[]).length||0,s=i.next(4);s.write_shift(2,r),s.write_shift(2,a),a>0&&Qg(e)&&i.push(e)}}function PO(i,t,e,n){var r=n||(e||[]).length||0;if(r<=8224)return pt(i,t,e,r);var a=t;if(!isNaN(a)){for(var s=e.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=i.next(4);for(u.write_shift(2,a),u.write_shift(2,c),i.push(e.slice(l,l+c)),l+=c;l<r;){for(u=i.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),i.push(e.slice(l,l+c)),l+=c}}}function pd(i,t,e){return i||(i=He(7)),i.write_shift(2,t),i.write_shift(2,e),i.write_shift(2,0),i.write_shift(1,0),i}function MO(i,t,e,n){var r=He(9);return pd(r,i,t),Ey(e,n||"b",r),r}function LO(i,t,e){var n=He(8+2*e.length);return pd(n,i,t),n.write_shift(1,e.length),n.write_shift(e.length,e,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function IO(i,t,e,n){if(t.v!=null)switch(t.t){case"d":case"n":var r=t.t=="d"?ma(na(t.v)):t.v;r==(r|0)&&r>=0&&r<65536?pt(i,2,YM(e,n,r)):pt(i,3,XM(e,n,r));return;case"b":case"e":pt(i,5,MO(e,n,t.v,t.t));return;case"s":case"str":pt(i,4,LO(e,n,(t.v||"").slice(0,255)));return}pt(i,1,pd(null,e,n))}function RO(i,t,e,n){var r=Array.isArray(t),a=dn(t["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=$n(a)}for(var c=a.s.r;c<=a.e.r;++c){o=Mr(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=Hr(u)),s=l[u]+o;var h=r?(t[c]||[])[u]:t[s];h&&IO(i,h,c,u,n)}}}function OO(i,t){var e=t||{};zs!=null&&e.dense==null&&(e.dense=zs);for(var n=pa(),r=0,a=0;a<i.SheetNames.length;++a)i.SheetNames[a]==e.sheet&&(r=a);if(r==0&&e.sheet&&i.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return pt(n,e.biff==4?1033:e.biff==3?521:9,a2(i,16,e)),RO(n,i.Sheets[i.SheetNames[r]],r,e,i),pt(n,10),n.end()}function BO(i,t,e){pt(i,49,NM({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function jO(i,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&pt(i,1054,LM(r,t[r],e))})}function VO(i,t){var e=He(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),pt(i,2151,e),e=He(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Ay(dn(t["!ref"]||"A1"),e),e.write_shift(4,4),pt(i,2152,e)}function UO(i,t){for(var e=0;e<16;++e)pt(i,224,kw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){pt(i,224,kw(n,0,t))})}function zO(i,t){for(var e=0;e<t["!links"].length;++e){var n=t["!links"][e];pt(i,440,zM(n)),n[1].Tooltip&&pt(i,2048,HM(n))}delete t["!links"]}function HO(i,t){if(t){var e=0;t.forEach(function(n,r){++e<=256&&n&&pt(i,125,GM(D1(r,n),r))})}}function WO(i,t,e,n,r){var a=16+yl(r.cellXfs,t,r);if(t.v==null&&!t.bf){pt(i,513,h0(e,n,a));return}if(t.bf)pt(i,6,pI(t,e,n,r,a));else switch(t.t){case"d":case"n":var s=t.t=="d"?ma(na(t.v)):t.v;pt(i,515,BM(e,n,s,a,r));break;case"b":case"e":pt(i,517,OM(e,n,t.v,a,r,t.t));break;case"s":case"str":if(r.bookSST){var o=u2(r.Strings,t.v,r.revStrings);pt(i,253,PM(e,n,o,a,r))}else pt(i,516,MM(e,n,(t.v||"").slice(0,255),a,r));break;default:pt(i,513,h0(e,n,a))}}function qO(i,t,e){var n=pa(),r=e.SheetNames[i],a=e.Sheets[r]||{},s=(e||{}).Workbook||{},o=(s.Sheets||[])[i]||{},l=Array.isArray(a),c=t.biff==8,u,h="",g=[],d=dn(a["!ref"]||"A1"),b=c?65536:16384;if(d.e.c>255||d.e.r>=b){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,b-1)}pt(n,2057,a2(e,16,t)),pt(n,13,Ya(1)),pt(n,12,Ya(100)),pt(n,15,ia(!0)),pt(n,17,ia(!1)),pt(n,16,f0(.001)),pt(n,95,ia(!0)),pt(n,42,ia(!1)),pt(n,43,ia(!1)),pt(n,130,Ya(1)),pt(n,128,RM([0,0])),pt(n,131,ia(!1)),pt(n,132,ia(!1)),c&&HO(n,a["!cols"]),pt(n,512,IM(d,t)),c&&(a["!links"]=[]);for(var _=d.s.r;_<=d.e.r;++_){h=Mr(_);for(var w=d.s.c;w<=d.e.c;++w){_===d.s.r&&(g[w]=Hr(w)),u=g[w]+h;var E=l?(a[_]||[])[w]:a[u];E&&(WO(n,E,_,w,t),c&&E.l&&a["!links"].push([u,E.l]))}}var A=o.CodeName||o.name||r;return c&&pt(n,574,DM((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&pt(n,229,UM(a["!merges"])),c&&zO(n,a),pt(n,442,Ty(A,t)),c&&VO(n,a),pt(n,10),n.end()}function GO(i,t,e){var n=pa(),r=(i||{}).Workbook||{},a=r.Sheets||[],s=r.WBProps||{},o=e.biff==8,l=e.biff==5;if(pt(n,2057,a2(i,5,e)),e.bookType=="xla"&&pt(n,135),pt(n,225,o?Ya(1200):null),pt(n,193,xM(2)),l&&pt(n,191),l&&pt(n,192),pt(n,226),pt(n,92,kM("SheetJS",e)),pt(n,66,Ya(o?1200:1252)),o&&pt(n,353,Ya(0)),o&&pt(n,448),pt(n,317,$M(i.SheetNames.length)),o&&i.vbaraw&&pt(n,211),o&&i.vbaraw){var c=s.CodeName||"ThisWorkbook";pt(n,442,Ty(c,e))}pt(n,156,Ya(17)),pt(n,25,ia(!1)),pt(n,18,ia(!1)),pt(n,19,Ya(0)),o&&pt(n,431,ia(!1)),o&&pt(n,444,Ya(0)),pt(n,61,FM(e)),pt(n,64,ia(!1)),pt(n,141,Ya(0)),pt(n,34,ia(ZR(i)=="true")),pt(n,14,ia(!0)),o&&pt(n,439,ia(!1)),pt(n,218,Ya(0)),BO(n,i,e),jO(n,i.SSF,e),UO(n,e),o&&pt(n,352,ia(!1));var u=n.end(),h=pa();o&&pt(h,140,WM()),o&&e.Strings&&PO(h,252,AM(e.Strings,e)),pt(h,10);var g=h.end(),d=pa(),b=0,_=0;for(_=0;_<i.SheetNames.length;++_)b+=(o?12:11)+(o?2:1)*i.SheetNames[_].length;var w=u.length+b+g.length;for(_=0;_<i.SheetNames.length;++_){var E=a[_]||{};pt(d,133,TM({pos:w,hs:E.Hidden||0,dt:0,name:i.SheetNames[_]},e)),w+=t[_].length}var A=d.end();if(b!=A.length)throw new Error("BS8 "+b+" != "+A.length);var D=[];return u.length&&D.push(u),A.length&&D.push(A),g.length&&D.push(g),Nr(D)}function $O(i,t){var e=t||{},n=[];i&&!i.SSF&&(i.SSF=ga(En)),i&&i.SSF&&(C1(),S1(i.SSF),e.revssf=E1(i.SSF),e.revssf[i.SSF[65535]]=0,e.ssf=i.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,d2(e),e.cellXfs=[],yl(e.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={});for(var r=0;r<i.SheetNames.length;++r)n[n.length]=qO(r,e,i);return n.unshift(GO(i,n,e)),Nr(n)}function e4(i,t){for(var e=0;e<=i.SheetNames.length;++e){var n=i.Sheets[i.SheetNames[e]];if(!(!n||!n["!ref"])){var r=Pa(n["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+i.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return $O(i,t);case 4:case 3:case 2:return OO(i,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function XO(i,t,e,n){for(var r=i["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<r.length;++c)if(!(r[c].s.r>e||r[c].s.c>s)&&!(r[c].e.r<e||r[c].e.c<s)){if(r[c].s.r<e||r[c].s.c<s){o=-1;break}o=r[c].e.r-r[c].s.r+1,l=r[c].e.c-r[c].s.c+1;break}if(!(o<0)){var u=qi({r:e,c:s}),h=n.dense?(i[e]||[])[s]:i[u],g=h&&h.v!=null&&(h.h||CP(h.w||(To(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?g='<span contenteditable="true">'+g+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+h.l.Target+'">'+g+"</a>")),d.id=(n.id||"sjs")+"-"+u,a.push(ft("td",g,d))}}var b="<tr>";return b+a.join("")+"</tr>"}var YO='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',KO="</body></html>";function ZO(i,t,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function t4(i,t){var e=t||{},n=e.header!=null?e.header:YO,r=e.footer!=null?e.footer:KO,a=[n],s=Pa(i["!ref"]);e.dense=Array.isArray(i),a.push(ZO(i,s,e));for(var o=s.s.r;o<=s.e.r;++o)a.push(XO(i,s,o,e));return a.push("</table>"+r),a.join("")}function i4(i,t,e){var n=e||{};zs!=null&&(n.dense=zs);var r=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")r=n.origin;else{var s=typeof n.origin=="string"?xr(n.origin):n.origin;r=s.r,a=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r,c:a}};if(i["!ref"]){var u=Pa(i["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),r==-1&&(c.e.r=r=u.e.r+1)}var h=[],g=0,d=i["!rows"]||(i["!rows"]=[]),b=0,_=0,w=0,E=0,A=0,D=0;for(i["!cols"]||(i["!cols"]=[]);b<o.length&&_<l;++b){var N=o[b];if(Mw(N)){if(n.display)continue;d[_]={hidden:!0}}var z=N.children;for(w=E=0;w<z.length;++w){var J=z[w];if(!(n.display&&Mw(J))){var W=J.hasAttribute("data-v")?J.getAttribute("data-v"):J.hasAttribute("v")?J.getAttribute("v"):AP(J.innerHTML),U=J.getAttribute("data-z")||J.getAttribute("z");for(g=0;g<h.length;++g){var M=h[g];M.s.c==E+a&&M.s.r<_+r&&_+r<=M.e.r&&(E=M.e.c+1-a,g=-1)}D=+J.getAttribute("colspan")||1,((A=+J.getAttribute("rowspan")||1)>1||D>1)&&h.push({s:{r:_+r,c:E+a},e:{r:_+r+(A||1)-1,c:E+a+(D||1)-1}});var X={t:"s",v:W},F=J.getAttribute("data-t")||J.getAttribute("t")||"";W!=null&&(W.length==0?X.t=F||"z":n.raw||W.trim().length==0||F=="s"||(W==="TRUE"?X={t:"b",v:!0}:W==="FALSE"?X={t:"b",v:!1}:isNaN(Co(W))?isNaN(sd(W).getDate())||(X={t:"d",v:na(W)},n.cellDates||(X={t:"n",v:ma(X.v)}),X.z=n.dateNF||En[14]):X={t:"n",v:Co(W)})),X.z===void 0&&U!=null&&(X.z=U);var I="",ee=J.getElementsByTagName("A");if(ee&&ee.length)for(var le=0;le<ee.length&&!(ee[le].hasAttribute("href")&&(I=ee[le].getAttribute("href"),I.charAt(0)!="#"));++le);I&&I.charAt(0)!="#"&&(X.l={Target:I}),n.dense?(i[_+r]||(i[_+r]=[]),i[_+r][E+a]=X):i[qi({c:E+a,r:_+r})]=X,c.e.c<E+a&&(c.e.c=E+a),E+=D}}++_}return h.length&&(i["!merges"]=(i["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,_-1+r),i["!ref"]=$n(c),_>=l&&(i["!fullref"]=$n((c.e.r=o.length-b+_-1+r,c))),i}function n4(i,t){var e=t||{},n=e.dense?[]:{};return i4(n,i,t)}function JO(i,t){return p0(n4(i,t),t)}function Mw(i){var t="",e=QO(i);return e&&(t=e(i).getPropertyValue("display")),t||(t=i.style&&i.style.display),t==="none"}function QO(i){return i.ownerDocument.defaultView&&typeof i.ownerDocument.defaultView.getComputedStyle=="function"?i.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var eB=(function(){var i=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+od({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+i+"</office:document-styles>";return function(){return Xn+t}})(),Lw=(function(){var i=function(a){return Wi(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,n=function(a,s,o){var l=[];l.push('      <table:table table:name="'+Wi(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=Pa(a["!ref"]||"A1"),g=a["!merges"]||[],d=0,b=Array.isArray(a);if(a["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var _="",w=a["!rows"]||[];for(c=0;c<h.s.r;++c)_=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+_+`></table:table-row>
`);for(;c<=h.e.r;++c){for(_=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+_+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var E=!1,A={},D="";for(d=0;d!=g.length;++d)if(!(g[d].s.c>u)&&!(g[d].s.r>c)&&!(g[d].e.c<u)&&!(g[d].e.r<c)){(g[d].s.c!=u||g[d].s.r!=c)&&(E=!0),A["table:number-columns-spanned"]=g[d].e.c-g[d].s.c+1,A["table:number-rows-spanned"]=g[d].e.r-g[d].s.r+1;break}if(E){l.push(e);continue}var N=qi({r:c,c:u}),z=b?(a[c]||[])[u]:a[N];if(z&&z.f&&(A["table:formula"]=Wi(bI(z.f)),z.F&&z.F.slice(0,N.length)==N)){var J=Pa(z.F);A["table:number-matrix-columns-spanned"]=J.e.c-J.s.c+1,A["table:number-matrix-rows-spanned"]=J.e.r-J.s.r+1}if(!z){l.push(t);continue}switch(z.t){case"b":D=z.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=z.v?"true":"false";break;case"n":D=z.w||String(z.v||0),A["office:value-type"]="float",A["office:value"]=z.v||0;break;case"s":case"str":D=z.v==null?"":z.v,A["office:value-type"]="string";break;case"d":D=z.w||na(z.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=na(z.v).toISOString(),A["table:style-name"]="ce1";break;default:l.push(t);continue}var W=i(D);if(z.l&&z.l.Target){var U=z.l.Target;U=U.charAt(0)=="#"?"#"+wI(U.slice(1)):U,U.charAt(0)!="#"&&!U.match(/^\w+:/)&&(U="../"+U),W=ft("text:a",W,{"xlink:href":U.replace(/&/g,"&amp;")})}l.push("          "+ft("table:table-cell",ft("text:p",W,{}),A)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},r=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;s2(h),h.ods=o;var g=c["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Xn],c=od({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=od({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(vy().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),r(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h,o));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function r4(i,t){if(t.bookType=="fods")return Lw(i,t);var e=qg(),n="",r=[],a=[];return n="mimetype",li(e,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",li(e,n,Lw(i,t)),r.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",li(e,n,eB(i,t)),r.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",li(e,n,Xn+vy()),r.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",li(e,n,fM(a)),r.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",li(e,n,uM(r)),e}function b1(i){return new DataView(i.buffer,i.byteOffset,i.byteLength)}function tB(i){return typeof TextEncoder<"u"?new TextEncoder().encode(i):gs(yo(i))}function iB(i,t){e:for(var e=0;e<=i.length-t.length;++e){for(var n=0;n<t.length;++n)if(i[e+n]!=t[n])continue e;return!0}return!1}function wl(i){var t=i.reduce(function(r,a){return r+a.length},0),e=new Uint8Array(t),n=0;return i.forEach(function(r){e.set(r,n),n+=r.length}),e}function nB(i,t,e){var n=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,r=e/Math.pow(10,n-6176);i[t+15]|=n>>7,i[t+14]|=(n&127)<<1;for(var a=0;r>=1;++a,r/=256)i[t+a]=r&255;i[t+15]|=e>=0?0:128}function ld(i,t){var e=t?t[0]:0,n=i[e]&127;e:if(i[e++]>=128&&(n|=(i[e]&127)<<7,i[e++]<128||(n|=(i[e]&127)<<14,i[e++]<128)||(n|=(i[e]&127)<<21,i[e++]<128)||(n+=(i[e]&127)*Math.pow(2,28),++e,i[e++]<128)||(n+=(i[e]&127)*Math.pow(2,35),++e,i[e++]<128)||(n+=(i[e]&127)*Math.pow(2,42),++e,i[e++]<128)))break e;return t&&(t[0]=e),n}function zi(i){var t=new Uint8Array(7);t[0]=i&127;var e=1;e:if(i>127){if(t[e-1]|=128,t[e]=i>>7&127,++e,i<=16383||(t[e-1]|=128,t[e]=i>>14&127,++e,i<=2097151)||(t[e-1]|=128,t[e]=i>>21&127,++e,i<=268435455)||(t[e-1]|=128,t[e]=i/256>>>21&127,++e,i<=34359738367)||(t[e-1]|=128,t[e]=i/65536>>>21&127,++e,i<=4398046511103))break e;t[e-1]|=128,t[e]=i/16777216>>>21&127,++e}return t.slice(0,e)}function xc(i){var t=0,e=i[t]&127;e:if(i[t++]>=128){if(e|=(i[t]&127)<<7,i[t++]<128||(e|=(i[t]&127)<<14,i[t++]<128)||(e|=(i[t]&127)<<21,i[t++]<128))break e;e|=(i[t]&127)<<28}return e}function ar(i){for(var t=[],e=[0];e[0]<i.length;){var n=e[0],r=ld(i,e),a=r&7;r=Math.floor(r/8);var s=0,o;if(r==0)break;switch(a){case 0:{for(var l=e[0];i[e[0]++]>=128;);o=i.slice(l,e[0])}break;case 5:s=4,o=i.slice(e[0],e[0]+s),e[0]+=s;break;case 1:s=8,o=i.slice(e[0],e[0]+s),e[0]+=s;break;case 2:s=ld(i,e),o=i.slice(e[0],e[0]+s),e[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(n))}var c={data:o,type:a};t[r]==null?t[r]=[c]:t[r].push(c)}return t}function Fr(i){var t=[];return i.forEach(function(e,n){e.forEach(function(r){r.data&&(t.push(zi(n*8+r.type)),r.type==2&&t.push(zi(r.data.length)),t.push(r.data))})}),wl(t)}function ps(i){for(var t,e=[],n=[0];n[0]<i.length;){var r=ld(i,n),a=ar(i.slice(n[0],n[0]+r));n[0]+=r;var s={id:xc(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=ar(o.data),c=xc(l[3][0].data);s.messages.push({meta:l,data:i.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(s.merge=xc(a[3][0].data)>>>0>0),e.push(s)}return e}function cc(i){var t=[];return i.forEach(function(e){var n=[];n[1]=[{data:zi(e.id),type:0}],n[2]=[],e.merge!=null&&(n[3]=[{data:zi(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(s){r.push(s.data),s.meta[3]=[{type:0,data:zi(s.data.length)}],n[2].push({data:Fr(s.meta),type:2})});var a=Fr(n);t.push(zi(a.length)),t.push(a),r.forEach(function(s){return t.push(s)})}),wl(t)}function rB(i,t){if(i!=0)throw new Error("Unexpected Snappy chunk type ".concat(i));for(var e=[0],n=ld(t,e),r=[];e[0]<t.length;){var a=t[e[0]]&3;if(a==0){var s=t[e[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[e[0]],o>1&&(s|=t[e[0]+1]<<8),o>2&&(s|=t[e[0]+2]<<16),o>3&&(s|=t[e[0]+3]<<24),s>>>=0,s++,e[0]+=o}r.push(t.slice(e[0],e[0]+s)),e[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(t[e[0]]>>2&7)+4,l=(t[e[0]++]&224)<<3,l|=t[e[0]++]):(c=(t[e[0]++]>>2)+1,a==2?(l=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(l=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),r=[wl(r)],l==0)throw new Error("Invalid offset 0");if(l>r[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(r.push(r[0].slice(-l)),c-=l;c>=r[r.length-1].length;)r.push(r[r.length-1]),c-=r[r.length-1].length;r.push(r[0].slice(-l,-l+c))}}var u=wl(r);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function ms(i){for(var t=[],e=0;e<i.length;){var n=i[e++],r=i[e]|i[e+1]<<8|i[e+2]<<16;e+=3,t.push(rB(n,i.slice(e,e+r))),e+=r}if(e!==i.length)throw new Error("data is not a valid framed stream!");return wl(t)}function uc(i){for(var t=[],e=0;e<i.length;){var n=Math.min(i.length-e,268435455),r=new Uint8Array(4);t.push(r);var a=zi(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(i.slice(e,e+n)),s+=n,r[0]=0,r[1]=s&255,r[2]=s>>8&255,r[3]=s>>16&255,e+=n}return wl(t)}function Rg(i,t){var e=new Uint8Array(32),n=b1(e),r=12,a=0;switch(e[0]=5,i.t){case"n":e[1]=2,nB(e,r,i.v),a|=1,r+=16;break;case"b":e[1]=6,n.setFloat64(r,i.v?1:0,!0),a|=2,r+=8;break;case"s":if(t.indexOf(i.v)==-1)throw new Error("Value ".concat(i.v," missing from SST!"));e[1]=3,n.setUint32(r,t.indexOf(i.v),!0),a|=8,r+=4;break;default:throw"unsupported cell type "+i.t}return n.setUint32(8,a,!0),e.slice(0,r)}function Og(i,t){var e=new Uint8Array(32),n=b1(e),r=12,a=0;switch(e[0]=3,i.t){case"n":e[2]=2,n.setFloat64(r,i.v,!0),a|=32,r+=8;break;case"b":e[2]=6,n.setFloat64(r,i.v?1:0,!0),a|=32,r+=8;break;case"s":if(t.indexOf(i.v)==-1)throw new Error("Value ".concat(i.v," missing from SST!"));e[2]=3,n.setUint32(r,t.indexOf(i.v),!0),a|=16,r+=4;break;default:throw"unsupported cell type "+i.t}return n.setUint32(4,a,!0),e.slice(0,r)}function gl(i){var t=ar(i);return ld(t[1][0].data)}function aB(i,t,e){var n,r,a,s;if(!((n=i[6])!=null&&n[0])||!((r=i[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=i[8])==null?void 0:a[0])==null?void 0:s.data)&&xc(i[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=b1(i[7][0].data),u=0,h=[],g=b1(i[4][0].data),d=0,b=[],_=0;_<t.length;++_){if(t[_]==null){c.setUint16(_*2,65535,!0),g.setUint16(_*2,65535);continue}c.setUint16(_*2,u,!0),g.setUint16(_*2,d,!0);var w,E;switch(typeof t[_]){case"string":w=Rg({t:"s",v:t[_]},e),E=Og({t:"s",v:t[_]},e);break;case"number":w=Rg({t:"n",v:t[_]},e),E=Og({t:"n",v:t[_]},e);break;case"boolean":w=Rg({t:"b",v:t[_]},e),E=Og({t:"b",v:t[_]},e);break;default:throw new Error("Unsupported value "+t[_])}h.push(w),u+=w.length,b.push(E),d+=E.length,++l}for(i[2][0].data=zi(l);_<i[7][0].data.length/2;++_)c.setUint16(_*2,65535,!0),g.setUint16(_*2,65535,!0);return i[6][0].data=wl(h),i[3][0].data=wl(b),l}function sB(i,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=i.Sheets[i.SheetNames[0]];i.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Pa(e["!ref"]);n.s.r=n.s.c=0;var r=!1;n.e.c>9&&(r=!0,n.e.c=9),n.e.r>49&&(r=!0,n.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat($n(n)));var a=w1(e,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(P){return P.forEach(function(O){typeof O=="string"&&s.push(O)})});var o={},l=[],c=$i.read(t.numbers,{type:"base64"});c.FileIndex.map(function(P,O){return[P,c.FullPaths[O]]}).forEach(function(P){var O=P[0],Q=P[1];if(O.type==2&&O.name.match(/\.iwa/)){var fe=O.content,ye=ms(fe),pe=ps(ye);pe.forEach(function(ge){l.push(ge.id),o[ge.id]={deps:[],location:Q,type:xc(ge.messages[0].meta[1][0].data)}})}}),l.sort(function(P,O){return P-O});var u=l.filter(function(P){return P>1}).map(function(P){return[P,zi(P)]});c.FileIndex.map(function(P,O){return[P,c.FullPaths[O]]}).forEach(function(P){var O=P[0],Q=P[1];if(O.name.match(/\.iwa/)){var fe=ps(ms(O.content));fe.forEach(function(ye){ye.messages.forEach(function(pe){u.forEach(function(ge){ye.messages.some(function(Xe){return xc(Xe.meta[1][0].data)!=11006&&iB(Xe.data,ge[1])})&&o[ge[0]].deps.push(ye.id)})})})}});function h(){for(var P=927262;P<2e6;++P)if(!o[P])return P;throw new Error("Too many messages")}for(var g=$i.find(c,o[1].location),d=ps(ms(g.content)),b,_=0;_<d.length;++_){var w=d[_];w.id==1&&(b=w)}var E=gl(ar(b.messages[0].data)[1][0].data);for(g=$i.find(c,o[E].location),d=ps(ms(g.content)),_=0;_<d.length;++_)w=d[_],w.id==E&&(b=w);for(E=gl(ar(b.messages[0].data)[2][0].data),g=$i.find(c,o[E].location),d=ps(ms(g.content)),_=0;_<d.length;++_)w=d[_],w.id==E&&(b=w);for(E=gl(ar(b.messages[0].data)[2][0].data),g=$i.find(c,o[E].location),d=ps(ms(g.content)),_=0;_<d.length;++_)w=d[_],w.id==E&&(b=w);var A=ar(b.messages[0].data);{A[6][0].data=zi(n.e.r+1),A[7][0].data=zi(n.e.c+1);var D=gl(A[46][0].data),N=$i.find(c,o[D].location),z=ps(ms(N.content));{for(var J=0;J<z.length&&z[J].id!=D;++J);if(z[J].id!=D)throw"Bad ColumnRowUIDMapArchive";var W=ar(z[J].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var U=0;U<=n.e.c;++U){var M=[];M[1]=M[2]=[{type:0,data:zi(U+420690)}],W[1].push({type:2,data:Fr(M)}),W[2].push({type:0,data:zi(U)}),W[3].push({type:0,data:zi(U)})}W[4]=[],W[5]=[],W[6]=[];for(var X=0;X<=n.e.r;++X)M=[],M[1]=M[2]=[{type:0,data:zi(X+726270)}],W[4].push({type:2,data:Fr(M)}),W[5].push({type:0,data:zi(X)}),W[6].push({type:0,data:zi(X)});z[J].messages[0].data=Fr(W)}N.content=uc(cc(z)),N.size=N.content.length,delete A[46];var F=ar(A[4][0].data);{F[7][0].data=zi(n.e.r+1);var I=ar(F[1][0].data),ee=gl(I[2][0].data);N=$i.find(c,o[ee].location),z=ps(ms(N.content));{if(z[0].id!=ee)throw"Bad HeaderStorageBucket";var le=ar(z[0].messages[0].data);for(X=0;X<a.length;++X){var de=ar(le[2][0].data);de[1][0].data=zi(X),de[4][0].data=zi(a[X].length),le[2][X]={type:le[2][0].type,data:Fr(de)}}z[0].messages[0].data=Fr(le)}N.content=uc(cc(z)),N.size=N.content.length;var ke=gl(F[2][0].data);N=$i.find(c,o[ke].location),z=ps(ms(N.content));{if(z[0].id!=ke)throw"Bad HeaderStorageBucket";for(le=ar(z[0].messages[0].data),U=0;U<=n.e.c;++U)de=ar(le[2][0].data),de[1][0].data=zi(U),de[4][0].data=zi(n.e.r+1),le[2][U]={type:le[2][0].type,data:Fr(de)};z[0].messages[0].data=Fr(le)}N.content=uc(cc(z)),N.size=N.content.length;var Fe=gl(F[4][0].data);(function(){for(var P=$i.find(c,o[Fe].location),O=ps(ms(P.content)),Q,fe=0;fe<O.length;++fe){var ye=O[fe];ye.id==Fe&&(Q=ye)}var pe=ar(Q.messages[0].data);{pe[3]=[];var ge=[];s.forEach(function(ut,Ne){ge[1]=[{type:0,data:zi(Ne)}],ge[2]=[{type:0,data:zi(1)}],ge[3]=[{type:2,data:tB(ut)}],pe[3].push({type:2,data:Fr(ge)})})}Q.messages[0].data=Fr(pe);var Xe=cc(O),Je=uc(Xe);P.content=Je,P.size=P.content.length})();var Se=ar(F[3][0].data);{var Oe=Se[1][0];delete Se[2];var Ze=ar(Oe.data);{var qe=gl(Ze[2][0].data);(function(){for(var P=$i.find(c,o[qe].location),O=ps(ms(P.content)),Q,fe=0;fe<O.length;++fe){var ye=O[fe];ye.id==qe&&(Q=ye)}var pe=ar(Q.messages[0].data);{delete pe[6],delete Se[7];var ge=new Uint8Array(pe[5][0].data);pe[5]=[];for(var Xe=0,Je=0;Je<=n.e.r;++Je){var ut=ar(ge);Xe+=aB(ut,a[Je],s),ut[1][0].data=zi(Je),pe[5].push({data:Fr(ut),type:2})}pe[1]=[{type:0,data:zi(n.e.c+1)}],pe[2]=[{type:0,data:zi(n.e.r+1)}],pe[3]=[{type:0,data:zi(Xe)}],pe[4]=[{type:0,data:zi(n.e.r+1)}]}Q.messages[0].data=Fr(pe);var Ne=cc(O),oe=uc(Ne);P.content=oe,P.size=P.content.length})()}Oe.data=Fr(Ze)}F[3][0].data=Fr(Se)}A[4][0].data=Fr(F)}b.messages[0].data=Fr(A);var k=cc(d),B=uc(k);return g.content=B,g.size=g.content.length,c}function oB(i){return function(e){for(var n=0;n!=i.length;++n){var r=i[n];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function d2(i){oB([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(i)}function lB(i,t){return t.bookType=="ods"?r4(i,t):t.bookType=="numbers"?sB(i,t):t.bookType=="xlsb"?cB(i,t):uB(i,t)}function cB(i,t){fc=1024,i&&!i.SSF&&(i.SSF=ga(En)),i&&i.SSF&&(C1(),S1(i.SSF),t.revssf=E1(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,id?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",n=Vy.indexOf(t.bookType)>-1,r=my();d2(t=t||{});var a=qg(),s="",o=0;if(t.cellXfs=[],yl(t.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={}),s="docProps/core.xml",li(a,s,_y(i.Props,t)),r.coreprops.push(s),Hi(t.rels,2,s,Ti.CORE_PROPS),s="docProps/app.xml",!(i.Props&&i.Props.SheetNames))if(!i.Workbook||!i.Workbook.Sheets)i.Props.SheetNames=i.SheetNames;else{for(var l=[],c=0;c<i.SheetNames.length;++c)(i.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(i.SheetNames[c]);i.Props.SheetNames=l}for(i.Props.Worksheets=i.Props.SheetNames.length,li(a,s,wy(i.Props,t)),r.extprops.push(s),Hi(t.rels,3,s,Ti.EXT_PROPS),i.Custprops!==i.Props&&Lr(i.Custprops||{}).length>0&&(s="docProps/custom.xml",li(a,s,yy(i.Custprops,t)),r.custprops.push(s),Hi(t.rels,4,s,Ti.CUST_PROPS)),o=1;o<=i.SheetNames.length;++o){var u={"!id":{}},h=i.Sheets[i.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,li(a,s,fO(o-1,s,t,i,u)),r.sheets.push(s),Hi(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ti.WS[0])}if(h){var d=h["!comments"],b=!1,_="";d&&d.length>0&&(_="xl/comments"+o+"."+e,li(a,_,mO(d,_,t)),r.comments.push(_),Hi(u,-1,"../comments"+o+"."+e,Ti.CMNT),b=!0),h["!legacy"]&&b&&li(a,"xl/drawings/vmlDrawing"+o+".vml",By(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&li(a,xy(s),mc(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+e,li(a,s,pO(t.Strings,s,t)),r.strs.push(s),Hi(t.wbrels,-1,"sharedStrings."+e,Ti.SST)),s="xl/workbook."+e,li(a,s,dO(i,s,t)),r.workbooks.push(s),Hi(t.rels,1,s,Ti.WB),s="xl/theme/theme1.xml",li(a,s,Ry(i.Themes,t)),r.themes.push(s),Hi(t.wbrels,-1,"theme/theme1.xml",Ti.THEME),s="xl/styles."+e,li(a,s,hO(i,s,t)),r.styles.push(s),Hi(t.wbrels,-1,"styles."+e,Ti.STY),i.vbaraw&&n&&(s="xl/vbaProject.bin",li(a,s,i.vbaraw),r.vba.push(s),Hi(t.wbrels,-1,"vbaProject.bin",Ti.VBA)),s="xl/metadata."+e,li(a,s,gO(s)),r.metadata.push(s),Hi(t.wbrels,-1,"metadata."+e,Ti.XLMETA),li(a,"[Content_Types].xml",gy(r,t)),li(a,"_rels/.rels",mc(t.rels)),li(a,"xl/_rels/workbook."+e+".rels",mc(t.wbrels)),delete t.revssf,delete t.ssf,a}function uB(i,t){fc=1024,i&&!i.SSF&&(i.SSF=ga(En)),i&&i.SSF&&(C1(),S1(i.SSF),t.revssf=E1(i.SSF),t.revssf[i.SSF[65535]]=0,t.ssf=i.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,id?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",n=Vy.indexOf(t.bookType)>-1,r=my();d2(t=t||{});var a=qg(),s="",o=0;if(t.cellXfs=[],yl(t.cellXfs,{},{revssf:{General:0}}),i.Props||(i.Props={}),s="docProps/core.xml",li(a,s,_y(i.Props,t)),r.coreprops.push(s),Hi(t.rels,2,s,Ti.CORE_PROPS),s="docProps/app.xml",!(i.Props&&i.Props.SheetNames))if(!i.Workbook||!i.Workbook.Sheets)i.Props.SheetNames=i.SheetNames;else{for(var l=[],c=0;c<i.SheetNames.length;++c)(i.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(i.SheetNames[c]);i.Props.SheetNames=l}i.Props.Worksheets=i.Props.SheetNames.length,li(a,s,wy(i.Props,t)),r.extprops.push(s),Hi(t.rels,3,s,Ti.EXT_PROPS),i.Custprops!==i.Props&&Lr(i.Custprops||{}).length>0&&(s="docProps/custom.xml",li(a,s,yy(i.Custprops,t)),r.custprops.push(s),Hi(t.rels,4,s,Ti.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=i.SheetNames.length;++o){var h={"!id":{}},g=i.Sheets[i.SheetNames[o-1]],d=(g||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+e,li(a,s,Yy(o-1,t,i,h)),r.sheets.push(s),Hi(t.wbrels,-1,"worksheets/sheet"+o+"."+e,Ti.WS[0])}if(g){var b=g["!comments"],_=!1,w="";if(b&&b.length>0){var E=!1;b.forEach(function(A){A[1].forEach(function(D){D.T==!0&&(E=!0)})}),E&&(w="xl/threadedComments/threadedComment"+o+"."+e,li(a,w,UL(b,u,t)),r.threadedcomments.push(w),Hi(h,-1,"../threadedComments/threadedComment"+o+"."+e,Ti.TCMNT)),w="xl/comments"+o+"."+e,li(a,w,jy(b,t)),r.comments.push(w),Hi(h,-1,"../comments"+o+"."+e,Ti.CMNT),_=!0}g["!legacy"]&&_&&li(a,"xl/drawings/vmlDrawing"+o+".vml",By(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}h["!id"].rId1&&li(a,xy(s),mc(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+e,li(a,s,Dy(t.Strings,t)),r.strs.push(s),Hi(t.wbrels,-1,"sharedStrings."+e,Ti.SST)),s="xl/workbook."+e,li(a,s,Jy(i,t)),r.workbooks.push(s),Hi(t.rels,1,s,Ti.WB),s="xl/theme/theme1.xml",li(a,s,Ry(i.Themes,t)),r.themes.push(s),Hi(t.wbrels,-1,"theme/theme1.xml",Ti.THEME),s="xl/styles."+e,li(a,s,Ly(i,t)),r.styles.push(s),Hi(t.wbrels,-1,"styles."+e,Ti.STY),i.vbaraw&&n&&(s="xl/vbaProject.bin",li(a,s,i.vbaraw),r.vba.push(s),Hi(t.wbrels,-1,"vbaProject.bin",Ti.VBA)),s="xl/metadata."+e,li(a,s,Oy()),r.metadata.push(s),Hi(t.wbrels,-1,"metadata."+e,Ti.XLMETA),u.length>1&&(s="xl/persons/person.xml",li(a,s,zL(u,t)),r.people.push(s),Hi(t.wbrels,-1,"persons/person.xml",Ti.PEOPLE)),li(a,"[Content_Types].xml",gy(r,t)),li(a,"_rels/.rels",mc(t.rels)),li(a,"xl/_rels/workbook."+e+".rels",mc(t.wbrels)),delete t.revssf,delete t.ssf,a}function dB(i,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];case"base64":e=ko(i.slice(0,12));break;case"binary":e=i;break;case"array":return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function a4(i,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return dd(t.file,$i.write(i,{type:Fi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $i.write(i,t)}function fB(i,t){var e=ga(t||{}),n=lB(i,e);return hB(n,e)}function hB(i,t){var e={},n=Fi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=n;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var r=i.FullPaths?$i.write(i,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):i.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(y1(r))}return t.password&&typeof encrypt_agile<"u"?a4(encrypt_agile(r,t.password),t):t.type==="file"?dd(t.file,r):t.type=="string"?Ju(r):r}function pB(i,t){var e=t||{},n=DO(i,e);return a4(n,e)}function Us(i,t,e){e||(e="");var n=e+i;switch(t.type){case"base64":return ad(yo(n));case"binary":return yo(n);case"string":return i;case"file":return dd(t.file,n,"utf8");case"buffer":return Fi?Ao(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Us(n,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function mB(i,t){switch(t.type){case"base64":return ad(i);case"binary":return i;case"string":return i;case"file":return dd(t.file,i,"binary");case"buffer":return Fi?Ao(i,"binary"):i.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function l1(i,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",n=0;n<i.length;++n)e+=String.fromCharCode(i[n]);return t.type=="base64"?ad(e):t.type=="string"?Ju(e):e;case"file":return dd(t.file,i);case"buffer":return i;default:throw new Error("Unrecognized type "+t.type)}}function s4(i,t){UN(),eO(i);var e=ga(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=s4(i,e);return e.type="array",y1(n)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=i.SheetNames.indexOf(e.sheet),!i.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Us(AO(i,e),e);case"slk":case"sylk":return Us(ZM.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"htm":case"html":return Us(t4(i.Sheets[i.SheetNames[r]],e),e);case"txt":return mB(o4(i.Sheets[i.SheetNames[r]],e),e);case"csv":return Us(f2(i.Sheets[i.SheetNames[r]],e),e,"\uFEFF");case"dif":return Us(JM.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"dbf":return l1(KM.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"prn":return Us(QM.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"rtf":return Us(sL.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"eth":return Us(Fy.from_sheet(i.Sheets[i.SheetNames[r]],e),e);case"fods":return Us(r4(i,e),e);case"wk1":return l1(Tw.sheet_to_wk1(i.Sheets[i.SheetNames[r]],e),e);case"wk3":return l1(Tw.book_to_wk3(i,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),l1(e4(i,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),pB(i,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return fB(i,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function gB(i){if(!i.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=i.file.slice(i.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(i.bookType=e.slice(1)),i.bookType=t[i.bookType]||i.bookType}}function Ws(i,t,e){var n=e||{};return n.type="file",n.file=t,gB(n),s4(i,n)}function xB(i,t,e,n,r,a,s,o){var l=Mr(e),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,g=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:e,enumerable:!1})}catch{g.__rowNum__=e}else g.__rowNum__=e;if(!s||i[e])for(var d=t.s.c;d<=t.e.c;++d){var b=s?i[e][d]:i[n[d]+l];if(b===void 0||b.t===void 0){if(c===void 0)continue;a[d]!=null&&(g[a[d]]=c);continue}var _=b.v;switch(b.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(a[d]!=null){if(_==null)if(b.t=="e"&&_===null)g[a[d]]=null;else if(c!==void 0)g[a[d]]=c;else if(u&&_===null)g[a[d]]=null;else continue;else g[a[d]]=u&&(b.t!=="n"||b.t==="n"&&o.rawNumbers!==!1)?_:To(b,_,o);_!=null&&(h=!1)}}return{row:g,isempty:h}}function w1(i,t){if(i==null||i["!ref"]==null)return[];var e={t:"n",v:0},n=0,r=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:i["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=dn(u);break;case"number":l=dn(i["!ref"]),l.s.r=u;break;default:l=u}n>0&&(r=0);var h=Mr(l.s.r),g=[],d=[],b=0,_=0,w=Array.isArray(i),E=l.s.r,A=0,D={};w&&!i[E]&&(i[E]=[]);var N=c.skipHidden&&i["!cols"]||[],z=c.skipHidden&&i["!rows"]||[];for(A=l.s.c;A<=l.e.c;++A)if(!(N[A]||{}).hidden)switch(g[A]=Hr(A),e=w?i[E][A]:i[g[A]+h],n){case 1:a[A]=A-l.s.c;break;case 2:a[A]=g[A];break;case 3:a[A]=c.header[A-l.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),o=s=To(e,null,c),_=D[s]||0,!_)D[s]=1;else{do o=s+"_"+_++;while(D[o]);D[s]=_,D[o]=1}a[A]=o}for(E=l.s.r+r;E<=l.e.r;++E)if(!(z[E]||{}).hidden){var J=xB(i,l,E,g,n,a,w,c);(J.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[b++]=J.row)}return d.length=b,d}var Iw=/"/g;function vB(i,t,e,n,r,a,s,o){for(var l=!0,c=[],u="",h=Mr(e),g=t.s.c;g<=t.e.c;++g)if(n[g]){var d=o.dense?(i[e]||[])[g]:i[n[g]+h];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:To(d,null,o));for(var b=0,_=0;b!==u.length;++b)if((_=u.charCodeAt(b))===r||_===a||_===34||o.forceQuotes){u='"'+u.replace(Iw,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(Iw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function f2(i,t){var e=[],n=t??{};if(i==null||i["!ref"]==null)return"";var r=dn(i["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(i);for(var g=n.skipHidden&&i["!cols"]||[],d=n.skipHidden&&i["!rows"]||[],b=r.s.c;b<=r.e.c;++b)(g[b]||{}).hidden||(h[b]=Hr(b));for(var _=0,w=r.s.r;w<=r.e.r;++w)(d[w]||{}).hidden||(u=vB(i,r,w,h,s,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&e.push((_++?o:"")+u)));return delete n.dense,e.join("")}function o4(i,t){t||(t={}),t.FS="	",t.RS=`
`;var e=f2(i,t);if(typeof Ji>"u"||t.type=="string")return e;var n=Ji.utils.encode(1200,e,"str");return"\xFF\xFE"+n}function _B(i){var t="",e,n="";if(i==null||i["!ref"]==null)return[];var r=dn(i["!ref"]),a="",s=[],o,l=[],c=Array.isArray(i);for(o=r.s.c;o<=r.e.c;++o)s[o]=Hr(o);for(var u=r.s.r;u<=r.e.r;++u)for(a=Mr(u),o=r.s.c;o<=r.e.c;++o)if(t=s[o]+a,e=c?(i[u]||[])[o]:i[t],n="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;n=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)n=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)n=""+e.v;else if(e.t=="b")n=e.v?"TRUE":"FALSE";else if(e.w!==void 0)n="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?n="'"+e.v:n=""+e.v}}l[l.length]=t+"="+n}return l}function l4(i,t,e){var n=e||{},r=+!n.skipHeader,a=i||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?xr(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+r}};if(a["!ref"]){var h=dn(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+t.length-1+r)}else s==-1&&(s=0,u.e.r=t.length-1+r);var g=n.header||[],d=0;t.forEach(function(_,w){Lr(_).forEach(function(E){(d=g.indexOf(E))==-1&&(g[d=g.length]=E);var A=_[E],D="z",N="",z=qi({c:o+d,r:s+w+r});c=cd(a,z),A&&typeof A=="object"&&!(A instanceof Date)?a[z]=A:(typeof A=="number"?D="n":typeof A=="boolean"?D="b":typeof A=="string"?D="s":A instanceof Date?(D="d",n.cellDates||(D="n",A=ma(A)),N=n.dateNF||En[14]):A===null&&n.nullError&&(D="e",A=0),c?(c.t=D,c.v=A,delete c.w,delete c.R,N&&(c.z=N)):a[z]=c={t:D,v:A},N&&(c.z=N))})}),u.e.c=Math.max(u.e.c,o+g.length-1);var b=Mr(s);if(r)for(d=0;d<g.length;++d)a[Hr(d+o)+b]={t:"s",v:g[d]};return a["!ref"]=$n(u),a}function bB(i,t){return l4(null,i,t)}function cd(i,t,e){if(typeof t=="string"){if(Array.isArray(i)){var n=xr(t);return i[n.r]||(i[n.r]=[]),i[n.r][n.c]||(i[n.r][n.c]={t:"z"})}return i[t]||(i[t]={t:"z"})}return typeof t!="number"?cd(i,qi(t)):cd(i,qi({r:t,c:e||0}))}function wB(i,t){if(typeof t=="number"){if(t>=0&&i.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=i.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function yB(){return{SheetNames:[],Sheets:{}}}function SB(i,t,e,n){var r=1;if(!e)for(;r<=65535&&i.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||i.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&i.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var s=a&&a[1]||e;for(++r;r<=65535&&i.SheetNames.indexOf(e=s+r)!=-1;++r);}if(Zy(e),i.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return i.SheetNames.push(e),i.Sheets[e]=t,e}function CB(i,t,e){i.Workbook||(i.Workbook={}),i.Workbook.Sheets||(i.Workbook.Sheets=[]);var n=wB(i,t);switch(i.Workbook.Sheets[n]||(i.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}i.Workbook.Sheets[n].Hidden=e}function EB(i,t){return i.z=t,i}function c4(i,t,e){return t?(i.l={Target:t},e&&(i.l.Tooltip=e)):delete i.l,i}function kB(i,t,e){return c4(i,"#"+t,e)}function TB(i,t,e){i.c||(i.c=[]),i.c.push({t,a:e||"SheetJS"})}function AB(i,t,e,n){for(var r=typeof t!="string"?t:dn(t),a=typeof t=="string"?t:$n(t),s=r.s.r;s<=r.e.r;++s)for(var o=r.s.c;o<=r.e.c;++o){var l=cd(i,s,o);l.t="n",l.F=a,delete l.v,s==r.s.r&&o==r.s.c&&(l.f=e,n&&(l.D=!0))}return i}var Yn={encode_col:Hr,encode_row:Mr,encode_cell:qi,encode_range:$n,decode_col:t2,decode_row:e2,split_cell:HP,decode_cell:xr,decode_range:Pa,format_cell:To,sheet_add_aoa:cy,sheet_add_json:l4,sheet_add_dom:i4,aoa_to_sheet:yc,json_to_sheet:bB,table_to_sheet:n4,table_to_book:JO,sheet_to_csv:f2,sheet_to_txt:o4,sheet_to_json:w1,sheet_to_html:t4,sheet_to_formulae:_B,sheet_to_row_object_array:w1,sheet_get_cell:cd,book_new:yB,book_append_sheet:SB,book_set_sheet_visibility:CB,cell_set_number_format:EB,cell_set_hyperlink:c4,cell_set_internal_link:kB,cell_add_comment:TB,sheet_set_array_formula:AB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var qK=nd.version;var _s=Uint8Array,Ma=Uint16Array,x2=Int32Array,v2=new _s([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),_2=new _s([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),u4=new _s([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p4=function(i,t){for(var e=new Ma(31),n=0;n<31;++n)e[n]=t+=1<<i[n-1];for(var r=new x2(e[30]),n=1;n<30;++n)for(var a=e[n];a<e[n+1];++a)r[a]=a-e[n]<<5|n;return{b:e,r}},m4=p4(v2,2),FB=m4.b,p2=m4.r;FB[28]=258,p2[258]=28;var g4=p4(_2,0),GK=g4.b,d4=g4.r,m2=new Ma(32768);for(Di=0;Di<32768;++Di)Fo=(Di&43690)>>1|(Di&21845)<<1,Fo=(Fo&52428)>>2|(Fo&13107)<<2,Fo=(Fo&61680)>>4|(Fo&3855)<<4,m2[Di]=((Fo&65280)>>8|(Fo&255)<<8)>>1;var Fo,Di,vd=function(i,t,e){for(var n=i.length,r=0,a=new Ma(t);r<n;++r)i[r]&&++a[i[r]-1];var s=new Ma(t);for(r=1;r<t;++r)s[r]=s[r-1]+a[r-1]<<1;var o;if(e){o=new Ma(1<<t);var l=15-t;for(r=0;r<n;++r)if(i[r])for(var c=r<<4|i[r],u=t-i[r],h=s[i[r]-1]++<<u,g=h|(1<<u)-1;h<=g;++h)o[m2[h]>>l]=c}else for(o=new Ma(n),r=0;r<n;++r)i[r]&&(o[r]=m2[s[i[r]-1]++]>>15-i[r]);return o},_0=new _s(288);for(Di=0;Di<144;++Di)_0[Di]=8;var Di;for(Di=144;Di<256;++Di)_0[Di]=9;var Di;for(Di=256;Di<280;++Di)_0[Di]=7;var Di;for(Di=280;Di<288;++Di)_0[Di]=8;var Di,N1=new _s(32);for(Di=0;Di<32;++Di)N1[Di]=5;var Di,DB=vd(_0,9,0);var NB=vd(N1,5,0);var x4=function(i){return(i+7)/8|0},PB=function(i,t,e){return(t==null||t<0)&&(t=0),(e==null||e>i.length)&&(e=i.length),new _s(i.subarray(t,e))};var Do=function(i,t,e){e<<=t&7;var n=t/8|0;i[n]|=e,i[n+1]|=e>>8},gd=function(i,t,e){e<<=t&7;var n=t/8|0;i[n]|=e,i[n+1]|=e>>8,i[n+2]|=e>>16},h2=function(i,t){for(var e=[],n=0;n<i.length;++n)i[n]&&e.push({s:n,f:i[n]});var r=e.length,a=e.slice();if(!r)return{t:_4,l:0};if(r==1){var s=new _s(e[0].s+1);return s[e[0].s]=1,{t:s,l:1}}e.sort(function(z,J){return z.f-J.f}),e.push({s:-1,f:25001});var o=e[0],l=e[1],c=0,u=1,h=2;for(e[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=r-1;)o=e[e[c].f<e[h].f?c++:h++],l=e[c!=u&&e[c].f<e[h].f?c++:h++],e[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var g=a[0].s,n=1;n<r;++n)a[n].s>g&&(g=a[n].s);var d=new Ma(g+1),b=g2(e[u-1],d,0);if(b>t){var n=0,_=0,w=b-t,E=1<<w;for(a.sort(function(J,W){return d[W.s]-d[J.s]||J.f-W.f});n<r;++n){var A=a[n].s;if(d[A]>t)_+=E-(1<<b-d[A]),d[A]=t;else break}for(_>>=w;_>0;){var D=a[n].s;d[D]<t?_-=1<<t-d[D]++-1:++n}for(;n>=0&&_;--n){var N=a[n].s;d[N]==t&&(--d[N],++_)}b=t}return{t:new _s(d),l:b}},g2=function(i,t,e){return i.s==-1?Math.max(g2(i.l,t,e+1),g2(i.r,t,e+1)):t[i.s]=e},f4=function(i){for(var t=i.length;t&&!i[--t];);for(var e=new Ma(++t),n=0,r=i[0],a=1,s=function(l){e[n++]=l},o=1;o<=t;++o)if(i[o]==r&&o!=t)++a;else{if(!r&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(r),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(r);a=1,r=i[o]}return{c:e.subarray(0,n),n:t}},xd=function(i,t){for(var e=0,n=0;n<t.length;++n)e+=i[n]*t[n];return e},v4=function(i,t,e){var n=e.length,r=x4(t+2);i[r]=n&255,i[r+1]=n>>8,i[r+2]=i[r]^255,i[r+3]=i[r+1]^255;for(var a=0;a<n;++a)i[r+a+4]=e[a];return(r+4+n)*8},h4=function(i,t,e,n,r,a,s,o,l,c,u){Do(t,u++,e),++r[256];for(var h=h2(r,15),g=h.t,d=h.l,b=h2(a,15),_=b.t,w=b.l,E=f4(g),A=E.c,D=E.n,N=f4(_),z=N.c,J=N.n,W=new Ma(19),U=0;U<A.length;++U)++W[A[U]&31];for(var U=0;U<z.length;++U)++W[z[U]&31];for(var M=h2(W,7),X=M.t,F=M.l,I=19;I>4&&!X[u4[I-1]];--I);var ee=c+5<<3,le=xd(r,_0)+xd(a,N1)+s,de=xd(r,g)+xd(a,_)+s+14+3*I+xd(W,X)+2*W[16]+3*W[17]+7*W[18];if(l>=0&&ee<=le&&ee<=de)return v4(t,u,i.subarray(l,l+c));var ke,Fe,Se,Oe;if(Do(t,u,1+(de<le)),u+=2,de<le){ke=vd(g,d,0),Fe=g,Se=vd(_,w,0),Oe=_;var Ze=vd(X,F,0);Do(t,u,D-257),Do(t,u+5,J-1),Do(t,u+10,I-4),u+=14;for(var U=0;U<I;++U)Do(t,u+3*U,X[u4[U]]);u+=3*I;for(var qe=[A,z],k=0;k<2;++k)for(var B=qe[k],U=0;U<B.length;++U){var P=B[U]&31;Do(t,u,Ze[P]),u+=X[P],P>15&&(Do(t,u,B[U]>>5&127),u+=B[U]>>12)}}else ke=DB,Fe=_0,Se=NB,Oe=N1;for(var U=0;U<o;++U){var O=n[U];if(O>255){var P=O>>18&31;gd(t,u,ke[P+257]),u+=Fe[P+257],P>7&&(Do(t,u,O>>23&31),u+=v2[P]);var Q=O&31;gd(t,u,Se[Q]),u+=Oe[Q],Q>3&&(gd(t,u,O>>5&8191),u+=_2[Q])}else gd(t,u,ke[O]),u+=Fe[O]}return gd(t,u,ke[256]),u+Fe[256]},MB=new x2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_4=new _s(0),LB=function(i,t,e,n,r,a){var s=a.z||i.length,o=new _s(n+s+5*(1+Math.ceil(s/7e3))+r),l=o.subarray(n,o.length-r),c=a.l,u=(a.r||0)&7;if(t){u&&(l[0]=a.r>>3);for(var h=MB[t-1],g=h>>13,d=h&8191,b=(1<<e)-1,_=a.p||new Ma(32768),w=a.h||new Ma(b+1),E=Math.ceil(e/3),A=2*E,D=function(Ne){return(i[Ne]^i[Ne+1]<<E^i[Ne+2]<<A)&b},N=new x2(25e3),z=new Ma(288),J=new Ma(32),W=0,U=0,M=a.i||0,X=0,F=a.w||0,I=0;M+2<s;++M){var ee=D(M),le=M&32767,de=w[ee];if(_[le]=de,w[ee]=le,F<=M){var ke=s-M;if((W>7e3||X>24576)&&(ke>423||!c)){u=h4(i,l,0,N,z,J,U,X,I,M-I,u),X=W=U=0,I=M;for(var Fe=0;Fe<286;++Fe)z[Fe]=0;for(var Fe=0;Fe<30;++Fe)J[Fe]=0}var Se=2,Oe=0,Ze=d,qe=le-de&32767;if(ke>2&&ee==D(M-qe))for(var k=Math.min(g,ke)-1,B=Math.min(32767,M),P=Math.min(258,ke);qe<=B&&--Ze&&le!=de;){if(i[M+Se]==i[M+Se-qe]){for(var O=0;O<P&&i[M+O]==i[M+O-qe];++O);if(O>Se){if(Se=O,Oe=qe,O>k)break;for(var Q=Math.min(qe,O-2),fe=0,Fe=0;Fe<Q;++Fe){var ye=M-qe+Fe&32767,pe=_[ye],ge=ye-pe&32767;ge>fe&&(fe=ge,de=ye)}}}le=de,de=_[le],qe+=le-de&32767}if(Oe){N[X++]=268435456|p2[Se]<<18|d4[Oe];var Xe=p2[Se]&31,Je=d4[Oe]&31;U+=v2[Xe]+_2[Je],++z[257+Xe],++J[Je],F=M+Se,++W}else N[X++]=i[M],++z[i[M]]}}for(M=Math.max(M,F);M<s;++M)N[X++]=i[M],++z[i[M]];u=h4(i,l,c,N,z,J,U,X,I,M-I,u),c||(a.r=u&7|l[u/8|0]<<3,u-=7,a.h=w,a.p=_,a.i=M,a.w=F)}else{for(var M=a.w||0;M<s+c;M+=65535){var ut=M+65535;ut>=s&&(l[u/8|0]=c,ut=s),u=v4(l,u+1,i.subarray(M,ut))}a.i=s}return PB(o,0,n+x4(u)+r)};var b4=function(){var i=1,t=0;return{p:function(e){for(var n=i,r=t,a=e.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)r+=n+=e[s];n=(n&65535)+15*(n>>16),r=(r&65535)+15*(r>>16)}i=n,t=r},d:function(){return i%=65521,t%=65521,(i&255)<<24|(i&65280)<<8|(t&255)<<8|t>>8}}},IB=function(i,t,e,n,r){if(!r&&(r={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),s=new _s(a.length+i.length);s.set(a),s.set(i,a.length),i=s,r.w=a.length}return LB(i,t.level==null?6:t.level,t.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(i.length)))*1.5):20:12+t.mem,e,n,r)};var w4=function(i,t,e){for(;e;++t)i[t]=e,e>>>=8};var RB=function(i,t){var e=t.level,n=e==0?0:e<6?1:e==9?3:2;if(i[0]=120,i[1]=n<<6|(t.dictionary&&32),i[1]|=31-(i[0]<<8|i[1])%31,t.dictionary){var r=b4();r.p(t.dictionary),w4(i,2,r.d())}};function P1(i,t){t||(t={});var e=b4();e.p(i);var n=IB(i,t,t.dictionary?6:2,4);return RB(n,t),w4(n,n.length-4,e.d()),n}var OB=typeof TextDecoder<"u"&&new TextDecoder,BB=0;try{OB.decode(_4,{stream:!0}),BB=1}catch{}function y4(i){if(Array.isArray(i))return i}function S4(i,t){var e=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(e!=null){var n,r,a,s,o=[],l=!0,c=!1;try{if(a=(e=e.call(i)).next,t===0){if(Object(e)!==e)return;l=!1}else for(;!(l=(n=a.call(e)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&e.return!=null&&(s=e.return(),Object(s)!==s))return}finally{if(c)throw r}}return o}}function b2(i,t){(t==null||t>i.length)&&(t=i.length);for(var e=0,n=Array(t);e<t;e++)n[e]=i[e];return n}function C4(i,t){if(i){if(typeof i=="string")return b2(i,t);var e={}.toString.call(i).slice(8,-1);return e==="Object"&&i.constructor&&(e=i.constructor.name),e==="Map"||e==="Set"?Array.from(i):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?b2(i,t):void 0}}function E4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w2(i,t){return y4(i)||S4(i,t)||C4(i,t)||E4()}function y2(i,t="utf8"){return new TextDecoder(t).decode(i)}var jB=new TextEncoder;function k4(i){return jB.encode(i)}var VB=1024*8,UB=(()=>{let i=new Uint8Array(4),t=new Uint32Array(i.buffer);return!((t[0]=1)&i[0])})(),S2={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array},_d=class i{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=VB,e={}){let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);let r=e.offset?e.offset>>>0:0,a=t.byteLength-r,s=r;(ArrayBuffer.isView(t)||t instanceof i)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+r),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){let t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){let n=(this.offset+t)*2,r=new Uint8Array(n);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){let n=S2[e].BYTES_PER_ELEMENT*t,r=this.byteOffset+this.offset,a=this.buffer.slice(r,r+n);if(this.littleEndian===UB&&e!=="uint8"&&e!=="int8"){let o=new Uint8Array(this.buffer.slice(r,r+n));o.reverse();let l=new S2[e](o.buffer);return this.offset+=n,l.reverse(),l}let s=new S2[e](a);return this.offset+=n,s}readInt16(){let t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){let t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){let t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){let t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){let t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){let t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){let t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){let t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let n=0;n<t;n++)e+=this.readChar();return e}readUtf8(t=1){return y2(this.readBytes(t))}decodeText(t=1,e="utf8"){return y2(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(k4(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}};function Dc(i){let t=i.length;for(;--t>=0;)i[t]=0}var zB=0,d3=1,HB=2,WB=3,qB=258,$2=29,Ld=256,kd=Ld+1+$2,Tc=30,X2=19,f3=2*kd+1,b0=15,C2=16,GB=7,Y2=256,h3=16,p3=17,m3=18,B2=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),B1=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),$B=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),g3=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),XB=512,Po=new Array((kd+2)*2);Dc(Po);var Sd=new Array(Tc*2);Dc(Sd);var Td=new Array(XB);Dc(Td);var Ad=new Array(qB-WB+1);Dc(Ad);var K2=new Array($2);Dc(K2);var j1=new Array(Tc);Dc(j1);function E2(i,t,e,n,r){this.static_tree=i,this.extra_bits=t,this.extra_base=e,this.elems=n,this.max_length=r,this.has_stree=i&&i.length}var x3,v3,_3;function k2(i,t){this.dyn_tree=i,this.max_code=0,this.stat_desc=t}var b3=i=>i<256?Td[i]:Td[256+(i>>>7)],Fd=(i,t)=>{i.pending_buf[i.pending++]=t&255,i.pending_buf[i.pending++]=t>>>8&255},xa=(i,t,e)=>{i.bi_valid>C2-e?(i.bi_buf|=t<<i.bi_valid&65535,Fd(i,i.bi_buf),i.bi_buf=t>>C2-i.bi_valid,i.bi_valid+=e-C2):(i.bi_buf|=t<<i.bi_valid&65535,i.bi_valid+=e)},Gs=(i,t,e)=>{xa(i,e[t*2],e[t*2+1])},w3=(i,t)=>{let e=0;do e|=i&1,i>>>=1,e<<=1;while(--t>0);return e>>>1},YB=i=>{i.bi_valid===16?(Fd(i,i.bi_buf),i.bi_buf=0,i.bi_valid=0):i.bi_valid>=8&&(i.pending_buf[i.pending++]=i.bi_buf&255,i.bi_buf>>=8,i.bi_valid-=8)},KB=(i,t)=>{let e=t.dyn_tree,n=t.max_code,r=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length,c,u,h,g,d,b,_=0;for(g=0;g<=b0;g++)i.bl_count[g]=0;for(e[i.heap[i.heap_max]*2+1]=0,c=i.heap_max+1;c<f3;c++)u=i.heap[c],g=e[e[u*2+1]*2+1]+1,g>l&&(g=l,_++),e[u*2+1]=g,!(u>n)&&(i.bl_count[g]++,d=0,u>=o&&(d=s[u-o]),b=e[u*2],i.opt_len+=b*(g+d),a&&(i.static_len+=b*(r[u*2+1]+d)));if(_!==0){do{for(g=l-1;i.bl_count[g]===0;)g--;i.bl_count[g]--,i.bl_count[g+1]+=2,i.bl_count[l]--,_-=2}while(_>0);for(g=l;g!==0;g--)for(u=i.bl_count[g];u!==0;)h=i.heap[--c],!(h>n)&&(e[h*2+1]!==g&&(i.opt_len+=(g-e[h*2+1])*e[h*2],e[h*2+1]=g),u--)}},y3=(i,t,e)=>{let n=new Array(b0+1),r=0,a,s;for(a=1;a<=b0;a++)r=r+e[a-1]<<1,n[a]=r;for(s=0;s<=t;s++){let o=i[s*2+1];o!==0&&(i[s*2]=w3(n[o]++,o))}},ZB=()=>{let i,t,e,n,r,a=new Array(b0+1);for(e=0,n=0;n<$2-1;n++)for(K2[n]=e,i=0;i<1<<B2[n];i++)Ad[e++]=n;for(Ad[e-1]=n,r=0,n=0;n<16;n++)for(j1[n]=r,i=0;i<1<<B1[n];i++)Td[r++]=n;for(r>>=7;n<Tc;n++)for(j1[n]=r<<7,i=0;i<1<<B1[n]-7;i++)Td[256+r++]=n;for(t=0;t<=b0;t++)a[t]=0;for(i=0;i<=143;)Po[i*2+1]=8,i++,a[8]++;for(;i<=255;)Po[i*2+1]=9,i++,a[9]++;for(;i<=279;)Po[i*2+1]=7,i++,a[7]++;for(;i<=287;)Po[i*2+1]=8,i++,a[8]++;for(y3(Po,kd+1,a),i=0;i<Tc;i++)Sd[i*2+1]=5,Sd[i*2]=w3(i,5);x3=new E2(Po,B2,Ld+1,kd,b0),v3=new E2(Sd,B1,0,Tc,b0),_3=new E2(new Array(0),$B,0,X2,GB)},S3=i=>{let t;for(t=0;t<kd;t++)i.dyn_ltree[t*2]=0;for(t=0;t<Tc;t++)i.dyn_dtree[t*2]=0;for(t=0;t<X2;t++)i.bl_tree[t*2]=0;i.dyn_ltree[Y2*2]=1,i.opt_len=i.static_len=0,i.sym_next=i.matches=0},C3=i=>{i.bi_valid>8?Fd(i,i.bi_buf):i.bi_valid>0&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0},T4=(i,t,e,n)=>{let r=t*2,a=e*2;return i[r]<i[a]||i[r]===i[a]&&n[t]<=n[e]},T2=(i,t,e)=>{let n=i.heap[e],r=e<<1;for(;r<=i.heap_len&&(r<i.heap_len&&T4(t,i.heap[r+1],i.heap[r],i.depth)&&r++,!T4(t,n,i.heap[r],i.depth));)i.heap[e]=i.heap[r],e=r,r<<=1;i.heap[e]=n},A4=(i,t,e)=>{let n,r,a=0,s,o;if(i.sym_next!==0)do n=i.pending_buf[i.sym_buf+a++]&255,n+=(i.pending_buf[i.sym_buf+a++]&255)<<8,r=i.pending_buf[i.sym_buf+a++],n===0?Gs(i,r,t):(s=Ad[r],Gs(i,s+Ld+1,t),o=B2[s],o!==0&&(r-=K2[s],xa(i,r,o)),n--,s=b3(n),Gs(i,s,e),o=B1[s],o!==0&&(n-=j1[s],xa(i,n,o)));while(a<i.sym_next);Gs(i,Y2,t)},j2=(i,t)=>{let e=t.dyn_tree,n=t.stat_desc.static_tree,r=t.stat_desc.has_stree,a=t.stat_desc.elems,s,o,l=-1,c;for(i.heap_len=0,i.heap_max=f3,s=0;s<a;s++)e[s*2]!==0?(i.heap[++i.heap_len]=l=s,i.depth[s]=0):e[s*2+1]=0;for(;i.heap_len<2;)c=i.heap[++i.heap_len]=l<2?++l:0,e[c*2]=1,i.depth[c]=0,i.opt_len--,r&&(i.static_len-=n[c*2+1]);for(t.max_code=l,s=i.heap_len>>1;s>=1;s--)T2(i,e,s);c=a;do s=i.heap[1],i.heap[1]=i.heap[i.heap_len--],T2(i,e,1),o=i.heap[1],i.heap[--i.heap_max]=s,i.heap[--i.heap_max]=o,e[c*2]=e[s*2]+e[o*2],i.depth[c]=(i.depth[s]>=i.depth[o]?i.depth[s]:i.depth[o])+1,e[s*2+1]=e[o*2+1]=c,i.heap[1]=c++,T2(i,e,1);while(i.heap_len>=2);i.heap[--i.heap_max]=i.heap[1],KB(i,t),y3(e,l,i.bl_count)},F4=(i,t,e)=>{let n,r=-1,a,s=t[1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),t[(e+1)*2+1]=65535,n=0;n<=e;n++)a=s,s=t[(n+1)*2+1],!(++o<l&&a===s)&&(o<c?i.bl_tree[a*2]+=o:a!==0?(a!==r&&i.bl_tree[a*2]++,i.bl_tree[h3*2]++):o<=10?i.bl_tree[p3*2]++:i.bl_tree[m3*2]++,o=0,r=a,s===0?(l=138,c=3):a===s?(l=6,c=3):(l=7,c=4))},D4=(i,t,e)=>{let n,r=-1,a,s=t[1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),n=0;n<=e;n++)if(a=s,s=t[(n+1)*2+1],!(++o<l&&a===s)){if(o<c)do Gs(i,a,i.bl_tree);while(--o!==0);else a!==0?(a!==r&&(Gs(i,a,i.bl_tree),o--),Gs(i,h3,i.bl_tree),xa(i,o-3,2)):o<=10?(Gs(i,p3,i.bl_tree),xa(i,o-3,3)):(Gs(i,m3,i.bl_tree),xa(i,o-11,7));o=0,r=a,s===0?(l=138,c=3):a===s?(l=6,c=3):(l=7,c=4)}},JB=i=>{let t;for(F4(i,i.dyn_ltree,i.l_desc.max_code),F4(i,i.dyn_dtree,i.d_desc.max_code),j2(i,i.bl_desc),t=X2-1;t>=3&&i.bl_tree[g3[t]*2+1]===0;t--);return i.opt_len+=3*(t+1)+5+5+4,t},QB=(i,t,e,n)=>{let r;for(xa(i,t-257,5),xa(i,e-1,5),xa(i,n-4,4),r=0;r<n;r++)xa(i,i.bl_tree[g3[r]*2+1],3);D4(i,i.dyn_ltree,t-1),D4(i,i.dyn_dtree,e-1)},ej=i=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&i.dyn_ltree[e*2]!==0)return 0;if(i.dyn_ltree[18]!==0||i.dyn_ltree[20]!==0||i.dyn_ltree[26]!==0)return 1;for(e=32;e<Ld;e++)if(i.dyn_ltree[e*2]!==0)return 1;return 0},N4=!1,tj=i=>{N4||(ZB(),N4=!0),i.l_desc=new k2(i.dyn_ltree,x3),i.d_desc=new k2(i.dyn_dtree,v3),i.bl_desc=new k2(i.bl_tree,_3),i.bi_buf=0,i.bi_valid=0,S3(i)},E3=(i,t,e,n)=>{xa(i,(zB<<1)+(n?1:0),3),C3(i),Fd(i,e),Fd(i,~e),e&&i.pending_buf.set(i.window.subarray(t,t+e),i.pending),i.pending+=e},ij=i=>{xa(i,d3<<1,3),Gs(i,Y2,Po),YB(i)},nj=(i,t,e,n)=>{let r,a,s=0;i.level>0?(i.strm.data_type===2&&(i.strm.data_type=ej(i)),j2(i,i.l_desc),j2(i,i.d_desc),s=JB(i),r=i.opt_len+3+7>>>3,a=i.static_len+3+7>>>3,a<=r&&(r=a)):r=a=e+5,e+4<=r&&t!==-1?E3(i,t,e,n):i.strategy===4||a===r?(xa(i,(d3<<1)+(n?1:0),3),A4(i,Po,Sd)):(xa(i,(HB<<1)+(n?1:0),3),QB(i,i.l_desc.max_code+1,i.d_desc.max_code+1,s+1),A4(i,i.dyn_ltree,i.dyn_dtree)),S3(i),n&&C3(i)},rj=(i,t,e)=>(i.pending_buf[i.sym_buf+i.sym_next++]=t,i.pending_buf[i.sym_buf+i.sym_next++]=t>>8,i.pending_buf[i.sym_buf+i.sym_next++]=e,t===0?i.dyn_ltree[e*2]++:(i.matches++,t--,i.dyn_ltree[(Ad[e]+Ld+1)*2]++,i.dyn_dtree[b3(t)*2]++),i.sym_next===i.sym_end),aj=tj,sj=E3,oj=nj,lj=rj,cj=ij,uj={_tr_init:aj,_tr_stored_block:sj,_tr_flush_block:oj,_tr_tally:lj,_tr_align:cj},dj=(i,t,e,n)=>{let r=i&65535|0,a=i>>>16&65535|0,s=0;for(;e!==0;){s=e>2e3?2e3:e,e-=s;do r=r+t[n++]|0,a=a+r|0;while(--s);r%=65521,a%=65521}return r|a<<16|0},Dd=dj,fj=()=>{let i,t=[];for(var e=0;e<256;e++){i=e;for(var n=0;n<8;n++)i=i&1?3988292384^i>>>1:i>>>1;t[e]=i}return t},hj=new Uint32Array(fj()),pj=(i,t,e,n)=>{let r=hj,a=n+e;i^=-1;for(let s=n;s<a;s++)i=i>>>8^r[(i^t[s])&255];return i^-1},_r=pj,S0={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Nc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:mj,_tr_stored_block:V2,_tr_flush_block:gj,_tr_tally:El,_tr_align:xj}=uj,{Z_NO_FLUSH:kl,Z_PARTIAL_FLUSH:vj,Z_FULL_FLUSH:_j,Z_FINISH:Za,Z_BLOCK:P4,Z_OK:Ir,Z_STREAM_END:M4,Z_STREAM_ERROR:$s,Z_DATA_ERROR:bj,Z_BUF_ERROR:A2,Z_DEFAULT_COMPRESSION:wj,Z_FILTERED:yj,Z_HUFFMAN_ONLY:M1,Z_RLE:Sj,Z_FIXED:Cj,Z_DEFAULT_STRATEGY:Ej,Z_UNKNOWN:kj,Z_DEFLATED:z1}=Nc,Tj=9,Aj=15,Fj=8,Dj=29,Nj=256,U2=Nj+1+Dj,Pj=30,Mj=19,Lj=2*U2+1,Ij=15,xi=3,Cl=258,Xs=Cl+xi+1,Rj=32,Ac=42,Z2=57,z2=69,H2=73,W2=91,q2=103,w0=113,wd=666,ra=1,Pc=2,C0=3,Mc=4,Oj=3,y0=(i,t)=>(i.msg=S0[t],t),L4=i=>i*2-(i>4?9:0),Sl=i=>{let t=i.length;for(;--t>=0;)i[t]=0},Bj=i=>{let t,e,n,r=i.w_size;t=i.hash_size,n=t;do e=i.head[--n],i.head[n]=e>=r?e-r:0;while(--t);t=r,n=t;do e=i.prev[--n],i.prev[n]=e>=r?e-r:0;while(--t)},jj=(i,t,e)=>(t<<i.hash_shift^e)&i.hash_mask,Tl=jj,La=i=>{let t=i.state,e=t.pending;e>i.avail_out&&(e=i.avail_out),e!==0&&(i.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),i.next_out),i.next_out+=e,t.pending_out+=e,i.total_out+=e,i.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},Ia=(i,t)=>{gj(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,t),i.block_start=i.strstart,La(i.strm)},Ni=(i,t)=>{i.pending_buf[i.pending++]=t},bd=(i,t)=>{i.pending_buf[i.pending++]=t>>>8&255,i.pending_buf[i.pending++]=t&255},G2=(i,t,e,n)=>{let r=i.avail_in;return r>n&&(r=n),r===0?0:(i.avail_in-=r,t.set(i.input.subarray(i.next_in,i.next_in+r),e),i.state.wrap===1?i.adler=Dd(i.adler,t,r,e):i.state.wrap===2&&(i.adler=_r(i.adler,t,r,e)),i.next_in+=r,i.total_in+=r,r)},k3=(i,t)=>{let e=i.max_chain_length,n=i.strstart,r,a,s=i.prev_length,o=i.nice_match,l=i.strstart>i.w_size-Xs?i.strstart-(i.w_size-Xs):0,c=i.window,u=i.w_mask,h=i.prev,g=i.strstart+Cl,d=c[n+s-1],b=c[n+s];i.prev_length>=i.good_match&&(e>>=2),o>i.lookahead&&(o=i.lookahead);do if(r=t,!(c[r+s]!==b||c[r+s-1]!==d||c[r]!==c[n]||c[++r]!==c[n+1])){n+=2,r++;do;while(c[++n]===c[++r]&&c[++n]===c[++r]&&c[++n]===c[++r]&&c[++n]===c[++r]&&c[++n]===c[++r]&&c[++n]===c[++r]&&c[++n]===c[++r]&&c[++n]===c[++r]&&n<g);if(a=Cl-(g-n),n=g-Cl,a>s){if(i.match_start=t,s=a,a>=o)break;d=c[n+s-1],b=c[n+s]}}while((t=h[t&u])>l&&--e!==0);return s<=i.lookahead?s:i.lookahead},Fc=i=>{let t=i.w_size,e,n,r;do{if(n=i.window_size-i.lookahead-i.strstart,i.strstart>=t+(t-Xs)&&(i.window.set(i.window.subarray(t,t+t-n),0),i.match_start-=t,i.strstart-=t,i.block_start-=t,i.insert>i.strstart&&(i.insert=i.strstart),Bj(i),n+=t),i.strm.avail_in===0)break;if(e=G2(i.strm,i.window,i.strstart+i.lookahead,n),i.lookahead+=e,i.lookahead+i.insert>=xi)for(r=i.strstart-i.insert,i.ins_h=i.window[r],i.ins_h=Tl(i,i.ins_h,i.window[r+1]);i.insert&&(i.ins_h=Tl(i,i.ins_h,i.window[r+xi-1]),i.prev[r&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=r,r++,i.insert--,!(i.lookahead+i.insert<xi)););}while(i.lookahead<Xs&&i.strm.avail_in!==0)},T3=(i,t)=>{let e=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,n,r,a,s=0,o=i.strm.avail_in;do{if(n=65535,a=i.bi_valid+42>>3,i.strm.avail_out<a||(a=i.strm.avail_out-a,r=i.strstart-i.block_start,n>r+i.strm.avail_in&&(n=r+i.strm.avail_in),n>a&&(n=a),n<e&&(n===0&&t!==Za||t===kl||n!==r+i.strm.avail_in)))break;s=t===Za&&n===r+i.strm.avail_in?1:0,V2(i,0,0,s),i.pending_buf[i.pending-4]=n,i.pending_buf[i.pending-3]=n>>8,i.pending_buf[i.pending-2]=~n,i.pending_buf[i.pending-1]=~n>>8,La(i.strm),r&&(r>n&&(r=n),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+r),i.strm.next_out),i.strm.next_out+=r,i.strm.avail_out-=r,i.strm.total_out+=r,i.block_start+=r,n-=r),n&&(G2(i.strm,i.strm.output,i.strm.next_out,n),i.strm.next_out+=n,i.strm.avail_out-=n,i.strm.total_out+=n)}while(s===0);return o-=i.strm.avail_in,o&&(o>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=o&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-o,i.strm.next_in),i.strstart),i.strstart+=o,i.insert+=o>i.w_size-i.insert?i.w_size-i.insert:o),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),s?Mc:t!==kl&&t!==Za&&i.strm.avail_in===0&&i.strstart===i.block_start?Pc:(a=i.window_size-i.strstart,i.strm.avail_in>a&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,a+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),a>i.strm.avail_in&&(a=i.strm.avail_in),a&&(G2(i.strm,i.window,i.strstart,a),i.strstart+=a,i.insert+=a>i.w_size-i.insert?i.w_size-i.insert:a),i.high_water<i.strstart&&(i.high_water=i.strstart),a=i.bi_valid+42>>3,a=i.pending_buf_size-a>65535?65535:i.pending_buf_size-a,e=a>i.w_size?i.w_size:a,r=i.strstart-i.block_start,(r>=e||(r||t===Za)&&t!==kl&&i.strm.avail_in===0&&r<=a)&&(n=r>a?a:r,s=t===Za&&i.strm.avail_in===0&&n===r?1:0,V2(i,i.block_start,n,s),i.block_start+=n,La(i.strm)),s?C0:ra)},F2=(i,t)=>{let e,n;for(;;){if(i.lookahead<Xs){if(Fc(i),i.lookahead<Xs&&t===kl)return ra;if(i.lookahead===0)break}if(e=0,i.lookahead>=xi&&(i.ins_h=Tl(i,i.ins_h,i.window[i.strstart+xi-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),e!==0&&i.strstart-e<=i.w_size-Xs&&(i.match_length=k3(i,e)),i.match_length>=xi)if(n=El(i,i.strstart-i.match_start,i.match_length-xi),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=xi){i.match_length--;do i.strstart++,i.ins_h=Tl(i,i.ins_h,i.window[i.strstart+xi-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Tl(i,i.ins_h,i.window[i.strstart+1]);else n=El(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(n&&(Ia(i,!1),i.strm.avail_out===0))return ra}return i.insert=i.strstart<xi-1?i.strstart:xi-1,t===Za?(Ia(i,!0),i.strm.avail_out===0?C0:Mc):i.sym_next&&(Ia(i,!1),i.strm.avail_out===0)?ra:Pc},Ec=(i,t)=>{let e,n,r;for(;;){if(i.lookahead<Xs){if(Fc(i),i.lookahead<Xs&&t===kl)return ra;if(i.lookahead===0)break}if(e=0,i.lookahead>=xi&&(i.ins_h=Tl(i,i.ins_h,i.window[i.strstart+xi-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=xi-1,e!==0&&i.prev_length<i.max_lazy_match&&i.strstart-e<=i.w_size-Xs&&(i.match_length=k3(i,e),i.match_length<=5&&(i.strategy===yj||i.match_length===xi&&i.strstart-i.match_start>4096)&&(i.match_length=xi-1)),i.prev_length>=xi&&i.match_length<=i.prev_length){r=i.strstart+i.lookahead-xi,n=El(i,i.strstart-1-i.prev_match,i.prev_length-xi),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=r&&(i.ins_h=Tl(i,i.ins_h,i.window[i.strstart+xi-1]),e=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=xi-1,i.strstart++,n&&(Ia(i,!1),i.strm.avail_out===0))return ra}else if(i.match_available){if(n=El(i,0,i.window[i.strstart-1]),n&&Ia(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return ra}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(n=El(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<xi-1?i.strstart:xi-1,t===Za?(Ia(i,!0),i.strm.avail_out===0?C0:Mc):i.sym_next&&(Ia(i,!1),i.strm.avail_out===0)?ra:Pc},Vj=(i,t)=>{let e,n,r,a,s=i.window;for(;;){if(i.lookahead<=Cl){if(Fc(i),i.lookahead<=Cl&&t===kl)return ra;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=xi&&i.strstart>0&&(r=i.strstart-1,n=s[r],n===s[++r]&&n===s[++r]&&n===s[++r])){a=i.strstart+Cl;do;while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<a);i.match_length=Cl-(a-r),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=xi?(e=El(i,1,i.match_length-xi),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(e=El(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),e&&(Ia(i,!1),i.strm.avail_out===0))return ra}return i.insert=0,t===Za?(Ia(i,!0),i.strm.avail_out===0?C0:Mc):i.sym_next&&(Ia(i,!1),i.strm.avail_out===0)?ra:Pc},Uj=(i,t)=>{let e;for(;;){if(i.lookahead===0&&(Fc(i),i.lookahead===0)){if(t===kl)return ra;break}if(i.match_length=0,e=El(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,e&&(Ia(i,!1),i.strm.avail_out===0))return ra}return i.insert=0,t===Za?(Ia(i,!0),i.strm.avail_out===0?C0:Mc):i.sym_next&&(Ia(i,!1),i.strm.avail_out===0)?ra:Pc};function qs(i,t,e,n,r){this.good_length=i,this.max_lazy=t,this.nice_length=e,this.max_chain=n,this.func=r}var yd=[new qs(0,0,0,0,T3),new qs(4,4,8,4,F2),new qs(4,5,16,8,F2),new qs(4,6,32,32,F2),new qs(4,4,16,16,Ec),new qs(8,16,32,32,Ec),new qs(8,16,128,128,Ec),new qs(8,32,128,256,Ec),new qs(32,128,258,1024,Ec),new qs(32,258,258,4096,Ec)],zj=i=>{i.window_size=2*i.w_size,Sl(i.head),i.max_lazy_match=yd[i.level].max_lazy,i.good_match=yd[i.level].good_length,i.nice_match=yd[i.level].nice_length,i.max_chain_length=yd[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=xi-1,i.match_available=0,i.ins_h=0};function Hj(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=z1,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(Lj*2),this.dyn_dtree=new Uint16Array((2*Pj+1)*2),this.bl_tree=new Uint16Array((2*Mj+1)*2),Sl(this.dyn_ltree),Sl(this.dyn_dtree),Sl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Ij+1),this.heap=new Uint16Array(2*U2+1),Sl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*U2+1),Sl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Id=i=>{if(!i)return 1;let t=i.state;return!t||t.strm!==i||t.status!==Ac&&t.status!==Z2&&t.status!==z2&&t.status!==H2&&t.status!==W2&&t.status!==q2&&t.status!==w0&&t.status!==wd?1:0},A3=i=>{if(Id(i))return y0(i,$s);i.total_in=i.total_out=0,i.data_type=kj;let t=i.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?Z2:t.wrap?Ac:w0,i.adler=t.wrap===2?0:1,t.last_flush=-2,mj(t),Ir},F3=i=>{let t=A3(i);return t===Ir&&zj(i.state),t},Wj=(i,t)=>Id(i)||i.state.wrap!==2?$s:(i.state.gzhead=t,Ir),D3=(i,t,e,n,r,a)=>{if(!i)return $s;let s=1;if(t===wj&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),r<1||r>Tj||e!==z1||n<8||n>15||t<0||t>9||a<0||a>Cj||n===8&&s!==1)return y0(i,$s);n===8&&(n=9);let o=new Hj;return i.state=o,o.strm=i,o.status=Ac,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=r+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+xi-1)/xi),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<r+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=t,o.strategy=a,o.method=e,F3(i)},qj=(i,t)=>D3(i,t,z1,Aj,Fj,Ej),Gj=(i,t)=>{if(Id(i)||t>P4||t<0)return i?y0(i,$s):$s;let e=i.state;if(!i.output||i.avail_in!==0&&!i.input||e.status===wd&&t!==Za)return y0(i,i.avail_out===0?A2:$s);let n=e.last_flush;if(e.last_flush=t,e.pending!==0){if(La(i),i.avail_out===0)return e.last_flush=-1,Ir}else if(i.avail_in===0&&L4(t)<=L4(n)&&t!==Za)return y0(i,A2);if(e.status===wd&&i.avail_in!==0)return y0(i,A2);if(e.status===Ac&&e.wrap===0&&(e.status=w0),e.status===Ac){let r=z1+(e.w_bits-8<<4)<<8,a=-1;if(e.strategy>=M1||e.level<2?a=0:e.level<6?a=1:e.level===6?a=2:a=3,r|=a<<6,e.strstart!==0&&(r|=Rj),r+=31-r%31,bd(e,r),e.strstart!==0&&(bd(e,i.adler>>>16),bd(e,i.adler&65535)),i.adler=1,e.status=w0,La(i),e.pending!==0)return e.last_flush=-1,Ir}if(e.status===Z2){if(i.adler=0,Ni(e,31),Ni(e,139),Ni(e,8),e.gzhead)Ni(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),Ni(e,e.gzhead.time&255),Ni(e,e.gzhead.time>>8&255),Ni(e,e.gzhead.time>>16&255),Ni(e,e.gzhead.time>>24&255),Ni(e,e.level===9?2:e.strategy>=M1||e.level<2?4:0),Ni(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(Ni(e,e.gzhead.extra.length&255),Ni(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(i.adler=_r(i.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=z2;else if(Ni(e,0),Ni(e,0),Ni(e,0),Ni(e,0),Ni(e,0),Ni(e,e.level===9?2:e.strategy>=M1||e.level<2?4:0),Ni(e,Oj),e.status=w0,La(i),e.pending!==0)return e.last_flush=-1,Ir}if(e.status===z2){if(e.gzhead.extra){let r=e.pending,a=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+a>e.pending_buf_size;){let o=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(i.adler=_r(i.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=o,La(i),e.pending!==0)return e.last_flush=-1,Ir;r=0,a-=o}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending+=a,e.gzhead.hcrc&&e.pending>r&&(i.adler=_r(i.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=H2}if(e.status===H2){if(e.gzhead.name){let r=e.pending,a;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(i.adler=_r(i.adler,e.pending_buf,e.pending-r,r)),La(i),e.pending!==0)return e.last_flush=-1,Ir;r=0}e.gzindex<e.gzhead.name.length?a=e.gzhead.name.charCodeAt(e.gzindex++)&255:a=0,Ni(e,a)}while(a!==0);e.gzhead.hcrc&&e.pending>r&&(i.adler=_r(i.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=W2}if(e.status===W2){if(e.gzhead.comment){let r=e.pending,a;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(i.adler=_r(i.adler,e.pending_buf,e.pending-r,r)),La(i),e.pending!==0)return e.last_flush=-1,Ir;r=0}e.gzindex<e.gzhead.comment.length?a=e.gzhead.comment.charCodeAt(e.gzindex++)&255:a=0,Ni(e,a)}while(a!==0);e.gzhead.hcrc&&e.pending>r&&(i.adler=_r(i.adler,e.pending_buf,e.pending-r,r))}e.status=q2}if(e.status===q2){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(La(i),e.pending!==0))return e.last_flush=-1,Ir;Ni(e,i.adler&255),Ni(e,i.adler>>8&255),i.adler=0}if(e.status=w0,La(i),e.pending!==0)return e.last_flush=-1,Ir}if(i.avail_in!==0||e.lookahead!==0||t!==kl&&e.status!==wd){let r=e.level===0?T3(e,t):e.strategy===M1?Uj(e,t):e.strategy===Sj?Vj(e,t):yd[e.level].func(e,t);if((r===C0||r===Mc)&&(e.status=wd),r===ra||r===C0)return i.avail_out===0&&(e.last_flush=-1),Ir;if(r===Pc&&(t===vj?xj(e):t!==P4&&(V2(e,0,0,!1),t===_j&&(Sl(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),La(i),i.avail_out===0))return e.last_flush=-1,Ir}return t!==Za?Ir:e.wrap<=0?M4:(e.wrap===2?(Ni(e,i.adler&255),Ni(e,i.adler>>8&255),Ni(e,i.adler>>16&255),Ni(e,i.adler>>24&255),Ni(e,i.total_in&255),Ni(e,i.total_in>>8&255),Ni(e,i.total_in>>16&255),Ni(e,i.total_in>>24&255)):(bd(e,i.adler>>>16),bd(e,i.adler&65535)),La(i),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?Ir:M4)},$j=i=>{if(Id(i))return $s;let t=i.state.status;return i.state=null,t===w0?y0(i,bj):Ir},Xj=(i,t)=>{let e=t.length;if(Id(i))return $s;let n=i.state,r=n.wrap;if(r===2||r===1&&n.status!==Ac||n.lookahead)return $s;if(r===1&&(i.adler=Dd(i.adler,t,e,0)),n.wrap=0,e>=n.w_size){r===0&&(Sl(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(t.subarray(e-n.w_size,e),0),t=l,e=n.w_size}let a=i.avail_in,s=i.next_in,o=i.input;for(i.avail_in=e,i.next_in=0,i.input=t,Fc(n);n.lookahead>=xi;){let l=n.strstart,c=n.lookahead-(xi-1);do n.ins_h=Tl(n,n.ins_h,n.window[l+xi-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=xi-1,Fc(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=xi-1,n.match_available=0,i.next_in=s,i.input=o,i.avail_in=a,n.wrap=r,Ir},Yj=qj,Kj=D3,Zj=F3,Jj=A3,Qj=Wj,eV=Gj,tV=$j,iV=Xj,nV="pako deflate (from Nodeca project)",Cd={deflateInit:Yj,deflateInit2:Kj,deflateReset:Zj,deflateResetKeep:Jj,deflateSetHeader:Qj,deflate:eV,deflateEnd:tV,deflateSetDictionary:iV,deflateInfo:nV},rV=(i,t)=>Object.prototype.hasOwnProperty.call(i,t),aV=function(i){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(let n in e)rV(e,n)&&(i[n]=e[n])}}return i},sV=i=>{let t=0;for(let n=0,r=i.length;n<r;n++)t+=i[n].length;let e=new Uint8Array(t);for(let n=0,r=0,a=i.length;n<a;n++){let s=i[n];e.set(s,r),r+=s.length}return e},H1={assign:aV,flattenChunks:sV},N3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{N3=!1}var Nd=new Uint8Array(256);for(let i=0;i<256;i++)Nd[i]=i>=252?6:i>=248?5:i>=240?4:i>=224?3:i>=192?2:1;Nd[254]=Nd[254]=1;var oV=i=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(i);let t,e,n,r,a,s=i.length,o=0;for(r=0;r<s;r++)e=i.charCodeAt(r),(e&64512)===55296&&r+1<s&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),r++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(o),a=0,r=0;a<o;r++)e=i.charCodeAt(r),(e&64512)===55296&&r+1<s&&(n=i.charCodeAt(r+1),(n&64512)===56320&&(e=65536+(e-55296<<10)+(n-56320),r++)),e<128?t[a++]=e:e<2048?(t[a++]=192|e>>>6,t[a++]=128|e&63):e<65536?(t[a++]=224|e>>>12,t[a++]=128|e>>>6&63,t[a++]=128|e&63):(t[a++]=240|e>>>18,t[a++]=128|e>>>12&63,t[a++]=128|e>>>6&63,t[a++]=128|e&63);return t},lV=(i,t)=>{if(t<65534&&i.subarray&&N3)return String.fromCharCode.apply(null,i.length===t?i:i.subarray(0,t));let e="";for(let n=0;n<t;n++)e+=String.fromCharCode(i[n]);return e},cV=(i,t)=>{let e=t||i.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(i.subarray(0,t));let n,r,a=new Array(e*2);for(r=0,n=0;n<e;){let s=i[n++];if(s<128){a[r++]=s;continue}let o=Nd[s];if(o>4){a[r++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<e;)s=s<<6|i[n++]&63,o--;if(o>1){a[r++]=65533;continue}s<65536?a[r++]=s:(s-=65536,a[r++]=55296|s>>10&1023,a[r++]=56320|s&1023)}return lV(a,r)},uV=(i,t)=>{t=t||i.length,t>i.length&&(t=i.length);let e=t-1;for(;e>=0&&(i[e]&192)===128;)e--;return e<0||e===0?t:e+Nd[i[e]]>t?e:t},Pd={string2buf:oV,buf2string:cV,utf8border:uV};function dV(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var P3=dV,M3=Object.prototype.toString,{Z_NO_FLUSH:fV,Z_SYNC_FLUSH:hV,Z_FULL_FLUSH:pV,Z_FINISH:mV,Z_OK:V1,Z_STREAM_END:gV,Z_DEFAULT_COMPRESSION:xV,Z_DEFAULT_STRATEGY:vV,Z_DEFLATED:_V}=Nc;function Rd(i){this.options=H1.assign({level:xV,method:_V,chunkSize:16384,windowBits:15,memLevel:8,strategy:vV},i||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P3,this.strm.avail_out=0;let e=Cd.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==V1)throw new Error(S0[e]);if(t.header&&Cd.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Pd.string2buf(t.dictionary):M3.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,e=Cd.deflateSetDictionary(this.strm,n),e!==V1)throw new Error(S0[e]);this._dict_set=!0}}Rd.prototype.push=function(i,t){let e=this.strm,n=this.options.chunkSize,r,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?mV:fV,typeof i=="string"?e.input=Pd.string2buf(i):M3.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),(a===hV||a===pV)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(r=Cd.deflate(e,a),r===gV)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Cd.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===V1;if(e.avail_out===0){this.onData(e.output);continue}if(a>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};Rd.prototype.onData=function(i){this.chunks.push(i)};Rd.prototype.onEnd=function(i){i===V1&&(this.result=H1.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function J2(i,t){let e=new Rd(t);if(e.push(i,!0),e.err)throw e.msg||S0[e.err];return e.result}function bV(i,t){return t=t||{},t.raw=!0,J2(i,t)}function wV(i,t){return t=t||{},t.gzip=!0,J2(i,t)}var yV=Rd,SV=J2,CV=bV,EV=wV,kV=Nc,TV={Deflate:yV,deflate:SV,deflateRaw:CV,gzip:EV,constants:kV},L1=16209,AV=16191,FV=function(t,e){let n,r,a,s,o,l,c,u,h,g,d,b,_,w,E,A,D,N,z,J,W,U,M,X,F=t.state;n=t.next_in,M=t.input,r=n+(t.avail_in-5),a=t.next_out,X=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),l=F.dmax,c=F.wsize,u=F.whave,h=F.wnext,g=F.window,d=F.hold,b=F.bits,_=F.lencode,w=F.distcode,E=(1<<F.lenbits)-1,A=(1<<F.distbits)-1;e:do{b<15&&(d+=M[n++]<<b,b+=8,d+=M[n++]<<b,b+=8),D=_[d&E];t:for(;;){if(N=D>>>24,d>>>=N,b-=N,N=D>>>16&255,N===0)X[a++]=D&65535;else if(N&16){z=D&65535,N&=15,N&&(b<N&&(d+=M[n++]<<b,b+=8),z+=d&(1<<N)-1,d>>>=N,b-=N),b<15&&(d+=M[n++]<<b,b+=8,d+=M[n++]<<b,b+=8),D=w[d&A];i:for(;;){if(N=D>>>24,d>>>=N,b-=N,N=D>>>16&255,N&16){if(J=D&65535,N&=15,b<N&&(d+=M[n++]<<b,b+=8,b<N&&(d+=M[n++]<<b,b+=8)),J+=d&(1<<N)-1,J>l){t.msg="invalid distance too far back",F.mode=L1;break e}if(d>>>=N,b-=N,N=a-s,J>N){if(N=J-N,N>u&&F.sane){t.msg="invalid distance too far back",F.mode=L1;break e}if(W=0,U=g,h===0){if(W+=c-N,N<z){z-=N;do X[a++]=g[W++];while(--N);W=a-J,U=X}}else if(h<N){if(W+=c+h-N,N-=h,N<z){z-=N;do X[a++]=g[W++];while(--N);if(W=0,h<z){N=h,z-=N;do X[a++]=g[W++];while(--N);W=a-J,U=X}}}else if(W+=h-N,N<z){z-=N;do X[a++]=g[W++];while(--N);W=a-J,U=X}for(;z>2;)X[a++]=U[W++],X[a++]=U[W++],X[a++]=U[W++],z-=3;z&&(X[a++]=U[W++],z>1&&(X[a++]=U[W++]))}else{W=a-J;do X[a++]=X[W++],X[a++]=X[W++],X[a++]=X[W++],z-=3;while(z>2);z&&(X[a++]=X[W++],z>1&&(X[a++]=X[W++]))}}else if((N&64)===0){D=w[(D&65535)+(d&(1<<N)-1)];continue i}else{t.msg="invalid distance code",F.mode=L1;break e}break}}else if((N&64)===0){D=_[(D&65535)+(d&(1<<N)-1)];continue t}else if(N&32){F.mode=AV;break e}else{t.msg="invalid literal/length code",F.mode=L1;break e}break}}while(n<r&&a<o);z=b>>3,n-=z,b-=z<<3,d&=(1<<b)-1,t.next_in=n,t.next_out=a,t.avail_in=n<r?5+(r-n):5-(n-r),t.avail_out=a<o?257+(o-a):257-(a-o),F.hold=d,F.bits=b},kc=15,I4=852,R4=592,O4=0,D2=1,B4=2,DV=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),NV=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),PV=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),MV=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),LV=(i,t,e,n,r,a,s,o)=>{let l=o.bits,c=0,u=0,h=0,g=0,d=0,b=0,_=0,w=0,E=0,A=0,D,N,z,J,W,U=null,M,X=new Uint16Array(kc+1),F=new Uint16Array(kc+1),I=null,ee,le,de;for(c=0;c<=kc;c++)X[c]=0;for(u=0;u<n;u++)X[t[e+u]]++;for(d=l,g=kc;g>=1&&X[g]===0;g--);if(d>g&&(d=g),g===0)return r[a++]=1<<24|64<<16|0,r[a++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<g&&X[h]===0;h++);for(d<h&&(d=h),w=1,c=1;c<=kc;c++)if(w<<=1,w-=X[c],w<0)return-1;if(w>0&&(i===O4||g!==1))return-1;for(F[1]=0,c=1;c<kc;c++)F[c+1]=F[c]+X[c];for(u=0;u<n;u++)t[e+u]!==0&&(s[F[t[e+u]]++]=u);if(i===O4?(U=I=s,M=20):i===D2?(U=DV,I=NV,M=257):(U=PV,I=MV,M=0),A=0,u=0,c=h,W=a,b=d,_=0,z=-1,E=1<<d,J=E-1,i===D2&&E>I4||i===B4&&E>R4)return 1;for(;;){ee=c-_,s[u]+1<M?(le=0,de=s[u]):s[u]>=M?(le=I[s[u]-M],de=U[s[u]-M]):(le=96,de=0),D=1<<c-_,N=1<<b,h=N;do N-=D,r[W+(A>>_)+N]=ee<<24|le<<16|de|0;while(N!==0);for(D=1<<c-1;A&D;)D>>=1;if(D!==0?(A&=D-1,A+=D):A=0,u++,--X[c]===0){if(c===g)break;c=t[e+s[u]]}if(c>d&&(A&J)!==z){for(_===0&&(_=d),W+=h,b=c-_,w=1<<b;b+_<g&&(w-=X[b+_],!(w<=0));)b++,w<<=1;if(E+=1<<b,i===D2&&E>I4||i===B4&&E>R4)return 1;z=A&J,r[z]=d<<24|b<<16|W-a|0}}return A!==0&&(r[W+A]=c-_<<24|64<<16|0),o.bits=d,0},Ed=LV,IV=0,L3=1,I3=2,{Z_FINISH:j4,Z_BLOCK:RV,Z_TREES:I1,Z_OK:E0,Z_STREAM_END:OV,Z_NEED_DICT:BV,Z_STREAM_ERROR:Ja,Z_DATA_ERROR:R3,Z_MEM_ERROR:O3,Z_BUF_ERROR:jV,Z_DEFLATED:V4}=Nc,W1=16180,U4=16181,z4=16182,H4=16183,W4=16184,q4=16185,G4=16186,$4=16187,X4=16188,Y4=16189,U1=16190,No=16191,N2=16192,K4=16193,P2=16194,Z4=16195,J4=16196,Q4=16197,e3=16198,R1=16199,O1=16200,t3=16201,i3=16202,n3=16203,r3=16204,a3=16205,M2=16206,s3=16207,o3=16208,gn=16209,B3=16210,j3=16211,VV=852,UV=592,zV=15,HV=zV,l3=i=>(i>>>24&255)+(i>>>8&65280)+((i&65280)<<8)+((i&255)<<24);function WV(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var k0=i=>{if(!i)return 1;let t=i.state;return!t||t.strm!==i||t.mode<W1||t.mode>j3?1:0},V3=i=>{if(k0(i))return Ja;let t=i.state;return i.total_in=i.total_out=t.total=0,i.msg="",t.wrap&&(i.adler=t.wrap&1),t.mode=W1,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(VV),t.distcode=t.distdyn=new Int32Array(UV),t.sane=1,t.back=-1,E0},U3=i=>{if(k0(i))return Ja;let t=i.state;return t.wsize=0,t.whave=0,t.wnext=0,V3(i)},z3=(i,t)=>{let e;if(k0(i))return Ja;let n=i.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ja:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=e,n.wbits=t,U3(i))},H3=(i,t)=>{if(!i)return Ja;let e=new WV;i.state=e,e.strm=i,e.window=null,e.mode=W1;let n=z3(i,t);return n!==E0&&(i.state=null),n},qV=i=>H3(i,HV),c3=!0,L2,I2,GV=i=>{if(c3){L2=new Int32Array(512),I2=new Int32Array(32);let t=0;for(;t<144;)i.lens[t++]=8;for(;t<256;)i.lens[t++]=9;for(;t<280;)i.lens[t++]=7;for(;t<288;)i.lens[t++]=8;for(Ed(L3,i.lens,0,288,L2,0,i.work,{bits:9}),t=0;t<32;)i.lens[t++]=5;Ed(I3,i.lens,0,32,I2,0,i.work,{bits:5}),c3=!1}i.lencode=L2,i.lenbits=9,i.distcode=I2,i.distbits=5},W3=(i,t,e,n)=>{let r,a=i.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(e-a.wsize,e),0),a.wnext=0,a.whave=a.wsize):(r=a.wsize-a.wnext,r>n&&(r=n),a.window.set(t.subarray(e-n,e-n+r),a.wnext),n-=r,n?(a.window.set(t.subarray(e-n,e),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0},$V=(i,t)=>{let e,n,r,a,s,o,l,c,u,h,g,d,b,_,w=0,E,A,D,N,z,J,W,U,M=new Uint8Array(4),X,F,I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(k0(i)||!i.output||!i.input&&i.avail_in!==0)return Ja;e=i.state,e.mode===No&&(e.mode=N2),s=i.next_out,r=i.output,l=i.avail_out,a=i.next_in,n=i.input,o=i.avail_in,c=e.hold,u=e.bits,h=o,g=l,U=E0;e:for(;;)switch(e.mode){case W1:if(e.wrap===0){e.mode=N2;break}for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(e.wrap&2&&c===35615){e.wbits===0&&(e.wbits=15),e.check=0,M[0]=c&255,M[1]=c>>>8&255,e.check=_r(e.check,M,2,0),c=0,u=0,e.mode=U4;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((c&255)<<8)+(c>>8))%31){i.msg="incorrect header check",e.mode=gn;break}if((c&15)!==V4){i.msg="unknown compression method",e.mode=gn;break}if(c>>>=4,u-=4,W=(c&15)+8,e.wbits===0&&(e.wbits=W),W>15||W>e.wbits){i.msg="invalid window size",e.mode=gn;break}e.dmax=1<<e.wbits,e.flags=0,i.adler=e.check=1,e.mode=c&512?Y4:No,c=0,u=0;break;case U4:for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(e.flags=c,(e.flags&255)!==V4){i.msg="unknown compression method",e.mode=gn;break}if(e.flags&57344){i.msg="unknown header flags set",e.mode=gn;break}e.head&&(e.head.text=c>>8&1),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,e.check=_r(e.check,M,2,0)),c=0,u=0,e.mode=z4;case z4:for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.head&&(e.head.time=c),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,M[2]=c>>>16&255,M[3]=c>>>24&255,e.check=_r(e.check,M,4,0)),c=0,u=0,e.mode=H4;case H4:for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.head&&(e.head.xflags=c&255,e.head.os=c>>8),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,e.check=_r(e.check,M,2,0)),c=0,u=0,e.mode=W4;case W4:if(e.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.length=c,e.head&&(e.head.extra_len=c),e.flags&512&&e.wrap&4&&(M[0]=c&255,M[1]=c>>>8&255,e.check=_r(e.check,M,2,0)),c=0,u=0}else e.head&&(e.head.extra=null);e.mode=q4;case q4:if(e.flags&1024&&(d=e.length,d>o&&(d=o),d&&(e.head&&(W=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(n.subarray(a,a+d),W)),e.flags&512&&e.wrap&4&&(e.check=_r(e.check,n,d,a)),o-=d,a+=d,e.length-=d),e.length))break e;e.length=0,e.mode=G4;case G4:if(e.flags&2048){if(o===0)break e;d=0;do W=n[a+d++],e.head&&W&&e.length<65536&&(e.head.name+=String.fromCharCode(W));while(W&&d<o);if(e.flags&512&&e.wrap&4&&(e.check=_r(e.check,n,d,a)),o-=d,a+=d,W)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=$4;case $4:if(e.flags&4096){if(o===0)break e;d=0;do W=n[a+d++],e.head&&W&&e.length<65536&&(e.head.comment+=String.fromCharCode(W));while(W&&d<o);if(e.flags&512&&e.wrap&4&&(e.check=_r(e.check,n,d,a)),o-=d,a+=d,W)break e}else e.head&&(e.head.comment=null);e.mode=X4;case X4:if(e.flags&512){for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(e.wrap&4&&c!==(e.check&65535)){i.msg="header crc mismatch",e.mode=gn;break}c=0,u=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),i.adler=e.check=0,e.mode=No;break;case Y4:for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}i.adler=e.check=l3(c),c=0,u=0,e.mode=U1;case U1:if(e.havedict===0)return i.next_out=s,i.avail_out=l,i.next_in=a,i.avail_in=o,e.hold=c,e.bits=u,BV;i.adler=e.check=1,e.mode=No;case No:if(t===RV||t===I1)break e;case N2:if(e.last){c>>>=u&7,u-=u&7,e.mode=M2;break}for(;u<3;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}switch(e.last=c&1,c>>>=1,u-=1,c&3){case 0:e.mode=K4;break;case 1:if(GV(e),e.mode=R1,t===I1){c>>>=2,u-=2;break e}break;case 2:e.mode=J4;break;case 3:i.msg="invalid block type",e.mode=gn}c>>>=2,u-=2;break;case K4:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){i.msg="invalid stored block lengths",e.mode=gn;break}if(e.length=c&65535,c=0,u=0,e.mode=P2,t===I1)break e;case P2:e.mode=Z4;case Z4:if(d=e.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;r.set(n.subarray(a,a+d),s),o-=d,a+=d,l-=d,s+=d,e.length-=d;break}e.mode=No;break;case J4:for(;u<14;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(e.nlen=(c&31)+257,c>>>=5,u-=5,e.ndist=(c&31)+1,c>>>=5,u-=5,e.ncode=(c&15)+4,c>>>=4,u-=4,e.nlen>286||e.ndist>30){i.msg="too many length or distance symbols",e.mode=gn;break}e.have=0,e.mode=Q4;case Q4:for(;e.have<e.ncode;){for(;u<3;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.lens[I[e.have++]]=c&7,c>>>=3,u-=3}for(;e.have<19;)e.lens[I[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,X={bits:e.lenbits},U=Ed(IV,e.lens,0,19,e.lencode,0,e.work,X),e.lenbits=X.bits,U){i.msg="invalid code lengths set",e.mode=gn;break}e.have=0,e.mode=e3;case e3:for(;e.have<e.nlen+e.ndist;){for(;w=e.lencode[c&(1<<e.lenbits)-1],E=w>>>24,A=w>>>16&255,D=w&65535,!(E<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(D<16)c>>>=E,u-=E,e.lens[e.have++]=D;else{if(D===16){for(F=E+2;u<F;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(c>>>=E,u-=E,e.have===0){i.msg="invalid bit length repeat",e.mode=gn;break}W=e.lens[e.have-1],d=3+(c&3),c>>>=2,u-=2}else if(D===17){for(F=E+3;u<F;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=E,u-=E,W=0,d=3+(c&7),c>>>=3,u-=3}else{for(F=E+7;u<F;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=E,u-=E,W=0,d=11+(c&127),c>>>=7,u-=7}if(e.have+d>e.nlen+e.ndist){i.msg="invalid bit length repeat",e.mode=gn;break}for(;d--;)e.lens[e.have++]=W}}if(e.mode===gn)break;if(e.lens[256]===0){i.msg="invalid code -- missing end-of-block",e.mode=gn;break}if(e.lenbits=9,X={bits:e.lenbits},U=Ed(L3,e.lens,0,e.nlen,e.lencode,0,e.work,X),e.lenbits=X.bits,U){i.msg="invalid literal/lengths set",e.mode=gn;break}if(e.distbits=6,e.distcode=e.distdyn,X={bits:e.distbits},U=Ed(I3,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,X),e.distbits=X.bits,U){i.msg="invalid distances set",e.mode=gn;break}if(e.mode=R1,t===I1)break e;case R1:e.mode=O1;case O1:if(o>=6&&l>=258){i.next_out=s,i.avail_out=l,i.next_in=a,i.avail_in=o,e.hold=c,e.bits=u,FV(i,g),s=i.next_out,r=i.output,l=i.avail_out,a=i.next_in,n=i.input,o=i.avail_in,c=e.hold,u=e.bits,e.mode===No&&(e.back=-1);break}for(e.back=0;w=e.lencode[c&(1<<e.lenbits)-1],E=w>>>24,A=w>>>16&255,D=w&65535,!(E<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(A&&(A&240)===0){for(N=E,z=A,J=D;w=e.lencode[J+((c&(1<<N+z)-1)>>N)],E=w>>>24,A=w>>>16&255,D=w&65535,!(N+E<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=N,u-=N,e.back+=N}if(c>>>=E,u-=E,e.back+=E,e.length=D,A===0){e.mode=a3;break}if(A&32){e.back=-1,e.mode=No;break}if(A&64){i.msg="invalid literal/length code",e.mode=gn;break}e.extra=A&15,e.mode=t3;case t3:if(e.extra){for(F=e.extra;u<F;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.length+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=i3;case i3:for(;w=e.distcode[c&(1<<e.distbits)-1],E=w>>>24,A=w>>>16&255,D=w&65535,!(E<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if((A&240)===0){for(N=E,z=A,J=D;w=e.distcode[J+((c&(1<<N+z)-1)>>N)],E=w>>>24,A=w>>>16&255,D=w&65535,!(N+E<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=N,u-=N,e.back+=N}if(c>>>=E,u-=E,e.back+=E,A&64){i.msg="invalid distance code",e.mode=gn;break}e.offset=D,e.extra=A&15,e.mode=n3;case n3:if(e.extra){for(F=e.extra;u<F;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.offset+=c&(1<<e.extra)-1,c>>>=e.extra,u-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){i.msg="invalid distance too far back",e.mode=gn;break}e.mode=r3;case r3:if(l===0)break e;if(d=g-l,e.offset>d){if(d=e.offset-d,d>e.whave&&e.sane){i.msg="invalid distance too far back",e.mode=gn;break}d>e.wnext?(d-=e.wnext,b=e.wsize-d):b=e.wnext-d,d>e.length&&(d=e.length),_=e.window}else _=r,b=s-e.offset,d=e.length;d>l&&(d=l),l-=d,e.length-=d;do r[s++]=_[b++];while(--d);e.length===0&&(e.mode=O1);break;case a3:if(l===0)break e;r[s++]=e.length,l--,e.mode=O1;break;case M2:if(e.wrap){for(;u<32;){if(o===0)break e;o--,c|=n[a++]<<u,u+=8}if(g-=l,i.total_out+=g,e.total+=g,e.wrap&4&&g&&(i.adler=e.check=e.flags?_r(e.check,r,g,s-g):Dd(e.check,r,g,s-g)),g=l,e.wrap&4&&(e.flags?c:l3(c))!==e.check){i.msg="incorrect data check",e.mode=gn;break}c=0,u=0}e.mode=s3;case s3:if(e.wrap&&e.flags){for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(e.wrap&4&&c!==(e.total&4294967295)){i.msg="incorrect length check",e.mode=gn;break}c=0,u=0}e.mode=o3;case o3:U=OV;break e;case gn:U=R3;break e;case B3:return O3;case j3:default:return Ja}return i.next_out=s,i.avail_out=l,i.next_in=a,i.avail_in=o,e.hold=c,e.bits=u,(e.wsize||g!==i.avail_out&&e.mode<gn&&(e.mode<M2||t!==j4))&&W3(i,i.output,i.next_out,g-i.avail_out),h-=i.avail_in,g-=i.avail_out,i.total_in+=h,i.total_out+=g,e.total+=g,e.wrap&4&&g&&(i.adler=e.check=e.flags?_r(e.check,r,g,i.next_out-g):Dd(e.check,r,g,i.next_out-g)),i.data_type=e.bits+(e.last?64:0)+(e.mode===No?128:0)+(e.mode===R1||e.mode===P2?256:0),(h===0&&g===0||t===j4)&&U===E0&&(U=jV),U},XV=i=>{if(k0(i))return Ja;let t=i.state;return t.window&&(t.window=null),i.state=null,E0},YV=(i,t)=>{if(k0(i))return Ja;let e=i.state;return(e.wrap&2)===0?Ja:(e.head=t,t.done=!1,E0)},KV=(i,t)=>{let e=t.length,n,r,a;return k0(i)||(n=i.state,n.wrap!==0&&n.mode!==U1)?Ja:n.mode===U1&&(r=1,r=Dd(r,t,e,0),r!==n.check)?R3:(a=W3(i,t,e,e),a?(n.mode=B3,O3):(n.havedict=1,E0))},ZV=U3,JV=z3,QV=V3,eU=qV,tU=H3,iU=$V,nU=XV,rU=YV,aU=KV,sU="pako inflate (from Nodeca project)",Mo={inflateReset:ZV,inflateReset2:JV,inflateResetKeep:QV,inflateInit:eU,inflateInit2:tU,inflate:iU,inflateEnd:nU,inflateGetHeader:rU,inflateSetDictionary:aU,inflateInfo:sU};function oU(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var lU=oU,q3=Object.prototype.toString,{Z_NO_FLUSH:cU,Z_FINISH:uU,Z_OK:Md,Z_STREAM_END:R2,Z_NEED_DICT:O2,Z_STREAM_ERROR:dU,Z_DATA_ERROR:u3,Z_MEM_ERROR:fU}=Nc;function Od(i){this.options=H1.assign({chunkSize:1024*64,windowBits:15,to:""},i||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(i&&i.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P3,this.strm.avail_out=0;let e=Mo.inflateInit2(this.strm,t.windowBits);if(e!==Md)throw new Error(S0[e]);if(this.header=new lU,Mo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Pd.string2buf(t.dictionary):q3.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Mo.inflateSetDictionary(this.strm,t.dictionary),e!==Md)))throw new Error(S0[e])}Od.prototype.push=function(i,t){let e=this.strm,n=this.options.chunkSize,r=this.options.dictionary,a,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?uU:cU,q3.call(i)==="[object ArrayBuffer]"?e.input=new Uint8Array(i):e.input=i,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(n),e.next_out=0,e.avail_out=n),a=Mo.inflate(e,s),a===O2&&r&&(a=Mo.inflateSetDictionary(e,r),a===Md?a=Mo.inflate(e,s):a===u3&&(a=O2));e.avail_in>0&&a===R2&&e.state.wrap>0&&i[e.next_in]!==0;)Mo.inflateReset(e),a=Mo.inflate(e,s);switch(a){case dU:case u3:case O2:case fU:return this.onEnd(a),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||a===R2))if(this.options.to==="string"){let l=Pd.utf8border(e.output,e.next_out),c=e.next_out-l,u=Pd.buf2string(e.output,l);e.next_out=c,e.avail_out=n-c,c&&e.output.set(e.output.subarray(l,l+c),0),this.onData(u)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(a===Md&&o===0)){if(a===R2)return a=Mo.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};Od.prototype.onData=function(i){this.chunks.push(i)};Od.prototype.onEnd=function(i){i===Md&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=H1.flattenChunks(this.chunks)),this.chunks=[],this.err=i,this.msg=this.strm.msg};function Q2(i,t){let e=new Od(t);if(e.push(i),e.err)throw e.msg||S0[e.err];return e.result}function hU(i,t){return t=t||{},t.raw=!0,Q2(i,t)}var pU=Od,mU=Q2,gU=hU,xU=Q2,vU=Nc,_U={Inflate:pU,inflate:mU,inflateRaw:gU,ungzip:xU,constants:vU},{Deflate:lZ,deflate:cZ,deflateRaw:uZ,gzip:dZ}=TV,{Inflate:bU,inflate:wU,inflateRaw:fZ,ungzip:hZ}=_U;var ex=bU,G3=wU;var X3=[];for(let i=0;i<256;i++){let t=i;for(let e=0;e<8;e++)t&1?t=3988292384^t>>>1:t=t>>>1;X3[i]=t}var $3=4294967295;function yU(i,t,e){let n=i;for(let r=0;r<e;r++)n=X3[(n^t[r])&255]^n>>>8;return n}function SU(i,t){return(yU($3,i,t)^$3)>>>0}function tx(i,t,e){let n=i.readUint32(),r=SU(new Uint8Array(i.buffer,i.byteOffset+i.offset-t-4,t),t);if(r!==n)throw new Error(`CRC mismatch for chunk ${e}. Expected ${n}, found ${r}`)}function q1(i,t,e){for(let n=0;n<e;n++)t[n]=i[n]}function G1(i,t,e,n){let r=0;for(;r<n;r++)t[r]=i[r];for(;r<e;r++)t[r]=i[r]+t[r-n]&255}function $1(i,t,e,n){let r=0;if(e.length===0)for(;r<n;r++)t[r]=i[r];else for(;r<n;r++)t[r]=i[r]+e[r]&255}function X1(i,t,e,n,r){let a=0;if(e.length===0){for(;a<r;a++)t[a]=i[a];for(;a<n;a++)t[a]=i[a]+(t[a-r]>>1)&255}else{for(;a<r;a++)t[a]=i[a]+(e[a]>>1)&255;for(;a<n;a++)t[a]=i[a]+(t[a-r]+e[a]>>1)&255}}function Y1(i,t,e,n,r){let a=0;if(e.length===0){for(;a<r;a++)t[a]=i[a];for(;a<n;a++)t[a]=i[a]+t[a-r]&255}else{for(;a<r;a++)t[a]=i[a]+e[a]&255;for(;a<n;a++)t[a]=i[a]+CU(t[a-r],e[a],e[a-r])&255}}function CU(i,t,e){let n=i+t-e,r=Math.abs(n-i),a=Math.abs(n-t),s=Math.abs(n-e);return r<=a&&r<=s?i:a<=s?t:e}function Y3(i,t,e,n,r,a){switch(i){case 0:q1(t,e,r);break;case 1:G1(t,e,r,a);break;case 2:$1(t,e,n,r);break;case 3:X1(t,e,n,r,a);break;case 4:Y1(t,e,n,r,a);break;default:throw new Error(`Unsupported filter: ${i}`)}}var EU=new Uint16Array([255]),kU=new Uint8Array(EU.buffer),TU=kU[0]===255;function K3(i){let{data:t,width:e,height:n,channels:r,depth:a}=i,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*r,l=new Uint8Array(n*e*o),c=0;for(let u=0;u<7;u++){let h=s[u],g=Math.ceil((e-h.x)/h.xStep),d=Math.ceil((n-h.y)/h.yStep);if(g<=0||d<=0)continue;let b=g*o,_=new Uint8Array(b);for(let w=0;w<d;w++){let E=t[c++],A=t.subarray(c,c+b);c+=b;let D=new Uint8Array(b);Y3(E,A,D,_,b,o),_.set(D);for(let N=0;N<g;N++){let z=h.x+N*h.xStep,J=h.y+w*h.yStep;if(!(z>=e||J>=n))for(let W=0;W<o;W++)l[(J*e+z)*o+W]=D[N*o+W]}}}if(a===16){let u=new Uint16Array(l.buffer);if(TU)for(let h=0;h<u.length;h++)u[h]=AU(u[h]);return u}else return l}function AU(i){return(i&255)<<8|i>>8&255}var FU=new Uint16Array([255]),DU=new Uint8Array(FU.buffer),NU=DU[0]===255,PU=new Uint8Array(0);function ix(i){let{data:t,width:e,height:n,channels:r,depth:a}=i,s=Math.ceil(a/8)*r,o=Math.ceil(a/8*r*e),l=new Uint8Array(n*o),c=PU,u=0,h,g;for(let d=0;d<n;d++){switch(h=t.subarray(u+1,u+1+o),g=l.subarray(d*o,(d+1)*o),t[u]){case 0:q1(h,g,o);break;case 1:G1(h,g,o,s);break;case 2:$1(h,g,c,o);break;case 3:X1(h,g,c,o,s);break;case 4:Y1(h,g,c,o,s);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}c=g,u+=o+1}if(a===16){let d=new Uint16Array(l.buffer);if(NU)for(let b=0;b<d.length;b++)d[b]=MU(d[b]);return d}else return l}function MU(i){return(i&255)<<8|i>>8&255}var K1=Uint8Array.of(137,80,78,71,13,10,26,10);function nx(i){if(!Z3(i.readBytes(K1.length)))throw new Error("wrong PNG signature")}function Z3(i){if(i.length<K1.length)return!1;for(let t=0;t<K1.length;t++)if(i[t]!==K1[t])return!1;return!0}var J3="tEXt",IU=0,Q3=new TextDecoder("latin1");function RU(i){if(BU(i),i.length===0||i.length>79)throw new Error("keyword length must be between 1 and 79")}var OU=/^[\u0000-\u00FF]*$/;function BU(i){if(!OU.test(i))throw new Error("invalid latin1 text")}function eS(i,t,e){let n=rx(t);i[n]=jU(t,e-n.length-1)}function rx(i){for(i.mark();i.readByte()!==IU;);let t=i.offset;i.reset();let e=Q3.decode(i.readBytes(t-i.offset-1));return i.skip(1),RU(e),e}function jU(i,t){return Q3.decode(i.readBytes(t))}var aa={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Bd={UNKNOWN:-1,DEFLATE:0},Z1={UNKNOWN:-1,ADAPTIVE:0},jd={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Vd={NONE:0,BACKGROUND:1,PREVIOUS:2},J1={SOURCE:0,OVER:1};var Q1=class extends _d{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,e={}){super(t);let{checkCrc:n=!1}=e;this._checkCrc=n,this._inflator=new ex,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Bd.UNKNOWN,this._filterMethod=Z1.UNKNOWN,this._interlaceMethod=jd.UNKNOWN,this._colorType=aa.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(nx(this);!this._end;){let t=this.readUint32(),e=this.readChars(4);this.decodeChunk(t,e)}return this.decodeImage(),this._png}decodeApng(){for(nx(this);!this._end;){let t=this.readUint32(),e=this.readChars(4);this.decodeApngChunk(t,e)}return this.decodeApngImage(),this._apng}decodeChunk(t,e){let n=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case J3:eS(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?tx(this,t+4,e):this.skip(4)}decodeApngChunk(t,e){let n=this.offset;switch(e!=="fdAT"&&e!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),e){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,e),this.offset=n+t;break}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);this._checkCrc?tx(this,t+4,e):this.skip(4)}decodeIHDR(){let t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=VU(this.readUint8());let e=this.readUint8();this._colorType=e;let n;switch(e){case aa.GREYSCALE:n=1;break;case aa.TRUECOLOUR:n=3;break;case aa.INDEXED_COLOUR:n=1;break;case aa.GREYSCALE_ALPHA:n=2;break;case aa.TRUECOLOUR_ALPHA:n=4;break;case aa.UNKNOWN:default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==Bd.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){let t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);let e=t/3;this._hasPalette=!0;let n=[];this._palette=n;for(let r=0;r<e;r++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;let e=t,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let e=t,n=this.offset+this.byteOffset;if(n+=4,e-=4,this._inflator.push(new Uint8Array(this.buffer,n,e)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case aa.GREYSCALE:case aa.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break}case aa.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){let n=this.readByte();this._palette[e].push(n)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}case aa.UNKNOWN:case aa.GREYSCALE_ALPHA:case aa.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e=rx(this),n=this.readUint8();if(n!==Bd.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);let r=this.readBytes(t-e.length-2);this._png.iccEmbeddedProfile={name:e,profile:G3(r)}}decodepHYs(){let t=this.readUint32(),e=this.readUint32(),n=this.readByte();this._png.resolution={x:t,y:e,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){let e={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(t);if(n){if(n.data=ix({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)e.data=n.data;else{let r=this._apng.frames.at(t-1);this.disposeFrame(n,r,e),this.addFrameDataToCanvas(e,n)}this._apng.frames.push(e)}}return this._apng}disposeFrame(t,e,n){switch(t.disposeOp){case Vd.NONE:break;case Vd.BACKGROUND:for(let r=0;r<this._png.height;r++)for(let a=0;a<this._png.width;a++){let s=(r*t.width+a)*this._png.channels;for(let o=0;o<this._png.channels;o++)n.data[s+o]=0}break;case Vd.PREVIOUS:n.data.set(e.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,e){let n=1<<this._png.depth,r=(a,s)=>{let o=((a+e.yOffset)*this._png.width+e.xOffset+s)*this._png.channels,l=(a*e.width+s)*this._png.channels;return{index:o,frameIndex:l}};switch(e.blendOp){case J1.SOURCE:for(let a=0;a<e.height;a++)for(let s=0;s<e.width;s++){let{index:o,frameIndex:l}=r(a,s);for(let c=0;c<this._png.channels;c++)t.data[o+c]=e.data[l+c]}break;case J1.OVER:for(let a=0;a<e.height;a++)for(let s=0;s<e.width;s++){let{index:o,frameIndex:l}=r(a,s);for(let c=0;c<this._png.channels;c++){let u=e.data[l+this._png.channels-1]/n,h=c%(this._png.channels-1)===0?1:e.data[l+c],g=Math.floor(u*h+(1-u)*t.data[o+c]);t.data[o+c]+=g}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);let t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==Z1.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===jd.NO_INTERLACE)this._png.data=ix({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===jd.ADAM7)this._png.data=K3({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){let t=this._inflator.result,e=this._frames.at(-1);e?e.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Vd.NONE,blendOp:J1.SOURCE,data:t}),this._inflator=new ex,this._writingDataChunks=!1}};function VU(i){if(i!==1&&i!==2&&i!==4&&i!==8&&i!==16)throw new Error(`invalid bit depth: ${i}`);return i}function tS(i,t){return new Q1(i,t).decode()}var Xt=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function ax(){Xt.console&&typeof Xt.console.log=="function"&&Xt.console.log.apply(Xt.console,arguments)}var Qi={log:ax,warn:function(i){Xt.console&&(typeof Xt.console.warn=="function"?Xt.console.warn.apply(Xt.console,arguments):ax.call(null,arguments))},error:function(i){Xt.console&&(typeof Xt.console.error=="function"?Xt.console.error.apply(Xt.console,arguments):ax(i))}};function sx(i,t,e){var n=new XMLHttpRequest;n.open("GET",i),n.responseType="blob",n.onload=function(){T0(n.response,t,e)},n.onerror=function(){Qi.error("could not download file")},n.send()}function iS(i){var t=new XMLHttpRequest;t.open("HEAD",i,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function ep(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(t)}}var T0=Xt.saveAs||((typeof window>"u"?"undefined":Gi(window))!=="object"||window!==Xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(i,t,e){var n=Xt.URL||Xt.webkitURL,r=document.createElement("a");t=t||i.name||"download",r.download=t,r.rel="noopener",typeof i=="string"?(r.href=i,r.origin!==location.origin?iS(r.href)?sx(i,t,e):ep(r,r.target="_blank"):ep(r)):(r.href=n.createObjectURL(i),setTimeout(function(){n.revokeObjectURL(r.href)},4e4),setTimeout(function(){ep(r)},0))}:"msSaveOrOpenBlob"in navigator?function(i,t,e){if(t=t||i.name||"download",typeof i=="string")if(iS(i))sx(i,t,e);else{var n=document.createElement("a");n.href=i,n.target="_blank",setTimeout(function(){ep(n)})}else navigator.msSaveOrOpenBlob((function(r,a){return a===void 0?a={autoBom:!1}:Gi(a)!=="object"&&(Qi.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r})(i,e),t)}:function(i,t,e,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof i=="string")return sx(i,t,e);var r=i.type==="application/octet-stream",a=/constructor/i.test(Xt.HTMLElement)||Xt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||r&&a)&&(typeof FileReader>"u"?"undefined":Gi(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(i)}else{var l=Xt.URL||Xt.webkitURL,c=l.createObjectURL(i);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function kS(i){var t;i=i||"",this.ok=!1,i.charAt(0)=="#"&&(i=i.substr(1,6)),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[i=(i=i.replace(/ /g,"")).toLowerCase()]||i;for(var e=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<e.length;n++){var r=e[n].re,a=e[n].process,s=r.exec(i);s&&(t=a(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var rp=Xt.atob.bind(Xt),nS=Xt.btoa.bind(Xt);function ox(i,t){var e=i[0],n=i[1],r=i[2],a=i[3];e=qr(e,n,r,a,t[0],7,-680876936),a=qr(a,e,n,r,t[1],12,-389564586),r=qr(r,a,e,n,t[2],17,606105819),n=qr(n,r,a,e,t[3],22,-1044525330),e=qr(e,n,r,a,t[4],7,-176418897),a=qr(a,e,n,r,t[5],12,1200080426),r=qr(r,a,e,n,t[6],17,-1473231341),n=qr(n,r,a,e,t[7],22,-45705983),e=qr(e,n,r,a,t[8],7,1770035416),a=qr(a,e,n,r,t[9],12,-1958414417),r=qr(r,a,e,n,t[10],17,-42063),n=qr(n,r,a,e,t[11],22,-1990404162),e=qr(e,n,r,a,t[12],7,1804603682),a=qr(a,e,n,r,t[13],12,-40341101),r=qr(r,a,e,n,t[14],17,-1502002290),e=Gr(e,n=qr(n,r,a,e,t[15],22,1236535329),r,a,t[1],5,-165796510),a=Gr(a,e,n,r,t[6],9,-1069501632),r=Gr(r,a,e,n,t[11],14,643717713),n=Gr(n,r,a,e,t[0],20,-373897302),e=Gr(e,n,r,a,t[5],5,-701558691),a=Gr(a,e,n,r,t[10],9,38016083),r=Gr(r,a,e,n,t[15],14,-660478335),n=Gr(n,r,a,e,t[4],20,-405537848),e=Gr(e,n,r,a,t[9],5,568446438),a=Gr(a,e,n,r,t[14],9,-1019803690),r=Gr(r,a,e,n,t[3],14,-187363961),n=Gr(n,r,a,e,t[8],20,1163531501),e=Gr(e,n,r,a,t[13],5,-1444681467),a=Gr(a,e,n,r,t[2],9,-51403784),r=Gr(r,a,e,n,t[7],14,1735328473),e=$r(e,n=Gr(n,r,a,e,t[12],20,-1926607734),r,a,t[5],4,-378558),a=$r(a,e,n,r,t[8],11,-2022574463),r=$r(r,a,e,n,t[11],16,1839030562),n=$r(n,r,a,e,t[14],23,-35309556),e=$r(e,n,r,a,t[1],4,-1530992060),a=$r(a,e,n,r,t[4],11,1272893353),r=$r(r,a,e,n,t[7],16,-155497632),n=$r(n,r,a,e,t[10],23,-1094730640),e=$r(e,n,r,a,t[13],4,681279174),a=$r(a,e,n,r,t[0],11,-358537222),r=$r(r,a,e,n,t[3],16,-722521979),n=$r(n,r,a,e,t[6],23,76029189),e=$r(e,n,r,a,t[9],4,-640364487),a=$r(a,e,n,r,t[12],11,-421815835),r=$r(r,a,e,n,t[15],16,530742520),e=Xr(e,n=$r(n,r,a,e,t[2],23,-995338651),r,a,t[0],6,-198630844),a=Xr(a,e,n,r,t[7],10,1126891415),r=Xr(r,a,e,n,t[14],15,-1416354905),n=Xr(n,r,a,e,t[5],21,-57434055),e=Xr(e,n,r,a,t[12],6,1700485571),a=Xr(a,e,n,r,t[3],10,-1894986606),r=Xr(r,a,e,n,t[10],15,-1051523),n=Xr(n,r,a,e,t[1],21,-2054922799),e=Xr(e,n,r,a,t[8],6,1873313359),a=Xr(a,e,n,r,t[15],10,-30611744),r=Xr(r,a,e,n,t[6],15,-1560198380),n=Xr(n,r,a,e,t[13],21,1309151649),e=Xr(e,n,r,a,t[4],6,-145523070),a=Xr(a,e,n,r,t[11],10,-1120210379),r=Xr(r,a,e,n,t[2],15,718787259),n=Xr(n,r,a,e,t[9],21,-343485551),i[0]=Fl(e,i[0]),i[1]=Fl(n,i[1]),i[2]=Fl(r,i[2]),i[3]=Fl(a,i[3])}function dp(i,t,e,n,r,a){return t=Fl(Fl(t,i),Fl(n,a)),Fl(t<<r|t>>>32-r,e)}function qr(i,t,e,n,r,a,s){return dp(t&e|~t&n,i,t,r,a,s)}function Gr(i,t,e,n,r,a,s){return dp(t&n|e&~n,i,t,r,a,s)}function $r(i,t,e,n,r,a,s){return dp(t^e^n,i,t,r,a,s)}function Xr(i,t,e,n,r,a,s){return dp(e^(t|~n),i,t,r,a,s)}function TS(i){var t,e=i.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=i.length;t+=64)ox(n,UU(i.substring(t-64,t)));i=i.substring(t-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i.length;t++)r[t>>2]|=i.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(ox(n,r),t=0;t<16;t++)r[t]=0;return r[14]=8*e,ox(n,r),n}function UU(i){var t,e=[];for(t=0;t<64;t+=4)e[t>>2]=i.charCodeAt(t)+(i.charCodeAt(t+1)<<8)+(i.charCodeAt(t+2)<<16)+(i.charCodeAt(t+3)<<24);return e}var rS="0123456789abcdef".split("");function zU(i){for(var t="",e=0;e<4;e++)t+=rS[i>>8*e+4&15]+rS[i>>8*e&15];return t}function HU(i){return String.fromCharCode(255&i,(65280&i)>>8,(16711680&i)>>16,(4278190080&i)>>24)}function hx(i){return TS(i).map(HU).join("")}var WU=(function(i){for(var t=0;t<i.length;t++)i[t]=zU(i[t]);return i.join("")})(TS("hello"))!="5d41402abc4b2a76b9719d911017c592";function Fl(i,t){if(WU){var e=(65535&i)+(65535&t);return(i>>16)+(t>>16)+(e>>16)<<16|65535&e}return i+t&4294967295}function px(i,t){var e,n,r,a;if(i!==e){for(var s=(r=i,a=1+(256/i.length|0),new Array(a+1).join(r)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}e=i,n=o}else o=n;var h=t.length,g=0,d=0,b="";for(l=0;l<h;l++)d=(d+(u=o[g=(g+1)%256]))%256,o[g]=o[d],o[d]=u,s=o[(o[g]+o[d])%256],b+=String.fromCharCode(t.charCodeAt(l)^s);return b}var aS={print:4,modify:8,copy:16,"annot-forms":32};function Rc(i,t,e,n){this.v=1,this.r=2;var r=192;i.forEach(function(o){if(aS.perm!==void 0)throw new Error("Invalid permission: "+o);r+=aS[o]}),this.padding="(\xBFN^Nu\x8AAd\0NV\xFF\xFA\b..\0\xB6\xD0h>\x80/\f\xA9\xFEdSiz";var a=(t+this.padding).substr(0,32),s=(e+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^r)),this.encryptionKey=hx(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=px(this.encryptionKey,this.padding)}function Oc(i){if(/[^\u0000-\u00ff]/.test(i))throw new Error("Invalid PDF Name Object: "+i+", Only accept ASCII characters.");for(var t="",e=i.length,n=0;n<e;n++){var r=i.charCodeAt(n);t+=r<33||r===35||r===37||r===40||r===41||r===47||r===60||r===62||r===91||r===93||r===123||r===125||r>126?"#"+("0"+r.toString(16)).slice(-2):i[n]}return t}function sS(i){if(Gi(i)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,n,r){if(r=r||!1,typeof e!="string"||typeof n!="function"||typeof r!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var a=Math.random().toString(35);return t[e][a]=[n,!!r],a},this.unsubscribe=function(e){for(var n in t)if(t[n][e])return delete t[n][e],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(e){if(t.hasOwnProperty(e)){var n=Array.prototype.slice.call(arguments,1),r=[];for(var a in t[e]){var s=t[e][a];try{s[0].apply(i,n)}catch(o){Xt.console&&Qi.error("jsPDF PubSub Error",o.message,o)}s[1]&&r.push(a)}r.length&&r.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function cp(i){if(!(this instanceof cp))return new cp(i);var t="opacity,stroke-opacity".split(",");for(var e in i)i.hasOwnProperty(e)&&t.indexOf(e)>=0&&(this[e]=i[e]);this.id="",this.objectNumber=-1}function AS(i,t){this.gState=i,this.matrix=t,this.id="",this.objectNumber=-1}function A0(i,t,e,n,r){if(!(this instanceof A0))return new A0(i,t,e,n,r);this.type=i==="axial"?2:3,this.coords=t,this.colors=e,AS.call(this,n,r)}function Bc(i,t,e,n,r){if(!(this instanceof Bc))return new Bc(i,t,e,n,r);this.boundingBox=i,this.xStep=t,this.yStep=e,this.stream="",this.cloneIndex=0,AS.call(this,n,r)}function _t(i){var t,e=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],r=arguments[2],a=arguments[3],s=[],o=1,l=16,c="S",u=null;Gi(i=i||{})==="object"&&(e=i.orientation,n=i.unit||n,r=i.format||r,a=i.compress||i.compressPdf||a,(u=i.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof i.userUnit=="number"?Math.abs(i.userUnit):1,i.precision!==void 0&&(t=i.precision),i.floatPrecision!==void 0&&(l=i.floatPrecision),c=i.defaultPathOperation||"S"),s=i.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",e=(""+(e||"P")).toLowerCase();var h=i.putOnlyUsedFonts||!1,g={},d={internal:{},__private__:{}};d.__private__.PubSub=sS;var b="1.3",_=d.__private__.getPdfVersion=function(){return b};d.__private__.setPdfVersion=function(y){b=y};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return w};var E=d.__private__.getPageFormat=function(y){return w[y]};r=r||"a4";var A="compat",D="advanced",N=A;function z(){this.saveGraphicsState(),oe(new Ot(Vt,0,0,-Vt,0,jl()*Vt).toString()+" cm"),this.setFontSize(this.getFontSize()/Vt),c="n",N=D}function J(){this.restoreGraphicsState(),c="S",N=A}var W=d.__private__.combineFontStyleAndFontWeight=function(y,L){if(y=="bold"&&L=="normal"||y=="bold"&&L==400||y=="normal"&&L=="italic"||y=="bold"&&L=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return L&&(y=L==400||L==="normal"?y==="italic"?"italic":"normal":L!=700&&L!=="bold"||y!=="normal"?(L==700?"bold":L)+""+y:"bold"),y};d.advancedAPI=function(y){var L=N===A;return L&&z.call(this),typeof y!="function"||(y(this),L&&J.call(this)),this},d.compatAPI=function(y){var L=N===D;return L&&J.call(this),typeof y!="function"||(y(this),L&&z.call(this)),this},d.isAdvancedAPI=function(){return N===D};var U,M=function(y){if(N!==D)throw new Error(y+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},X=d.roundToPrecision=d.__private__.roundToPrecision=function(y,L){var ae=t||L;if(isNaN(y)||isNaN(ae))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return y.toFixed(ae).replace(/0+$/,"")};U=d.hpf=d.__private__.hpf=typeof l=="number"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return X(y,l)}:l==="smart"?function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return X(y,y>-1&&y<1?16:5)}:function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.hpf");return X(y,16)};var F=d.f2=d.__private__.f2=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f2");return X(y,2)},I=d.__private__.f3=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.f3");return X(y,3)},ee=d.scale=d.__private__.scale=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.scale");return N===A?y*Vt:N===D?y:void 0},le=function(y){return ee((function(L){return N===A?jl()-L:N===D?L:void 0})(y))};d.__private__.setPrecision=d.setPrecision=function(y){typeof parseInt(y,10)=="number"&&(t=parseInt(y,10))};var de,ke="00000000000000000000000000000000",Fe=d.__private__.getFileId=function(){return ke},Se=d.__private__.setFileId=function(y){return ke=y!==void 0&&/^[a-fA-F0-9]{32}$/.test(y)?y.toUpperCase():ke.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(An=new Rc(u.userPermissions,u.userPassword,u.ownerPassword,ke)),ke};d.setFileId=function(y){return Se(y),this},d.getFileId=function(){return Fe()};var Oe=d.__private__.convertDateToPDFDate=function(y){var L=y.getTimezoneOffset(),ae=L<0?"+":"-",he=Math.floor(Math.abs(L/60)),Ee=Math.abs(L%60),Ye=[ae,P(he),"'",P(Ee),"'"].join("");return["D:",y.getFullYear(),P(y.getMonth()+1),P(y.getDate()),P(y.getHours()),P(y.getMinutes()),P(y.getSeconds()),Ye].join("")},Ze=d.__private__.convertPDFDateToDate=function(y){var L=parseInt(y.substr(2,4),10),ae=parseInt(y.substr(6,2),10)-1,he=parseInt(y.substr(8,2),10),Ee=parseInt(y.substr(10,2),10),Ye=parseInt(y.substr(12,2),10),it=parseInt(y.substr(14,2),10);return new Date(L,ae,he,Ee,Ye,it,0)},qe=d.__private__.setCreationDate=function(y){var L;if(y===void 0&&(y=new Date),y instanceof Date)L=Oe(y);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(y))throw new Error("Invalid argument passed to jsPDF.setCreationDate");L=y}return de=L},k=d.__private__.getCreationDate=function(y){var L=de;return y==="jsDate"&&(L=Ze(de)),L};d.setCreationDate=function(y){return qe(y),this},d.getCreationDate=function(y){return k(y)};var B,P=d.__private__.padd2=function(y){return("0"+parseInt(y)).slice(-2)},O=d.__private__.padd2Hex=function(y){return("00"+(y=y.toString())).substr(y.length)},Q=0,fe=[],ye=[],pe=0,ge=[],Xe=[],Je=!1,ut=ye;d.__private__.setCustomOutputDestination=function(y){Je=!0,ut=y};var Ne=function(y){Je||(ut=y)};d.__private__.resetCustomOutputDestination=function(){Je=!1,ut=ye};var oe=d.__private__.out=function(y){return y=y.toString(),pe+=y.length+1,ut.push(y),ut},Ft=d.__private__.write=function(y){return oe(arguments.length===1?y.toString():Array.prototype.join.call(arguments," "))},et=d.__private__.getArrayBuffer=function(y){for(var L=y.length,ae=new ArrayBuffer(L),he=new Uint8Array(ae);L--;)he[L]=y.charCodeAt(L);return ae},bt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return bt};var rt=i.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(y){return rt=N===D?y/Vt:y,this};var yt,mt=d.__private__.getFontSize=d.getFontSize=function(){return N===A?rt:rt*Vt},Jt=i.R2L||!1;d.__private__.setR2L=d.setR2L=function(y){return Jt=y,this},d.__private__.getR2L=d.getR2L=function(){return Jt};var Nt,ri=d.__private__.setZoomMode=function(y){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(y))yt=y;else if(isNaN(y)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(y)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+y+'" is not recognized.');yt=y}else yt=parseInt(y,10)};d.__private__.getZoomMode=function(){return yt};var qt,Gt=d.__private__.setPageMode=function(y){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(y)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+y+'" is not recognized.');Nt=y};d.__private__.getPageMode=function(){return Nt};var Ci=d.__private__.setLayoutMode=function(y){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(y)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+y+'" is not recognized.');qt=y};d.__private__.getLayoutMode=function(){return qt},d.__private__.setDisplayMode=d.setDisplayMode=function(y,L,ae){return ri(y),Ci(L),Gt(ae),this};var jt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(y){if(Object.keys(jt).indexOf(y)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return jt[y]},d.__private__.getDocumentProperties=function(){return jt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(y){for(var L in jt)jt.hasOwnProperty(L)&&y[L]&&(jt[L]=y[L]);return this},d.__private__.setDocumentProperty=function(y,L){if(Object.keys(jt).indexOf(y)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return jt[y]=L};var Lt,Vt,Pt,Ri,vi,Et={},Yt={},Oi=[],Rt={},ci={},Kt={},fn={},Tn=null,Bi=0,Ut=[],Ei=new sS(d),Js=i.hotfixes||[],sr={},Qa={},Ra=[],Ot=function y(L,ae,he,Ee,Ye,it){if(!(this instanceof y))return new y(L,ae,he,Ee,Ye,it);isNaN(L)&&(L=1),isNaN(ae)&&(ae=0),isNaN(he)&&(he=0),isNaN(Ee)&&(Ee=1),isNaN(Ye)&&(Ye=0),isNaN(it)&&(it=0),this._matrix=[L,ae,he,Ee,Ye,it]};Object.defineProperty(Ot.prototype,"sx",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(Ot.prototype,"shy",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(Ot.prototype,"shx",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(Ot.prototype,"sy",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(Ot.prototype,"tx",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(Ot.prototype,"ty",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(Ot.prototype,"a",{get:function(){return this._matrix[0]},set:function(y){this._matrix[0]=y}}),Object.defineProperty(Ot.prototype,"b",{get:function(){return this._matrix[1]},set:function(y){this._matrix[1]=y}}),Object.defineProperty(Ot.prototype,"c",{get:function(){return this._matrix[2]},set:function(y){this._matrix[2]=y}}),Object.defineProperty(Ot.prototype,"d",{get:function(){return this._matrix[3]},set:function(y){this._matrix[3]=y}}),Object.defineProperty(Ot.prototype,"e",{get:function(){return this._matrix[4]},set:function(y){this._matrix[4]=y}}),Object.defineProperty(Ot.prototype,"f",{get:function(){return this._matrix[5]},set:function(y){this._matrix[5]=y}}),Object.defineProperty(Ot.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ot.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ot.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ot.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ot.prototype.join=function(y){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(U).join(y)},Ot.prototype.multiply=function(y){var L=y.sx*this.sx+y.shy*this.shx,ae=y.sx*this.shy+y.shy*this.sy,he=y.shx*this.sx+y.sy*this.shx,Ee=y.shx*this.shy+y.sy*this.sy,Ye=y.tx*this.sx+y.ty*this.shx+this.tx,it=y.tx*this.shy+y.ty*this.sy+this.ty;return new Ot(L,ae,he,Ee,Ye,it)},Ot.prototype.decompose=function(){var y=this.sx,L=this.shy,ae=this.shx,he=this.sy,Ee=this.tx,Ye=this.ty,it=Math.sqrt(y*y+L*L),Ct=(y/=it)*ae+(L/=it)*he;ae-=y*Ct,he-=L*Ct;var Dt=Math.sqrt(ae*ae+he*he);return Ct/=Dt,y*(he/=Dt)<L*(ae/=Dt)&&(y=-y,L=-L,Ct=-Ct,it=-it),{scale:new Ot(it,0,0,Dt,0,0),translate:new Ot(1,0,0,1,Ee,Ye),rotate:new Ot(y,L,-L,y,0,0),skew:new Ot(1,0,Ct,1,0,0)}},Ot.prototype.toString=function(y){return this.join(" ")},Ot.prototype.inversed=function(){var y=this.sx,L=this.shy,ae=this.shx,he=this.sy,Ee=this.tx,Ye=this.ty,it=1/(y*he-L*ae),Ct=he*it,Dt=-L*it,Zt=-ae*it,ti=y*it;return new Ot(Ct,Dt,Zt,ti,-Ct*Ee-Zt*Ye,-Dt*Ee-ti*Ye)},Ot.prototype.applyToPoint=function(y){var L=y.x*this.sx+y.y*this.shx+this.tx,ae=y.x*this.shy+y.y*this.sy+this.ty;return new Ol(L,ae)},Ot.prototype.applyToRectangle=function(y){var L=this.applyToPoint(y),ae=this.applyToPoint(new Ol(y.x+y.w,y.y+y.h));return new Zc(L.x,L.y,ae.x-L.x,ae.y-L.y)},Ot.prototype.clone=function(){var y=this.sx,L=this.shy,ae=this.shx,he=this.sy,Ee=this.tx,Ye=this.ty;return new Ot(y,L,ae,he,Ee,Ye)},d.Matrix=Ot;var es=d.matrixMult=function(y,L){return L.multiply(y)},ts=new Ot(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=ts;var Rr=function(y,L){if(!ci[y]){var ae=(L instanceof A0?"Sh":"P")+(Object.keys(Rt).length+1).toString(10);L.id=ae,ci[y]=ae,Rt[ae]=L,Ei.publish("addPattern",L)}};d.ShadingPattern=A0,d.TilingPattern=Bc,d.addShadingPattern=function(y,L){return M("addShadingPattern()"),Rr(y,L),this},d.beginTilingPattern=function(y){M("beginTilingPattern()"),Jc(y.boundingBox[0],y.boundingBox[1],y.boundingBox[2]-y.boundingBox[0],y.boundingBox[3]-y.boundingBox[1],y.matrix)},d.endTilingPattern=function(y,L){M("endTilingPattern()"),L.stream=Xe[B].join(`
`),Rr(y,L),Ei.publish("endTilingPattern",L),Ra.pop().restore()};var sa,hn=d.__private__.newObject=function(){var y=On();return j(y,!0),y},On=d.__private__.newObjectDeferred=function(){return Q++,fe[Q]=function(){return pe},Q},j=function(y,L){return L=typeof L=="boolean"&&L,fe[y]=pe,L&&oe(y+" 0 obj"),y},ne=d.__private__.newAdditionalObject=function(){var y={objId:On(),content:""};return ge.push(y),y},Y=On(),Z=On(),re=d.__private__.decodeColorString=function(y){var L=y.split(" ");if(L.length!==2||L[1]!=="g"&&L[1]!=="G")L.length!==5||L[4]!=="k"&&L[4]!=="K"||(L=[(1-L[0])*(1-L[3]),(1-L[1])*(1-L[3]),(1-L[2])*(1-L[3]),"r"]);else{var ae=parseFloat(L[0]);L=[ae,ae,ae,"r"]}for(var he="#",Ee=0;Ee<3;Ee++)he+=("0"+Math.floor(255*parseFloat(L[Ee])).toString(16)).slice(-2);return he},se=d.__private__.encodeColorString=function(y){var L;typeof y=="string"&&(y={ch1:y});var ae=y.ch1,he=y.ch2,Ee=y.ch3,Ye=y.ch4,it=y.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ae=="string"&&ae.charAt(0)!=="#"){var Ct=new kS(ae);if(Ct.ok)ae=Ct.toHex();else if(!/^\d*\.?\d*$/.test(ae))throw new Error('Invalid color "'+ae+'" passed to jsPDF.encodeColorString.')}if(typeof ae=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ae)&&(ae="#"+ae[1]+ae[1]+ae[2]+ae[2]+ae[3]+ae[3]),typeof ae=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ae)){var Dt=parseInt(ae.substr(1),16);ae=Dt>>16&255,he=Dt>>8&255,Ee=255&Dt}if(he===void 0||Ye===void 0&&ae===he&&he===Ee)L=typeof ae=="string"?ae+" "+it[0]:y.precision===2?F(ae/255)+" "+it[0]:I(ae/255)+" "+it[0];else if(Ye===void 0||Gi(Ye)==="object"){if(Ye&&!isNaN(Ye.a)&&Ye.a===0)return["1.","1.","1.",it[1]].join(" ");L=typeof ae=="string"?[ae,he,Ee,it[1]].join(" "):y.precision===2?[F(ae/255),F(he/255),F(Ee/255),it[1]].join(" "):[I(ae/255),I(he/255),I(Ee/255),it[1]].join(" ")}else L=typeof ae=="string"?[ae,he,Ee,Ye,it[2]].join(" "):y.precision===2?[F(ae),F(he),F(Ee),F(Ye),it[2]].join(" "):[I(ae),I(he),I(Ee),I(Ye),it[2]].join(" ");return L},De=d.__private__.getFilters=function(){return s},ze=d.__private__.putStream=function(y){var L=(y=y||{}).data||"",ae=y.filters||De(),he=y.alreadyAppliedFilters||[],Ee=y.addLength1||!1,Ye=L.length,it=y.objectId,Ct=function(Kn){return Kn};if(u!==null&&it===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Ct=An.encryptor(it,0));var Dt={};ae===!0&&(ae=["FlateEncode"]);var Zt=y.additionalKeyValues||[],ti=(Dt=_t.API.processDataByFilters!==void 0?_t.API.processDataByFilters(L,ae):{data:L,reverseChain:[]}).reverseChain+(Array.isArray(he)?he.join(" "):he.toString());if(Dt.data.length!==0&&(Zt.push({key:"Length",value:Dt.data.length}),Ee===!0&&Zt.push({key:"Length1",value:Ye})),ti.length!=0)if(ti.split("/").length-1==1)Zt.push({key:"Filter",value:ti});else{Zt.push({key:"Filter",value:"["+ti+"]"});for(var Ai=0;Ai<Zt.length;Ai+=1)if(Zt[Ai].key==="DecodeParms"){for(var xn=[],jn=0;jn<Dt.reverseChain.split("/").length-1;jn+=1)xn.push("null");xn.push(Zt[Ai].value),Zt[Ai].value="["+xn.join(" ")+"]"}}oe("<<");for(var tn=0;tn<Zt.length;tn++)oe("/"+Zt[tn].key+" "+Zt[tn].value);oe(">>"),Dt.data.length!==0&&(oe("stream"),oe(Ct(Dt.data)),oe("endstream"))},Le=d.__private__.putPage=function(y){var L=y.number,ae=y.data,he=y.objId,Ee=y.contentsObjId;j(he,!0),oe("<</Type /Page"),oe("/Parent "+y.rootDictionaryObjId+" 0 R"),oe("/Resources "+y.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(U(y.mediaBox.bottomLeftX))+" "+parseFloat(U(y.mediaBox.bottomLeftY))+" "+U(y.mediaBox.topRightX)+" "+U(y.mediaBox.topRightY)+"]"),y.cropBox!==null&&oe("/CropBox ["+U(y.cropBox.bottomLeftX)+" "+U(y.cropBox.bottomLeftY)+" "+U(y.cropBox.topRightX)+" "+U(y.cropBox.topRightY)+"]"),y.bleedBox!==null&&oe("/BleedBox ["+U(y.bleedBox.bottomLeftX)+" "+U(y.bleedBox.bottomLeftY)+" "+U(y.bleedBox.topRightX)+" "+U(y.bleedBox.topRightY)+"]"),y.trimBox!==null&&oe("/TrimBox ["+U(y.trimBox.bottomLeftX)+" "+U(y.trimBox.bottomLeftY)+" "+U(y.trimBox.topRightX)+" "+U(y.trimBox.topRightY)+"]"),y.artBox!==null&&oe("/ArtBox ["+U(y.artBox.bottomLeftX)+" "+U(y.artBox.bottomLeftY)+" "+U(y.artBox.topRightX)+" "+U(y.artBox.topRightY)+"]"),typeof y.userUnit=="number"&&y.userUnit!==1&&oe("/UserUnit "+y.userUnit),Ei.publish("putPage",{objId:he,pageContext:Ut[L],pageNumber:L,page:ae}),oe("/Contents "+Ee+" 0 R"),oe(">>"),oe("endobj");var Ye=ae.join(`
`);return N===D&&(Ye+=`
Q`),j(Ee,!0),ze({data:Ye,filters:De(),objectId:Ee}),oe("endobj"),he},Pe=d.__private__.putPages=function(){var y,L,ae=[];for(y=1;y<=Bi;y++)Ut[y].objId=On(),Ut[y].contentsObjId=On();for(y=1;y<=Bi;y++)ae.push(Le({number:y,data:Xe[y],objId:Ut[y].objId,contentsObjId:Ut[y].contentsObjId,mediaBox:Ut[y].mediaBox,cropBox:Ut[y].cropBox,bleedBox:Ut[y].bleedBox,trimBox:Ut[y].trimBox,artBox:Ut[y].artBox,userUnit:Ut[y].userUnit,rootDictionaryObjId:Y,resourceDictionaryObjId:Z}));j(Y,!0),oe("<</Type /Pages");var he="/Kids [";for(L=0;L<Bi;L++)he+=ae[L]+" 0 R ";oe(he+"]"),oe("/Count "+Bi),oe(">>"),oe("endobj"),Ei.publish("postPutPages")},Be=function(y){Ei.publish("putFont",{font:y,out:oe,newObject:hn,putStream:ze}),y.isAlreadyPutted!==!0&&(y.objectNumber=hn(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+Oc(y.postScriptName)),oe("/Subtype /Type1"),typeof y.encoding=="string"&&oe("/Encoding /"+y.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},at=function(y){y.objectNumber=hn();var L=[];L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Form"}),L.push({key:"BBox",value:"["+[U(y.x),U(y.y),U(y.x+y.width),U(y.y+y.height)].join(" ")+"]"}),L.push({key:"Matrix",value:"["+y.matrix.toString()+"]"});var ae=y.pages[1].join(`
`);ze({data:ae,additionalKeyValues:L,objectId:y.objectNumber}),oe("endobj")},ct=function(y,L){L||(L=21);var ae=hn(),he=(function(it,Ct){var Dt,Zt=[],ti=1/(Ct-1);for(Dt=0;Dt<1;Dt+=ti)Zt.push(Dt);if(Zt.push(1),it[0].offset!=0){var Ai={offset:0,color:it[0].color};it.unshift(Ai)}if(it[it.length-1].offset!=1){var xn={offset:1,color:it[it.length-1].color};it.push(xn)}for(var jn="",tn=0,Kn=0;Kn<Zt.length;Kn++){for(Dt=Zt[Kn];Dt>it[tn+1].offset;)tn++;var Vn=it[tn].offset,wr=(Dt-Vn)/(it[tn+1].offset-Vn),Ba=it[tn].color,oa=it[tn+1].color;jn+=O(Math.round((1-wr)*Ba[0]+wr*oa[0]).toString(16))+O(Math.round((1-wr)*Ba[1]+wr*oa[1]).toString(16))+O(Math.round((1-wr)*Ba[2]+wr*oa[2]).toString(16))}return jn.trim()})(y.colors,L),Ee=[];Ee.push({key:"FunctionType",value:"0"}),Ee.push({key:"Domain",value:"[0.0 1.0]"}),Ee.push({key:"Size",value:"["+L+"]"}),Ee.push({key:"BitsPerSample",value:"8"}),Ee.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ee.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ze({data:he,additionalKeyValues:Ee,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ae}),oe("endobj"),y.objectNumber=hn(),oe("<< /ShadingType "+y.type),oe("/ColorSpace /DeviceRGB");var Ye="/Coords ["+U(parseFloat(y.coords[0]))+" "+U(parseFloat(y.coords[1]))+" ";y.type===2?Ye+=U(parseFloat(y.coords[2]))+" "+U(parseFloat(y.coords[3])):Ye+=U(parseFloat(y.coords[2]))+" "+U(parseFloat(y.coords[3]))+" "+U(parseFloat(y.coords[4]))+" "+U(parseFloat(y.coords[5])),oe(Ye+="]"),y.matrix&&oe("/Matrix ["+y.matrix.toString()+"]"),oe("/Function "+ae+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},vt=function(y,L){var ae=On(),he=hn();L.push({resourcesOid:ae,objectOid:he}),y.objectNumber=he;var Ee=[];Ee.push({key:"Type",value:"/Pattern"}),Ee.push({key:"PatternType",value:"1"}),Ee.push({key:"PaintType",value:"1"}),Ee.push({key:"TilingType",value:"1"}),Ee.push({key:"BBox",value:"["+y.boundingBox.map(U).join(" ")+"]"}),Ee.push({key:"XStep",value:U(y.xStep)}),Ee.push({key:"YStep",value:U(y.yStep)}),Ee.push({key:"Resources",value:ae+" 0 R"}),y.matrix&&Ee.push({key:"Matrix",value:"["+y.matrix.toString()+"]"}),ze({data:y.stream,additionalKeyValues:Ee,objectId:y.objectNumber}),oe("endobj")},dt=function(y){for(var L in y.objectNumber=hn(),oe("<<"),y)switch(L){case"opacity":oe("/ca "+F(y[L]));break;case"stroke-opacity":oe("/CA "+F(y[L]))}oe(">>"),oe("endobj")},ht=function(y){j(y.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var L in oe("/Font <<"),Et)Et.hasOwnProperty(L)&&(h===!1||h===!0&&g.hasOwnProperty(L))&&oe("/"+L+" "+Et[L].objectNumber+" 0 R");oe(">>")})(),(function(){if(Object.keys(Rt).length>0){for(var L in oe("/Shading <<"),Rt)Rt.hasOwnProperty(L)&&Rt[L]instanceof A0&&Rt[L].objectNumber>=0&&oe("/"+L+" "+Rt[L].objectNumber+" 0 R");Ei.publish("putShadingPatternDict"),oe(">>")}})(),(function(L){if(Object.keys(Rt).length>0){for(var ae in oe("/Pattern <<"),Rt)Rt.hasOwnProperty(ae)&&Rt[ae]instanceof d.TilingPattern&&Rt[ae].objectNumber>=0&&Rt[ae].objectNumber<L&&oe("/"+ae+" "+Rt[ae].objectNumber+" 0 R");Ei.publish("putTilingPatternDict"),oe(">>")}})(y.objectOid),(function(){if(Object.keys(Kt).length>0){var L;for(L in oe("/ExtGState <<"),Kt)Kt.hasOwnProperty(L)&&Kt[L].objectNumber>=0&&oe("/"+L+" "+Kt[L].objectNumber+" 0 R");Ei.publish("putGStateDict"),oe(">>")}})(),(function(){for(var L in oe("/XObject <<"),sr)sr.hasOwnProperty(L)&&sr[L].objectNumber>=0&&oe("/"+L+" "+sr[L].objectNumber+" 0 R");Ei.publish("putXobjectDict"),oe(">>")})(),oe(">>"),oe("endobj")},Wt=function(y){Yt[y.fontName]=Yt[y.fontName]||{},Yt[y.fontName][y.fontStyle]=y.id},Pi=function(y,L,ae,he,Ee){var Ye={id:"F"+(Object.keys(Et).length+1).toString(10),postScriptName:y,fontName:L,fontStyle:ae,encoding:he,isStandardFont:Ee||!1,metadata:{}};return Ei.publish("addFont",{font:Ye,instance:this}),Et[Ye.id]=Ye,Wt(Ye),Ye.id},Xi=d.__private__.pdfEscape=d.pdfEscape=function(y,L){return(function(ae,he){var Ee,Ye,it,Ct,Dt,Zt,ti,Ai,xn;if(it=(he=he||{}).sourceEncoding||"Unicode",Dt=he.outputEncoding,(he.autoencode||Dt)&&Et[Lt].metadata&&Et[Lt].metadata[it]&&Et[Lt].metadata[it].encoding&&(Ct=Et[Lt].metadata[it].encoding,!Dt&&Et[Lt].encoding&&(Dt=Et[Lt].encoding),!Dt&&Ct.codePages&&(Dt=Ct.codePages[0]),typeof Dt=="string"&&(Dt=Ct[Dt]),Dt)){for(ti=!1,Zt=[],Ee=0,Ye=ae.length;Ee<Ye;Ee++)(Ai=Dt[ae.charCodeAt(Ee)])?Zt.push(String.fromCharCode(Ai)):Zt.push(ae[Ee]),Zt[Ee].charCodeAt(0)>>8&&(ti=!0);ae=Zt.join("")}for(Ee=ae.length;ti===void 0&&Ee!==0;)ae.charCodeAt(Ee-1)>>8&&(ti=!0),Ee--;if(!ti)return ae;for(Zt=he.noBOM?[]:[254,255],Ee=0,Ye=ae.length;Ee<Ye;Ee++){if((xn=(Ai=ae.charCodeAt(Ee))>>8)>>8)throw new Error("Character at position "+Ee+" of string '"+ae+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zt.push(xn),Zt.push(Ai-(xn<<8))}return String.fromCharCode.apply(void 0,Zt)})(y,L).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},en=d.__private__.beginPage=function(y){Xe[++Bi]=[],Ut[Bi]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(y[0]),topRightY:Number(y[1])}},Cs(Bi),Ne(Xe[B])},or=function(y,L){var ae,he,Ee;switch(e=L||e,typeof y=="string"&&(ae=E(y.toLowerCase()),Array.isArray(ae)&&(he=ae[0],Ee=ae[1])),Array.isArray(y)&&(he=y[0]*Vt,Ee=y[1]*Vt),isNaN(he)&&(he=r[0],Ee=r[1]),(he>14400||Ee>14400)&&(Qi.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),he=Math.min(14400,he),Ee=Math.min(14400,Ee)),r=[he,Ee],e.substr(0,1)){case"l":Ee>he&&(r=[Ee,he]);break;case"p":he>Ee&&(r=[Ee,he])}en(r),Dp($c),oe(N0),Yc!==0&&oe(Yc+" J"),Kc!==0&&oe(Kc+" j"),Ei.publish("addPage",{pageNumber:Bi})},is=function(y){y>0&&y<=Bi&&(Xe.splice(y,1),Ut.splice(y,1),Bi--,B>Bi&&(B=Bi),this.setPage(B))},Cs=function(y){y>0&&y<=Bi&&(B=y)},Oa=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return Xe.length-1},Ro=function(y,L,ae){var he,Ee=void 0;return ae=ae||{},y=y!==void 0?y:Et[Lt].fontName,L=L!==void 0?L:Et[Lt].fontStyle,he=y.toLowerCase(),Yt[he]!==void 0&&Yt[he][L]!==void 0?Ee=Yt[he][L]:Yt[y]!==void 0&&Yt[y][L]!==void 0?Ee=Yt[y][L]:ae.disableWarning===!1&&Qi.warn("Unable to look up font label for font '"+y+"', '"+L+"'. Refer to getFontList() for available fonts."),Ee||ae.noFallback||(Ee=Yt.times[L])==null&&(Ee=Yt.times.normal),Ee},Or=d.__private__.putInfo=function(){var y=hn(),L=function(he){return he};for(var ae in u!==null&&(L=An.encryptor(y,0)),oe("<<"),oe("/Producer ("+Xi(L("jsPDF "+_t.version))+")"),jt)jt.hasOwnProperty(ae)&&jt[ae]&&oe("/"+ae.substr(0,1).toUpperCase()+ae.substr(1)+" ("+Xi(L(jt[ae]))+")");oe("/CreationDate ("+Xi(L(de))+")"),oe(">>"),oe("endobj")},yp=d.__private__.putCatalog=function(y){var L=(y=y||{}).rootDictionaryObjId||Y;switch(hn(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+L+" 0 R"),yt||(yt="fullwidth"),yt){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ae=""+yt;ae.substr(ae.length-1)==="%"&&(yt=parseInt(yt)/100),typeof yt=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+F(yt)+"]")}switch(qt||(qt="continuous"),qt){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}Nt&&oe("/PageMode /"+Nt),Ei.publish("putCatalog"),oe(">>"),oe("endobj")},Bn=d.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(Q+1)),oe("/Root "+Q+" 0 R"),oe("/Info "+(Q-1)+" 0 R"),u!==null&&oe("/Encrypt "+An.oid+" 0 R"),oe("/ID [ <"+ke+"> <"+ke+"> ]"),oe(">>")},Hd=d.__private__.putHeader=function(){oe("%PDF-"+b),oe("%\xBA\xDF\xAC\xE0")},Wd=d.__private__.putXRef=function(){var y="0000000000";oe("xref"),oe("0 "+(Q+1)),oe("0000000000 65535 f ");for(var L=1;L<=Q;L++)typeof fe[L]=="function"?oe((y+fe[L]()).slice(-10)+" 00000 n "):fe[L]!==void 0?oe((y+fe[L]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},Qs=d.__private__.buildDocument=function(){var y;Q=0,pe=0,ye=[],fe=[],ge=[],Y=On(),Z=On(),Ne(ye),Ei.publish("buildDocument"),Hd(),Pe(),(function(){Ei.publish("putAdditionalObjects");for(var ae=0;ae<ge.length;ae++){var he=ge[ae];j(he.objId,!0),oe(he.content),oe("endobj")}Ei.publish("postPutAdditionalObjects")})(),y=[],(function(){for(var ae in Et)Et.hasOwnProperty(ae)&&(h===!1||h===!0&&g.hasOwnProperty(ae))&&Be(Et[ae])})(),(function(){var ae;for(ae in Kt)Kt.hasOwnProperty(ae)&&dt(Kt[ae])})(),(function(){for(var ae in sr)sr.hasOwnProperty(ae)&&at(sr[ae])})(),(function(ae){var he;for(he in Rt)Rt.hasOwnProperty(he)&&(Rt[he]instanceof A0?ct(Rt[he]):Rt[he]instanceof Bc&&vt(Rt[he],ae))})(y),Ei.publish("putResources"),y.forEach(ht),ht({resourcesOid:Z,objectOid:Number.MAX_SAFE_INTEGER}),Ei.publish("postPutResources"),u!==null&&(An.oid=hn(),oe("<<"),oe("/Filter /Standard"),oe("/V "+An.v),oe("/R "+An.r),oe("/U <"+An.toHexString(An.U)+">"),oe("/O <"+An.toHexString(An.O)+">"),oe("/P "+An.P),oe(">>"),oe("endobj")),Or(),yp();var L=pe;return Wd(),Bn(),oe("startxref"),oe(""+L),oe("%%EOF"),Ne(Xe[B]),ye.join(`
`)},Nl=d.__private__.getBlob=function(y){return new Blob([et(y)],{type:"application/pdf"})},ns=d.output=d.__private__.output=(sa=function(y,L){switch(typeof(L=L||{})=="string"?L={filename:L}:L.filename=L.filename||"generated.pdf",y){case void 0:return Qs();case"save":d.save(L.filename);break;case"arraybuffer":return et(Qs());case"blob":return Nl(Qs());case"bloburi":case"bloburl":if(Xt.URL!==void 0&&typeof Xt.URL.createObjectURL=="function")return Xt.URL&&Xt.URL.createObjectURL(Nl(Qs()))||void 0;Qi.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ae="",he=Qs();try{ae=nS(he)}catch{ae=nS(unescape(encodeURIComponent(he)))}return"data:application/pdf;filename="+L.filename+";base64,"+ae;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var Ee="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ye=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';L.pdfObjectUrl&&(Ee=L.pdfObjectUrl,Ye="");var it='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ee+'"'+Ye+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(L)+");<\/script></body></html>",Ct=Xt.open();return Ct!==null&&Ct.document.write(it),Ct}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Xt)==="[object Window]"){var Dt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(L.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+L.filename+'" width="500px" height="400px" /></body></html>',Zt=Xt.open();if(Zt!==null){Zt.document.write(Dt);var ti=this;Zt.document.documentElement.querySelector("#pdfViewer").onload=function(){Zt.document.title=L.filename,Zt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(ti.output("bloburl"))}}return Zt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ai='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",L)+'"></iframe></body></html>',xn=Xt.open();if(xn!==null&&(xn.document.write(Ai),xn.document.title=L.filename),xn||typeof safari>"u")return xn;break;case"datauri":case"dataurl":return Xt.document.location.href=this.output("datauristring",L);default:return null}},sa.foo=function(){try{return sa.apply(this,arguments)}catch(ae){var y=ae.stack||"";~y.indexOf(" at ")&&(y=y.split(" at ")[1]);var L="Error in function "+y.split(`
`)[0].split("<")[0]+": "+ae.message;if(!Xt.console)throw new Error(L);Xt.console.error(L,ae),Xt.alert&&alert(L)}},sa.foo.bar=sa,sa.foo),Pl=function(y){return Array.isArray(Js)===!0&&Js.indexOf(y)>-1};switch(n){case"pt":Vt=1;break;case"mm":Vt=72/25.4;break;case"cm":Vt=72/2.54;break;case"in":Vt=72;break;case"px":Vt=Pl("px_scaling")==1?.75:96/72;break;case"pc":case"em":Vt=12;break;case"ex":Vt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Vt=n}var An=null;qe(),Se();var Wc=d.__private__.getPageInfo=d.getPageInfo=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ut[y].objId,pageNumber:y,pageContext:Ut[y]}},Sp=d.__private__.getPageInfoByObjId=function(y){if(isNaN(y)||y%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var L in Ut)if(Ut[L].objId===y)break;return Wc(L)},Cp=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:Ut[B].objId,pageNumber:B,pageContext:Ut[B]}};d.addPage=function(){return or.apply(this,arguments),this},d.setPage=function(){return Cs.apply(this,arguments),Ne.call(this,Xe[B]),this},d.insertPage=function(y){return this.addPage(),this.movePage(B,y),this},d.movePage=function(y,L){var ae,he;if(y>L){ae=Xe[y],he=Ut[y];for(var Ee=y;Ee>L;Ee--)Xe[Ee]=Xe[Ee-1],Ut[Ee]=Ut[Ee-1];Xe[L]=ae,Ut[L]=he,this.setPage(L)}else if(y<L){ae=Xe[y],he=Ut[y];for(var Ye=y;Ye<L;Ye++)Xe[Ye]=Xe[Ye+1],Ut[Ye]=Ut[Ye+1];Xe[L]=ae,Ut[L]=he,this.setPage(L)}return this},d.deletePage=function(){return is.apply(this,arguments),this},d.__private__.text=d.text=function(y,L,ae,he,Ee){var Ye,it,Ct,Dt,Zt,ti,Ai,xn,jn,tn=(he=he||{}).scope||this;if(typeof y=="number"&&typeof L=="number"&&(typeof ae=="string"||Array.isArray(ae))){var Kn=ae;ae=L,L=y,y=Kn}if(arguments[3]instanceof Ot==0?(Ct=arguments[4],Dt=arguments[5],Gi(Ai=arguments[3])==="object"&&Ai!==null||(typeof Ct=="string"&&(Dt=Ct,Ct=null),typeof Ai=="string"&&(Dt=Ai,Ai=null),typeof Ai=="number"&&(Ct=Ai,Ai=null),he={flags:Ai,angle:Ct,align:Dt})):(M("The transform parameter of text() with a Matrix value"),jn=Ee),isNaN(L)||isNaN(ae)||y==null)throw new Error("Invalid arguments passed to jsPDF.text");if(y.length===0)return tn;var Vn,wr="",Ba=typeof he.lineHeightFactor=="number"?he.lineHeightFactor:Ll,oa=tn.internal.scaleFactor;function Jd(Mi){return Mi=Mi.split("	").join(Array(he.TabLen||9).join(" ")),Xi(Mi,Ai)}function I0(Mi){for(var Yi,Dn=Mi.concat(),Zn=[],so=Dn.length;so--;)typeof(Yi=Dn.shift())=="string"?Zn.push(Yi):Array.isArray(Mi)&&(Yi.length===1||Yi[1]===void 0&&Yi[2]===void 0)?Zn.push(Yi[0]):Zn.push([Yi[0],Yi[1],Yi[2]]);return Zn}function Vl(Mi,Yi){var Dn;if(typeof Mi=="string")Dn=Yi(Mi)[0];else if(Array.isArray(Mi)){for(var Zn,so,lu=Mi.concat(),B0=[],tf=lu.length;tf--;)typeof(Zn=lu.shift())=="string"?B0.push(Yi(Zn)[0]):Array.isArray(Zn)&&typeof Zn[0]=="string"&&(so=Yi(Zn[0],Zn[1],Zn[2]),B0.push([so[0],so[1],so[2]]));Dn=B0}return Dn}var jo=!1,Ul=!0;if(typeof y=="string")jo=!0;else if(Array.isArray(y)){var zl=y.concat();it=[];for(var Hl,Br=zl.length;Br--;)(typeof(Hl=zl.shift())!="string"||Array.isArray(Hl)&&typeof Hl[0]!="string")&&(Ul=!1);jo=Ul}if(jo===!1)throw new Error('Type of text must be string or Array. "'+y+'" is not recognized.');typeof y=="string"&&(y=y.match(/[\r?\n]/)?y.split(/\r\n|\r|\n/g):[y]);var Wl=rt/tn.internal.scaleFactor,ql=Wl*(Ba-1);switch(he.baseline){case"bottom":ae-=ql;break;case"top":ae+=Wl-ql;break;case"hanging":ae+=Wl-2*ql;break;case"middle":ae+=Wl/2-ql}if((ti=he.maxWidth||0)>0&&(typeof y=="string"?y=tn.splitTextToSize(y,ti):Object.prototype.toString.call(y)==="[object Array]"&&(y=y.reduce(function(Mi,Yi){return Mi.concat(tn.splitTextToSize(Yi,ti))},[]))),Ye={text:y,x:L,y:ae,options:he,mutex:{pdfEscape:Xi,activeFontKey:Lt,fonts:Et,activeFontSize:rt}},Ei.publish("preProcessText",Ye),y=Ye.text,Ct=(he=Ye.options).angle,jn instanceof Ot==0&&Ct&&typeof Ct=="number"){Ct*=Math.PI/180,he.rotationDirection===0&&(Ct=-Ct),N===D&&(Ct=-Ct);var Qc=Math.cos(Ct),eu=Math.sin(Ct);jn=new Ot(Qc,eu,-eu,Qc,0,0)}else Ct&&Ct instanceof Ot&&(jn=Ct);N!==D||jn||(jn=ts),(Zt=he.charSpace||M0)!==void 0&&(wr+=U(ee(Zt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(xn=he.horizontalScale)!==void 0&&(wr+=U(100*xn)+` Tz
`),he.lang;var _n=-1,ro=he.renderingMode!==void 0?he.renderingMode:he.stroke,R0=tn.internal.getCurrentPageInfo().pageContext;switch(ro){case 0:case!1:case"fill":_n=0;break;case 1:case!0:case"stroke":_n=1;break;case 2:case"fillThenStroke":_n=2;break;case 3:case"invisible":_n=3;break;case 4:case"fillAndAddForClipping":_n=4;break;case 5:case"strokeAndAddPathForClipping":_n=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":_n=6;break;case 7:case"addToPathForClipping":_n=7}var Qd=R0.usedRenderingMode!==void 0?R0.usedRenderingMode:-1;_n!==-1?wr+=_n+` Tr
`:Qd!==-1&&(wr+=`0 Tr
`),_n!==-1&&(R0.usedRenderingMode=_n),Dt=he.align||"left";var ja,Gl=rt*Ba,tu=tn.internal.pageSize.getWidth(),iu=Et[Lt];Zt=he.charSpace||M0,ti=he.maxWidth||0,Ai=Object.assign({autoencode:!0,noBOM:!0},he.flags);var Vo=[],$l=function(Mi){return tn.getStringUnitWidth(Mi,{font:iu,charSpace:Zt,fontSize:rt,doKerning:!1})*rt/oa};if(Object.prototype.toString.call(y)==="[object Array]"){var _a;it=I0(y),Dt!=="left"&&(ja=it.map($l));var ba,Uo=0;if(Dt==="right"){L-=ja[0],y=[],Br=it.length;for(var ao=0;ao<Br;ao++)ao===0?(ba=eo(L),_a=to(ae)):(ba=ee(Uo-ja[ao]),_a=-Gl),y.push([it[ao],ba,_a]),Uo=ja[ao]}else if(Dt==="center"){L-=ja[0]/2,y=[],Br=it.length;for(var zo=0;zo<Br;zo++)zo===0?(ba=eo(L),_a=to(ae)):(ba=ee((Uo-ja[zo])/2),_a=-Gl),y.push([it[zo],ba,_a]),Uo=ja[zo]}else if(Dt==="left"){y=[],Br=it.length;for(var nu=0;nu<Br;nu++)y.push(it[nu])}else if(Dt==="justify"&&iu.encoding==="Identity-H"){y=[],Br=it.length,ti=ti!==0?ti:tu;for(var O0=0,Fn=0;Fn<Br;Fn++)if(_a=Fn===0?to(ae):-Gl,ba=Fn===0?eo(L):O0,Fn<Br-1){var ef=ee((ti-ja[Fn])/(it[Fn].split(" ").length-1)),ks=it[Fn].split(" ");y.push([ks[0]+" ",ba,_a]),O0=0;for(var Ts=1;Ts<ks.length;Ts++){var ru=($l(ks[Ts-1]+" "+ks[Ts])-$l(ks[Ts]))*oa+ef;Ts==ks.length-1?y.push([ks[Ts],ru,0]):y.push([ks[Ts]+" ",ru,0]),O0-=ru}}else y.push([it[Fn],ba,_a]);y.push(["",O0,0])}else{if(Dt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(y=[],Br=it.length,ti=ti!==0?ti:tu,Fn=0;Fn<Br;Fn++){_a=Fn===0?to(ae):-Gl,ba=Fn===0?eo(L):0;var au=it[Fn].split(" ").length-1,su=au>0?(ti-ja[Fn])/au:0;Fn<Br-1?Vo.push(U(ee(su))):Vo.push(0),y.push([it[Fn],ba,_a])}}}(typeof he.R2L=="boolean"?he.R2L:Jt)===!0&&(y=Vl(y,function(Mi,Yi,Dn){return[Mi.split("").reverse().join(""),Yi,Dn]})),Ye={text:y,x:L,y:ae,options:he,mutex:{pdfEscape:Xi,activeFontKey:Lt,fonts:Et,activeFontSize:rt}},Ei.publish("postProcessText",Ye),y=Ye.text,Vn=Ye.mutex.isHex||!1;var ou=Et[Lt].encoding;ou!=="WinAnsiEncoding"&&ou!=="StandardEncoding"||(y=Vl(y,function(Mi,Yi,Dn){return[Jd(Mi),Yi,Dn]})),it=I0(y),y=[];for(var Ho,Wo,qo,Xl=Array.isArray(it[0])?1:0,Go="",Yl=function(Mi,Yi,Dn){var Zn="";return Dn instanceof Ot?(Dn=typeof he.angle=="number"?es(Dn,new Ot(1,0,0,1,Mi,Yi)):es(new Ot(1,0,0,1,Mi,Yi),Dn),N===D&&(Dn=es(new Ot(1,0,0,-1,0,0),Dn)),Zn=Dn.join(" ")+` Tm
`):Zn=U(Mi)+" "+U(Yi)+` Td
`,Zn},Va=0;Va<it.length;Va++){switch(Go="",Xl){case 1:qo=(Vn?"<":"(")+it[Va][0]+(Vn?">":")"),Ho=parseFloat(it[Va][1]),Wo=parseFloat(it[Va][2]);break;case 0:qo=(Vn?"<":"(")+it[Va]+(Vn?">":")"),Ho=eo(L),Wo=to(ae)}Vo!==void 0&&Vo[Va]!==void 0&&(Go=Vo[Va]+` Tw
`),Va===0?y.push(Go+Yl(Ho,Wo,jn)+qo):Xl===0?y.push(Go+qo):Xl===1&&y.push(Go+Yl(Ho,Wo,jn)+qo)}y=Xl===0?y.join(` Tj
T* `):y.join(` Tj
`),y+=` Tj
`;var As=`BT
/`;return As+=Lt+" "+rt+` Tf
`,As+=U(rt*Ba)+` TL
`,As+=Il+`
`,As+=wr,As+=y,oe(As+="ET"),g[Lt]=!0,tn};var Ep=d.__private__.clip=d.clip=function(y){return oe(y==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Ep("evenodd")},d.__private__.discardPath=d.discardPath=function(){return oe("n"),this};var Es=d.__private__.isValidStyle=function(y){var L=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(y)!==-1&&(L=!0),L};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(y){return Es(y)&&(c=y),this};var qd=d.__private__.getStyle=d.getStyle=function(y){var L=c;switch(y){case"D":case"S":L="S";break;case"F":L="f";break;case"FD":case"DF":L="B";break;case"f":case"f*":case"B":case"B*":L=y}return L},Gd=d.close=function(){return oe("h"),this};d.stroke=function(){return oe("S"),this},d.fill=function(y){return Oo("f",y),this},d.fillEvenOdd=function(y){return Oo("f*",y),this},d.fillStroke=function(y){return Oo("B",y),this},d.fillStrokeEvenOdd=function(y){return Oo("B*",y),this};var Oo=function(y,L){Gi(L)==="object"?Tp(L,y):oe(y)},qc=function(y){y===null||N===D&&y===void 0||(y=qd(y),oe(y))};function kp(y,L,ae,he,Ee){var Ye=new Bc(L||this.boundingBox,ae||this.xStep,he||this.yStep,this.gState,Ee||this.matrix);Ye.stream=this.stream;var it=y+"$$"+this.cloneIndex+++"$$";return Rr(it,Ye),Ye}var Tp=function(y,L){var ae=ci[y.key],he=Rt[ae];if(he instanceof A0)oe("q"),oe(Ap(L)),he.gState&&d.setGState(he.gState),oe(y.matrix.toString()+" cm"),oe("/"+ae+" sh"),oe("Q");else if(he instanceof Bc){var Ee=new Ot(1,0,0,-1,0,jl());y.matrix&&(Ee=Ee.multiply(y.matrix||ts),ae=kp.call(he,y.key,y.boundingBox,y.xStep,y.yStep,Ee).id),oe("q"),oe("/Pattern cs"),oe("/"+ae+" scn"),he.gState&&d.setGState(he.gState),oe(L),oe("Q")}},Ap=function(y){switch(y){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Gc=d.moveTo=function(y,L){return oe(U(ee(y))+" "+U(le(L))+" m"),this},Ml=d.lineTo=function(y,L){return oe(U(ee(y))+" "+U(le(L))+" l"),this},Bo=d.curveTo=function(y,L,ae,he,Ee,Ye){return oe([U(ee(y)),U(le(L)),U(ee(ae)),U(le(he)),U(ee(Ee)),U(le(Ye)),"c"].join(" ")),this};d.__private__.line=d.line=function(y,L,ae,he,Ee){if(isNaN(y)||isNaN(L)||isNaN(ae)||isNaN(he)||!Es(Ee))throw new Error("Invalid arguments passed to jsPDF.line");return N===A?this.lines([[ae-y,he-L]],y,L,[1,1],Ee||"S"):this.lines([[ae-y,he-L]],y,L,[1,1]).stroke()},d.__private__.lines=d.lines=function(y,L,ae,he,Ee,Ye){var it,Ct,Dt,Zt,ti,Ai,xn,jn,tn,Kn,Vn,wr;if(typeof y=="number"&&(wr=ae,ae=L,L=y,y=wr),he=he||[1,1],Ye=Ye||!1,isNaN(L)||isNaN(ae)||!Array.isArray(y)||!Array.isArray(he)||!Es(Ee)||typeof Ye!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Gc(L,ae),it=he[0],Ct=he[1],Zt=y.length,Kn=L,Vn=ae,Dt=0;Dt<Zt;Dt++)(ti=y[Dt]).length===2?(Kn=ti[0]*it+Kn,Vn=ti[1]*Ct+Vn,Ml(Kn,Vn)):(Ai=ti[0]*it+Kn,xn=ti[1]*Ct+Vn,jn=ti[2]*it+Kn,tn=ti[3]*Ct+Vn,Kn=ti[4]*it+Kn,Vn=ti[5]*Ct+Vn,Bo(Ai,xn,jn,tn,Kn,Vn));return Ye&&Gd(),qc(Ee),this},d.path=function(y){for(var L=0;L<y.length;L++){var ae=y[L],he=ae.c;switch(ae.op){case"m":Gc(he[0],he[1]);break;case"l":Ml(he[0],he[1]);break;case"c":Bo.apply(this,he);break;case"h":Gd()}}return this},d.__private__.rect=d.rect=function(y,L,ae,he,Ee){if(isNaN(y)||isNaN(L)||isNaN(ae)||isNaN(he)||!Es(Ee))throw new Error("Invalid arguments passed to jsPDF.rect");return N===A&&(he=-he),oe([U(ee(y)),U(le(L)),U(ee(ae)),U(ee(he)),"re"].join(" ")),qc(Ee),this},d.__private__.triangle=d.triangle=function(y,L,ae,he,Ee,Ye,it){if(isNaN(y)||isNaN(L)||isNaN(ae)||isNaN(he)||isNaN(Ee)||isNaN(Ye)||!Es(it))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ae-y,he-L],[Ee-ae,Ye-he],[y-Ee,L-Ye]],y,L,[1,1],it,!0),this},d.__private__.roundedRect=d.roundedRect=function(y,L,ae,he,Ee,Ye,it){if(isNaN(y)||isNaN(L)||isNaN(ae)||isNaN(he)||isNaN(Ee)||isNaN(Ye)||!Es(it))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ct=4/3*(Math.SQRT2-1);return Ee=Math.min(Ee,.5*ae),Ye=Math.min(Ye,.5*he),this.lines([[ae-2*Ee,0],[Ee*Ct,0,Ee,Ye-Ye*Ct,Ee,Ye],[0,he-2*Ye],[0,Ye*Ct,-Ee*Ct,Ye,-Ee,Ye],[2*Ee-ae,0],[-Ee*Ct,0,-Ee,-Ye*Ct,-Ee,-Ye],[0,2*Ye-he],[0,-Ye*Ct,Ee*Ct,-Ye,Ee,-Ye]],y+Ee,L,[1,1],it,!0),this},d.__private__.ellipse=d.ellipse=function(y,L,ae,he,Ee){if(isNaN(y)||isNaN(L)||isNaN(ae)||isNaN(he)||!Es(Ee))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ye=4/3*(Math.SQRT2-1)*ae,it=4/3*(Math.SQRT2-1)*he;return Gc(y+ae,L),Bo(y+ae,L-it,y+Ye,L-he,y,L-he),Bo(y-Ye,L-he,y-ae,L-it,y-ae,L),Bo(y-ae,L+it,y-Ye,L+he,y,L+he),Bo(y+Ye,L+he,y+ae,L+it,y+ae,L),qc(Ee),this},d.__private__.circle=d.circle=function(y,L,ae,he){if(isNaN(y)||isNaN(L)||isNaN(ae)||!Es(he))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(y,L,ae,ae,he)},d.setFont=function(y,L,ae){return ae&&(L=W(L,ae)),Lt=Ro(y,L,{disableWarning:!1}),this};var Fp=d.__private__.getFont=d.getFont=function(){return Et[Ro.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var y,L,ae={};for(y in Yt)if(Yt.hasOwnProperty(y))for(L in ae[y]=[],Yt[y])Yt[y].hasOwnProperty(L)&&ae[y].push(L);return ae},d.addFont=function(y,L,ae,he,Ee){var Ye=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ye.indexOf(arguments[3])!==-1?Ee=arguments[3]:arguments[3]&&Ye.indexOf(arguments[3])==-1&&(ae=W(ae,he)),Pi.call(this,y,L,ae,Ee=Ee||"Identity-H")};var Ll,$c=i.lineWidth||.200025,Qt=d.__private__.getLineWidth=d.getLineWidth=function(){return $c},Dp=d.__private__.setLineWidth=d.setLineWidth=function(y){return $c=y,oe(U(ee(y))+" w"),this};d.__private__.setLineDash=_t.API.setLineDash=_t.API.setLineDashPattern=function(y,L){if(y=y||[],L=L||0,isNaN(L)||!Array.isArray(y))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return y=y.map(function(ae){return U(ee(ae))}).join(" "),L=U(ee(L)),oe("["+y+"] "+L+" d"),this};var Np=d.__private__.getLineHeight=d.getLineHeight=function(){return rt*Ll};d.__private__.getLineHeight=d.getLineHeight=function(){return rt*Ll};var Pp=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(y){return typeof(y=y||1.15)=="number"&&(Ll=y),this},Mp=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Ll};Pp(i.lineHeight);var eo=d.__private__.getHorizontalCoordinate=function(y){return ee(y)},to=d.__private__.getVerticalCoordinate=function(y){return N===D?y:Ut[B].mediaBox.topRightY-Ut[B].mediaBox.bottomLeftY-ee(y)},Lp=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(y){return U(eo(y))},Ip=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(y){return U(to(y))},N0=i.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return re(N0)},d.__private__.setStrokeColor=d.setDrawColor=function(y,L,ae,he){return N0=se({ch1:y,ch2:L,ch3:ae,ch4:he,pdfColorType:"draw",precision:2}),oe(N0),this};var Xc=i.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return re(Xc)},d.__private__.setFillColor=d.setFillColor=function(y,L,ae,he){return Xc=se({ch1:y,ch2:L,ch3:ae,ch4:he,pdfColorType:"fill",precision:2}),oe(Xc),this};var Il=i.textColor||"0 g",P0=d.__private__.getTextColor=d.getTextColor=function(){return re(Il)};d.__private__.setTextColor=d.setTextColor=function(y,L,ae,he){return Il=se({ch1:y,ch2:L,ch3:ae,ch4:he,pdfColorType:"text",precision:3}),this};var M0=i.charSpace,Rp=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(M0||0)};d.__private__.setCharSpace=d.setCharSpace=function(y){if(isNaN(y))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return M0=y,this};var Yc=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(y){var L=d.CapJoinStyles[y];if(L===void 0)throw new Error("Line cap style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Yc=L,oe(L+" J"),this};var Kc=0;d.__private__.setLineJoin=d.setLineJoin=function(y){var L=d.CapJoinStyles[y];if(L===void 0)throw new Error("Line join style of '"+y+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Kc=L,oe(L+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(y){if(y=y||0,isNaN(y))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(U(ee(y))+" M"),this},d.GState=cp,d.setGState=function(y){(y=typeof y=="string"?Kt[fn[y]]:Rl(null,y)).equals(Tn)||(oe("/"+y.id+" gs"),Tn=y)};var Rl=function(y,L){if(!y||!fn[y]){var ae=!1;for(var he in Kt)if(Kt.hasOwnProperty(he)&&Kt[he].equals(L)){ae=!0;break}if(ae)L=Kt[he];else{var Ee="GS"+(Object.keys(Kt).length+1).toString(10);Kt[Ee]=L,L.id=Ee}return y&&(fn[y]=L.id),Ei.publish("addGState",L),L}};d.addGState=function(y,L){return Rl(y,L),this},d.saveGraphicsState=function(){return oe("q"),Oi.push({key:Lt,size:rt,color:Il}),this},d.restoreGraphicsState=function(){oe("Q");var y=Oi.pop();return Lt=y.key,rt=y.size,Il=y.color,Tn=null,this},d.setCurrentTransformationMatrix=function(y){return oe(y.toString()+" cm"),this},d.comment=function(y){return oe("#"+y),this};var Ol=function(y,L){var ae=y||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ae},set:function(Ye){isNaN(Ye)||(ae=parseFloat(Ye))}});var he=L||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return he},set:function(Ye){isNaN(Ye)||(he=parseFloat(Ye))}});var Ee="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ee},set:function(Ye){Ee=Ye.toString()}}),this},Zc=function(y,L,ae,he){Ol.call(this,y,L),this.type="rect";var Ee=ae||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ee},set:function(it){isNaN(it)||(Ee=parseFloat(it))}});var Ye=he||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ye},set:function(it){isNaN(it)||(Ye=parseFloat(it))}}),this},L0=function(){this.page=Bi,this.currentPage=B,this.pages=Xe.slice(0),this.pagesContext=Ut.slice(0),this.x=Pt,this.y=Ri,this.matrix=vi,this.width=$d(B),this.height=io(B),this.outputDestination=ut,this.id="",this.objectNumber=-1};L0.prototype.restore=function(){Bi=this.page,B=this.currentPage,Ut=this.pagesContext,Xe=this.pages,Pt=this.x,Ri=this.y,vi=this.matrix,Xd(B,this.width),no(B,this.height),ut=this.outputDestination};var Jc=function(y,L,ae,he,Ee){Ra.push(new L0),Bi=B=0,Xe=[],Pt=y,Ri=L,vi=Ee,en([ae,he])};for(var Bl in d.beginFormObject=function(y,L,ae,he,Ee){return Jc(y,L,ae,he,Ee),this},d.endFormObject=function(y){return(function(L){if(Qa[L])Ra.pop().restore();else{var ae=new L0,he="Xo"+(Object.keys(sr).length+1).toString(10);ae.id=he,Qa[L]=he,sr[he]=ae,Ei.publish("addFormObject",ae),Ra.pop().restore()}})(y),this},d.doFormObject=function(y,L){var ae=sr[Qa[y]];return oe("q"),oe(L.toString()+" cm"),oe("/"+ae.id+" Do"),oe("Q"),this},d.getFormObject=function(y){var L=sr[Qa[y]];return{x:L.x,y:L.y,width:L.width,height:L.height,matrix:L.matrix}},d.save=function(y,L){return y=y||"generated.pdf",(L=L||{}).returnPromise=L.returnPromise||!1,L.returnPromise===!1?(T0(Nl(Qs()),y),typeof T0.unload=="function"&&Xt.setTimeout&&setTimeout(T0.unload,911),this):new Promise(function(ae,he){try{var Ee=T0(Nl(Qs()),y);typeof T0.unload=="function"&&Xt.setTimeout&&setTimeout(T0.unload,911),ae(Ee)}catch(Ye){he(Ye.message)}})},_t.API)_t.API.hasOwnProperty(Bl)&&(Bl==="events"&&_t.API.events.length?(function(y,L){var ae,he,Ee;for(Ee=L.length-1;Ee!==-1;Ee--)ae=L[Ee][0],he=L[Ee][1],y.subscribe.apply(y,[ae].concat(typeof he=="function"?[he]:he))})(Ei,_t.API.events):d[Bl]=_t.API[Bl]);function $d(y){return Ut[y].mediaBox.topRightX-Ut[y].mediaBox.bottomLeftX}function Xd(y,L){Ut[y].mediaBox.topRightX=L+Ut[y].mediaBox.bottomLeftX}function io(y){return Ut[y].mediaBox.topRightY-Ut[y].mediaBox.bottomLeftY}function no(y,L){Ut[y].mediaBox.topRightY=L+Ut[y].mediaBox.bottomLeftY}var Yd=d.getPageWidth=function(y){return $d(y=y||B)/Vt},Kd=d.setPageWidth=function(y,L){Xd(y,L*Vt)},jl=d.getPageHeight=function(y){return io(y=y||B)/Vt},Zd=d.setPageHeight=function(y,L){no(y,L*Vt)};return d.internal={pdfEscape:Xi,getStyle:qd,getFont:Fp,getFontSize:mt,getCharSpace:Rp,getTextColor:P0,getLineHeight:Np,getLineHeightFactor:Mp,getLineWidth:Qt,write:Ft,getHorizontalCoordinate:eo,getVerticalCoordinate:to,getCoordinateString:Lp,getVerticalCoordinateString:Ip,collections:{},newObject:hn,newAdditionalObject:ne,newObjectDeferred:On,newObjectDeferredBegin:j,getFilters:De,putStream:ze,events:Ei,scaleFactor:Vt,pageSize:{getWidth:function(){return Yd(B)},setWidth:function(y){Kd(B,y)},getHeight:function(){return jl(B)},setHeight:function(y){Zd(B,y)}},encryptionOptions:u,encryption:An,getEncryptor:function(y){return u!==null?An.encryptor(y,0):function(L){return L}},output:ns,getNumberOfPages:Oa,pages:Xe,out:oe,f2:F,f3:I,getPageInfo:Wc,getPageInfoByObjId:Sp,getCurrentPageInfo:Cp,getPDFVersion:_,Point:Ol,Rectangle:Zc,Matrix:Ot,hasHotfix:Pl},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Yd(B)},set:function(y){Kd(B,y)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return jl(B)},set:function(y){Zd(B,y)},enumerable:!0,configurable:!0}),function(y){for(var L=0,ae=bt.length;L<ae;L++){var he=Pi.call(this,y[L][0],y[L][1],y[L][2],bt[L][3],!0);h===!1&&(g[he]=!0);var Ee=y[L][0].split("-");Wt({id:he,fontName:Ee[0],fontStyle:Ee[1]||""})}Ei.publish("addFonts",{fonts:Et,dictionary:Yt})}.call(d,bt),Lt="F1",or(r,e),Ei.publish("initialized"),d}Rc.prototype.lsbFirstWord=function(i){return String.fromCharCode(255&i,i>>8&255,i>>16&255,i>>24&255)},Rc.prototype.toHexString=function(i){return i.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Rc.prototype.hexToBytes=function(i){for(var t=[],e=0;e<i.length;e+=2)t.push(String.fromCharCode(parseInt(i.substr(e,2),16)));return t.join("")},Rc.prototype.processOwnerPassword=function(i,t){return px(hx(t).substr(0,5),i)},Rc.prototype.encryptor=function(i,t){var e=hx(this.encryptionKey+String.fromCharCode(255&i,i>>8&255,i>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return px(e,n)}},cp.prototype.equals=function(i){var t,e="id,objectNumber,equals";if(!i||Gi(i)!==Gi(this))return!1;var n=0;for(t in this)if(!(e.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!i.hasOwnProperty(t)||this[t]!==i[t])return!1;n++}for(t in i)i.hasOwnProperty(t)&&e.indexOf(t)<0&&n--;return n===0},_t.API={events:[]},_t.version="3.0.3";var kn=_t.API,xx=1,D0=function(i){return i.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Lc=function(i){return i.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},ii=function(i){return i.toFixed(2)},Al=function(i){return i.toFixed(5)};kn.__acroform__={};var va=function(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i},oS=function(i){return i*xx},Ys=function(i){var t=new DS,e=St.internal.getHeight(i)||0,n=St.internal.getWidth(i)||0;return t.BBox=[0,0,Number(ii(n)),Number(ii(e))],t},qU=kn.__acroform__.setBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return i|1<<t},GU=kn.__acroform__.clearBit=function(i,t){if(i=i||0,t=t||0,isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return i&~(1<<t)},$U=kn.__acroform__.getBit=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return i&1<<t?1:0},Ln=kn.__acroform__.getBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return $U(i,t-1)},In=kn.__acroform__.setBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return qU(i,t-1)},Rn=kn.__acroform__.clearBitForPdf=function(i,t){if(isNaN(i)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return GU(i,t-1)},XU=kn.__acroform__.calculateCoordinates=function(i,t){var e=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,r=i[0],a=i[1],s=i[2],o=i[3],l={};return l.lowerLeft_X=e(r)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=e(r+s)||0,l.upperRight_Y=n(a)||0,[Number(ii(l.lowerLeft_X)),Number(ii(l.lowerLeft_Y)),Number(ii(l.upperRight_X)),Number(ii(l.upperRight_Y))]},YU=function(i){if(i.appearanceStreamContent)return i.appearanceStreamContent;if(i.V||i.DV){var t=[],e=i._V||i.DV,n=mx(i,e),r=i.scope.internal.getFont(i.fontName,i.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(i.scope.__private__.encodeColorString(i.color)),t.push("/"+r+" "+ii(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=Ys(i);return a.scope=i.scope,a.stream=t.join(`
`),a}},mx=function(i,t){var e=i.fontSize===0?i.maxFontSize:i.fontSize,n={text:"",fontSize:""},r=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");r=i.multiline?r.map(function(F){return F.split(`
`)}):r.map(function(F){return[F]});var a=e,s=St.internal.getHeight(i)||0;s=s<0?-s:s;var o=St.internal.getWidth(i)||0;o=o<0?-o:o;var l=function(F,I,ee){if(F+1<r.length){var le=I+" "+r[F+1][0];return tp(le,i,ee).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var c,u,h=tp("3",i,a).height,g=i.multiline?s-a:(s-h)/2,d=g+=2,b=0,_=0,w=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+tp(t,i,a=12).width+", FieldWidth:"+o+`
`;break}for(var E="",A=0,D=0;D<r.length;D++)if(r.hasOwnProperty(D)){var N=!1;if(r[D].length!==1&&w!==r[D].length-1){if((h+2)*(A+2)+2>s)continue e;E+=r[D][w],N=!0,_=D,D--}else{E=(E+=r[D][w]+" ").substr(E.length-1)==" "?E.substr(0,E.length-1):E;var z=parseInt(D),J=l(z,E,a),W=D>=r.length-1;if(J&&!W){E+=" ",w=0;continue}if(J||W){if(W)_=z;else if(i.multiline&&(h+2)*(A+2)+2>s)continue e}else{if(!i.multiline||(h+2)*(A+2)+2>s)continue e;_=z}}for(var U="",M=b;M<=_;M++){var X=r[M];if(i.multiline){if(M===_){U+=X[w]+" ",w=(w+1)%X.length;continue}if(M===b){U+=X[X.length-1]+" ";continue}}U+=X[0]+" "}switch(U=U.substr(U.length-1)==" "?U.substr(0,U.length-1):U,u=tp(U,i,a).width,i.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}t+=ii(c)+" "+ii(d)+` Td
`,t+="("+D0(U)+`) Tj
`,t+=-ii(c)+` 0 Td
`,d=-(a+2),u=0,b=N?_:_+1,A++,E=""}break}return n.text=t,n.fontSize=a,n},tp=function(i,t,e){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),r=t.scope.getStringUnitWidth(i,{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(e),charSpace:0})*parseFloat(e)*1.5,width:r}},KU={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ZU=function(i,t){var e={type:"reference",object:i};t.internal.getPageInfo(i.page).pageContext.annotations.find(function(n){return n.type===e.type&&n.object===e.object})===void 0&&t.internal.getPageInfo(i.page).pageContext.annotations.push(e)},JU=function(i,t){if(t.scope=i,i.internal!==void 0&&(i.internal.acroformPlugin===void 0||i.internal.acroformPlugin.isInitialized===!1)){if(ws.FieldNum=0,i.internal.acroformPlugin=JSON.parse(JSON.stringify(KU)),i.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");xx=i.internal.scaleFactor,i.internal.acroformPlugin.acroFormDictionaryRoot=new NS,i.internal.acroformPlugin.acroFormDictionaryRoot.scope=i,i.internal.acroformPlugin.acroFormDictionaryRoot._eventID=i.internal.events.subscribe("postPutResources",function(){(function(e){e.internal.events.unsubscribe(e.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete e.internal.acroformPlugin.acroFormDictionaryRoot._eventID,e.internal.acroformPlugin.printedOut=!0})(i)}),i.internal.events.subscribe("buildDocument",function(){(function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in n)if(n.hasOwnProperty(r)){var a=n[r];a.objId=void 0,a.hasAnnotation&&ZU(a,e)}})(i)}),i.internal.events.subscribe("putCatalog",function(){(function(e){if(e.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(i)}),i.internal.events.subscribe("postPutPages",function(e){(function(n,r){var a=!n;for(var s in n||(r.internal.newObjectDeferredBegin(r.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),r.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||r.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=XU(o.Rect,r)),r.internal.newObjectDeferredBegin(o.objId,!0),o.DA=St.createDefaultAppearanceStream(o),Gi(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=YU(o);l.push({key:"AP",value:"<</N "+u+">>"}),r.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var h="";for(var g in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(g)){var d=o.appearanceStreamContent[g];if(h+="/"+g+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var s in d)if(d.hasOwnProperty(s)){var b=d[s];typeof b=="function"&&(b=b.call(r,o)),h+="/"+s+" "+b+" ",r.internal.acroformPlugin.xForms.indexOf(b)>=0||r.internal.acroformPlugin.xForms.push(b)}}else typeof(b=d)=="function"&&(b=b.call(r,o)),h+="/"+s+" "+b,r.internal.acroformPlugin.xForms.indexOf(b)>=0||r.internal.acroformPlugin.xForms.push(b);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}r.internal.putStream({additionalKeyValues:l,objectId:o.objId}),r.internal.out("endobj")}a&&(function(_,w){for(var E in _)if(_.hasOwnProperty(E)){var A=E,D=_[E];w.internal.newObjectDeferredBegin(D.objId,!0),Gi(D)==="object"&&typeof D.putStream=="function"&&D.putStream(),delete _[A]}})(r.internal.acroformPlugin.xForms,r)})(e,i)}),i.internal.acroformPlugin.isInitialized=!0}},FS=kn.__acroform__.arrayToPdfArray=function(i,t,e){var n=function(s){return s};if(Array.isArray(i)){for(var r="[",a=0;a<i.length;a++)switch(a!==0&&(r+=" "),Gi(i[a])){case"boolean":case"number":case"object":r+=i[a].toString();break;case"string":i[a].substr(0,1)!=="/"?(t!==void 0&&e&&(n=e.internal.getEncryptor(t)),r+="("+D0(n(i[a].toString()))+")"):r+=i[a].toString()}return r+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},lx=function(i,t,e){var n=function(r){return r};return t!==void 0&&e&&(n=e.internal.getEncryptor(t)),(i=i||"").toString(),"("+D0(n(i))+")"},Ks=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(i){this._objId=i}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ks.prototype.toString=function(){return this.objId+" 0 R"},Ks.prototype.putStream=function(){var i=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:i,objectId:this.objId}),this.scope.internal.out("endobj")},Ks.prototype.getKeyValueListForStream=function(){var i=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var e in t)if(Object.getOwnPropertyDescriptor(this,t[e]).configurable===!1){var n=t[e],r=this[n];r&&(Array.isArray(r)?i.push({key:n,value:FS(r,this.objId,this.scope)}):r instanceof Ks?(r.scope=this.scope,i.push({key:n,value:r.objId+" 0 R"})):typeof r!="function"&&i.push({key:n,value:r}))}return i};var DS=function(){Ks.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var i,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(e){i=e.trim()},get:function(){return i||null}})};va(DS,Ks);var NS=function(){Ks.call(this);var i,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(i){var e=function(n){return n};return this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),"("+D0(e(i))+")"}},set:function(e){i=e}})};va(NS,Ks);var ws=function i(){Ks.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute F supplied.');t=E}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ln(t,3)},set:function(E){E?this.F=In(t,3):this.F=Rn(t,3)}});var e=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return e},set:function(E){if(isNaN(E))throw new Error('Invalid value "'+E+'" for attribute Ff supplied.');e=E}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(E){n=E!==void 0?E:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(E){n[0]=E}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(E){n[1]=E}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(E){n[2]=E}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(E){n[3]=E}});var r="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return r},set:function(E){switch(E){case"/Btn":case"/Tx":case"/Ch":case"/Sig":r=E;break;default:throw new Error('Invalid value "'+E+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof up)return;a="FieldObject"+i.FieldNum++}var E=function(A){return A};return this.scope&&(E=this.scope.internal.getEncryptor(this.objId)),"("+D0(E(a))+")"},set:function(E){a=E.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(E){a=E}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(E){s=E}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(E){o=E}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(E){l=E}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/xx:c},set:function(E){c=E}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(E){u=E}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof up||this instanceof F0))return lx(h,this.objId,this.scope)},set:function(E){E=E.toString(),h=E}});var g=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof br==0?lx(g,this.objId,this.scope):g},set:function(E){E=E.toString(),g=this instanceof br==0?E.substr(0,1)==="("?Lc(E.substr(1,E.length-2)):Lc(E):E}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof br==1?Lc(g.substr(1,g.length-1)):g},set:function(E){E=E.toString(),g=this instanceof br==1?"/"+E:E}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(E){this.V=E}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof br==0?lx(d,this.objId,this.scope):d},set:function(E){E=E.toString(),d=this instanceof br==0?E.substr(0,1)==="("?Lc(E.substr(1,E.length-2)):Lc(E):E}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof br==1?Lc(d.substr(1,d.length-1)):d},set:function(E){E=E.toString(),d=this instanceof br==1?"/"+E:E}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,_=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return _},set:function(E){E=!!E,_=E}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(E){b=E}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,1)},set:function(E){E?this.Ff=In(this.Ff,1):this.Ff=Rn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,2)},set:function(E){E?this.Ff=In(this.Ff,2):this.Ff=Rn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,3)},set:function(E){E?this.Ff=In(this.Ff,3):this.Ff=Rn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(E){if([0,1,2].indexOf(E)===-1)throw new Error('Invalid value "'+E+'" for attribute Q supplied.');w=E}}),Object.defineProperty(this,"textAlign",{get:function(){var E;switch(w){case 0:default:E="left";break;case 1:E="center";break;case 2:E="right"}return E},configurable:!0,enumerable:!0,set:function(E){switch(E){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};va(ws,Ks);var jc=function(){ws.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var i=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return FS(t,this.objId,this.scope)},set:function(e){var n,r;r=[],typeof(n=e)=="string"&&(r=(function(a,s,o){o||(o=1);for(var l,c=[];l=s.exec(a);)c.push(l[o]);return c})(n,/\((.*?)\)/g)),t=r}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,n){for(n=n||!1,e=(e=e||"").toString();t.indexOf(e)!==-1&&(t.splice(t.indexOf(e),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,18)},set:function(e){e?this.Ff=In(this.Ff,18):this.Ff=Rn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,19)},set:function(e){this.combo===!0&&(e?this.Ff=In(this.Ff,19):this.Ff=Rn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,20)},set:function(e){e?(this.Ff=In(this.Ff,20),t.sort()):this.Ff=Rn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,22)},set:function(e){e?this.Ff=In(this.Ff,22):this.Ff=Rn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,23)},set:function(e){e?this.Ff=In(this.Ff,23):this.Ff=Rn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,27)},set:function(e){e?this.Ff=In(this.Ff,27):this.Ff=Rn(this.Ff,27)}}),this.hasAppearanceStream=!1};va(jc,ws);var Vc=function(){jc.call(this),this.fontName="helvetica",this.combo=!1};va(Vc,jc);var Uc=function(){Vc.call(this),this.combo=!0};va(Uc,Vc);var ap=function(){Uc.call(this),this.edit=!0};va(ap,Uc);var br=function(){ws.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,15)},set:function(e){e?this.Ff=In(this.Ff,15):this.Ff=Rn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,16)},set:function(e){e?this.Ff=In(this.Ff,16):this.Ff=Rn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,17)},set:function(e){e?this.Ff=In(this.Ff,17):this.Ff=Rn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,26)},set:function(e){e?this.Ff=In(this.Ff,26):this.Ff=Rn(this.Ff,26)}});var i,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(a){return a};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,r=[];for(n in r.push("<<"),t)r.push("/"+n+" ("+D0(e(t[n]))+")");return r.push(">>"),r.join(`
`)}},set:function(e){Gi(e)==="object"&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){typeof e=="string"&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return i},set:function(e){i=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return i.substr(1,i.length-1)},set:function(e){i="/"+e}})};va(br,ws);var sp=function(){br.call(this),this.pushButton=!0};va(sp,br);var zc=function(){br.call(this),this.radio=!0,this.pushButton=!1;var i=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t!==void 0?t:[]}})};va(zc,br);var up=function(){var i,t;ws.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return i},set:function(r){i=r}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(r){t=r}});var e,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(o){return o};this.scope&&(r=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+D0(r(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(r){Gi(r)==="object"&&(n=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(r){typeof r=="string"&&(n.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=St.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};va(up,ws),zc.prototype.setAppearance=function(i){if(!("createAppearanceStream"in i)||!("getCA"in i))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var e=this.Kids[t];e.appearanceStreamContent=i.createAppearanceStream(e.optionName),e.caption=i.getCA()}},zc.prototype.createOption=function(i){var t=new up;return t.Parent=this,t.optionName=i,this.Kids.push(t),QU.call(this.scope,t),t};var op=function(){br.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=St.CheckBox.createAppearanceStream()};va(op,br);var F0=function(){ws.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,13)},set:function(t){t?this.Ff=In(this.Ff,13):this.Ff=Rn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,21)},set:function(t){t?this.Ff=In(this.Ff,21):this.Ff=Rn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,23)},set:function(t){t?this.Ff=In(this.Ff,23):this.Ff=Rn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,24)},set:function(t){t?this.Ff=In(this.Ff,24):this.Ff=Rn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,25)},set:function(t){t?this.Ff=In(this.Ff,25):this.Ff=Rn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,26)},set:function(t){t?this.Ff=In(this.Ff,26):this.Ff=Rn(this.Ff,26)}});var i=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return i},set:function(t){i=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return i},set:function(t){Number.isInteger(t)&&(i=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};va(F0,ws);var lp=function(){F0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ln(this.Ff,14)},set:function(i){i?this.Ff=In(this.Ff,14):this.Ff=Rn(this.Ff,14)}}),this.password=!0};va(lp,F0);var St={CheckBox:{createAppearanceStream:function(){return{N:{On:St.CheckBox.YesNormal},D:{On:St.CheckBox.YesPushDown,Off:St.CheckBox.OffPushDown}}},YesPushDown:function(i){var t=Ys(i);t.scope=i.scope;var e=[],n=i.scope.internal.getFont(i.fontName,i.fontStyle).id,r=i.scope.__private__.encodeColorString(i.color),a=mx(i,i.caption);return e.push("0.749023 g"),e.push("0 0 "+ii(St.internal.getWidth(i))+" "+ii(St.internal.getHeight(i))+" re"),e.push("f"),e.push("BMC"),e.push("q"),e.push("0 0 1 rg"),e.push("/"+n+" "+ii(a.fontSize)+" Tf "+r),e.push("BT"),e.push(a.text),e.push("ET"),e.push("Q"),e.push("EMC"),t.stream=e.join(`
`),t},YesNormal:function(i){var t=Ys(i);t.scope=i.scope;var e=i.scope.internal.getFont(i.fontName,i.fontStyle).id,n=i.scope.__private__.encodeColorString(i.color),r=[],a=St.internal.getHeight(i),s=St.internal.getWidth(i),o=mx(i,i.caption);return r.push("1 g"),r.push("0 0 "+ii(s)+" "+ii(a)+" re"),r.push("f"),r.push("q"),r.push("0 0 1 rg"),r.push("0 0 "+ii(s-1)+" "+ii(a-1)+" re"),r.push("W"),r.push("n"),r.push("0 g"),r.push("BT"),r.push("/"+e+" "+ii(o.fontSize)+" Tf "+n),r.push(o.text),r.push("ET"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(i){var t=Ys(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+ii(St.internal.getWidth(i))+" "+ii(St.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(i){var t={D:{Off:St.RadioButton.Circle.OffPushDown},N:{}};return t.N[i]=St.RadioButton.Circle.YesNormal,t.D[i]=St.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(i){var t=Ys(i);t.scope=i.scope;var e=[],n=St.internal.getWidth(i)<=St.internal.getHeight(i)?St.internal.getWidth(i)/4:St.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=St.internal.Bezier_C,a=Number((n*r).toFixed(5));return e.push("q"),e.push("1 0 0 1 "+Al(St.internal.getWidth(i)/2)+" "+Al(St.internal.getHeight(i)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),e.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),e.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),e.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=Ys(i);t.scope=i.scope;var e=[],n=St.internal.getWidth(i)<=St.internal.getHeight(i)?St.internal.getWidth(i)/4:St.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),a=Number((r*St.internal.Bezier_C).toFixed(5)),s=Number((n*St.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Al(St.internal.getWidth(i)/2)+" "+Al(St.internal.getHeight(i)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),e.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),e.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),e.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),e.push("f"),e.push("Q"),e.push("0 g"),e.push("q"),e.push("1 0 0 1 "+Al(St.internal.getWidth(i)/2)+" "+Al(St.internal.getHeight(i)/2)+" cm"),e.push(n+" 0 m"),e.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),e.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),e.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),e.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t},OffPushDown:function(i){var t=Ys(i);t.scope=i.scope;var e=[],n=St.internal.getWidth(i)<=St.internal.getHeight(i)?St.internal.getWidth(i)/4:St.internal.getHeight(i)/4;n=Number((.9*n).toFixed(5));var r=Number((2*n).toFixed(5)),a=Number((r*St.internal.Bezier_C).toFixed(5));return e.push("0.749023 g"),e.push("q"),e.push("1 0 0 1 "+Al(St.internal.getWidth(i)/2)+" "+Al(St.internal.getHeight(i)/2)+" cm"),e.push(r+" 0 m"),e.push(r+" "+a+" "+a+" "+r+" 0 "+r+" c"),e.push("-"+a+" "+r+" -"+r+" "+a+" -"+r+" 0 c"),e.push("-"+r+" -"+a+" -"+a+" -"+r+" 0 -"+r+" c"),e.push(a+" -"+r+" "+r+" -"+a+" "+r+" 0 c"),e.push("f"),e.push("Q"),t.stream=e.join(`
`),t}},Cross:{createAppearanceStream:function(i){var t={D:{Off:St.RadioButton.Cross.OffPushDown},N:{}};return t.N[i]=St.RadioButton.Cross.YesNormal,t.D[i]=St.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(i){var t=Ys(i);t.scope=i.scope;var e=[],n=St.internal.calculateCross(i);return e.push("q"),e.push("1 1 "+ii(St.internal.getWidth(i)-2)+" "+ii(St.internal.getHeight(i)-2)+" re"),e.push("W"),e.push("n"),e.push(ii(n.x1.x)+" "+ii(n.x1.y)+" m"),e.push(ii(n.x2.x)+" "+ii(n.x2.y)+" l"),e.push(ii(n.x4.x)+" "+ii(n.x4.y)+" m"),e.push(ii(n.x3.x)+" "+ii(n.x3.y)+" l"),e.push("s"),e.push("Q"),t.stream=e.join(`
`),t},YesPushDown:function(i){var t=Ys(i);t.scope=i.scope;var e=St.internal.calculateCross(i),n=[];return n.push("0.749023 g"),n.push("0 0 "+ii(St.internal.getWidth(i))+" "+ii(St.internal.getHeight(i))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+ii(St.internal.getWidth(i)-2)+" "+ii(St.internal.getHeight(i)-2)+" re"),n.push("W"),n.push("n"),n.push(ii(e.x1.x)+" "+ii(e.x1.y)+" m"),n.push(ii(e.x2.x)+" "+ii(e.x2.y)+" l"),n.push(ii(e.x4.x)+" "+ii(e.x4.y)+" m"),n.push(ii(e.x3.x)+" "+ii(e.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(i){var t=Ys(i);t.scope=i.scope;var e=[];return e.push("0.749023 g"),e.push("0 0 "+ii(St.internal.getWidth(i))+" "+ii(St.internal.getHeight(i))+" re"),e.push("f"),t.stream=e.join(`
`),t}}},createDefaultAppearanceStream:function(i){var t=i.scope.internal.getFont(i.fontName,i.fontStyle).id,e=i.scope.__private__.encodeColorString(i.color);return"/"+t+" "+i.fontSize+" Tf "+e}};St.internal={Bezier_C:.551915024494,calculateCross:function(i){var t=St.internal.getWidth(i),e=St.internal.getHeight(i),n=Math.min(t,e);return{x1:{x:(t-n)/2,y:(e-n)/2+n},x2:{x:(t-n)/2+n,y:(e-n)/2},x3:{x:(t-n)/2,y:(e-n)/2},x4:{x:(t-n)/2+n,y:(e-n)/2+n}}}},St.internal.getWidth=function(i){var t=0;return Gi(i)==="object"&&(t=oS(i.Rect[2])),t},St.internal.getHeight=function(i){var t=0;return Gi(i)==="object"&&(t=oS(i.Rect[3])),t};var QU=kn.addField=function(i){if(JU(this,i),!(i instanceof ws))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=i).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),i.page=i.scope.internal.getCurrentPageInfo().pageNumber,this};kn.AcroFormChoiceField=jc,kn.AcroFormListBox=Vc,kn.AcroFormComboBox=Uc,kn.AcroFormEditBox=ap,kn.AcroFormButton=br,kn.AcroFormPushButton=sp,kn.AcroFormRadioButton=zc,kn.AcroFormCheckBox=op,kn.AcroFormTextField=F0,kn.AcroFormPasswordField=lp,kn.AcroFormAppearance=St,kn.AcroForm={ChoiceField:jc,ListBox:Vc,ComboBox:Uc,EditBox:ap,Button:br,PushButton:sp,RadioButton:zc,CheckBox:op,TextField:F0,PasswordField:lp,Appearance:St},_t.AcroForm={ChoiceField:jc,ListBox:Vc,ComboBox:Uc,EditBox:ap,Button:br,PushButton:sp,RadioButton:zc,CheckBox:op,TextField:F0,PasswordField:lp,Appearance:St};var oJ=_t.AcroForm;function PS(i){return i.reduce(function(t,e,n){return t[e]=n,t},{})}(function(i){var t="addImage_";i.__addimage__={};var e="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=i.__addimage__.getImageFileTypeByImageData=function(F,I){var ee,le,de,ke,Fe,Se=e;if((I=I||e)==="RGBA"||F.data!==void 0&&F.data instanceof Uint8ClampedArray&&"height"in F&&"width"in F)return"RGBA";if(J(F))for(Fe in n)for(de=n[Fe],ee=0;ee<de.length;ee+=1){for(ke=!0,le=0;le<de[ee].length;le+=1)if(de[ee][le]!==void 0&&de[ee][le]!==F[le]){ke=!1;break}if(ke===!0){Se=Fe;break}}else for(Fe in n)for(de=n[Fe],ee=0;ee<de.length;ee+=1){for(ke=!0,le=0;le<de[ee].length;le+=1)if(de[ee][le]!==void 0&&de[ee][le]!==F.charCodeAt(le)){ke=!1;break}if(ke===!0){Se=Fe;break}}return Se===e&&I!==e&&(Se=I),Se},a=function F(I){for(var ee=this.internal.write,le=this.internal.putStream,de=(0,this.internal.getFilters)();de.indexOf("FlateEncode")!==-1;)de.splice(de.indexOf("FlateEncode"),1);I.objectId=this.internal.newObject();var ke=[];if(ke.push({key:"Type",value:"/XObject"}),ke.push({key:"Subtype",value:"/Image"}),ke.push({key:"Width",value:I.width}),ke.push({key:"Height",value:I.height}),I.colorSpace===E.INDEXED?ke.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(I.palette.length/3-1)+" "+("sMask"in I&&I.sMask!==void 0?I.objectId+2:I.objectId+1)+" 0 R]"}):(ke.push({key:"ColorSpace",value:"/"+I.colorSpace}),I.colorSpace===E.DEVICE_CMYK&&ke.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ke.push({key:"BitsPerComponent",value:I.bitsPerComponent}),"decodeParameters"in I&&I.decodeParameters!==void 0&&ke.push({key:"DecodeParms",value:"<<"+I.decodeParameters+">>"}),"transparency"in I&&Array.isArray(I.transparency)&&I.transparency.length>0){for(var Fe="",Se=0,Oe=I.transparency.length;Se<Oe;Se++)Fe+=I.transparency[Se]+" "+I.transparency[Se]+" ";ke.push({key:"Mask",value:"["+Fe+"]"})}I.sMask!==void 0&&ke.push({key:"SMask",value:I.objectId+1+" 0 R"});var Ze=I.filter!==void 0?["/"+I.filter]:void 0;if(le({data:I.data,additionalKeyValues:ke,alreadyAppliedFilters:Ze,objectId:I.objectId}),ee("endobj"),"sMask"in I&&I.sMask!==void 0){var qe,k=(qe=I.sMaskBitsPerComponent)!==null&&qe!==void 0?qe:I.bitsPerComponent,B={width:I.width,height:I.height,colorSpace:"DeviceGray",bitsPerComponent:k,data:I.sMask};"filter"in I&&(B.decodeParameters="/Predictor ".concat(I.predictor," /Colors 1 /BitsPerComponent ").concat(k," /Columns ").concat(I.width),B.filter=I.filter),F.call(this,B)}if(I.colorSpace===E.INDEXED){var P=this.internal.newObject();le({data:U(new Uint8Array(I.palette)),objectId:P}),ee("endobj")}},s=function(){var F=this.internal.collections[t+"images"];for(var I in F)a.call(this,F[I])},o=function(){var F,I=this.internal.collections[t+"images"],ee=this.internal.write;for(var le in I)ee("/I"+(F=I[le]).index,F.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var F=this.internal.collections[t+"images"];return l.call(this),F},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(F){return typeof i["process"+F.toUpperCase()]=="function"},g=function(F){return Gi(F)==="object"&&F.nodeType===1},d=function(F,I){if(F.nodeName==="IMG"&&F.hasAttribute("src")){var ee=""+F.getAttribute("src");if(ee.indexOf("data:image/")===0)return rp(unescape(ee).split("base64,").pop());var le=i.loadFile(ee,!0);if(le!==void 0)return le}if(F.nodeName==="CANVAS"){if(F.width===0||F.height===0)throw new Error("Given canvas must have data. Canvas width: "+F.width+", height: "+F.height);var de;switch(I){case"PNG":de="image/png";break;case"WEBP":de="image/webp";break;default:de="image/jpeg"}return rp(F.toDataURL(de,1).split("base64,").pop())}},b=function(F){var I=this.internal.collections[t+"images"];if(I){for(var ee in I)if(F===I[ee].alias)return I[ee]}},_=function(F,I,ee){return F||I||(F=-96,I=-96),F<0&&(F=-1*ee.width*72/F/this.internal.scaleFactor),I<0&&(I=-1*ee.height*72/I/this.internal.scaleFactor),F===0&&(F=I*ee.width/ee.height),I===0&&(I=F*ee.height/ee.width),[F,I]},w=function(F,I,ee,le,de,ke){var Fe=_.call(this,ee,le,de),Se=this.internal.getCoordinateString,Oe=this.internal.getVerticalCoordinateString,Ze=c.call(this);if(ee=Fe[0],le=Fe[1],Ze[de.index]=de,ke){ke*=Math.PI/180;var qe=Math.cos(ke),k=Math.sin(ke),B=function(O){return O.toFixed(4)},P=[B(qe),B(k),B(-1*k),B(qe),0,0,"cm"]}this.internal.write("q"),ke?(this.internal.write([1,"0","0",1,Se(F),Oe(I+le),"cm"].join(" ")),this.internal.write(P.join(" ")),this.internal.write([Se(ee),"0","0",Se(le),"0","0","cm"].join(" "))):this.internal.write([Se(ee),"0","0",Se(le),Se(F),Oe(I+le),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+de.index+" Do"),this.internal.write("Q")},E=i.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};i.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var A=i.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},D=i.__addimage__.sHashCode=function(F){var I,ee,le=0;if(typeof F=="string")for(ee=F.length,I=0;I<ee;I++)le=(le<<5)-le+F.charCodeAt(I),le|=0;else if(J(F))for(ee=F.byteLength/2,I=0;I<ee;I++)le=(le<<5)-le+F[I],le|=0;return le},N=i.__addimage__.validateStringAsBase64=function(F){(F=F||"").toString().trim();var I=!0;return F.length===0&&(I=!1),F.length%4!=0&&(I=!1),/^[A-Za-z0-9+/]+$/.test(F.substr(0,F.length-2))===!1&&(I=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(F.substr(-2))===!1&&(I=!1),I},z=i.__addimage__.extractImageFromDataUrl=function(F){if(F==null||!(F=F.trim()).startsWith("data:"))return null;var I=F.indexOf(",");return I<0?null:F.substring(0,I).trim().endsWith("base64")?F.substring(I+1):null};i.__addimage__.isArrayBuffer=function(F){return F instanceof ArrayBuffer};var J=i.__addimage__.isArrayBufferView=function(F){return F instanceof Int8Array||F instanceof Uint8Array||F instanceof Uint8ClampedArray||F instanceof Int16Array||F instanceof Uint16Array||F instanceof Int32Array||F instanceof Uint32Array||F instanceof Float32Array||F instanceof Float64Array},W=i.__addimage__.binaryStringToUint8Array=function(F){for(var I=F.length,ee=new Uint8Array(I),le=0;le<I;le++)ee[le]=F.charCodeAt(le);return ee},U=i.__addimage__.arrayBufferToBinaryString=function(F){for(var I="",ee=J(F)?F:new Uint8Array(F),le=0;le<ee.length;le+=8192)I+=String.fromCharCode.apply(null,ee.subarray(le,le+8192));return I};i.addImage=function(){var F,I,ee,le,de,ke,Fe,Se,Oe;if(typeof arguments[1]=="number"?(I=e,ee=arguments[1],le=arguments[2],de=arguments[3],ke=arguments[4],Fe=arguments[5],Se=arguments[6],Oe=arguments[7]):(I=arguments[1],ee=arguments[2],le=arguments[3],de=arguments[4],ke=arguments[5],Fe=arguments[6],Se=arguments[7],Oe=arguments[8]),Gi(F=arguments[0])==="object"&&!g(F)&&"imageData"in F){var Ze=F;F=Ze.imageData,I=Ze.format||I||e,ee=Ze.x||ee||0,le=Ze.y||le||0,de=Ze.w||Ze.width||de,ke=Ze.h||Ze.height||ke,Fe=Ze.alias||Fe,Se=Ze.compression||Se,Oe=Ze.rotation||Ze.angle||Oe}var qe=this.internal.getFilters();if(Se===void 0&&qe.indexOf("FlateEncode")!==-1&&(Se="SLOW"),isNaN(ee)||isNaN(le))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var k=M.call(this,F,I,Fe,Se);return w.call(this,ee,le,de,ke,k,Oe),this};var M=function(F,I,ee,le){var de,ke,Fe;if(typeof F=="string"&&r(F)===e){F=unescape(F);var Se=X(F,!1);(Se!==""||(Se=i.loadFile(F,!0))!==void 0)&&(F=Se)}if(g(F)&&(F=d(F,I)),I=r(F,I),!h(I))throw new Error("addImage does not support files of type '"+I+"', please ensure that a plugin for '"+I+"' support is added.");if(((Fe=ee)==null||Fe.length===0)&&(ee=(function(Oe){return typeof Oe=="string"||J(Oe)?D(Oe):J(Oe.data)?D(Oe.data):null})(F)),(de=b.call(this,ee))||(F instanceof Uint8Array||I==="RGBA"||(ke=F,F=W(F)),de=this["process"+I.toUpperCase()](F,u.call(this),ee,(function(Oe){return Oe&&typeof Oe=="string"&&(Oe=Oe.toUpperCase()),Oe in i.image_compression?Oe:A.NONE})(le),ke)),!de)throw new Error("An unknown error occurred whilst processing the image.");return de},X=i.__addimage__.convertBase64ToBinaryString=function(F,I){I=typeof I!="boolean"||I;var ee,le="";if(typeof F=="string"){var de;ee=(de=z(F))!==null&&de!==void 0?de:F;try{le=rp(ee)}catch(ke){if(I)throw N(ee)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ke.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return le};i.getImageProperties=function(F){var I,ee,le="";if(g(F)&&(F=d(F)),typeof F=="string"&&r(F)===e&&((le=X(F,!1))===""&&(le=i.loadFile(F)||""),F=le),ee=r(F),!h(ee))throw new Error("addImage does not support files of type '"+ee+"', please ensure that a plugin for '"+ee+"' support is added.");if(F instanceof Uint8Array||(F=W(F)),!(I=this["process"+ee.toUpperCase()](F)))throw new Error("An unknown error occurred whilst processing the image");return I.fileType=ee,I}})(_t.API),(function(i){var t=function(e){if(e!==void 0&&e!="")return!0};_t.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),i.events.push(["putPage",function(e){for(var n,r,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(e.objId),c=e.pageContext.annotations,u=!1,h=0;h<c.length&&!u;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var g=0;g<c.length;g++){n=c[g];var d=this.internal.pdfEscape,b=this.internal.getEncryptor(e.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var _=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),E=this.internal.getEncryptor(_.objId),A=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(r="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(E(n.contents))+")",a+=" /Popup "+w.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+d(E(A))+") >>",_.content=a;var D=_.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(r="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+D,n.open&&(a+=" /Open true"),a+=" >>",w.content=a,this.internal.write(_.objId,"0 R",w.objId,"0 R");break;case"freetext":r="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var N=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+r+"/Contents ("+d(b(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var z=this.annotations._nameMap[n.options.name];n.options.pageNumber=z.page,n.options.top=z.y}else n.options.top||(n.options.top=0);if(r="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /A <</S /URI /URI ("+d(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+r+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var J=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+J+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),i.createAnnotation=function(e){var n=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":n.pageContext.annotations.push(e)}},i.link=function(e,n,r,a,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(e),y:c(n),w:l(e+r),h:c(n+a)},options:s,type:"link"})},i.textWithLink=function(e,n,r,a){var s,o,l=this.getTextWidth(e),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var u=this.splitTextToSize(e,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(e,n,r,a),r+=.2*c,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,r-c,o,s,a),l},i.getTextWidth=function(e){var n=this.internal.getFontSize();return this.getStringUnitWidth(e)*n/this.internal.scaleFactor}})(_t.API),(function(i){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},e={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},r=[1570,1571,1573,1575];i.__arabicParser__={};var a=i.__arabicParser__.isInArabicSubstitutionA=function(_){return t[_.charCodeAt(0)]!==void 0},s=i.__arabicParser__.isArabicLetter=function(_){return typeof _=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(_)},o=i.__arabicParser__.isArabicEndLetter=function(_){return s(_)&&a(_)&&t[_.charCodeAt(0)].length<=2},l=i.__arabicParser__.isArabicAlfLetter=function(_){return s(_)&&r.indexOf(_.charCodeAt(0))>=0};i.__arabicParser__.arabicLetterHasIsolatedForm=function(_){return s(_)&&a(_)&&t[_.charCodeAt(0)].length>=1};var c=i.__arabicParser__.arabicLetterHasFinalForm=function(_){return s(_)&&a(_)&&t[_.charCodeAt(0)].length>=2};i.__arabicParser__.arabicLetterHasInitialForm=function(_){return s(_)&&a(_)&&t[_.charCodeAt(0)].length>=3};var u=i.__arabicParser__.arabicLetterHasMedialForm=function(_){return s(_)&&a(_)&&t[_.charCodeAt(0)].length==4},h=i.__arabicParser__.resolveLigatures=function(_){var w=0,E=e,A="",D=0;for(w=0;w<_.length;w+=1)E[_.charCodeAt(w)]!==void 0?(D++,typeof(E=E[_.charCodeAt(w)])=="number"&&(A+=String.fromCharCode(E),E=e,D=0),w===_.length-1&&(E=e,A+=_.charAt(w-(D-1)),w-=D-1,D=0)):(E=e,A+=_.charAt(w-D),w-=D,D=0);return A};i.__arabicParser__.isArabicDiacritic=function(_){return _!==void 0&&n[_.charCodeAt(0)]!==void 0};var g=i.__arabicParser__.getCorrectForm=function(_,w,E){return s(_)?a(_)===!1?-1:!c(_)||!s(w)&&!s(E)||!s(E)&&o(w)||o(_)&&!s(w)||o(_)&&l(w)||o(_)&&o(w)?0:u(_)&&s(w)&&!o(w)&&s(E)&&c(E)?3:o(_)||!s(E)?1:2:-1},d=function(_){var w=0,E=0,A=0,D="",N="",z="",J=(_=_||"").split("\\s+"),W=[];for(w=0;w<J.length;w+=1){for(W.push(""),E=0;E<J[w].length;E+=1)D=J[w][E],N=J[w][E-1],z=J[w][E+1],s(D)?(A=g(D,N,z),W[w]+=A!==-1?String.fromCharCode(t[D.charCodeAt(0)][A]):D):W[w]+=D;W[w]=h(W[w])}return W.join(" ")},b=i.__arabicParser__.processArabic=i.processArabic=function(){var _,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,E=[];if(Array.isArray(w)){var A=0;for(E=[],A=0;A<w.length;A+=1)Array.isArray(w[A])?E.push([d(w[A][0]),w[A][1],w[A][2]]):E.push([d(w[A])]);_=E}else _=d(w);return typeof arguments[0]=="string"?_:(arguments[0].text=_,arguments[0])};i.events.push(["preProcessText",b])})(_t.API),_t.API.autoPrint=function(i){var t;return(i=i||{}).variant=i.variant||"non-conform",i.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(i){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(o){e=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,n){var r;if((e=e||"2d")!=="2d")return null;for(r in n)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=n[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},i.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(_t.API),(function(i){var t={left:0,top:0,bottom:0,right:0},e=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),r.call(this))},r=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(_){l=_}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(_){c=_}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(_){u=_}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(_){h=_}});var g=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return g},set:function(_){g=_}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(_){d=_}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(_){b=_}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},i.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},i.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),g=c.scaleFactor||this.internal.scaleFactor,d=0,b=0,_=0,w=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var E=c.maxWidth;E>0?typeof l=="string"?l=this.splitTextToSize(l,E):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(D,N){return D.concat(w.splitTextToSize(N,E))},[])):l=Array.isArray(l)?l:[l];for(var A=0;A<l.length;A++)d<(_=this.getStringUnitWidth(l[A],{font:h})*u)&&(d=_);return d!==0&&(b=l.length),{w:d/=g,h:Math.max((b*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/g,0)}},i.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=i.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,g=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,d&&g&&(this.printHeaderRow(l.lineNumber,!0),l.y+=g[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,e===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};i.table=function(l,c,u,h,g){if(n.call(this),!u)throw new Error("No data for PDF table.");var d,b,_,w,E=[],A=[],D=[],N={},z={},J=[],W=[],U=(g=g||{}).autoSize||!1,M=g.printHeaders!==!1,X=g.css&&g.css["font-size"]!==void 0?16*g.css["font-size"]:g.fontSize||12,F=g.margins||Object.assign({width:this.getPageWidth()},t),I=typeof g.padding=="number"?g.padding:3,ee=g.headerBackgroundColor||"#c8c8c8",le=g.headerTextColor||"#000";if(r.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=F,this.internal.__cell__.table_font_size=X,this.internal.__cell__.padding=I,this.internal.__cell__.headerBackgroundColor=ee,this.internal.__cell__.headerTextColor=le,this.setFontSize(X),h==null)A=E=Object.keys(u[0]),D=E.map(function(){return"left"});else if(Array.isArray(h)&&Gi(h[0])==="object")for(E=h.map(function(Ze){return Ze.name}),A=h.map(function(Ze){return Ze.prompt||Ze.name||""}),D=h.map(function(Ze){return Ze.align||"left"}),d=0;d<h.length;d+=1)z[h[d].name]=.7499990551181103*h[d].width;else Array.isArray(h)&&typeof h[0]=="string"&&(A=E=h,D=E.map(function(){return"left"}));if(U||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<E.length;d+=1){for(N[w=E[d]]=u.map(function(Ze){return Ze[w]}),this.setFont(void 0,"bold"),J.push(this.getTextDimensions(A[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=N[w],this.setFont(void 0,"normal"),_=0;_<b.length;_+=1)J.push(this.getTextDimensions(b[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);z[w]=Math.max.apply(null,J)+I+I,J=[]}if(M){var de={};for(d=0;d<E.length;d+=1)de[E[d]]={},de[E[d]].text=A[d],de[E[d]].align=D[d];var ke=o.call(this,de,z);W=E.map(function(Ze){return new a(l,c,z[Ze],ke,de[Ze].text,void 0,de[Ze].align)}),this.setTableHeaderRow(W),this.printHeaderRow(1,!1)}var Fe=h.reduce(function(Ze,qe){return Ze[qe.name]=qe.align,Ze},{});for(d=0;d<u.length;d+=1){"rowStart"in g&&g.rowStart instanceof Function&&g.rowStart({row:d,data:u[d]},this);var Se=o.call(this,u[d],z);for(_=0;_<E.length;_+=1){var Oe=u[d][E[_]];"cellStart"in g&&g.cellStart instanceof Function&&g.cellStart({row:d,col:_,data:Oe},this),s.call(this,new a(l,c,z[E[_]],Se,Oe,d+2,Fe[E[_]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,g=this.internal.scaleFactor;return Object.keys(l).map(function(d){var b=l[d];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,c[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/g+u+u},this).reduce(function(d,b){return Math.max(d,b)},0)};i.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},i.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(e=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var g=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,g.push(u)),u.lineNumber=l;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(b)}g.length>0&&this.setTableHeaderRow(g),this.setFont(void 0,"normal"),e=!1}})(_t.API);var MS={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},LS=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],gx=PS(LS),IS=[100,200,300,400,500,600,700,800,900],ez=PS(IS);function cx(i){var t=i.family.replace(/"|'/g,"").toLowerCase(),e=(function(a){return MS[a=a||"normal"]?a:"normal"})(i.style),n=(function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400})(i.weight),r=(function(a){return typeof gx[a=a||"normal"]=="number"?a:"normal"})(i.stretch);return{family:t,style:e,weight:n,stretch:r,src:i.src||[],ref:i.ref||{name:t,style:[r,e,n].join(" ")}}}function lS(i,t,e,n){var r;for(r=e;r>=0&&r<t.length;r+=n)if(i[t[r]])return i[t[r]];for(r=e;r>=0&&r<t.length;r-=n)if(i[t[r]])return i[t[r]]}var tz={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},cS={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function uS(i){return[i.stretch,i.style,i.weight,i.family].join(" ")}function dS(i){return i.trimLeft()}function iz(i,t){for(var e=0;e<i.length;){if(i.charAt(e)===t)return[i.substring(0,e),i.substring(e+1)];e+=1}return null}function nz(i){var t=i.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],i.substring(t[0].length)]}var ip,fS,hS,Ic,np,pS,mS,gS,ux=["times"];function xS(i,t,e,n,r){var a=4,s=_S;switch(r){case _t.API.image_compression.FAST:a=1,s=vS;break;case _t.API.image_compression.MEDIUM:a=6,s=bS;break;case _t.API.image_compression.SLOW:a=9,s=wS}i=(function(l,c,u,h){for(var g,d=l.length/c,b=new Uint8Array(l.length+d),_=[rz,vS,_S,bS,wS],w=0;w<d;w+=1){var E=w*c,A=l.subarray(E,E+c);if(h)b.set(h(A,u,g),E+w);else{for(var D=_.length,N=[],z=0;z<D;z+=1)N[z]=_[z](A,u,g);var J=sz(N.concat());b.set(N[J],E+w)}g=A}return b})(i,t,Math.ceil(e*n/8),s);var o=P1(i,{level:a});return _t.API.__addimage__.arrayBufferToBinaryString(o)}function rz(i){var t=Array.apply([],i);return t.unshift(0),t}function vS(i,t){var e=i.length,n=[];n[0]=1;for(var r=0;r<e;r+=1){var a=i[r-t]||0;n[r+1]=i[r]-a+256&255}return n}function _S(i,t,e){var n=i.length,r=[];r[0]=2;for(var a=0;a<n;a+=1){var s=e&&e[a]||0;r[a+1]=i[a]-s+256&255}return r}function bS(i,t,e){var n=i.length,r=[];r[0]=3;for(var a=0;a<n;a+=1){var s=i[a-t]||0,o=e&&e[a]||0;r[a+1]=i[a]+256-(s+o>>>1)&255}return r}function wS(i,t,e){var n=i.length,r=[];r[0]=4;for(var a=0;a<n;a+=1){var s=az(i[a-t]||0,e&&e[a]||0,e&&e[a-t]||0);r[a+1]=i[a]-s+256&255}return r}function az(i,t,e){if(i===t&&t===e)return i;var n=Math.abs(t-e),r=Math.abs(i-e),a=Math.abs(i+t-e-e);return n<=r&&n<=a?i:r<=a?t:e}function sz(i){var t=i.map(function(e){return e.reduce(function(n,r){return n+Math.abs(r)},0)});return t.indexOf(Math.min.apply(null,t))}function dx(i,t,e){var n=t*e,r=Math.floor(n/8),a=16-(n-8*r+e),s=(1<<e)-1;return RS(i,r)>>a&s}function yS(i,t,e,n){var r=e*n,a=Math.floor(r/8),s=16-(r-8*a+n),o=(1<<n)-1,l=(t&o)<<s;(function(c,u,h){if(u+1<c.byteLength)c.setUint16(u,h,!1);else{var g=h>>8&255;c.setUint8(u,g)}})(i,a,RS(i,a)&~(o<<s)&65535|l)}function RS(i,t){return t+1<i.byteLength?i.getUint16(t,!1):i.getUint8(t)<<8}function oz(i){var t=0;if(i[t++]!==71||i[t++]!==73||i[t++]!==70||i[t++]!==56||(i[t++]+1&253)!=56||i[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var e=i[t++]|i[t++]<<8,n=i[t++]|i[t++]<<8,r=i[t++],a=r>>7,s=1<<1+(7&r);i[t++],i[t++];var o=null,l=null;a&&(o=t,l=s,t+=3*s);var c=!0,u=[],h=0,g=null,d=0,b=null;for(this.width=e,this.height=n;c&&t<i.length;)switch(i[t++]){case 33:switch(i[t++]){case 255:if(i[t]!==11||i[t+1]==78&&i[t+2]==69&&i[t+3]==84&&i[t+4]==83&&i[t+5]==67&&i[t+6]==65&&i[t+7]==80&&i[t+8]==69&&i[t+9]==50&&i[t+10]==46&&i[t+11]==48&&i[t+12]==3&&i[t+13]==1&&i[t+16]==0)t+=14,b=i[t++]|i[t++]<<8,t++;else for(t+=12;;){if(!((F=i[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;case 249:if(i[t++]!==4||i[t+4]!==0)throw new Error("Invalid graphics extension block.");var _=i[t++];h=i[t++]|i[t++]<<8,g=i[t++],1&_||(g=null),d=_>>2&7,t++;break;case 254:for(;;){if(!((F=i[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}break;default:throw new Error("Unknown graphic control label: 0x"+i[t-1].toString(16))}break;case 44:var w=i[t++]|i[t++]<<8,E=i[t++]|i[t++]<<8,A=i[t++]|i[t++]<<8,D=i[t++]|i[t++]<<8,N=i[t++],z=N>>6&1,J=1<<1+(7&N),W=o,U=l,M=!1;N>>7&&(M=!0,W=t,U=J,t+=3*J);var X=t;for(t++;;){var F;if(!((F=i[t++])>=0))throw Error("Invalid block size");if(F===0)break;t+=F}u.push({x:w,y:E,width:A,height:D,has_local_palette:M,palette_offset:W,palette_size:U,data_offset:X,data_length:t-X,transparent_index:g,interlaced:!!z,delay:h,disposal:d});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+i[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return b},this.frameInfo=function(I){if(I<0||I>=u.length)throw new Error("Frame index out of range.");return u[I]},this.decodeAndBlitFrameBGRA=function(I,ee){var le=this.frameInfo(I),de=le.width*le.height,ke=new Uint8Array(de);SS(i,le.data_offset,ke,de);var Fe=le.palette_offset,Se=le.transparent_index;Se===null&&(Se=256);var Oe=le.width,Ze=e-Oe,qe=Oe,k=4*(le.y*e+le.x),B=4*((le.y+le.height)*e+le.x),P=k,O=4*Ze;le.interlaced===!0&&(O+=4*e*7);for(var Q=8,fe=0,ye=ke.length;fe<ye;++fe){var pe=ke[fe];if(qe===0&&(qe=Oe,(P+=O)>=B&&(O=4*Ze+4*e*(Q-1),P=k+(Oe+Ze)*(Q<<1),Q>>=1)),pe===Se)P+=4;else{var ge=i[Fe+3*pe],Xe=i[Fe+3*pe+1],Je=i[Fe+3*pe+2];ee[P++]=Je,ee[P++]=Xe,ee[P++]=ge,ee[P++]=255}--qe}},this.decodeAndBlitFrameRGBA=function(I,ee){var le=this.frameInfo(I),de=le.width*le.height,ke=new Uint8Array(de);SS(i,le.data_offset,ke,de);var Fe=le.palette_offset,Se=le.transparent_index;Se===null&&(Se=256);var Oe=le.width,Ze=e-Oe,qe=Oe,k=4*(le.y*e+le.x),B=4*((le.y+le.height)*e+le.x),P=k,O=4*Ze;le.interlaced===!0&&(O+=4*e*7);for(var Q=8,fe=0,ye=ke.length;fe<ye;++fe){var pe=ke[fe];if(qe===0&&(qe=Oe,(P+=O)>=B&&(O=4*Ze+4*e*(Q-1),P=k+(Oe+Ze)*(Q<<1),Q>>=1)),pe===Se)P+=4;else{var ge=i[Fe+3*pe],Xe=i[Fe+3*pe+1],Je=i[Fe+3*pe+2];ee[P++]=ge,ee[P++]=Xe,ee[P++]=Je,ee[P++]=255}--qe}}}function SS(i,t,e,n){for(var r=i[t++],a=1<<r,s=a+1,o=s+1,l=r+1,c=(1<<l)-1,u=0,h=0,g=0,d=i[t++],b=new Int32Array(4096),_=null;;){for(;u<16&&d!==0;)h|=i[t++]<<u,u+=8,d===1?d=i[t++]:--d;if(u<l)break;var w=h&c;if(h>>=l,u-=l,w!==a){if(w===s)break;for(var E=w<o?w:_,A=0,D=E;D>a;)D=b[D]>>8,++A;var N=D;if(g+A+(E!==w?1:0)>n)return void Qi.log("Warning, gif stream longer than expected.");e[g++]=N;var z=g+=A;for(E!==w&&(e[g++]=N),D=E;A--;)D=b[D],e[--z]=255&D,D>>=8;_!==null&&o<4096&&(b[o++]=_<<8|N,o>=c+1&&l<12&&(++l,c=c<<1|1)),_=w}else o=s+1,c=(1<<(l=r+1))-1,_=null}return g!==n&&Qi.log("Warning, gif stream shorter than expected."),e}function fx(i){var t,e,n,r,a,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),g=new Array(65535),d=new Array(64),b=new Array(64),_=[],w=0,E=7,A=new Array(64),D=new Array(64),N=new Array(64),z=new Array(256),J=new Array(2048),W=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],U=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],F=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],I=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],ee=[0,1,2,3,4,5,6,7,8,9,10,11],le=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],de=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ke(k,B){for(var P=0,O=0,Q=new Array,fe=1;fe<=16;fe++){for(var ye=1;ye<=k[fe];ye++)Q[B[O]]=[],Q[B[O]][0]=P,Q[B[O]][1]=fe,O++,P++;P*=2}return Q}function Fe(k){for(var B=k[0],P=k[1]-1;P>=0;)B&1<<P&&(w|=1<<E),P--,--E<0&&(w==255?(Se(255),Se(0)):Se(w),E=7,w=0)}function Se(k){_.push(k)}function Oe(k){Se(k>>8&255),Se(255&k)}function Ze(k,B,P,O,Q){for(var fe,ye=Q[0],pe=Q[240],ge=(function(rt,yt){var mt,Jt,Nt,ri,qt,Gt,Ci,jt,Lt,Vt,Pt=0;for(Lt=0;Lt<8;++Lt){mt=rt[Pt],Jt=rt[Pt+1],Nt=rt[Pt+2],ri=rt[Pt+3],qt=rt[Pt+4],Gt=rt[Pt+5],Ci=rt[Pt+6];var Ri=mt+(jt=rt[Pt+7]),vi=mt-jt,Et=Jt+Ci,Yt=Jt-Ci,Oi=Nt+Gt,Rt=Nt-Gt,ci=ri+qt,Kt=ri-qt,fn=Ri+ci,Tn=Ri-ci,Bi=Et+Oi,Ut=Et-Oi;rt[Pt]=fn+Bi,rt[Pt+4]=fn-Bi;var Ei=.707106781*(Ut+Tn);rt[Pt+2]=Tn+Ei,rt[Pt+6]=Tn-Ei;var Js=.382683433*((fn=Kt+Rt)-(Ut=Yt+vi)),sr=.5411961*fn+Js,Qa=1.306562965*Ut+Js,Ra=.707106781*(Bi=Rt+Yt),Ot=vi+Ra,es=vi-Ra;rt[Pt+5]=es+sr,rt[Pt+3]=es-sr,rt[Pt+1]=Ot+Qa,rt[Pt+7]=Ot-Qa,Pt+=8}for(Pt=0,Lt=0;Lt<8;++Lt){mt=rt[Pt],Jt=rt[Pt+8],Nt=rt[Pt+16],ri=rt[Pt+24],qt=rt[Pt+32],Gt=rt[Pt+40],Ci=rt[Pt+48];var ts=mt+(jt=rt[Pt+56]),Rr=mt-jt,sa=Jt+Ci,hn=Jt-Ci,On=Nt+Gt,j=Nt-Gt,ne=ri+qt,Y=ri-qt,Z=ts+ne,re=ts-ne,se=sa+On,De=sa-On;rt[Pt]=Z+se,rt[Pt+32]=Z-se;var ze=.707106781*(De+re);rt[Pt+16]=re+ze,rt[Pt+48]=re-ze;var Le=.382683433*((Z=Y+j)-(De=hn+Rr)),Pe=.5411961*Z+Le,Be=1.306562965*De+Le,at=.707106781*(se=j+hn),ct=Rr+at,vt=Rr-at;rt[Pt+40]=vt+Pe,rt[Pt+24]=vt-Pe,rt[Pt+8]=ct+Be,rt[Pt+56]=ct-Be,Pt++}for(Lt=0;Lt<64;++Lt)Vt=rt[Lt]*yt[Lt],d[Lt]=Vt>0?Vt+.5|0:Vt-.5|0;return d})(k,B),Xe=0;Xe<64;++Xe)b[W[Xe]]=ge[Xe];var Je=b[0]-P;P=b[0],Je==0?Fe(O[0]):(Fe(O[g[fe=32767+Je]]),Fe(h[fe]));for(var ut=63;ut>0&&b[ut]==0;)ut--;if(ut==0)return Fe(ye),P;for(var Ne,oe=1;oe<=ut;){for(var Ft=oe;b[oe]==0&&oe<=ut;)++oe;var et=oe-Ft;if(et>=16){Ne=et>>4;for(var bt=1;bt<=Ne;++bt)Fe(pe);et&=15}fe=32767+b[oe],Fe(Q[(et<<4)+g[fe]]),Fe(h[fe]),oe++}return ut!=63&&Fe(ye),P}function qe(k){k=Math.min(Math.max(k,1),100),a!=k&&((function(B){for(var P=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var Q=s((P[O]*B+50)/100);Q=Math.min(Math.max(Q,1),255),o[W[O]]=Q}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ye=0;ye<64;ye++){var pe=s((fe[ye]*B+50)/100);pe=Math.min(Math.max(pe,1),255),l[W[ye]]=pe}for(var ge=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Xe=0,Je=0;Je<8;Je++)for(var ut=0;ut<8;ut++)c[Xe]=1/(o[W[Xe]]*ge[Je]*ge[ut]*8),u[Xe]=1/(l[W[Xe]]*ge[Je]*ge[ut]*8),Xe++})(k<50?Math.floor(5e3/k):Math.floor(200-2*k)),a=k)}this.encode=function(k,B){B&&qe(B),_=new Array,w=0,E=7,Oe(65496),Oe(65504),Oe(16),Se(74),Se(70),Se(73),Se(70),Se(0),Se(1),Se(1),Se(0),Oe(1),Oe(1),Se(0),Se(0),(function(){Oe(65499),Oe(132),Se(0);for(var Jt=0;Jt<64;Jt++)Se(o[Jt]);Se(1);for(var Nt=0;Nt<64;Nt++)Se(l[Nt])})(),(function(Jt,Nt){Oe(65472),Oe(17),Se(8),Oe(Nt),Oe(Jt),Se(3),Se(1),Se(17),Se(0),Se(2),Se(17),Se(1),Se(3),Se(17),Se(1)})(k.width,k.height),(function(){Oe(65476),Oe(418),Se(0);for(var Jt=0;Jt<16;Jt++)Se(U[Jt+1]);for(var Nt=0;Nt<=11;Nt++)Se(M[Nt]);Se(16);for(var ri=0;ri<16;ri++)Se(X[ri+1]);for(var qt=0;qt<=161;qt++)Se(F[qt]);Se(1);for(var Gt=0;Gt<16;Gt++)Se(I[Gt+1]);for(var Ci=0;Ci<=11;Ci++)Se(ee[Ci]);Se(17);for(var jt=0;jt<16;jt++)Se(le[jt+1]);for(var Lt=0;Lt<=161;Lt++)Se(de[Lt])})(),Oe(65498),Oe(12),Se(3),Se(1),Se(0),Se(2),Se(17),Se(3),Se(17),Se(0),Se(63),Se(0);var P=0,O=0,Q=0;w=0,E=7,this.encode.displayName="_encode_";for(var fe,ye,pe,ge,Xe,Je,ut,Ne,oe,Ft=k.data,et=k.width,bt=k.height,rt=4*et,yt=0;yt<bt;){for(fe=0;fe<rt;){for(Xe=rt*yt+fe,ut=-1,Ne=0,oe=0;oe<64;oe++)Je=Xe+(Ne=oe>>3)*rt+(ut=4*(7&oe)),yt+Ne>=bt&&(Je-=rt*(yt+1+Ne-bt)),fe+ut>=rt&&(Je-=fe+ut-rt+4),ye=Ft[Je++],pe=Ft[Je++],ge=Ft[Je++],A[oe]=(J[ye]+J[pe+256|0]+J[ge+512|0]>>16)-128,D[oe]=(J[ye+768|0]+J[pe+1024|0]+J[ge+1280|0]>>16)-128,N[oe]=(J[ye+1280|0]+J[pe+1536|0]+J[ge+1792|0]>>16)-128;P=Ze(A,c,P,t,n),O=Ze(D,u,O,e,r),Q=Ze(N,u,Q,e,r),fe+=32}yt+=8}if(E>=0){var mt=[];mt[1]=E+1,mt[0]=(1<<E+1)-1,Fe(mt)}return Oe(65497),new Uint8Array(_)},i=i||50,(function(){for(var k=String.fromCharCode,B=0;B<256;B++)z[B]=k(B)})(),t=ke(U,M),e=ke(I,ee),n=ke(X,F),r=ke(le,de),(function(){for(var k=1,B=2,P=1;P<=15;P++){for(var O=k;O<B;O++)g[32767+O]=P,h[32767+O]=[],h[32767+O][1]=P,h[32767+O][0]=O;for(var Q=-(B-1);Q<=-k;Q++)g[32767+Q]=P,h[32767+Q]=[],h[32767+Q][1]=P,h[32767+Q][0]=B-1+Q;k<<=1,B<<=1}})(),(function(){for(var k=0;k<256;k++)J[k]=19595*k,J[k+256|0]=38470*k,J[k+512|0]=7471*k+32768,J[k+768|0]=-11059*k,J[k+1024|0]=-21709*k,J[k+1280|0]=32768*k+8421375,J[k+1536|0]=-27439*k,J[k+1792|0]=-5329*k})(),qe(i)}function bs(i,t){if(this.pos=0,this.buffer=i,this.datav=new DataView(i.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function CS(i){function t(M){if(!M)throw Error("assert :P")}function e(M,X,F){for(var I=0;4>I;I++)if(M[X+I]!=F.charCodeAt(I))return!0;return!1}function n(M,X,F,I,ee){for(var le=0;le<ee;le++)M[X+le]=F[I+le]}function r(M,X,F,I){for(var ee=0;ee<I;ee++)M[X+ee]=F}function a(M){return new Int32Array(M)}function s(M,X){for(var F=[],I=0;I<M;I++)F.push(new X);return F}function o(M,X){var F=[];return(function I(ee,le,de){for(var ke=de[le],Fe=0;Fe<ke&&(ee.push(de.length>le+1?[]:new X),!(de.length<le+1));Fe++)I(ee[Fe],le+1,de)})(F,0,M),F}var l=function(){var M=this;function X(m,v){for(var C=1<<v-1>>>0;m&C;)C>>>=1;return C?(m&C-1)+C:m}function F(m,v,C,T,R){t(!(T%C));do m[v+(T-=C)]=R;while(0<T)}function I(m,v,C,T,R){if(t(2328>=R),512>=R)var V=a(512);else if((V=a(R))==null)return 0;return(function(H,G,K,te,me,Ie){var ie,_e,Te=G,We=1<<K,Me=a(16),$e=a(16);for(t(me!=0),t(te!=null),t(H!=null),t(0<K),_e=0;_e<me;++_e){if(15<te[_e])return 0;++Me[te[_e]]}if(Me[0]==me)return 0;for($e[1]=0,ie=1;15>ie;++ie){if(Me[ie]>1<<ie)return 0;$e[ie+1]=$e[ie]+Me[ie]}for(_e=0;_e<me;++_e)ie=te[_e],0<te[_e]&&(Ie[$e[ie]++]=_e);if($e[15]==1)return(te=new ee).g=0,te.value=Ie[0],F(H,Te,1,We,te),We;var Ke,ot=-1,tt=We-1,Mt=0,wt=1,ai=1,kt=1<<K;for(_e=0,ie=1,me=2;ie<=K;++ie,me<<=1){if(wt+=ai<<=1,0>(ai-=Me[ie]))return 0;for(;0<Me[ie];--Me[ie])(te=new ee).g=ie,te.value=Ie[_e++],F(H,Te+Mt,me,kt,te),Mt=X(Mt,ie)}for(ie=K+1,me=2;15>=ie;++ie,me<<=1){if(wt+=ai<<=1,0>(ai-=Me[ie]))return 0;for(;0<Me[ie];--Me[ie]){if(te=new ee,(Mt&tt)!=ot){for(Te+=kt,Ke=1<<(ot=ie)-K;15>ot&&!(0>=(Ke-=Me[ot]));)++ot,Ke<<=1;We+=kt=1<<(Ke=ot-K),H[G+(ot=Mt&tt)].g=Ke+K,H[G+ot].value=Te-G-ot}te.g=ie-K,te.value=Ie[_e++],F(H,Te+(Mt>>K),me,kt,te),Mt=X(Mt,ie)}}return wt!=2*$e[15]-1?0:We})(m,v,C,T,R,V)}function ee(){this.value=this.g=0}function le(){this.value=this.g=0}function de(){this.G=s(5,ee),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s($l,le)}function ke(m,v,C,T){t(m!=null),t(v!=null),t(2147483648>T),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=v,m.pa=C,m.Jd=v,m.Yc=C+T,m.Zc=4<=T?C+T-4+1:C,ye(m)}function Fe(m,v){for(var C=0;0<v--;)C|=ge(m,128)<<v;return C}function Se(m,v){var C=Fe(m,v);return pe(m)?-C:C}function Oe(m,v,C,T){var R,V=0;for(t(m!=null),t(v!=null),t(4294967288>T),m.Sb=T,m.Ra=0,m.u=0,m.h=0,4<T&&(T=4),R=0;R<T;++R)V+=v[C+R]<<8*R;m.Ra=V,m.bb=T,m.oa=v,m.pa=C}function Ze(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<Uo-8>>>0,++m.bb,m.u-=8;O(m)&&(m.h=1,m.u=0)}function qe(m,v){if(t(0<=v),!m.h&&v<=ba){var C=P(m)&_a[v];return m.u+=v,Ze(m),C}return m.h=1,m.u=0}function k(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function B(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function P(m){return m.Ra>>>(m.u&Uo-1)>>>0}function O(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>Uo}function Q(m,v){m.u=v,m.h=O(m)}function fe(m){m.u>=ao&&(t(m.u>=ao),Ze(m))}function ye(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function pe(m){return Fe(m,1)}function ge(m,v){var C=m.Ca;0>m.b&&ye(m);var T=m.b,R=C*v>>>8,V=(m.I>>>T>R)+0;for(V?(C-=R,m.I-=R+1<<T>>>0):C=R+1,T=C,R=0;256<=T;)R+=8,T>>=8;return T=7^R+zo[T],m.b-=T,m.Ca=(C<<T)-1,V}function Xe(m,v,C){m[v+0]=C>>24&255,m[v+1]=C>>16&255,m[v+2]=C>>8&255,m[v+3]=255&C}function Je(m,v){return m[v+0]|m[v+1]<<8}function ut(m,v){return Je(m,v)|m[v+2]<<16}function Ne(m,v){return Je(m,v)|Je(m,v+2)<<16}function oe(m,v){var C=1<<v;return t(m!=null),t(0<v),m.X=a(C),m.X==null?0:(m.Mb=32-v,m.Xa=v,1)}function Ft(m,v){t(m!=null),t(v!=null),t(m.Xa==v.Xa),n(v.X,0,m.X,0,1<<v.Xa)}function et(){this.X=[],this.Xa=this.Mb=0}function bt(m,v,C,T){t(C!=null),t(T!=null);var R=C[0],V=T[0];return R==0&&(R=(m*V+v/2)/v),V==0&&(V=(v*R+m/2)/m),0>=R||0>=V?0:(C[0]=R,T[0]=V,1)}function rt(m,v){return m+(1<<v)-1>>>v}function yt(m,v){return((4278255360&m)+(4278255360&v)>>>0&4278255360)+((16711935&m)+(16711935&v)>>>0&16711935)>>>0}function mt(m,v){M[v]=function(C,T,R,V,H,G,K){var te;for(te=0;te<H;++te){var me=M[m](G[K+te-1],R,V+te);G[K+te]=yt(C[T+te],me)}}}function Jt(){this.ud=this.hd=this.jd=0}function Nt(m,v){return((4278124286&(m^v))>>>1)+(m&v)>>>0}function ri(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function qt(m,v){return ri(m+(m-v+.5>>1))}function Gt(m,v,C){return Math.abs(v-C)-Math.abs(m-C)}function Ci(m,v,C,T,R,V,H){for(T=V[H-1],C=0;C<R;++C)V[H+C]=T=yt(m[v+C],T)}function jt(m,v,C,T,R){var V;for(V=0;V<C;++V){var H=m[v+V],G=H>>8&255,K=16711935&(K=(K=16711935&H)+((G<<16)+G));T[R+V]=(4278255360&H)+K>>>0}}function Lt(m,v){v.jd=255&m,v.hd=m>>8&255,v.ud=m>>16&255}function Vt(m,v,C,T,R,V){var H;for(H=0;H<T;++H){var G=v[C+H],K=G>>>8,te=G,me=255&(me=(me=G>>>16)+((m.jd<<24>>24)*(K<<24>>24)>>>5));te=255&(te=(te+=(m.hd<<24>>24)*(K<<24>>24)>>>5)+((m.ud<<24>>24)*(me<<24>>24)>>>5)),R[V+H]=(4278255360&G)+(me<<16)+te}}function Pt(m,v,C,T,R){M[v]=function(V,H,G,K,te,me,Ie,ie,_e){for(K=Ie;K<ie;++K)for(Ie=0;Ie<_e;++Ie)te[me++]=R(G[T(V[H++])])},M[m]=function(V,H,G,K,te,me,Ie){var ie=8>>V.b,_e=V.Ea,Te=V.K[0],We=V.w;if(8>ie)for(V=(1<<V.b)-1,We=(1<<ie)-1;H<G;++H){var Me,$e=0;for(Me=0;Me<_e;++Me)Me&V||($e=T(K[te++])),me[Ie++]=R(Te[$e&We]),$e>>=ie}else M["VP8LMapColor"+C](K,te,Te,We,me,Ie,H,G,_e)}}function Ri(m,v,C,T,R){for(C=v+C;v<C;){var V=m[v++];T[R++]=V>>16&255,T[R++]=V>>8&255,T[R++]=255&V}}function vi(m,v,C,T,R){for(C=v+C;v<C;){var V=m[v++];T[R++]=V>>16&255,T[R++]=V>>8&255,T[R++]=255&V,T[R++]=V>>24&255}}function Et(m,v,C,T,R){for(C=v+C;v<C;){var V=(H=m[v++])>>16&240|H>>12&15,H=240&H|H>>28&15;T[R++]=V,T[R++]=H}}function Yt(m,v,C,T,R){for(C=v+C;v<C;){var V=(H=m[v++])>>16&248|H>>13&7,H=H>>5&224|H>>3&31;T[R++]=V,T[R++]=H}}function Oi(m,v,C,T,R){for(C=v+C;v<C;){var V=m[v++];T[R++]=255&V,T[R++]=V>>8&255,T[R++]=V>>16&255}}function Rt(m,v,C,T,R,V){if(V==0)for(C=v+C;v<C;)Xe(T,((V=m[v++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),R+=32;else n(T,R,m,v,C)}function ci(m,v){M[v][0]=M[m+"0"],M[v][1]=M[m+"1"],M[v][2]=M[m+"2"],M[v][3]=M[m+"3"],M[v][4]=M[m+"4"],M[v][5]=M[m+"5"],M[v][6]=M[m+"6"],M[v][7]=M[m+"7"],M[v][8]=M[m+"8"],M[v][9]=M[m+"9"],M[v][10]=M[m+"10"],M[v][11]=M[m+"11"],M[v][12]=M[m+"12"],M[v][13]=M[m+"13"],M[v][14]=M[m+"0"],M[v][15]=M[m+"0"]}function Kt(m){return m==jp||m==Vp||m==lf||m==Up}function fn(){this.eb=[],this.size=this.A=this.fb=0}function Tn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Bi(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new fn,this.f.kb=new Tn,this.sd=null}function Ut(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ei(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Js(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function sr(m,v){var C=m.T,T=v.ba.f.RGBA,R=T.eb,V=T.fb+m.ka*T.A,H=za[v.ba.S],G=m.y,K=m.O,te=m.f,me=m.N,Ie=m.ea,ie=m.W,_e=v.cc,Te=v.dc,We=v.Mc,Me=v.Nc,$e=m.ka,Ke=m.ka+m.T,ot=m.U,tt=ot+1>>1;for($e==0?H(G,K,null,null,te,me,Ie,ie,te,me,Ie,ie,R,V,null,null,ot):(H(v.ec,v.fc,G,K,_e,Te,We,Me,te,me,Ie,ie,R,V-T.A,R,V,ot),++C);$e+2<Ke;$e+=2)_e=te,Te=me,We=Ie,Me=ie,me+=m.Rc,ie+=m.Rc,V+=2*T.A,H(G,(K+=2*m.fa)-m.fa,G,K,_e,Te,We,Me,te,me,Ie,ie,R,V-T.A,R,V,ot);return K+=m.fa,m.j+Ke<m.o?(n(v.ec,v.fc,G,K,ot),n(v.cc,v.dc,te,me,tt),n(v.Mc,v.Nc,Ie,ie,tt),C--):1&Ke||H(G,K,null,null,te,me,Ie,ie,te,me,Ie,ie,R,V+T.A,null,null,ot),C}function Qa(m,v,C){var T=m.F,R=[m.J];if(T!=null){var V=m.U,H=v.ba.S,G=H==of||H==lf;v=v.ba.f.RGBA;var K=[0],te=m.ka;K[0]=m.T,m.Kb&&(te==0?--K[0]:(--te,R[0]-=m.width),m.j+m.ka+m.T==m.o&&(K[0]=m.o-m.j-te));var me=v.eb;te=v.fb+te*v.A,m=Ix(T,R[0],m.width,V,K,me,te+(G?0:3),v.A),t(C==K),m&&Kt(H)&&cu(me,te,G,V,K,v.A)}return 0}function Ra(m){var v=m.ma,C=v.ba.S,T=11>C,R=C==af||C==sf||C==of||C==Bp||C==12||Kt(C);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!tu(v.Oa,m,R?11:12))return 0;if(R&&Kt(C)&&Jd(),m.da)alert("todo:use_scaling");else{if(T){if(v.Ib=Js,m.Kb){if(C=m.U+1>>1,v.memory=a(m.U+2*C),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+m.U,v.Mc=v.cc,v.Nc=v.dc+C,v.Ib=sr,Jd()}}else alert("todo:EmitYUV");R&&(v.Jb=Qa,T&&Ba())}if(T&&!Jx){for(m=0;256>m;++m)CC[m]=89858*(m-128)+uf>>cf,TC[m]=-22014*(m-128)+uf,kC[m]=-45773*(m-128),EC[m]=113618*(m-128)+uf>>cf;for(m=du;m<Wp;++m)v=76283*(m-16)+uf>>cf,AC[m-du]=_n(v,255),FC[m-du]=_n(v+8>>4,15);Jx=1}return 1}function Ot(m){var v=m.ma,C=m.U,T=m.T;return t(!(1&m.ka)),0>=C||0>=T?0:(C=v.Ib(m,v),v.Jb!=null&&v.Jb(m,v,C),v.Dc+=C,1)}function es(m){m.ma.memory=null}function ts(m,v,C,T){return qe(m,8)!=47?0:(v[0]=qe(m,14)+1,C[0]=qe(m,14)+1,T[0]=qe(m,1),qe(m,3)!=0?0:!m.h)}function Rr(m,v){if(4>m)return m+1;var C=m-2>>1;return(2+(1&m)<<C)+qe(v,C)+1}function sa(m,v){return 120<v?v-120:1<=(C=((C=uC[v-1])>>4)*m+(8-(15&C)))?C:1;var C}function hn(m,v,C){var T=P(C),R=m[v+=255&T].g-8;return 0<R&&(Q(C,C.u+8),T=P(C),v+=m[v].value,v+=T&(1<<R)-1),Q(C,C.u+m[v].g),m[v].value}function On(m,v,C){return C.g+=m.g,C.value+=m.value<<v>>>0,t(8>=C.g),m.g}function j(m,v,C){var T=m.xc;return t((v=T==0?0:m.vc[m.md*(C>>T)+(v>>T)])<m.Wb),m.Ya[v]}function ne(m,v,C,T){var R=m.ab,V=m.c*v,H=m.C;v=H+v;var G=C,K=T;for(T=m.Ta,C=m.Ua;0<R--;){var te=m.gc[R],me=H,Ie=v,ie=G,_e=K,Te=(K=T,G=C,te.Ea);switch(t(me<Ie),t(Ie<=te.nc),te.hc){case 2:Fn(ie,_e,(Ie-me)*Te,K,G);break;case 0:var We=me,Me=Ie,$e=K,Ke=G,ot=(kt=te).Ea;We==0&&(nu(ie,_e,null,null,1,$e,Ke),Ci(ie,_e+1,0,0,ot-1,$e,Ke+1),_e+=ot,Ke+=ot,++We);for(var tt=1<<kt.b,Mt=tt-1,wt=rt(ot,kt.b),ai=kt.K,kt=kt.w+(We>>kt.b)*wt;We<Me;){var pi=ai,Jn=kt,si=1;for(O0(ie,_e,$e,Ke-ot,1,$e,Ke);si<ot;){var Tt=(si&~Mt)+tt;Tt>ot&&(Tt=ot),(0,au[pi[Jn++]>>8&15])(ie,_e+ +si,$e,Ke+si-ot,Tt-si,$e,Ke+si),si=Tt}_e+=ot,Ke+=ot,++We&Mt||(kt+=wt)}Ie!=te.nc&&n(K,G-Te,K,G+(Ie-me-1)*Te,Te);break;case 1:for(Te=ie,Me=_e,ot=(ie=te.Ea)-(Ke=ie&~($e=(_e=1<<te.b)-1)),We=rt(ie,te.b),tt=te.K,te=te.w+(me>>te.b)*We;me<Ie;){for(Mt=tt,wt=te,ai=new Jt,kt=Me+Ke,pi=Me+ie;Me<kt;)Lt(Mt[wt++],ai),su(ai,Te,Me,_e,K,G),Me+=_e,G+=_e;Me<pi&&(Lt(Mt[wt++],ai),su(ai,Te,Me,ot,K,G),Me+=ot,G+=ot),++me&$e||(te+=We)}break;case 3:if(ie==K&&_e==G&&0<te.b){for(Me=K,ie=Te=G+(Ie-me)*Te-(Ke=(Ie-me)*rt(te.Ea,te.b)),_e=K,$e=G,We=[],Ke=(ot=Ke)-1;0<=Ke;--Ke)We[Ke]=_e[$e+Ke];for(Ke=ot-1;0<=Ke;--Ke)Me[ie+Ke]=We[Ke];ef(te,me,Ie,K,Te,K,G)}else ef(te,me,Ie,ie,_e,K,G)}G=T,K=C}K!=C&&n(T,C,G,K,V)}function Y(m,v){var C=m.V,T=m.Ba+m.c*m.C,R=v-m.C;if(t(v<=m.l.o),t(16>=R),0<R){var V=m.l,H=m.Ta,G=m.Ua,K=V.width;if(ne(m,R,C,T),R=G=[G],t((C=m.C)<(T=v)),t(V.v<V.va),T>V.o&&(T=V.o),C<V.j){var te=V.j-C;C=V.j,R[0]+=te*K}if(C>=T?C=0:(R[0]+=4*V.v,V.ka=C-V.j,V.U=V.va-V.v,V.T=T-C,C=1),C){if(G=G[0],11>(C=m.ca).S){var me=C.f.RGBA,Ie=(T=C.S,R=V.U,V=V.T,te=me.eb,me.A),ie=V;for(me=me.fb+m.Ma*me.A;0<ie--;){var _e=H,Te=G,We=R,Me=te,$e=me;switch(T){case rf:ou(_e,Te,We,Me,$e);break;case af:Ho(_e,Te,We,Me,$e);break;case jp:Ho(_e,Te,We,Me,$e),cu(Me,$e,0,We,1,0);break;case zx:Xl(_e,Te,We,Me,$e);break;case sf:Rt(_e,Te,We,Me,$e,1);break;case Vp:Rt(_e,Te,We,Me,$e,1),cu(Me,$e,0,We,1,0);break;case of:Rt(_e,Te,We,Me,$e,0);break;case lf:Rt(_e,Te,We,Me,$e,0),cu(Me,$e,1,We,1,0);break;case Bp:Wo(_e,Te,We,Me,$e);break;case Up:Wo(_e,Te,We,Me,$e),Lx(Me,$e,We,1,0);break;case Hx:qo(_e,Te,We,Me,$e);break;default:t(0)}G+=K,me+=Ie}m.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=C.height)}}m.C=v,t(m.C<=m.i)}function Z(m){var v;if(0<m.ua)return 0;for(v=0;v<m.Wb;++v){var C=m.Ya[v].G,T=m.Ya[v].H;if(0<C[1][T[1]+0].g||0<C[2][T[2]+0].g||0<C[3][T[3]+0].g)return 0}return 1}function re(m,v,C,T,R,V){if(m.Z!=0){var H=m.qd,G=m.rd;for(t(Xo[m.Z]!=null);v<C;++v)Xo[m.Z](H,G,T,R,T,R,V),H=T,G=R,R+=V;m.qd=H,m.rd=G}}function se(m,v){var C=m.l.ma,T=C.Z==0||C.Z==1?m.l.j:m.C;if(T=m.C<T?T:m.C,t(v<=m.l.o),v>T){var R=m.l.width,V=C.ca,H=C.tb+R*T,G=m.V,K=m.Ba+m.c*T,te=m.gc;t(m.ab==1),t(te[0].hc==3),Ts(te[0],T,v,G,K,V,H),re(C,T,v,V,H,R)}m.C=m.Ma=v}function De(m,v,C,T,R,V,H){var G=m.$/T,K=m.$%T,te=m.m,me=m.s,Ie=C+m.$,ie=Ie;R=C+T*R;var _e=C+T*V,Te=280+me.ua,We=m.Pb?G:16777216,Me=0<me.ua?me.Wa:null,$e=me.wc,Ke=Ie<_e?j(me,K,G):null;t(m.C<V),t(_e<=R);var ot=!1;e:for(;;){for(;ot||Ie<_e;){var tt=0;if(G>=We){var Mt=Ie-C;t((We=m).Pb),We.wd=We.m,We.xd=Mt,0<We.s.ua&&Ft(We.s.Wa,We.s.vb),We=G+fC}if(K&$e||(Ke=j(me,K,G)),t(Ke!=null),Ke.Qb&&(v[Ie]=Ke.qb,ot=!0),!ot)if(fe(te),Ke.jc){tt=te,Mt=v;var wt=Ie,ai=Ke.pd[P(tt)&$l-1];t(Ke.jc),256>ai.g?(Q(tt,tt.u+ai.g),Mt[wt]=ai.value,tt=0):(Q(tt,tt.u+ai.g-256),t(256<=ai.value),tt=ai.value),tt==0&&(ot=!0)}else tt=hn(Ke.G[0],Ke.H[0],te);if(te.h)break;if(ot||256>tt){if(!ot)if(Ke.nd)v[Ie]=(Ke.qb|tt<<8)>>>0;else{if(fe(te),ot=hn(Ke.G[1],Ke.H[1],te),fe(te),Mt=hn(Ke.G[2],Ke.H[2],te),wt=hn(Ke.G[3],Ke.H[3],te),te.h)break;v[Ie]=(wt<<24|ot<<16|tt<<8|Mt)>>>0}if(ot=!1,++Ie,++K>=T&&(K=0,++G,H!=null&&G<=V&&!(G%16)&&H(m,G),Me!=null))for(;ie<Ie;)tt=v[ie++],Me.X[(506832829*tt&4294967295)>>>Me.Mb]=tt}else if(280>tt){if(tt=Rr(tt-256,te),Mt=hn(Ke.G[4],Ke.H[4],te),fe(te),Mt=sa(T,Mt=Rr(Mt,te)),te.h)break;if(Ie-C<Mt||R-Ie<tt)break e;for(wt=0;wt<tt;++wt)v[Ie+wt]=v[Ie+wt-Mt];for(Ie+=tt,K+=tt;K>=T;)K-=T,++G,H!=null&&G<=V&&!(G%16)&&H(m,G);if(t(Ie<=R),K&$e&&(Ke=j(me,K,G)),Me!=null)for(;ie<Ie;)tt=v[ie++],Me.X[(506832829*tt&4294967295)>>>Me.Mb]=tt}else{if(!(tt<Te))break e;for(ot=tt-280,t(Me!=null);ie<Ie;)tt=v[ie++],Me.X[(506832829*tt&4294967295)>>>Me.Mb]=tt;tt=Ie,t(!(ot>>>(Mt=Me).Xa)),v[tt]=Mt.X[ot],ot=!0}ot||t(te.h==O(te))}if(m.Pb&&te.h&&Ie<R)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&Ft(m.s.vb,m.s.Wa);else{if(te.h)break e;H?.(m,G>V?V:G),m.a=0,m.$=Ie-C}return 1}return m.a=3,0}function ze(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var v=m.Wa;v!=null&&(v.X=null),m.vb=null,t(m!=null)}function Le(){var m=new Dt;return m==null?null:(m.a=0,m.xb=Gx,ci("Predictor","VP8LPredictors"),ci("Predictor","VP8LPredictors_C"),ci("PredictorAdd","VP8LPredictorsAdd"),ci("PredictorAdd","VP8LPredictorsAdd_C"),Fn=jt,su=Vt,ou=Ri,Ho=vi,Wo=Et,qo=Yt,Xl=Oi,M.VP8LMapColor32b=ks,M.VP8LMapColor8b=ru,m)}function Pe(m,v,C,T,R){var V=1,H=[m],G=[v],K=T.m,te=T.s,me=null,Ie=0;e:for(;;){if(C)for(;V&&qe(K,1);){var ie=H,_e=G,Te=T,We=1,Me=Te.m,$e=Te.gc[Te.ab],Ke=qe(Me,2);if(Te.Oc&1<<Ke)V=0;else{switch(Te.Oc|=1<<Ke,$e.hc=Ke,$e.Ea=ie[0],$e.nc=_e[0],$e.K=[null],++Te.ab,t(4>=Te.ab),Ke){case 0:case 1:$e.b=qe(Me,3)+2,We=Pe(rt($e.Ea,$e.b),rt($e.nc,$e.b),0,Te,$e.K),$e.K=$e.K[0];break;case 3:var ot,tt=qe(Me,8)+1,Mt=16<tt?0:4<tt?1:2<tt?2:3;if(ie[0]=rt($e.Ea,Mt),$e.b=Mt,ot=We=Pe(tt,1,0,Te,$e.K)){var wt,ai=tt,kt=$e,pi=1<<(8>>kt.b),Jn=a(pi);if(Jn==null)ot=0;else{var si=kt.K[0],Tt=kt.w;for(Jn[0]=kt.K[0][0],wt=1;wt<1*ai;++wt)Jn[wt]=yt(si[Tt+wt],Jn[wt-1]);for(;wt<4*pi;++wt)Jn[wt]=0;kt.K[0]=null,kt.K[0]=Jn,ot=1}}We=ot;break;case 2:break;default:t(0)}V=We}}if(H=H[0],G=G[0],V&&qe(K,1)&&!(V=1<=(Ie=qe(K,4))&&11>=Ie)){T.a=3;break e}var gt;if(gt=V)t:{var Nn,ni,_i,on=T,yr=H,Yr=G,bn=Ie,jr=C,Kr=on.m,Qn=on.s,yi=[null],ji=1,wn=0,Vi=dC[bn];i:for(;;){if(jr&&qe(Kr,1)){var Sr=qe(Kr,3)+2,as=rt(yr,Sr),Pn=rt(Yr,Sr),la=as*Pn;if(!Pe(as,Pn,0,on,yi))break i;for(yi=yi[0],Qn.xc=Sr,Nn=0;Nn<la;++Nn){var Ki=yi[Nn]>>8&65535;yi[Nn]=Ki,Ki>=ji&&(ji=Ki+1)}}if(Kr.h)break i;for(ni=0;5>ni;++ni){var er=Wx[ni];!ni&&0<bn&&(er+=1<<bn),wn<er&&(wn=er)}var ya=s(ji*Vi,ee),Zr=ji,Sa=s(Zr,de);if(Sa==null)var Ca=null;else t(65536>=Zr),Ca=Sa;var ca=a(wn);if(Ca==null||ca==null||ya==null){on.a=1;break i}var Ea=ya;for(Nn=_i=0;Nn<ji;++Nn){var nn=Ca[Nn],ka=nn.G,ss=nn.H,Kl=0,lo=1,Cr=0;for(ni=0;5>ni;++ni){er=Wx[ni],ka[ni]=Ea,ss[ni]=_i,!ni&&0<bn&&(er+=1<<bn);r:{var ff,qp=er,hf=on,fu=ca,PC=Ea,MC=_i,Gp=0,Yo=hf.m,LC=qe(Yo,1);if(r(fu,0,0,qp),LC){var IC=qe(Yo,1)+1,RC=qe(Yo,1),tv=qe(Yo,RC==0?1:8);fu[tv]=1,IC==2&&(fu[tv=qe(Yo,8)]=1);var pf=1}else{var iv=a(19),nv=qe(Yo,4)+4;if(19<nv){hf.a=3;var mf=0;break r}for(ff=0;ff<nv;++ff)iv[cC[ff]]=qe(Yo,3);var $p=void 0,hu=void 0,rv=hf,OC=iv,gf=qp,av=fu,Xp=0,Ko=rv.m,sv=8,ov=s(128,ee);n:for(;I(ov,0,7,OC,19);){if(qe(Ko,1)){var BC=2+2*qe(Ko,3);if(($p=2+qe(Ko,BC))>gf)break n}else $p=gf;for(hu=0;hu<gf&&$p--;){fe(Ko);var lv=ov[0+(127&P(Ko))];Q(Ko,Ko.u+lv.g);var j0=lv.value;if(16>j0)av[hu++]=j0,j0!=0&&(sv=j0);else{var jC=j0==16,cv=j0-16,VC=oC[cv],uv=qe(Ko,sC[cv])+VC;if(hu+uv>gf)break n;for(var UC=jC?sv:0;0<uv--;)av[hu++]=UC}}Xp=1;break n}Xp||(rv.a=3),pf=Xp}(pf=pf&&!Yo.h)&&(Gp=I(PC,MC,8,fu,qp)),pf&&Gp!=0?mf=Gp:(hf.a=3,mf=0)}if(mf==0)break i;if(lo&&lC[ni]==1&&(lo=Ea[_i].g==0),Kl+=Ea[_i].g,_i+=mf,3>=ni){var pu,Yp=ca[0];for(pu=1;pu<er;++pu)ca[pu]>Yp&&(Yp=ca[pu]);Cr+=Yp}}if(nn.nd=lo,nn.Qb=0,lo&&(nn.qb=(ka[3][ss[3]+0].value<<24|ka[1][ss[1]+0].value<<16|ka[2][ss[2]+0].value)>>>0,Kl==0&&256>ka[0][ss[0]+0].value&&(nn.Qb=1,nn.qb+=ka[0][ss[0]+0].value<<8)),nn.jc=!nn.Qb&&6>Cr,nn.jc){var xf,co=nn;for(xf=0;xf<$l;++xf){var Zo=xf,Jo=co.pd[Zo],vf=co.G[0][co.H[0]+Zo];256<=vf.value?(Jo.g=vf.g+256,Jo.value=vf.value):(Jo.g=0,Jo.value=0,Zo>>=On(vf,8,Jo),Zo>>=On(co.G[1][co.H[1]+Zo],16,Jo),Zo>>=On(co.G[2][co.H[2]+Zo],0,Jo),On(co.G[3][co.H[3]+Zo],24,Jo))}}}Qn.vc=yi,Qn.Wb=ji,Qn.Ya=Ca,Qn.yc=ya,gt=1;break t}gt=0}if(!(V=gt)){T.a=3;break e}if(0<Ie){if(te.ua=1<<Ie,!oe(te.Wa,Ie)){T.a=1,V=0;break e}}else te.ua=0;var Kp=T,dv=H,zC=G,Zp=Kp.s,Jp=Zp.xc;if(Kp.c=dv,Kp.i=zC,Zp.md=rt(dv,Jp),Zp.wc=Jp==0?-1:(1<<Jp)-1,C){T.xb=_C;break e}if((me=a(H*G))==null){T.a=1,V=0;break e}V=(V=De(T,me,0,H,G,G,null))&&!K.h;break e}return V?(R!=null?R[0]=me:(t(me==null),t(C)),T.$=0,C||ze(te)):ze(te),V}function Be(m,v){var C=m.c*m.i,T=C+v+16*v;return t(m.c<=v),m.V=a(T),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+C+v,1)}function at(m,v){var C=m.C,T=v-C,R=m.V,V=m.Ba+m.c*C;for(t(v<=m.l.o);0<T;){var H=16<T?16:T,G=m.l.ma,K=m.l.width,te=K*H,me=G.ca,Ie=G.tb+K*C,ie=m.Ta,_e=m.Ua;ne(m,H,R,V),Rx(ie,_e,me,Ie,te),re(G,C,C+H,me,Ie,K),T-=H,R+=H*m.c,C+=H}t(C==v),m.C=m.Ma=v}function ct(){this.ub=this.yd=this.td=this.Rb=0}function vt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function dt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function ht(){this.Yb=(function(){var m=[];return(function v(C,T,R){for(var V=R[T],H=0;H<V&&(C.push(R.length>T+1?[]:0),!(R.length<T+1));H++)v(C[H],T+1,R)})(m,0,[3,11]),m})()}function Wt(){this.jb=a(3),this.Wc=o([4,8],ht),this.Xc=o([4,17],ht)}function Pi(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Xi(){this.ld=this.La=this.dd=this.tc=0}function en(){this.Na=this.la=0}function or(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function is(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Cs(){this.uc=this.M=this.Nb=0,this.wa=Array(new Xi),this.Y=0,this.ya=Array(new is),this.aa=0,this.l=new Or}function Oa(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Ro(){this.cb=this.a=0,this.sc="",this.m=new k,this.Od=new ct,this.Kc=new vt,this.ed=new Pi,this.Qa=new dt,this.Ic=this.$c=this.Aa=0,this.D=new Cs,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,k),this.ia=0,this.pb=s(4,or),this.Pa=new Wt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Oa),this.Hd=0,this.rb=Array(new en),this.sb=0,this.wa=Array(new Xi),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new is),this.L=this.aa=0,this.gd=o([4,2],Xi),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Or(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function yp(){var m=new Ro;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,uu||(uu=Qs)),m}function Bn(m,v,C){return m.a==0&&(m.a=v,m.sc=C,m.cb=0),0}function Hd(m,v,C){return 3<=C&&m[v+0]==157&&m[v+1]==1&&m[v+2]==42}function Wd(m,v){if(m==null)return 0;if(m.a=0,m.sc="OK",v==null)return Bn(m,2,"null VP8Io passed to VP8GetHeaders()");var C=v.data,T=v.w,R=v.ha;if(4>R)return Bn(m,7,"Truncated header.");var V=C[T+0]|C[T+1]<<8|C[T+2]<<16,H=m.Od;if(H.Rb=!(1&V),H.td=V>>1&7,H.yd=V>>4&1,H.ub=V>>5,3<H.td)return Bn(m,3,"Incorrect keyframe parameters.");if(!H.yd)return Bn(m,4,"Frame not displayable.");T+=3,R-=3;var G=m.Kc;if(H.Rb){if(7>R)return Bn(m,7,"cannot parse picture header");if(!Hd(C,T,R))return Bn(m,3,"Bad code word");G.c=16383&(C[T+4]<<8|C[T+3]),G.Td=C[T+4]>>6,G.i=16383&(C[T+6]<<8|C[T+5]),G.Ud=C[T+6]>>6,T+=7,R-=7,m.za=G.c+15>>4,m.Ub=G.i+15>>4,v.width=G.c,v.height=G.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,r((V=m.Pa).jb,0,255,V.jb.length),t((V=m.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,r(V.Zb,0,0,V.Zb.length),r(V.Lb,0,0,V.Lb)}if(H.ub>R)return Bn(m,7,"bad partition length");ke(V=m.m,C,T,H.ub),T+=H.ub,R-=H.ub,H.Rb&&(G.Ld=pe(V),G.Kd=pe(V)),G=m.Qa;var K,te=m.Pa;if(t(V!=null),t(G!=null),G.Cb=pe(V),G.Cb){if(G.Bb=pe(V),pe(V)){for(G.Fb=pe(V),K=0;4>K;++K)G.Zb[K]=pe(V)?Se(V,7):0;for(K=0;4>K;++K)G.Lb[K]=pe(V)?Se(V,6):0}if(G.Bb)for(K=0;3>K;++K)te.jb[K]=pe(V)?Fe(V,8):255}else G.Bb=0;if(V.Ka)return Bn(m,3,"cannot parse segment header");if((G=m.ed).zd=pe(V),G.Tb=Fe(V,6),G.wb=Fe(V,3),G.Pc=pe(V),G.Pc&&pe(V)){for(te=0;4>te;++te)pe(V)&&(G.vd[te]=Se(V,6));for(te=0;4>te;++te)pe(V)&&(G.od[te]=Se(V,6))}if(m.L=G.Tb==0?0:G.zd?1:2,V.Ka)return Bn(m,3,"cannot parse filter header");var me=R;if(R=K=T,T=K+me,G=me,m.Xb=(1<<Fe(m.m,2))-1,me<3*(te=m.Xb))C=7;else{for(K+=3*te,G-=3*te,me=0;me<te;++me){var Ie=C[R+0]|C[R+1]<<8|C[R+2]<<16;Ie>G&&(Ie=G),ke(m.Jc[+me],C,K,Ie),K+=Ie,G-=Ie,R+=3}ke(m.Jc[+te],C,K,G),C=K<T?0:5}if(C!=0)return Bn(m,C,"cannot parse partitions");for(C=Fe(K=m.m,7),R=pe(K)?Se(K,4):0,T=pe(K)?Se(K,4):0,G=pe(K)?Se(K,4):0,te=pe(K)?Se(K,4):0,K=pe(K)?Se(K,4):0,me=m.Qa,Ie=0;4>Ie;++Ie){if(me.Cb){var ie=me.Zb[Ie];me.Fb||(ie+=C)}else{if(0<Ie){m.pb[Ie]=m.pb[0];continue}ie=C}var _e=m.pb[Ie];_e.Sc[0]=zp[_n(ie+R,127)],_e.Sc[1]=Hp[_n(ie+0,127)],_e.Eb[0]=2*zp[_n(ie+T,127)],_e.Eb[1]=101581*Hp[_n(ie+G,127)]>>16,8>_e.Eb[1]&&(_e.Eb[1]=8),_e.Qc[0]=zp[_n(ie+te,117)],_e.Qc[1]=Hp[_n(ie+K,127)],_e.lc=ie+K}if(!H.Rb)return Bn(m,4,"Not a key frame.");for(pe(V),H=m.Pa,C=0;4>C;++C){for(R=0;8>R;++R)for(T=0;3>T;++T)for(G=0;11>G;++G)te=ge(V,xC[C][R][T][G])?Fe(V,8):mC[C][R][T][G],H.Wc[C][R].Yb[T][G]=te;for(R=0;17>R;++R)H.Xc[C][R]=H.Wc[C][vC[R]]}return m.kc=pe(V),m.kc&&(m.Bd=Fe(V,8)),m.cb=1}function Qs(m,v,C,T,R,V,H){var G=v[R].Yb[C];for(C=0;16>R;++R){if(!ge(m,G[C+0]))return R;for(;!ge(m,G[C+1]);)if(G=v[++R].Yb[0],C=0,R==16)return 16;var K=v[R+1].Yb;if(ge(m,G[C+2])){var te=m,me=0;if(ge(te,(ie=G)[(Ie=C)+3]))if(ge(te,ie[Ie+6])){for(G=0,Ie=2*(me=ge(te,ie[Ie+8]))+(ie=ge(te,ie[Ie+9+me])),me=0,ie=hC[Ie];ie[G];++G)me+=me+ge(te,ie[G]);me+=3+(8<<Ie)}else ge(te,ie[Ie+7])?(me=7+2*ge(te,165),me+=ge(te,145)):me=5+ge(te,159);else me=ge(te,ie[Ie+4])?3+ge(te,ie[Ie+5]):2;G=K[2]}else me=1,G=K[1];K=H+pC[R],0>(te=m).b&&ye(te);var Ie,ie=te.b,_e=(Ie=te.Ca>>1)-(te.I>>ie)>>31;--te.b,te.Ca+=_e,te.Ca|=1,te.I-=(Ie+1&_e)<<ie,V[K]=((me^_e)-_e)*T[(0<R)+0]}return 16}function Nl(m){var v=m.rb[m.sb-1];v.la=0,v.Na=0,r(m.zc,0,0,m.zc.length),m.ja=0}function ns(m,v,C,T,R){R=m[v+C+32*T]+(R>>3),m[v+C+32*T]=-256&R?0>R?0:255:R}function Pl(m,v,C,T,R,V){ns(m,v,0,C,T+R),ns(m,v,1,C,T+V),ns(m,v,2,C,T-V),ns(m,v,3,C,T-R)}function An(m){return(20091*m>>16)+m}function Wc(m,v,C,T){var R,V=0,H=a(16);for(R=0;4>R;++R){var G=m[v+0]+m[v+8],K=m[v+0]-m[v+8],te=(35468*m[v+4]>>16)-An(m[v+12]),me=An(m[v+4])+(35468*m[v+12]>>16);H[V+0]=G+me,H[V+1]=K+te,H[V+2]=K-te,H[V+3]=G-me,V+=4,v++}for(R=V=0;4>R;++R)G=(m=H[V+0]+4)+H[V+8],K=m-H[V+8],te=(35468*H[V+4]>>16)-An(H[V+12]),ns(C,T,0,0,G+(me=An(H[V+4])+(35468*H[V+12]>>16))),ns(C,T,1,0,K+te),ns(C,T,2,0,K-te),ns(C,T,3,0,G-me),V++,T+=32}function Sp(m,v,C,T){var R=m[v+0]+4,V=35468*m[v+4]>>16,H=An(m[v+4]),G=35468*m[v+1]>>16;Pl(C,T,0,R+H,m=An(m[v+1]),G),Pl(C,T,1,R+V,m,G),Pl(C,T,2,R-V,m,G),Pl(C,T,3,R-H,m,G)}function Cp(m,v,C,T,R){Wc(m,v,C,T),R&&Wc(m,v+16,C,T+4)}function Ep(m,v,C,T){Yl(m,v+0,C,T,1),Yl(m,v+32,C,T+128,1)}function Es(m,v,C,T){var R;for(m=m[v+0]+4,R=0;4>R;++R)for(v=0;4>v;++v)ns(C,T,v,R,m)}function qd(m,v,C,T){m[v+0]&&Mi(m,v+0,C,T),m[v+16]&&Mi(m,v+16,C,T+4),m[v+32]&&Mi(m,v+32,C,T+128),m[v+48]&&Mi(m,v+48,C,T+128+4)}function Gd(m,v,C,T){var R,V=a(16);for(R=0;4>R;++R){var H=m[v+0+R]+m[v+12+R],G=m[v+4+R]+m[v+8+R],K=m[v+4+R]-m[v+8+R],te=m[v+0+R]-m[v+12+R];V[0+R]=H+G,V[8+R]=H-G,V[4+R]=te+K,V[12+R]=te-K}for(R=0;4>R;++R)H=(m=V[0+4*R]+3)+V[3+4*R],G=V[1+4*R]+V[2+4*R],K=V[1+4*R]-V[2+4*R],te=m-V[3+4*R],C[T+0]=H+G>>3,C[T+16]=te+K>>3,C[T+32]=H-G>>3,C[T+48]=te-K>>3,T+=64}function Oo(m,v,C){var T,R=v-32,V=wa,H=255-m[R-1];for(T=0;T<C;++T){var G,K=V,te=H+m[v-1];for(G=0;G<C;++G)m[v+G]=K[te+m[R+G]];v+=32}}function qc(m,v){Oo(m,v,4)}function kp(m,v){Oo(m,v,8)}function Tp(m,v){Oo(m,v,16)}function Ap(m,v){var C;for(C=0;16>C;++C)n(m,v+32*C,m,v-32,16)}function Gc(m,v){var C;for(C=16;0<C;--C)r(m,v,m[v-1],16),v+=32}function Ml(m,v,C){var T;for(T=0;16>T;++T)r(v,C+32*T,m,16)}function Bo(m,v){var C,T=16;for(C=0;16>C;++C)T+=m[v-1+32*C]+m[v+C-32];Ml(T>>5,m,v)}function Fp(m,v){var C,T=8;for(C=0;16>C;++C)T+=m[v-1+32*C];Ml(T>>4,m,v)}function Ll(m,v){var C,T=8;for(C=0;16>C;++C)T+=m[v+C-32];Ml(T>>4,m,v)}function $c(m,v){Ml(128,m,v)}function Qt(m,v,C){return m+2*v+C+2>>2}function Dp(m,v){var C,T=v-32;for(T=new Uint8Array([Qt(m[T-1],m[T+0],m[T+1]),Qt(m[T+0],m[T+1],m[T+2]),Qt(m[T+1],m[T+2],m[T+3]),Qt(m[T+2],m[T+3],m[T+4])]),C=0;4>C;++C)n(m,v+32*C,T,0,T.length)}function Np(m,v){var C=m[v-1],T=m[v-1+32],R=m[v-1+64],V=m[v-1+96];Xe(m,v+0,16843009*Qt(m[v-1-32],C,T)),Xe(m,v+32,16843009*Qt(C,T,R)),Xe(m,v+64,16843009*Qt(T,R,V)),Xe(m,v+96,16843009*Qt(R,V,V))}function Pp(m,v){var C,T=4;for(C=0;4>C;++C)T+=m[v+C-32]+m[v-1+32*C];for(T>>=3,C=0;4>C;++C)r(m,v+32*C,T,4)}function Mp(m,v){var C=m[v-1+0],T=m[v-1+32],R=m[v-1+64],V=m[v-1-32],H=m[v+0-32],G=m[v+1-32],K=m[v+2-32],te=m[v+3-32];m[v+0+96]=Qt(T,R,m[v-1+96]),m[v+1+96]=m[v+0+64]=Qt(C,T,R),m[v+2+96]=m[v+1+64]=m[v+0+32]=Qt(V,C,T),m[v+3+96]=m[v+2+64]=m[v+1+32]=m[v+0+0]=Qt(H,V,C),m[v+3+64]=m[v+2+32]=m[v+1+0]=Qt(G,H,V),m[v+3+32]=m[v+2+0]=Qt(K,G,H),m[v+3+0]=Qt(te,K,G)}function eo(m,v){var C=m[v+1-32],T=m[v+2-32],R=m[v+3-32],V=m[v+4-32],H=m[v+5-32],G=m[v+6-32],K=m[v+7-32];m[v+0+0]=Qt(m[v+0-32],C,T),m[v+1+0]=m[v+0+32]=Qt(C,T,R),m[v+2+0]=m[v+1+32]=m[v+0+64]=Qt(T,R,V),m[v+3+0]=m[v+2+32]=m[v+1+64]=m[v+0+96]=Qt(R,V,H),m[v+3+32]=m[v+2+64]=m[v+1+96]=Qt(V,H,G),m[v+3+64]=m[v+2+96]=Qt(H,G,K),m[v+3+96]=Qt(G,K,K)}function to(m,v){var C=m[v-1+0],T=m[v-1+32],R=m[v-1+64],V=m[v-1-32],H=m[v+0-32],G=m[v+1-32],K=m[v+2-32],te=m[v+3-32];m[v+0+0]=m[v+1+64]=V+H+1>>1,m[v+1+0]=m[v+2+64]=H+G+1>>1,m[v+2+0]=m[v+3+64]=G+K+1>>1,m[v+3+0]=K+te+1>>1,m[v+0+96]=Qt(R,T,C),m[v+0+64]=Qt(T,C,V),m[v+0+32]=m[v+1+96]=Qt(C,V,H),m[v+1+32]=m[v+2+96]=Qt(V,H,G),m[v+2+32]=m[v+3+96]=Qt(H,G,K),m[v+3+32]=Qt(G,K,te)}function Lp(m,v){var C=m[v+0-32],T=m[v+1-32],R=m[v+2-32],V=m[v+3-32],H=m[v+4-32],G=m[v+5-32],K=m[v+6-32],te=m[v+7-32];m[v+0+0]=C+T+1>>1,m[v+1+0]=m[v+0+64]=T+R+1>>1,m[v+2+0]=m[v+1+64]=R+V+1>>1,m[v+3+0]=m[v+2+64]=V+H+1>>1,m[v+0+32]=Qt(C,T,R),m[v+1+32]=m[v+0+96]=Qt(T,R,V),m[v+2+32]=m[v+1+96]=Qt(R,V,H),m[v+3+32]=m[v+2+96]=Qt(V,H,G),m[v+3+64]=Qt(H,G,K),m[v+3+96]=Qt(G,K,te)}function Ip(m,v){var C=m[v-1+0],T=m[v-1+32],R=m[v-1+64],V=m[v-1+96];m[v+0+0]=C+T+1>>1,m[v+2+0]=m[v+0+32]=T+R+1>>1,m[v+2+32]=m[v+0+64]=R+V+1>>1,m[v+1+0]=Qt(C,T,R),m[v+3+0]=m[v+1+32]=Qt(T,R,V),m[v+3+32]=m[v+1+64]=Qt(R,V,V),m[v+3+64]=m[v+2+64]=m[v+0+96]=m[v+1+96]=m[v+2+96]=m[v+3+96]=V}function N0(m,v){var C=m[v-1+0],T=m[v-1+32],R=m[v-1+64],V=m[v-1+96],H=m[v-1-32],G=m[v+0-32],K=m[v+1-32],te=m[v+2-32];m[v+0+0]=m[v+2+32]=C+H+1>>1,m[v+0+32]=m[v+2+64]=T+C+1>>1,m[v+0+64]=m[v+2+96]=R+T+1>>1,m[v+0+96]=V+R+1>>1,m[v+3+0]=Qt(G,K,te),m[v+2+0]=Qt(H,G,K),m[v+1+0]=m[v+3+32]=Qt(C,H,G),m[v+1+32]=m[v+3+64]=Qt(T,C,H),m[v+1+64]=m[v+3+96]=Qt(R,T,C),m[v+1+96]=Qt(V,R,T)}function Xc(m,v){var C;for(C=0;8>C;++C)n(m,v+32*C,m,v-32,8)}function Il(m,v){var C;for(C=0;8>C;++C)r(m,v,m[v-1],8),v+=32}function P0(m,v,C){var T;for(T=0;8>T;++T)r(v,C+32*T,m,8)}function M0(m,v){var C,T=8;for(C=0;8>C;++C)T+=m[v+C-32]+m[v-1+32*C];P0(T>>4,m,v)}function Rp(m,v){var C,T=4;for(C=0;8>C;++C)T+=m[v+C-32];P0(T>>3,m,v)}function Yc(m,v){var C,T=4;for(C=0;8>C;++C)T+=m[v-1+32*C];P0(T>>3,m,v)}function Kc(m,v){P0(128,m,v)}function Rl(m,v,C){var T=m[v-C],R=m[v+0],V=3*(R-T)+Op[1020+m[v-2*C]-m[v+C]],H=nf[112+(V+4>>3)];m[v-C]=wa[255+T+nf[112+(V+3>>3)]],m[v+0]=wa[255+R-H]}function Ol(m,v,C,T){var R=m[v+0],V=m[v+C];return Ua[255+m[v-2*C]-m[v-C]]>T||Ua[255+V-R]>T}function Zc(m,v,C,T){return 4*Ua[255+m[v-C]-m[v+0]]+Ua[255+m[v-2*C]-m[v+C]]<=T}function L0(m,v,C,T,R){var V=m[v-3*C],H=m[v-2*C],G=m[v-C],K=m[v+0],te=m[v+C],me=m[v+2*C],Ie=m[v+3*C];return 4*Ua[255+G-K]+Ua[255+H-te]>T?0:Ua[255+m[v-4*C]-V]<=R&&Ua[255+V-H]<=R&&Ua[255+H-G]<=R&&Ua[255+Ie-me]<=R&&Ua[255+me-te]<=R&&Ua[255+te-K]<=R}function Jc(m,v,C,T){var R=2*T+1;for(T=0;16>T;++T)Zc(m,v+T,C,R)&&Rl(m,v+T,C)}function Bl(m,v,C,T){var R=2*T+1;for(T=0;16>T;++T)Zc(m,v+T*C,1,R)&&Rl(m,v+T*C,1)}function $d(m,v,C,T){var R;for(R=3;0<R;--R)Jc(m,v+=4*C,C,T)}function Xd(m,v,C,T){var R;for(R=3;0<R;--R)Bl(m,v+=4,C,T)}function io(m,v,C,T,R,V,H,G){for(V=2*V+1;0<R--;){if(L0(m,v,C,V,H))if(Ol(m,v,C,G))Rl(m,v,C);else{var K=m,te=v,me=C,Ie=K[te-2*me],ie=K[te-me],_e=K[te+0],Te=K[te+me],We=K[te+2*me],Me=27*(Ke=Op[1020+3*(_e-ie)+Op[1020+Ie-Te]])+63>>7,$e=18*Ke+63>>7,Ke=9*Ke+63>>7;K[te-3*me]=wa[255+K[te-3*me]+Ke],K[te-2*me]=wa[255+Ie+$e],K[te-me]=wa[255+ie+Me],K[te+0]=wa[255+_e-Me],K[te+me]=wa[255+Te-$e],K[te+2*me]=wa[255+We-Ke]}v+=T}}function no(m,v,C,T,R,V,H,G){for(V=2*V+1;0<R--;){if(L0(m,v,C,V,H))if(Ol(m,v,C,G))Rl(m,v,C);else{var K=m,te=v,me=C,Ie=K[te-me],ie=K[te+0],_e=K[te+me],Te=nf[112+(4+(We=3*(ie-Ie))>>3)],We=nf[112+(We+3>>3)],Me=Te+1>>1;K[te-2*me]=wa[255+K[te-2*me]+Me],K[te-me]=wa[255+Ie+We],K[te+0]=wa[255+ie-Te],K[te+me]=wa[255+_e-Me]}v+=T}}function Yd(m,v,C,T,R,V){io(m,v,C,1,16,T,R,V)}function Kd(m,v,C,T,R,V){io(m,v,1,C,16,T,R,V)}function jl(m,v,C,T,R,V){var H;for(H=3;0<H;--H)no(m,v+=4*C,C,1,16,T,R,V)}function Zd(m,v,C,T,R,V){var H;for(H=3;0<H;--H)no(m,v+=4,1,C,16,T,R,V)}function y(m,v,C,T,R,V,H,G){io(m,v,R,1,8,V,H,G),io(C,T,R,1,8,V,H,G)}function L(m,v,C,T,R,V,H,G){io(m,v,1,R,8,V,H,G),io(C,T,1,R,8,V,H,G)}function ae(m,v,C,T,R,V,H,G){no(m,v+4*R,R,1,8,V,H,G),no(C,T+4*R,R,1,8,V,H,G)}function he(m,v,C,T,R,V,H,G){no(m,v+4,1,R,8,V,H,G),no(C,T+4,1,R,8,V,H,G)}function Ee(){this.ba=new Bi,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ei,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ye(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function it(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ct(){this.ua=0,this.Wa=new et,this.vb=new et,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new de,this.yc=new ee}function Dt(){this.xb=this.a=0,this.l=new Or,this.ca=new Bi,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new B,this.Pb=0,this.wd=new B,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ct,this.ab=0,this.gc=s(4,it),this.Oc=0}function Zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Or,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ti(m,v,C,T,R,V,H){for(m=m==null?0:m[v+0],v=0;v<H;++v)R[V+v]=m+C[T+v]&255,m=R[V+v]}function Ai(m,v,C,T,R,V,H){var G;if(m==null)ti(null,null,C,T,R,V,H);else for(G=0;G<H;++G)R[V+G]=m[v+G]+C[T+G]&255}function xn(m,v,C,T,R,V,H){if(m==null)ti(null,null,C,T,R,V,H);else{var G,K=m[v+0],te=K,me=K;for(G=0;G<H;++G)te=me+(K=m[v+G])-te,me=C[T+G]+(-256&te?0>te?0:255:te)&255,te=K,R[V+G]=me}}function jn(m,v,C,T){var R=v.width,V=v.o;if(t(m!=null&&v!=null),0>C||0>=T||C+T>V)return null;if(!m.Cc){if(m.ga==null){var H;if(m.ga=new Zt,(H=m.ga==null)||(H=v.width*v.o,t(m.Gb.length==0),m.Gb=a(H),m.Uc=0,m.Gb==null?H=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,H=1),H=!H),!H){H=m.ga;var G=m.Fa,K=m.P,te=m.qc,me=m.mb,Ie=m.nb,ie=K+1,_e=te-1,Te=H.l;if(t(G!=null&&me!=null&&v!=null),Xo[0]=null,Xo[1]=ti,Xo[2]=Ai,Xo[3]=xn,H.ca=me,H.tb=Ie,H.c=v.width,H.i=v.height,t(0<H.c&&0<H.i),1>=te)v=0;else if(H.$a=3&G[K+0],H.Z=G[K+0]>>2&3,H.Lc=G[K+0]>>4&3,K=G[K+0]>>6&3,0>H.$a||1<H.$a||4<=H.Z||1<H.Lc||K)v=0;else if(Te.put=Ot,Te.ac=Ra,Te.bc=es,Te.ma=H,Te.width=v.width,Te.height=v.height,Te.Da=v.Da,Te.v=v.v,Te.va=v.va,Te.j=v.j,Te.o=v.o,H.$a)e:{t(H.$a==1),v=Le();t:for(;;){if(v==null){v=0;break e}if(t(H!=null),H.mc=v,v.c=H.c,v.i=H.i,v.l=H.l,v.l.ma=H,v.l.width=H.c,v.l.height=H.i,v.a=0,Oe(v.m,G,ie,_e),!Pe(H.c,H.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Z(v.s)?(H.ic=1,G=v.c*v.i,v.Ta=null,v.Ua=0,v.V=a(G),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(H.ic=0,v=Be(v,H.c)),!v))break t;v=1;break e}H.mc=null,v=0}else v=_e>=H.c*H.i;H=!v}if(H)return null;m.ga.Lc!=1?m.Ga=0:T=V-C}t(m.ga!=null),t(C+T<=V);e:{if(v=(G=m.ga).c,V=G.l.o,G.$a==0){if(ie=m.rc,_e=m.Vc,Te=m.Fa,K=m.P+1+C*v,te=m.mb,me=m.nb+C*v,t(K<=m.P+m.qc),G.Z!=0)for(t(Xo[G.Z]!=null),H=0;H<T;++H)Xo[G.Z](ie,_e,Te,K,te,me,v),ie=te,_e=me,me+=v,K+=v;else for(H=0;H<T;++H)n(te,me,Te,K,v),ie=te,_e=me,me+=v,K+=v;m.rc=ie,m.Vc=_e}else{if(t(G.mc!=null),v=C+T,t((H=G.mc)!=null),t(v<=H.i),H.C>=v)v=1;else if(G.ic||Ba(),G.ic){G=H.V,ie=H.Ba,_e=H.c;var We=H.i,Me=(Te=1,K=H.$/_e,te=H.$%_e,me=H.m,Ie=H.s,H.$),$e=_e*We,Ke=_e*v,ot=Ie.wc,tt=Me<Ke?j(Ie,te,K):null;t(Me<=$e),t(v<=We),t(Z(Ie));t:for(;;){for(;!me.h&&Me<Ke;){if(te&ot||(tt=j(Ie,te,K)),t(tt!=null),fe(me),256>(We=hn(tt.G[0],tt.H[0],me)))G[ie+Me]=We,++Me,++te>=_e&&(te=0,++K<=v&&!(K%16)&&se(H,K));else{if(!(280>We)){Te=0;break t}We=Rr(We-256,me);var Mt,wt=hn(tt.G[4],tt.H[4],me);if(fe(me),!(Me>=(wt=sa(_e,wt=Rr(wt,me)))&&$e-Me>=We)){Te=0;break t}for(Mt=0;Mt<We;++Mt)G[ie+Me+Mt]=G[ie+Me+Mt-wt];for(Me+=We,te+=We;te>=_e;)te-=_e,++K<=v&&!(K%16)&&se(H,K);Me<Ke&&te&ot&&(tt=j(Ie,te,K))}t(me.h==O(me))}se(H,K>v?v:K);break t}!Te||me.h&&Me<$e?(Te=0,H.a=me.h?5:3):H.$=Me,v=Te}else v=De(H,H.V,H.Ba,H.c,H.i,v,at);if(!v){T=0;break e}}C+T>=V&&(m.Cc=1),T=1}if(!T)return null;if(m.Cc&&((T=m.ga)!=null&&(T.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+C*R}function tn(m,v,C,T,R,V){for(;0<R--;){var H,G=m,K=v+(C?1:0),te=m,me=v+(C?0:3);for(H=0;H<T;++H){var Ie=te[me+4*H];Ie!=255&&(Ie*=32897,G[K+4*H+0]=G[K+4*H+0]*Ie>>23,G[K+4*H+1]=G[K+4*H+1]*Ie>>23,G[K+4*H+2]=G[K+4*H+2]*Ie>>23)}v+=V}}function Kn(m,v,C,T,R){for(;0<T--;){var V;for(V=0;V<C;++V){var H=m[v+2*V+0],G=15&(te=m[v+2*V+1]),K=4369*G,te=(240&te|te>>4)*K>>16;m[v+2*V+0]=(240&H|H>>4)*K>>16&240|(15&H|H<<4)*K>>16>>4&15,m[v+2*V+1]=240&te|G}v+=R}}function Vn(m,v,C,T,R,V,H,G){var K,te,me=255;for(te=0;te<R;++te){for(K=0;K<T;++K){var Ie=m[v+K];V[H+4*K]=Ie,me&=Ie}v+=C,H+=G}return me!=255}function wr(m,v,C,T,R){var V;for(V=0;V<R;++V)C[T+V]=m[v+V]>>8}function Ba(){cu=tn,Lx=Kn,Ix=Vn,Rx=wr}function oa(m,v,C){M[m]=function(T,R,V,H,G,K,te,me,Ie,ie,_e,Te,We,Me,$e,Ke,ot){var tt,Mt=ot-1>>1,wt=G[K+0]|te[me+0]<<16,ai=Ie[ie+0]|_e[Te+0]<<16;t(T!=null);var kt=3*wt+ai+131074>>2;for(v(T[R+0],255&kt,kt>>16,We,Me),V!=null&&(kt=3*ai+wt+131074>>2,v(V[H+0],255&kt,kt>>16,$e,Ke)),tt=1;tt<=Mt;++tt){var pi=G[K+tt]|te[me+tt]<<16,Jn=Ie[ie+tt]|_e[Te+tt]<<16,si=wt+pi+ai+Jn+524296,Tt=si+2*(pi+ai)>>3;kt=Tt+wt>>1,wt=(si=si+2*(wt+Jn)>>3)+pi>>1,v(T[R+2*tt-1],255&kt,kt>>16,We,Me+(2*tt-1)*C),v(T[R+2*tt-0],255&wt,wt>>16,We,Me+(2*tt-0)*C),V!=null&&(kt=si+ai>>1,wt=Tt+Jn>>1,v(V[H+2*tt-1],255&kt,kt>>16,$e,Ke+(2*tt-1)*C),v(V[H+2*tt+0],255&wt,wt>>16,$e,Ke+(2*tt+0)*C)),wt=pi,ai=Jn}1&ot||(kt=3*wt+ai+131074>>2,v(T[R+ot-1],255&kt,kt>>16,We,Me+(ot-1)*C),V!=null&&(kt=3*ai+wt+131074>>2,v(V[H+ot-1],255&kt,kt>>16,$e,Ke+(ot-1)*C)))}}function Jd(){za[rf]=bC,za[af]=$x,za[zx]=wC,za[sf]=Xx,za[of]=Yx,za[Bp]=Kx,za[Hx]=yC,za[jp]=$x,za[Vp]=Xx,za[lf]=Yx,za[Up]=Kx}function I0(m){return m&~SC?0>m?0:255:m>>Zx}function Vl(m,v){return I0((19077*m>>8)+(26149*v>>8)-14234)}function jo(m,v,C){return I0((19077*m>>8)-(6419*v>>8)-(13320*C>>8)+8708)}function Ul(m,v){return I0((19077*m>>8)+(33050*v>>8)-17685)}function zl(m,v,C,T,R){T[R+0]=Vl(m,C),T[R+1]=jo(m,v,C),T[R+2]=Ul(m,v)}function Hl(m,v,C,T,R){T[R+0]=Ul(m,v),T[R+1]=jo(m,v,C),T[R+2]=Vl(m,C)}function Br(m,v,C,T,R){var V=jo(m,v,C);v=V<<3&224|Ul(m,v)>>3,T[R+0]=248&Vl(m,C)|V>>5,T[R+1]=v}function Wl(m,v,C,T,R){var V=240&Ul(m,v)|15;T[R+0]=240&Vl(m,C)|jo(m,v,C)>>4,T[R+1]=V}function ql(m,v,C,T,R){T[R+0]=255,zl(m,v,C,T,R+1)}function Qc(m,v,C,T,R){Hl(m,v,C,T,R),T[R+3]=255}function eu(m,v,C,T,R){zl(m,v,C,T,R),T[R+3]=255}function _n(m,v){return 0>m?0:m>v?v:m}function ro(m,v,C){M[m]=function(T,R,V,H,G,K,te,me,Ie){for(var ie=me+(-2&Ie)*C;me!=ie;)v(T[R+0],V[H+0],G[K+0],te,me),v(T[R+1],V[H+0],G[K+0],te,me+C),R+=2,++H,++K,me+=2*C;1&Ie&&v(T[R+0],V[H+0],G[K+0],te,me)}}function R0(m,v,C){return C==0?m==0?v==0?6:5:v==0?4:0:C}function Qd(m,v,C,T,R){switch(m>>>30){case 3:Yl(v,C,T,R,0);break;case 2:Va(v,C,T,R);break;case 1:Mi(v,C,T,R)}}function ja(m,v){var C,T,R=v.M,V=v.Nb,H=m.oc,G=m.pc+40,K=m.oc,te=m.pc+584,me=m.oc,Ie=m.pc+600;for(C=0;16>C;++C)H[G+32*C-1]=129;for(C=0;8>C;++C)K[te+32*C-1]=129,me[Ie+32*C-1]=129;for(0<R?H[G-1-32]=K[te-1-32]=me[Ie-1-32]=129:(r(H,G-32-1,127,21),r(K,te-32-1,127,9),r(me,Ie-32-1,127,9)),T=0;T<m.za;++T){var ie=v.ya[v.aa+T];if(0<T){for(C=-1;16>C;++C)n(H,G+32*C-4,H,G+32*C+12,4);for(C=-1;8>C;++C)n(K,te+32*C-4,K,te+32*C+4,4),n(me,Ie+32*C-4,me,Ie+32*C+4,4)}var _e=m.Gd,Te=m.Hd+T,We=ie.ad,Me=ie.Hc;if(0<R&&(n(H,G-32,_e[Te].y,0,16),n(K,te-32,_e[Te].f,0,8),n(me,Ie-32,_e[Te].ea,0,8)),ie.Za){var $e=H,Ke=G-32+16;for(0<R&&(T>=m.za-1?r($e,Ke,_e[Te].y[15],4):n($e,Ke,_e[Te+1].y,0,4)),C=0;4>C;C++)$e[Ke+128+C]=$e[Ke+256+C]=$e[Ke+384+C]=$e[Ke+0+C];for(C=0;16>C;++C,Me<<=2)$e=H,Ke=G+Qx[C],rs[ie.Ob[C]]($e,Ke),Qd(Me,We,16*+C,$e,Ke)}else if($e=R0(T,R,ie.Ob[0]),$o[$e](H,G),Me!=0)for(C=0;16>C;++C,Me<<=2)Qd(Me,We,16*+C,H,G+Qx[C]);for(C=ie.Gc,$e=R0(T,R,ie.Dd),oo[$e](K,te),oo[$e](me,Ie),Me=We,$e=K,Ke=te,255&(ie=0|C)&&(170&ie?As(Me,256,$e,Ke):Yi(Me,256,$e,Ke)),ie=me,Me=Ie,255&(C>>=8)&&(170&C?As(We,320,ie,Me):Yi(We,320,ie,Me)),R<m.Ub-1&&(n(_e[Te].y,0,H,G+480,16),n(_e[Te].f,0,K,te+224,8),n(_e[Te].ea,0,me,Ie+224,8)),C=8*V*m.B,_e=m.sa,Te=m.ta+16*T+16*V*m.R,We=m.qa,ie=m.ra+8*T+C,Me=m.Ha,$e=m.Ia+8*T+C,C=0;16>C;++C)n(_e,Te+C*m.R,H,G+32*C,16);for(C=0;8>C;++C)n(We,ie+C*m.B,K,te+32*C,8),n(Me,$e+C*m.B,me,Ie+32*C,8)}}function Gl(m,v,C,T,R,V,H,G,K){var te=[0],me=[0],Ie=0,ie=K!=null?K.kd:0,_e=K??new Ye;if(m==null||12>C)return 7;_e.data=m,_e.w=v,_e.ha=C,v=[v],C=[C],_e.gb=[_e.gb];e:{var Te=v,We=C,Me=_e.gb;if(t(m!=null),t(We!=null),t(Me!=null),Me[0]=0,12<=We[0]&&!e(m,Te[0],"RIFF")){if(e(m,Te[0]+8,"WEBP")){Me=3;break e}var $e=Ne(m,Te[0]+4);if(12>$e||4294967286<$e){Me=3;break e}if(ie&&$e>We[0]-8){Me=7;break e}Me[0]=$e,Te[0]+=12,We[0]-=12}Me=0}if(Me!=0)return Me;for($e=0<_e.gb[0],C=C[0];;){e:{var Ke=m;We=v,Me=C;var ot=te,tt=me,Mt=Te=[0];if((kt=Ie=[Ie])[0]=0,8>Me[0])Me=7;else{if(!e(Ke,We[0],"VP8X")){if(Ne(Ke,We[0]+4)!=10){Me=3;break e}if(18>Me[0]){Me=7;break e}var wt=Ne(Ke,We[0]+8),ai=1+ut(Ke,We[0]+12);if(2147483648<=ai*(Ke=1+ut(Ke,We[0]+15))){Me=3;break e}Mt!=null&&(Mt[0]=wt),ot!=null&&(ot[0]=ai),tt!=null&&(tt[0]=Ke),We[0]+=18,Me[0]-=18,kt[0]=1}Me=0}}if(Ie=Ie[0],Te=Te[0],Me!=0)return Me;if(We=!!(2&Te),!$e&&Ie)return 3;if(V!=null&&(V[0]=!!(16&Te)),H!=null&&(H[0]=We),G!=null&&(G[0]=0),H=te[0],Te=me[0],Ie&&We&&K==null){Me=0;break}if(4>C){Me=7;break}if($e&&Ie||!$e&&!Ie&&!e(m,v[0],"ALPH")){C=[C],_e.na=[_e.na],_e.P=[_e.P],_e.Sa=[_e.Sa];e:{wt=m,Me=v,$e=C;var kt=_e.gb;ot=_e.na,tt=_e.P,Mt=_e.Sa,ai=22,t(wt!=null),t($e!=null),Ke=Me[0];var pi=$e[0];for(t(ot!=null),t(Mt!=null),ot[0]=null,tt[0]=null,Mt[0]=0;;){if(Me[0]=Ke,$e[0]=pi,8>pi){Me=7;break e}var Jn=Ne(wt,Ke+4);if(4294967286<Jn){Me=3;break e}var si=8+Jn+1&-2;if(ai+=si,0<kt&&ai>kt){Me=3;break e}if(!e(wt,Ke,"VP8 ")||!e(wt,Ke,"VP8L")){Me=0;break e}if(pi[0]<si){Me=7;break e}e(wt,Ke,"ALPH")||(ot[0]=wt,tt[0]=Ke+8,Mt[0]=Jn),Ke+=si,pi-=si}}if(C=C[0],_e.na=_e.na[0],_e.P=_e.P[0],_e.Sa=_e.Sa[0],Me!=0)break}C=[C],_e.Ja=[_e.Ja],_e.xa=[_e.xa];e:if(kt=m,Me=v,$e=C,ot=_e.gb[0],tt=_e.Ja,Mt=_e.xa,wt=Me[0],Ke=!e(kt,wt,"VP8 "),ai=!e(kt,wt,"VP8L"),t(kt!=null),t($e!=null),t(tt!=null),t(Mt!=null),8>$e[0])Me=7;else{if(Ke||ai){if(kt=Ne(kt,wt+4),12<=ot&&kt>ot-12){Me=3;break e}if(ie&&kt>$e[0]-8){Me=7;break e}tt[0]=kt,Me[0]+=8,$e[0]-=8,Mt[0]=ai}else Mt[0]=5<=$e[0]&&kt[wt+0]==47&&!(kt[wt+4]>>5),tt[0]=$e[0];Me=0}if(C=C[0],_e.Ja=_e.Ja[0],_e.xa=_e.xa[0],v=v[0],Me!=0)break;if(4294967286<_e.Ja)return 3;if(G==null||We||(G[0]=_e.xa?2:1),H=[H],Te=[Te],_e.xa){if(5>C){Me=7;break}G=H,ie=Te,We=V,m==null||5>C?m=0:5<=C&&m[v+0]==47&&!(m[v+4]>>5)?($e=[0],kt=[0],ot=[0],Oe(tt=new B,m,v,C),ts(tt,$e,kt,ot)?(G!=null&&(G[0]=$e[0]),ie!=null&&(ie[0]=kt[0]),We!=null&&(We[0]=ot[0]),m=1):m=0):m=0}else{if(10>C){Me=7;break}G=Te,m==null||10>C||!Hd(m,v+3,C-3)?m=0:(ie=m[v+0]|m[v+1]<<8|m[v+2]<<16,We=16383&(m[v+7]<<8|m[v+6]),m=16383&(m[v+9]<<8|m[v+8]),1&ie||3<(ie>>1&7)||!(ie>>4&1)||ie>>5>=_e.Ja||!We||!m?m=0:(H&&(H[0]=We),G&&(G[0]=m),m=1))}if(!m||(H=H[0],Te=Te[0],Ie&&(te[0]!=H||me[0]!=Te)))return 3;K!=null&&(K[0]=_e,K.offset=v-K.w,t(4294967286>v-K.w),t(K.offset==K.ha-C));break}return Me==0||Me==7&&Ie&&K==null?(V!=null&&(V[0]|=_e.na!=null&&0<_e.na.length),T!=null&&(T[0]=H),R!=null&&(R[0]=Te),0):Me}function tu(m,v,C){var T=v.width,R=v.height,V=0,H=0,G=T,K=R;if(v.Da=m!=null&&0<m.Da,v.Da&&(G=m.cd,K=m.bd,V=m.v,H=m.j,11>C||(V&=-2,H&=-2),0>V||0>H||0>=G||0>=K||V+G>T||H+K>R))return 0;if(v.v=V,v.j=H,v.va=V+G,v.o=H+K,v.U=G,v.T=K,v.da=m!=null&&0<m.da,v.da){if(!bt(G,K,C=[m.ib],V=[m.hb]))return 0;v.ib=C[0],v.hb=V[0]}return v.ob=m!=null&&m.ob,v.Kb=m==null||!m.Sd,v.da&&(v.ob=v.ib<3*T/4&&v.hb<3*R/4,v.Kb=0),1}function iu(m){if(m==null)return 2;if(11>m.S){var v=m.f.RGBA;v.fb+=(m.height-1)*v.A,v.A=-v.A}else v=m.f.kb,m=m.height,v.O+=(m-1)*v.fa,v.fa=-v.fa,v.N+=(m-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(m-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(m-1)*v.lb,v.lb=-v.lb);return 0}function Vo(m,v,C,T){if(T==null||0>=m||0>=v)return 2;if(C!=null){if(C.Da){var R=C.cd,V=C.bd,H=-2&C.v,G=-2&C.j;if(0>H||0>G||0>=R||0>=V||H+R>m||G+V>v)return 2;m=R,v=V}if(C.da){if(!bt(m,v,R=[C.ib],V=[C.hb]))return 2;m=R[0],v=V[0]}}T.width=m,T.height=v;e:{var K=T.width,te=T.height;if(m=T.S,0>=K||0>=te||!(m>=rf&&13>m))m=2;else{if(0>=T.Rd&&T.sd==null){H=V=R=v=0;var me=(G=K*ev[m])*te;if(11>m||(V=(te+1)/2*(v=(K+1)/2),m==12&&(H=(R=K)*te)),(te=a(me+2*V+H))==null){m=1;break e}T.sd=te,11>m?((K=T.f.RGBA).eb=te,K.fb=0,K.A=G,K.size=me):((K=T.f.kb).y=te,K.O=0,K.fa=G,K.Fd=me,K.f=te,K.N=0+me,K.Ab=v,K.Cd=V,K.ea=te,K.W=0+me+V,K.Db=v,K.Ed=V,m==12&&(K.F=te,K.J=0+me+2*V),K.Tc=H,K.lb=R)}if(v=1,R=T.S,V=T.width,H=T.height,R>=rf&&13>R)if(11>R)m=T.f.RGBA,v&=(G=Math.abs(m.A))*(H-1)+V<=m.size,v&=G>=V*ev[R],v&=m.eb!=null;else{m=T.f.kb,G=(V+1)/2,me=(H+1)/2,K=Math.abs(m.fa),te=Math.abs(m.Ab);var Ie=Math.abs(m.Db),ie=Math.abs(m.lb),_e=ie*(H-1)+V;v&=K*(H-1)+V<=m.Fd,v&=te*(me-1)+G<=m.Cd,v=(v&=Ie*(me-1)+G<=m.Ed)&K>=V&te>=G&Ie>=G,v&=m.y!=null,v&=m.f!=null,v&=m.ea!=null,R==12&&(v&=ie>=V,v&=_e<=m.Tc,v&=m.F!=null)}else v=0;m=v?0:2}}return m!=0||C!=null&&C.fd&&(m=iu(T)),m}var $l=64,_a=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ba=24,Uo=32,ao=8,zo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];mt("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(m){return m},M.Predictor2=function(m,v,C){return v[C+0]},M.Predictor3=function(m,v,C){return v[C+1]},M.Predictor4=function(m,v,C){return v[C-1]},M.Predictor5=function(m,v,C){return Nt(Nt(m,v[C+1]),v[C+0])},M.Predictor6=function(m,v,C){return Nt(m,v[C-1])},M.Predictor7=function(m,v,C){return Nt(m,v[C+0])},M.Predictor8=function(m,v,C){return Nt(v[C-1],v[C+0])},M.Predictor9=function(m,v,C){return Nt(v[C+0],v[C+1])},M.Predictor10=function(m,v,C){return Nt(Nt(m,v[C-1]),Nt(v[C+0],v[C+1]))},M.Predictor11=function(m,v,C){var T=v[C+0];return 0>=Gt(T>>24&255,m>>24&255,(v=v[C-1])>>24&255)+Gt(T>>16&255,m>>16&255,v>>16&255)+Gt(T>>8&255,m>>8&255,v>>8&255)+Gt(255&T,255&m,255&v)?T:m},M.Predictor12=function(m,v,C){var T=v[C+0];return(ri((m>>24&255)+(T>>24&255)-((v=v[C-1])>>24&255))<<24|ri((m>>16&255)+(T>>16&255)-(v>>16&255))<<16|ri((m>>8&255)+(T>>8&255)-(v>>8&255))<<8|ri((255&m)+(255&T)-(255&v)))>>>0},M.Predictor13=function(m,v,C){var T=v[C-1];return(qt((m=Nt(m,v[C+0]))>>24&255,T>>24&255)<<24|qt(m>>16&255,T>>16&255)<<16|qt(m>>8&255,T>>8&255)<<8|qt(255&m,255&T))>>>0};var nu=M.PredictorAdd0;M.PredictorAdd1=Ci,mt("Predictor2","PredictorAdd2"),mt("Predictor3","PredictorAdd3"),mt("Predictor4","PredictorAdd4"),mt("Predictor5","PredictorAdd5"),mt("Predictor6","PredictorAdd6"),mt("Predictor7","PredictorAdd7"),mt("Predictor8","PredictorAdd8"),mt("Predictor9","PredictorAdd9"),mt("Predictor10","PredictorAdd10"),mt("Predictor11","PredictorAdd11"),mt("Predictor12","PredictorAdd12"),mt("Predictor13","PredictorAdd13");var O0=M.PredictorAdd2;Pt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),Pt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var Fn,ef=M.ColorIndexInverseTransform,ks=M.MapARGB,Ts=M.VP8LColorIndexInverseTransformAlpha,ru=M.MapAlpha,au=M.VP8LPredictorsAdd=[];au.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var su,ou,Ho,Wo,qo,Xl,Go,Yl,Va,As,Mi,Yi,Dn,Zn,so,lu,B0,tf,Ax,Fx,Dx,Nx,Px,Mx,cu,Lx,Ix,Rx,Ox=a(511),Bx=a(2041),jx=a(225),Vx=a(767),Ux=0,Op=Bx,nf=jx,wa=Vx,Ua=Ox,rf=0,af=1,zx=2,sf=3,of=4,Bp=5,Hx=6,jp=7,Vp=8,lf=9,Up=10,sC=[2,3,7],oC=[3,3,11],Wx=[280,256,256,256,40],lC=[0,1,1,1,0],cC=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],uC=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],dC=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],fC=8,zp=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Hp=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],uu=null,hC=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],pC=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],qx=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],mC=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],gC=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],xC=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],vC=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],$o=[],rs=[],oo=[],_C=1,Gx=2,Xo=[],za=[];oa("UpsampleRgbLinePair",zl,3),oa("UpsampleBgrLinePair",Hl,3),oa("UpsampleRgbaLinePair",eu,4),oa("UpsampleBgraLinePair",Qc,4),oa("UpsampleArgbLinePair",ql,4),oa("UpsampleRgba4444LinePair",Wl,2),oa("UpsampleRgb565LinePair",Br,2);var bC=M.UpsampleRgbLinePair,wC=M.UpsampleBgrLinePair,$x=M.UpsampleRgbaLinePair,Xx=M.UpsampleBgraLinePair,Yx=M.UpsampleArgbLinePair,Kx=M.UpsampleRgba4444LinePair,yC=M.UpsampleRgb565LinePair,cf=16,uf=1<<cf-1,du=-227,Wp=482,Zx=6,SC=(256<<Zx)-1,Jx=0,CC=a(256),EC=a(256),kC=a(256),TC=a(256),AC=a(Wp-du),FC=a(Wp-du);ro("YuvToRgbRow",zl,3),ro("YuvToBgrRow",Hl,3),ro("YuvToRgbaRow",eu,4),ro("YuvToBgraRow",Qc,4),ro("YuvToArgbRow",ql,4),ro("YuvToRgba4444Row",Wl,2),ro("YuvToRgb565Row",Br,2);var Qx=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],df=[0,2,8],DC=[8,7,6,4,4,2,2,2,1,1,1,1],NC=1;this.WebPDecodeRGBA=function(m,v,C,T,R){var V=af,H=new Ee,G=new Bi;H.ba=G,G.S=V,G.width=[G.width],G.height=[G.height];var K=G.width,te=G.height,me=new Ut;if(me==null||m==null)var Ie=2;else t(me!=null),Ie=Gl(m,v,C,me.width,me.height,me.Pd,me.Qd,me.format,null);if(Ie!=0?K=0:(K!=null&&(K[0]=me.width[0]),te!=null&&(te[0]=me.height[0]),K=1),K){G.width=G.width[0],G.height=G.height[0],T!=null&&(T[0]=G.width),R!=null&&(R[0]=G.height);e:{if(T=new Or,(R=new Ye).data=m,R.w=v,R.ha=C,R.kd=1,v=[0],t(R!=null),((m=Gl(R.data,R.w,R.ha,null,null,null,v,null,R))==0||m==7)&&v[0]&&(m=4),(v=m)==0){if(t(H!=null),T.data=R.data,T.w=R.w+R.offset,T.ha=R.ha-R.offset,T.put=Ot,T.ac=Ra,T.bc=es,T.ma=H,R.xa){if((m=Le())==null){H=1;break e}if((function(ie,_e){var Te=[0],We=[0],Me=[0];t:for(;;){if(ie==null)return 0;if(_e==null)return ie.a=2,0;if(ie.l=_e,ie.a=0,Oe(ie.m,_e.data,_e.w,_e.ha),!ts(ie.m,Te,We,Me)){ie.a=3;break t}if(ie.xb=Gx,_e.width=Te[0],_e.height=We[0],!Pe(Te[0],We[0],1,ie,null))break t;return 1}return t(ie.a!=0),0})(m,T)){if(T=(v=Vo(T.width,T.height,H.Oa,H.ba))==0){t:{T=m;i:for(;;){if(T==null){T=0;break t}if(t(T.s.yc!=null),t(T.s.Ya!=null),t(0<T.s.Wb),t((C=T.l)!=null),t((R=C.ma)!=null),T.xb!=0){if(T.ca=R.ba,T.tb=R.tb,t(T.ca!=null),!tu(R.Oa,C,sf)){T.a=2;break i}if(!Be(T,C.width)||C.da)break i;if((C.da||Kt(T.ca.S))&&Ba(),11>T.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),T.ca.f.kb.F!=null&&Ba()),T.Pb&&0<T.s.ua&&T.s.vb.X==null&&!oe(T.s.vb,T.s.Wa.Xa)){T.a=1;break i}T.xb=0}if(!De(T,T.V,T.Ba,T.c,T.i,C.o,Y))break i;R.Dc=T.Ma,T=1;break t}t(T.a!=0),T=0}T=!T}T&&(v=m.a)}else v=m.a}else{if((m=new yp)==null){H=1;break e}if(m.Fa=R.na,m.P=R.P,m.qc=R.Sa,Wd(m,T)){if((v=Vo(T.width,T.height,H.Oa,H.ba))==0){if(m.Aa=0,C=H.Oa,t((R=m)!=null),C!=null){if(0<(K=0>(K=C.Md)?0:100<K?255:255*K/100)){for(te=me=0;4>te;++te)12>(Ie=R.pb[te]).lc&&(Ie.ia=K*DC[0>Ie.lc?0:Ie.lc]>>3),me|=Ie.ia;me&&(alert("todo:VP8InitRandom"),R.ia=1)}R.Ga=C.Id,100<R.Ga?R.Ga=100:0>R.Ga&&(R.Ga=0)}(function(ie,_e){if(ie==null)return 0;if(_e==null)return Bn(ie,2,"NULL VP8Io parameter in VP8Decode().");if(!ie.cb&&!Wd(ie,_e))return 0;if(t(ie.cb),_e.ac==null||_e.ac(_e)){_e.ob&&(ie.L=0);var Te=df[ie.L];if(ie.L==2?(ie.yb=0,ie.zb=0):(ie.yb=_e.v-Te>>4,ie.zb=_e.j-Te>>4,0>ie.yb&&(ie.yb=0),0>ie.zb&&(ie.zb=0)),ie.Va=_e.o+15+Te>>4,ie.Hb=_e.va+15+Te>>4,ie.Hb>ie.za&&(ie.Hb=ie.za),ie.Va>ie.Ub&&(ie.Va=ie.Ub),0<ie.L){var We=ie.ed;for(Te=0;4>Te;++Te){var Me;if(ie.Qa.Cb){var $e=ie.Qa.Lb[Te];ie.Qa.Fb||($e+=We.Tb)}else $e=We.Tb;for(Me=0;1>=Me;++Me){var Ke=ie.gd[Te][Me],ot=$e;if(We.Pc&&(ot+=We.vd[0],Me&&(ot+=We.od[0])),0<(ot=0>ot?0:63<ot?63:ot)){var tt=ot;0<We.wb&&(tt=4<We.wb?tt>>2:tt>>1)>9-We.wb&&(tt=9-We.wb),1>tt&&(tt=1),Ke.dd=tt,Ke.tc=2*ot+tt,Ke.ld=40<=ot?2:15<=ot?1:0}else Ke.tc=0;Ke.La=Me}}}Te=0}else Bn(ie,6,"Frame setup failed"),Te=ie.a;if(Te=Te==0){if(Te){ie.$c=0,0<ie.Aa||(ie.Ic=NC);t:{Te=ie.Ic,We=4*(tt=ie.za);var Mt=32*tt,wt=tt+1,ai=0<ie.L?tt*(0<ie.Aa?2:1):0,kt=(ie.Aa==2?2:1)*tt;if((Ke=We+832+(Me=3*(16*Te+df[ie.L])/2*Mt)+($e=ie.Fa!=null&&0<ie.Fa.length?ie.Kc.c*ie.Kc.i:0))!=Ke)Te=0;else{if(Ke>ie.Vb){if(ie.Vb=0,ie.Ec=a(Ke),ie.Fc=0,ie.Ec==null){Te=Bn(ie,1,"no memory during frame initialization.");break t}ie.Vb=Ke}Ke=ie.Ec,ot=ie.Fc,ie.Ac=Ke,ie.Bc=ot,ot+=We,ie.Gd=s(Mt,Oa),ie.Hd=0,ie.rb=s(wt+1,en),ie.sb=1,ie.wa=ai?s(ai,Xi):null,ie.Y=0,ie.D.Nb=0,ie.D.wa=ie.wa,ie.D.Y=ie.Y,0<ie.Aa&&(ie.D.Y+=tt),t(!0),ie.oc=Ke,ie.pc=ot,ot+=832,ie.ya=s(kt,is),ie.aa=0,ie.D.ya=ie.ya,ie.D.aa=ie.aa,ie.Aa==2&&(ie.D.aa+=tt),ie.R=16*tt,ie.B=8*tt,tt=(Mt=df[ie.L])*ie.R,Mt=Mt/2*ie.B,ie.sa=Ke,ie.ta=ot+tt,ie.qa=ie.sa,ie.ra=ie.ta+16*Te*ie.R+Mt,ie.Ha=ie.qa,ie.Ia=ie.ra+8*Te*ie.B+Mt,ie.$c=0,ot+=Me,ie.mb=$e?Ke:null,ie.nb=$e?ot:null,t(ot+$e<=ie.Fc+ie.Vb),Nl(ie),r(ie.Ac,ie.Bc,0,We),Te=1}}if(Te){if(_e.ka=0,_e.y=ie.sa,_e.O=ie.ta,_e.f=ie.qa,_e.N=ie.ra,_e.ea=ie.Ha,_e.Vd=ie.Ia,_e.fa=ie.R,_e.Rc=ie.B,_e.F=null,_e.J=0,!Ux){for(Te=-255;255>=Te;++Te)Ox[255+Te]=0>Te?-Te:Te;for(Te=-1020;1020>=Te;++Te)Bx[1020+Te]=-128>Te?-128:127<Te?127:Te;for(Te=-112;112>=Te;++Te)jx[112+Te]=-16>Te?-16:15<Te?15:Te;for(Te=-255;510>=Te;++Te)Vx[255+Te]=0>Te?0:255<Te?255:Te;Ux=1}Go=Gd,Yl=Cp,As=Ep,Mi=Es,Yi=qd,Va=Sp,Dn=Yd,Zn=Kd,so=y,lu=L,B0=jl,tf=Zd,Ax=ae,Fx=he,Dx=Jc,Nx=Bl,Px=$d,Mx=Xd,rs[0]=Pp,rs[1]=qc,rs[2]=Dp,rs[3]=Np,rs[4]=Mp,rs[5]=to,rs[6]=eo,rs[7]=Lp,rs[8]=N0,rs[9]=Ip,$o[0]=Bo,$o[1]=Tp,$o[2]=Ap,$o[3]=Gc,$o[4]=Fp,$o[5]=Ll,$o[6]=$c,oo[0]=M0,oo[1]=kp,oo[2]=Xc,oo[3]=Il,oo[4]=Yc,oo[5]=Rp,oo[6]=Kc,Te=1}else Te=0}Te&&(Te=(function(pi,Jn){for(pi.M=0;pi.M<pi.Va;++pi.M){var si,Tt=pi.Jc[pi.M&pi.Xb],gt=pi.m,Nn=pi;for(si=0;si<Nn.za;++si){var ni=gt,_i=Nn,on=_i.Ac,yr=_i.Bc+4*si,Yr=_i.zc,bn=_i.ya[_i.aa+si];if(_i.Qa.Bb?bn.$b=ge(ni,_i.Pa.jb[0])?2+ge(ni,_i.Pa.jb[2]):ge(ni,_i.Pa.jb[1]):bn.$b=0,_i.kc&&(bn.Ad=ge(ni,_i.Bd)),bn.Za=!ge(ni,145)+0,bn.Za){var jr=bn.Ob,Kr=0;for(_i=0;4>_i;++_i){var Qn,yi=Yr[0+_i];for(Qn=0;4>Qn;++Qn){yi=gC[on[yr+Qn]][yi];for(var ji=qx[ge(ni,yi[0])];0<ji;)ji=qx[2*ji+ge(ni,yi[ji])];yi=-ji,on[yr+Qn]=yi}n(jr,Kr,on,yr,4),Kr+=4,Yr[0+_i]=yi}}else yi=ge(ni,156)?ge(ni,128)?1:3:ge(ni,163)?2:0,bn.Ob[0]=yi,r(on,yr,yi,4),r(Yr,0,yi,4);bn.Dd=ge(ni,142)?ge(ni,114)?ge(ni,183)?1:3:2:0}if(Nn.m.Ka)return Bn(pi,7,"Premature end-of-partition0 encountered.");for(;pi.ja<pi.za;++pi.ja){if(Nn=Tt,ni=(gt=pi).rb[gt.sb-1],on=gt.rb[gt.sb+gt.ja],si=gt.ya[gt.aa+gt.ja],yr=gt.kc?si.Ad:0)ni.la=on.la=0,si.Za||(ni.Na=on.Na=0),si.Hc=0,si.Gc=0,si.ia=0;else{var wn,Vi;if(ni=on,on=Nn,yr=gt.Pa.Xc,Yr=gt.ya[gt.aa+gt.ja],bn=gt.pb[Yr.$b],_i=Yr.ad,jr=0,Kr=gt.rb[gt.sb-1],yi=Qn=0,r(_i,jr,0,384),Yr.Za)var Sr=0,as=yr[3];else{ji=a(16);var Pn=ni.Na+Kr.Na;if(Pn=uu(on,yr[1],Pn,bn.Eb,0,ji,0),ni.Na=Kr.Na=(0<Pn)+0,1<Pn)Go(ji,0,_i,jr);else{var la=ji[0]+3>>3;for(ji=0;256>ji;ji+=16)_i[jr+ji]=la}Sr=1,as=yr[0]}var Ki=15&ni.la,er=15&Kr.la;for(ji=0;4>ji;++ji){var ya=1&er;for(la=Vi=0;4>la;++la)Ki=Ki>>1|(ya=(Pn=uu(on,as,Pn=ya+(1&Ki),bn.Sc,Sr,_i,jr))>Sr)<<7,Vi=Vi<<2|(3<Pn?3:1<Pn?2:_i[jr+0]!=0),jr+=16;Ki>>=4,er=er>>1|ya<<7,Qn=(Qn<<8|Vi)>>>0}for(as=Ki,Sr=er>>4,wn=0;4>wn;wn+=2){for(Vi=0,Ki=ni.la>>4+wn,er=Kr.la>>4+wn,ji=0;2>ji;++ji){for(ya=1&er,la=0;2>la;++la)Pn=ya+(1&Ki),Ki=Ki>>1|(ya=0<(Pn=uu(on,yr[2],Pn,bn.Qc,0,_i,jr)))<<3,Vi=Vi<<2|(3<Pn?3:1<Pn?2:_i[jr+0]!=0),jr+=16;Ki>>=2,er=er>>1|ya<<5}yi|=Vi<<4*wn,as|=Ki<<4<<wn,Sr|=(240&er)<<wn}ni.la=as,Kr.la=Sr,Yr.Hc=Qn,Yr.Gc=yi,Yr.ia=43690&yi?0:bn.ia,yr=!(Qn|yi)}if(0<gt.L&&(gt.wa[gt.Y+gt.ja]=gt.gd[si.$b][si.Za],gt.wa[gt.Y+gt.ja].La|=!yr),Nn.Ka)return Bn(pi,7,"Premature end-of-file encountered.")}if(Nl(pi),gt=Jn,Nn=1,si=(Tt=pi).D,ni=0<Tt.L&&Tt.M>=Tt.zb&&Tt.M<=Tt.Va,Tt.Aa==0)t:{if(si.M=Tt.M,si.uc=ni,ja(Tt,si),Nn=1,si=(Vi=Tt.D).Nb,ni=(yi=df[Tt.L])*Tt.R,on=yi/2*Tt.B,ji=16*si*Tt.R,la=8*si*Tt.B,yr=Tt.sa,Yr=Tt.ta-ni+ji,bn=Tt.qa,_i=Tt.ra-on+la,jr=Tt.Ha,Kr=Tt.Ia-on+la,er=(Ki=Vi.M)==0,Qn=Ki>=Tt.Va-1,Tt.Aa==2&&ja(Tt,Vi),Vi.uc)for(ya=(Pn=Tt).D.M,t(Pn.D.uc),Vi=Pn.yb;Vi<Pn.Hb;++Vi){Sr=Vi,as=ya;var Zr=(Sa=(Cr=Pn).D).Nb;wn=Cr.R;var Sa=Sa.wa[Sa.Y+Sr],Ca=Cr.sa,ca=Cr.ta+16*Zr*wn+16*Sr,Ea=Sa.dd,nn=Sa.tc;if(nn!=0)if(t(3<=nn),Cr.L==1)0<Sr&&Nx(Ca,ca,wn,nn+4),Sa.La&&Mx(Ca,ca,wn,nn),0<as&&Dx(Ca,ca,wn,nn+4),Sa.La&&Px(Ca,ca,wn,nn);else{var ka=Cr.B,ss=Cr.qa,Kl=Cr.ra+8*Zr*ka+8*Sr,lo=Cr.Ha,Cr=Cr.Ia+8*Zr*ka+8*Sr;Zr=Sa.ld,0<Sr&&(Zn(Ca,ca,wn,nn+4,Ea,Zr),lu(ss,Kl,lo,Cr,ka,nn+4,Ea,Zr)),Sa.La&&(tf(Ca,ca,wn,nn,Ea,Zr),Fx(ss,Kl,lo,Cr,ka,nn,Ea,Zr)),0<as&&(Dn(Ca,ca,wn,nn+4,Ea,Zr),so(ss,Kl,lo,Cr,ka,nn+4,Ea,Zr)),Sa.La&&(B0(Ca,ca,wn,nn,Ea,Zr),Ax(ss,Kl,lo,Cr,ka,nn,Ea,Zr))}}if(Tt.ia&&alert("todo:DitherRow"),gt.put!=null){if(Vi=16*Ki,Ki=16*(Ki+1),er?(gt.y=Tt.sa,gt.O=Tt.ta+ji,gt.f=Tt.qa,gt.N=Tt.ra+la,gt.ea=Tt.Ha,gt.W=Tt.Ia+la):(Vi-=yi,gt.y=yr,gt.O=Yr,gt.f=bn,gt.N=_i,gt.ea=jr,gt.W=Kr),Qn||(Ki-=yi),Ki>gt.o&&(Ki=gt.o),gt.F=null,gt.J=null,Tt.Fa!=null&&0<Tt.Fa.length&&Vi<Ki&&(gt.J=jn(Tt,gt,Vi,Ki-Vi),gt.F=Tt.mb,gt.F==null&&gt.F.length==0)){Nn=Bn(Tt,3,"Could not decode alpha data.");break t}Vi<gt.j&&(yi=gt.j-Vi,Vi=gt.j,t(!(1&yi)),gt.O+=Tt.R*yi,gt.N+=Tt.B*(yi>>1),gt.W+=Tt.B*(yi>>1),gt.F!=null&&(gt.J+=gt.width*yi)),Vi<Ki&&(gt.O+=gt.v,gt.N+=gt.v>>1,gt.W+=gt.v>>1,gt.F!=null&&(gt.J+=gt.v),gt.ka=Vi-gt.j,gt.U=gt.va-gt.v,gt.T=Ki-Vi,Nn=gt.put(gt))}si+1!=Tt.Ic||Qn||(n(Tt.sa,Tt.ta-ni,yr,Yr+16*Tt.R,ni),n(Tt.qa,Tt.ra-on,bn,_i+8*Tt.B,on),n(Tt.Ha,Tt.Ia-on,jr,Kr+8*Tt.B,on))}if(!Nn)return Bn(pi,6,"Output aborted.")}return 1})(ie,_e)),_e.bc!=null&&_e.bc(_e),Te&=1}return Te?(ie.cb=0,Te):0})(m,T)||(v=m.a)}}else v=m.a}v==0&&H.Oa!=null&&H.Oa.fd&&(v=iu(H.ba))}H=v}V=H!=0?null:11>V?G.f.RGBA.eb:G.f.kb.y}else V=null;return V};var ev=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(M,X){for(var F="",I=0;I<4;I++)F+=String.fromCharCode(M[X++]);return F}function u(M,X){return M[X+0]|M[X+1]<<8}function h(M,X){return(M[X+0]|M[X+1]<<8|M[X+2]<<16)>>>0}function g(M,X){return(M[X+0]|M[X+1]<<8|M[X+2]<<16|M[X+3]<<24)>>>0}new l;var d=[0],b=[0],_=[],w=new l,E=i,A=(function(M,X){var F={},I=0,ee=!1,le=0,de=0;if(F.frames=[],!(function(k,B){for(var P=0;P<4;P++)if(k[B+P]!="RIFF".charCodeAt(P))return!0;return!1})(M,X)){for(g(M,X+=4),X+=8;X<M.length;){var ke=c(M,X),Fe=g(M,X+=4);X+=4;var Se=Fe+(1&Fe);switch(ke){case"VP8 ":case"VP8L":F.frames[I]===void 0&&(F.frames[I]={}),(qe=F.frames[I]).src_off=ee?de:X-8,qe.src_size=le+Fe+8,I++,ee&&(ee=!1,le=0,de=0);break;case"VP8X":(qe=F.header={}).feature_flags=M[X];var Oe=X+4;qe.canvas_width=1+h(M,Oe),Oe+=3,qe.canvas_height=1+h(M,Oe),Oe+=3;break;case"ALPH":ee=!0,le=Se+8,de=X-8;break;case"ANIM":(qe=F.header).bgcolor=g(M,X),Oe=X+4,qe.loop_count=u(M,Oe),Oe+=2;break;case"ANMF":var Ze,qe;(qe=F.frames[I]={}).offset_x=2*h(M,X),X+=3,qe.offset_y=2*h(M,X),X+=3,qe.width=1+h(M,X),X+=3,qe.height=1+h(M,X),X+=3,qe.duration=h(M,X),X+=3,Ze=M[X++],qe.dispose=1&Ze,qe.blend=Ze>>1&1}ke!="ANMF"&&(X+=Se)}return F}})(E,0);A.response=E,A.rgbaoutput=!0,A.dataurl=!1;var D=A.header?A.header:null,N=A.frames?A.frames:null;if(D){D.loop_counter=D.loop_count,d=[D.canvas_height],b=[D.canvas_width];for(var z=0;z<N.length&&N[z].blend!=0;z++);}var J=N[0],W=w.WebPDecodeRGBA(E,J.src_off,J.src_size,b,d);J.rgba=W,J.imgwidth=b[0],J.imgheight=d[0];for(var U=0;U<b[0]*d[0]*4;U++)_[U]=W[U];return this.width=b,this.height=d,this.data=_,this}(function(i){var t,e,n,r,a,s,o,l,c,u=function(k){return k=k||{},this.isStrokeTransparent=k.isStrokeTransparent||!1,this.strokeOpacity=k.strokeOpacity||1,this.strokeStyle=k.strokeStyle||"#000000",this.fillStyle=k.fillStyle||"#000000",this.isFillTransparent=k.isFillTransparent||!1,this.fillOpacity=k.fillOpacity||1,this.font=k.font||"10px sans-serif",this.textBaseline=k.textBaseline||"alphabetic",this.textAlign=k.textAlign||"left",this.lineWidth=k.lineWidth||1,this.lineJoin=k.lineJoin||"miter",this.lineCap=k.lineCap||"butt",this.path=k.path||[],this.transform=k.transform!==void 0?k.transform.clone():new l,this.globalCompositeOperation=k.globalCompositeOperation||"normal",this.globalAlpha=k.globalAlpha||1,this.clip_path=k.clip_path||[],this.currentPoint=k.currentPoint||new s,this.miterLimit=k.miterLimit||10,this.lastPoint=k.lastPoint||new s,this.lineDashOffset=k.lineDashOffset||0,this.lineDash=k.lineDash||[],this.margin=k.margin||[0,0,0,0],this.prevPageLastElemOffset=k.prevPageLastElemOffset||0,this.ignoreClearRect=typeof k.ignoreClearRect!="boolean"||k.ignoreClearRect,this};i.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,e=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,r=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var h=function(k){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var B=k;Object.defineProperty(this,"pdf",{get:function(){return B}});var P=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return P},set:function(Ne){P=!!Ne}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(Ne){O=!!Ne}});var Q=0;Object.defineProperty(this,"posX",{get:function(){return Q},set:function(Ne){isNaN(Ne)||(Q=Ne)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(Ne){isNaN(Ne)||(fe=Ne)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Ne){var oe;typeof Ne=="number"?oe=[Ne,Ne,Ne,Ne]:((oe=new Array(4))[0]=Ne[0],oe[1]=Ne.length>=2?Ne[1]:oe[0],oe[2]=Ne.length>=3?Ne[2]:oe[0],oe[3]=Ne.length>=4?Ne[3]:oe[1]),c.margin=oe}});var ye=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ye},set:function(Ne){ye=Ne}});var pe=0;Object.defineProperty(this,"lastBreak",{get:function(){return pe},set:function(Ne){pe=Ne}});var ge=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ge},set:function(Ne){ge=Ne}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Ne){Ne instanceof u&&(c=Ne)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Ne){c.path=Ne}});var Xe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Xe},set:function(Ne){Xe=Ne}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ne){var oe;oe=g(Ne),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ne){var oe=g(Ne);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ne){["butt","round","square"].indexOf(Ne)!==-1&&(this.ctx.lineCap=Ne,this.pdf.setLineCap(Ne))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ne){isNaN(Ne)||(this.ctx.lineWidth=Ne,this.pdf.setLineWidth(Ne))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ne){["bevel","round","miter"].indexOf(Ne)!==-1&&(this.ctx.lineJoin=Ne,this.pdf.setLineJoin(Ne))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ne){isNaN(Ne)||(this.ctx.miterLimit=Ne,this.pdf.setMiterLimit(Ne))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ne){this.ctx.textBaseline=Ne}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ne){["right","end","center","left","start"].indexOf(Ne)!==-1&&(this.ctx.textAlign=Ne)}});var Je=null,ut=null;Object.defineProperty(this,"fontFaces",{get:function(){return ut},set:function(Ne){Je=null,ut=Ne}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ne){var oe;if(this.ctx.font=Ne,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ne))!==null){var Ft=oe[1];oe[2];var et=oe[3],bt=oe[4];oe[5];var rt=oe[6],yt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(bt)[2];bt=Math.floor(yt==="px"?parseFloat(bt)*this.pdf.internal.scaleFactor:yt==="em"?parseFloat(bt)*this.pdf.getFontSize():parseFloat(bt)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(bt);var mt=(function(Vt){var Pt,Ri,vi=[],Et=Vt.trim();if(Et==="")return ux;if(Et in cS)return[cS[Et]];for(;Et!=="";){switch(Ri=null,Pt=(Et=dS(Et)).charAt(0)){case'"':case"'":Ri=iz(Et.substring(1),Pt);break;default:Ri=nz(Et)}if(Ri===null||(vi.push(Ri[0]),(Et=dS(Ri[1]))!==""&&Et.charAt(0)!==","))return ux;Et=Et.replace(/^,/,"")}return vi})(rt);if(this.fontFaces){var Jt=(function(Vt,Pt){if(Je===null){var Ri=(function(vi){var Et=[];return Object.keys(vi).forEach(function(Yt){vi[Yt].forEach(function(Oi){var Rt=null;switch(Oi){case"bold":Rt={family:Yt,weight:"bold"};break;case"italic":Rt={family:Yt,style:"italic"};break;case"bolditalic":Rt={family:Yt,weight:"bold",style:"italic"};break;case"":case"normal":Rt={family:Yt}}Rt!==null&&(Rt.ref={name:Yt,style:Oi},Et.push(Rt))})}),Et})(Vt.getFontList());Je=(function(vi){for(var Et={},Yt=0;Yt<vi.length;++Yt){var Oi=cx(vi[Yt]),Rt=Oi.family,ci=Oi.stretch,Kt=Oi.style,fn=Oi.weight;Et[Rt]=Et[Rt]||{},Et[Rt][ci]=Et[Rt][ci]||{},Et[Rt][ci][Kt]=Et[Rt][ci][Kt]||{},Et[Rt][ci][Kt][fn]=Oi}return Et})(Ri.concat(Pt))}return Je})(this.pdf,this.fontFaces),Nt=mt.map(function(Vt){return{family:Vt,stretch:"normal",weight:et,style:Ft}}),ri=(function(Vt,Pt,Ri){for(var vi=(Ri=Ri||{}).defaultFontFamily||"times",Et=Object.assign({},tz,Ri.genericFontFamilies||{}),Yt=null,Oi=null,Rt=0;Rt<Pt.length;++Rt)if(Et[(Yt=cx(Pt[Rt])).family]&&(Yt.family=Et[Yt.family]),Vt.hasOwnProperty(Yt.family)){Oi=Vt[Yt.family];break}if(!(Oi=Oi||Vt[vi]))throw new Error("Could not find a font-family for the rule '"+uS(Yt)+"' and default family '"+vi+"'.");if(Oi=(function(ci,Kt){if(Kt[ci])return Kt[ci];var fn=gx[ci],Tn=fn<=gx.normal?-1:1,Bi=lS(Kt,LS,fn,Tn);if(!Bi)throw new Error("Could not find a matching font-stretch value for "+ci);return Bi})(Yt.stretch,Oi),Oi=(function(ci,Kt){if(Kt[ci])return Kt[ci];for(var fn=MS[ci],Tn=0;Tn<fn.length;++Tn)if(Kt[fn[Tn]])return Kt[fn[Tn]];throw new Error("Could not find a matching font-style for "+ci)})(Yt.style,Oi),!(Oi=(function(ci,Kt){if(Kt[ci])return Kt[ci];if(ci===400&&Kt[500])return Kt[500];if(ci===500&&Kt[400])return Kt[400];var fn=ez[ci],Tn=lS(Kt,IS,fn,ci<400?-1:1);if(!Tn)throw new Error("Could not find a matching font-weight for value "+ci);return Tn})(Yt.weight,Oi)))throw new Error("Failed to resolve a font for the rule '"+uS(Yt)+"'.");return Oi})(Jt,Nt);this.pdf.setFont(ri.ref.name,ri.ref.style)}else{var qt="";(et==="bold"||parseInt(et,10)>=700||Ft==="bold")&&(qt="bold"),Ft==="italic"&&(qt+="italic"),qt.length===0&&(qt="normal");for(var Gt="",Ci={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},jt=0;jt<mt.length;jt++){if(this.pdf.internal.getFont(mt[jt],qt,{noFallback:!0,disableWarning:!0})!==void 0){Gt=mt[jt];break}if(qt==="bolditalic"&&this.pdf.internal.getFont(mt[jt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Gt=mt[jt],qt="bold";else if(this.pdf.internal.getFont(mt[jt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Gt=mt[jt],qt="normal";break}}if(Gt===""){for(var Lt=0;Lt<mt.length;Lt++)if(Ci[mt[Lt]]){Gt=Ci[mt[Lt]];break}}Gt=Gt===""?"Times":Gt,this.pdf.setFont(Gt,qt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ne){this.ctx.globalCompositeOperation=Ne}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ne){this.ctx.globalAlpha=Ne}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ne){this.ctx.lineDashOffset=Ne,qe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ne){this.ctx.lineDash=Ne,qe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ne){this.ctx.ignoreClearRect=!!Ne}})};h.prototype.setLineDash=function(k){this.lineDash=k},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){N.call(this,"fill",!1)},h.prototype.stroke=function(){N.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(k,B){if(isNaN(k)||isNaN(B))throw Qi.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var P=this.ctx.transform.applyToPoint(new s(k,B));this.path.push({type:"mt",x:P.x,y:P.y}),this.ctx.lastPoint=new s(k,B)},h.prototype.closePath=function(){var k=new s(0,0),B=0;for(B=this.path.length-1;B!==-1;B--)if(this.path[B].type==="begin"&&Gi(this.path[B+1])==="object"&&typeof this.path[B+1].x=="number"){k=new s(this.path[B+1].x,this.path[B+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(k.x,k.y)},h.prototype.lineTo=function(k,B){if(isNaN(k)||isNaN(B))throw Qi.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var P=this.ctx.transform.applyToPoint(new s(k,B));this.path.push({type:"lt",x:P.x,y:P.y}),this.ctx.lastPoint=new s(P.x,P.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},h.prototype.quadraticCurveTo=function(k,B,P,O){if(isNaN(P)||isNaN(O)||isNaN(k)||isNaN(B))throw Qi.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Q=this.ctx.transform.applyToPoint(new s(P,O)),fe=this.ctx.transform.applyToPoint(new s(k,B));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new s(Q.x,Q.y)},h.prototype.bezierCurveTo=function(k,B,P,O,Q,fe){if(isNaN(Q)||isNaN(fe)||isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O))throw Qi.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ye=this.ctx.transform.applyToPoint(new s(Q,fe)),pe=this.ctx.transform.applyToPoint(new s(k,B)),ge=this.ctx.transform.applyToPoint(new s(P,O));this.path.push({type:"bct",x1:pe.x,y1:pe.y,x2:ge.x,y2:ge.y,x:ye.x,y:ye.y}),this.ctx.lastPoint=new s(ye.x,ye.y)},h.prototype.arc=function(k,B,P,O,Q,fe){if(isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O)||isNaN(Q))throw Qi.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var ye=this.ctx.transform.applyToPoint(new s(k,B));k=ye.x,B=ye.y;var pe=this.ctx.transform.applyToPoint(new s(0,P)),ge=this.ctx.transform.applyToPoint(new s(0,0));P=Math.sqrt(Math.pow(pe.x-ge.x,2)+Math.pow(pe.y-ge.y,2))}Math.abs(Q-O)>=2*Math.PI&&(O=0,Q=2*Math.PI),this.path.push({type:"arc",x:k,y:B,radius:P,startAngle:O,endAngle:Q,counterclockwise:fe})},h.prototype.arcTo=function(k,B,P,O,Q){throw new Error("arcTo not implemented.")},h.prototype.rect=function(k,B,P,O){if(isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O))throw Qi.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(k,B),this.lineTo(k+P,B),this.lineTo(k+P,B+O),this.lineTo(k,B+O),this.lineTo(k,B),this.lineTo(k+P,B),this.lineTo(k,B)},h.prototype.fillRect=function(k,B,P,O){if(isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O))throw Qi.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var Q={};this.lineCap!=="butt"&&(Q.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Q.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(k,B,P,O),this.fill(),Q.hasOwnProperty("lineCap")&&(this.lineCap=Q.lineCap),Q.hasOwnProperty("lineJoin")&&(this.lineJoin=Q.lineJoin)}},h.prototype.strokeRect=function(k,B,P,O){if(isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O))throw Qi.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(k,B,P,O),this.stroke())},h.prototype.clearRect=function(k,B,P,O){if(isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O))throw Qi.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(k,B,P,O))},h.prototype.save=function(k){k=typeof k!="boolean"||k;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("q");if(this.pdf.setPage(B),k){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},h.prototype.restore=function(k){k=typeof k!="boolean"||k;for(var B=this.pdf.internal.getCurrentPageInfo().pageNumber,P=0;P<this.pdf.internal.getNumberOfPages();P++)this.pdf.setPage(P+1),this.pdf.internal.out("Q");this.pdf.setPage(B),k&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var g=function(k){var B,P,O,Q;if(k.isCanvasGradient===!0&&(k=k.getColor()),!k)return{r:0,g:0,b:0,a:0,style:k};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(k))B=0,P=0,O=0,Q=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(k);if(fe!==null)B=parseInt(fe[1]),P=parseInt(fe[2]),O=parseInt(fe[3]),Q=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(k))!==null)B=parseInt(fe[1]),P=parseInt(fe[2]),O=parseInt(fe[3]),Q=parseFloat(fe[4]);else{if(Q=1,typeof k=="string"&&k.charAt(0)!=="#"){var ye=new kS(k);k=ye.ok?ye.toHex():"#000000"}k.length===4?(B=k.substring(1,2),B+=B,P=k.substring(2,3),P+=P,O=k.substring(3,4),O+=O):(B=k.substring(1,3),P=k.substring(3,5),O=k.substring(5,7)),B=parseInt(B,16),P=parseInt(P,16),O=parseInt(O,16)}}return{r:B,g:P,b:O,a:Q,style:k}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(k,B,P,O){if(isNaN(B)||isNaN(P)||typeof k!="string")throw Qi.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!d.call(this)){var Q=Se(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;I.call(this,{text:k,x:B,y:P,scale:fe,angle:Q,align:this.textAlign,maxWidth:O})}},h.prototype.strokeText=function(k,B,P,O){if(isNaN(B)||isNaN(P)||typeof k!="string")throw Qi.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){O=isNaN(O)?void 0:O;var Q=Se(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;I.call(this,{text:k,x:B,y:P,scale:fe,renderingMode:"stroke",angle:Q,align:this.textAlign,maxWidth:O})}},h.prototype.measureText=function(k){if(typeof k!="string")throw Qi.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var B=this.pdf,P=this.pdf.internal.scaleFactor,O=B.internal.getFontSize(),Q=B.getStringUnitWidth(k)*O/B.internal.scaleFactor;return new function(fe){var ye=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ye}}),this}({width:Q*=Math.round(96*P/72*1e4)/1e4})},h.prototype.scale=function(k,B){if(isNaN(k)||isNaN(B))throw Qi.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var P=new l(k,0,0,B,0,0);this.ctx.transform=this.ctx.transform.multiply(P)},h.prototype.rotate=function(k){if(isNaN(k))throw Qi.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var B=new l(Math.cos(k),Math.sin(k),-Math.sin(k),Math.cos(k),0,0);this.ctx.transform=this.ctx.transform.multiply(B)},h.prototype.translate=function(k,B){if(isNaN(k)||isNaN(B))throw Qi.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var P=new l(1,0,0,1,k,B);this.ctx.transform=this.ctx.transform.multiply(P)},h.prototype.transform=function(k,B,P,O,Q,fe){if(isNaN(k)||isNaN(B)||isNaN(P)||isNaN(O)||isNaN(Q)||isNaN(fe))throw Qi.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ye=new l(k,B,P,O,Q,fe);this.ctx.transform=this.ctx.transform.multiply(ye)},h.prototype.setTransform=function(k,B,P,O,Q,fe){k=isNaN(k)?1:k,B=isNaN(B)?0:B,P=isNaN(P)?0:P,O=isNaN(O)?1:O,Q=isNaN(Q)?0:Q,fe=isNaN(fe)?0:fe,this.ctx.transform=new l(k,B,P,O,Q,fe)};var _=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(k,B,P,O,Q,fe,ye,pe,ge){var Xe=this.pdf.getImageProperties(k),Je=1,ut=1,Ne=1,oe=1;O!==void 0&&pe!==void 0&&(Ne=pe/O,oe=ge/Q,Je=Xe.width/O*pe/O,ut=Xe.height/Q*ge/Q),fe===void 0&&(fe=B,ye=P,B=0,P=0),O!==void 0&&pe===void 0&&(pe=O,ge=Q),O===void 0&&pe===void 0&&(pe=Xe.width,ge=Xe.height);for(var Ft,et=this.ctx.transform.decompose(),bt=Se(et.rotate.shx),rt=new l,yt=(rt=(rt=(rt=rt.multiply(et.translate)).multiply(et.skew)).multiply(et.scale)).applyToRectangle(new o(fe-B*Ne,ye-P*oe,O*Je,Q*ut)),mt=w.call(this,yt),Jt=[],Nt=0;Nt<mt.length;Nt+=1)Jt.indexOf(mt[Nt])===-1&&Jt.push(mt[Nt]);if(D(Jt),this.autoPaging)for(var ri=Jt[0],qt=Jt[Jt.length-1],Gt=ri;Gt<qt+1;Gt++){this.pdf.setPage(Gt);var Ci=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],jt=Gt===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Vt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pt=Gt===1?0:Lt+(Gt-2)*Vt;if(this.ctx.clip_path.length!==0){var Ri=this.path;Ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(Ft,this.posX+this.margin[3],-Pt+jt+this.ctx.prevPageLastElemOffset),z.call(this,"fill",!0),this.path=Ri}var vi=JSON.parse(JSON.stringify(yt));vi=A([vi],this.posX+this.margin[3],-Pt+jt+this.ctx.prevPageLastElemOffset)[0];var Et=(Gt>ri||Gt<qt)&&_.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ci,Vt,null).clip().discardPath()),this.pdf.addImage(k,"JPEG",vi.x,vi.y,vi.w,vi.h,null,null,bt),Et&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(k,"JPEG",yt.x,yt.y,yt.w,yt.h,null,null,bt)};var w=function(k,B,P){var O=[];B=B||this.pdf.internal.pageSize.width,P=P||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Q=this.posY+this.ctx.prevPageLastElemOffset;switch(k.type){default:case"mt":case"lt":O.push(Math.floor((k.y+Q)/P)+1);break;case"arc":O.push(Math.floor((k.y+Q-k.radius)/P)+1),O.push(Math.floor((k.y+Q+k.radius)/P)+1);break;case"qct":var fe=Oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x,k.y);O.push(Math.floor((fe.y+Q)/P)+1),O.push(Math.floor((fe.y+fe.h+Q)/P)+1);break;case"bct":var ye=Ze(this.ctx.lastPoint.x,this.ctx.lastPoint.y,k.x1,k.y1,k.x2,k.y2,k.x,k.y);O.push(Math.floor((ye.y+Q)/P)+1),O.push(Math.floor((ye.y+ye.h+Q)/P)+1);break;case"rect":O.push(Math.floor((k.y+Q)/P)+1),O.push(Math.floor((k.y+k.h+Q)/P)+1)}for(var pe=0;pe<O.length;pe+=1)for(;this.pdf.internal.getNumberOfPages()<O[pe];)E.call(this);return O},E=function(){var k=this.fillStyle,B=this.strokeStyle,P=this.font,O=this.lineCap,Q=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=k,this.strokeStyle=B,this.font=P,this.lineCap=O,this.lineWidth=Q,this.lineJoin=fe},A=function(k,B,P){for(var O=0;O<k.length;O++)switch(k[O].type){case"bct":k[O].x2+=B,k[O].y2+=P;case"qct":k[O].x1+=B,k[O].y1+=P;default:k[O].x+=B,k[O].y+=P}return k},D=function(k){return k.sort(function(B,P){return B-P})},N=function(k,B){for(var P,O,Q=this.fillStyle,fe=this.strokeStyle,ye=this.lineCap,pe=this.lineWidth,ge=Math.abs(pe*this.ctx.transform.scaleX),Xe=this.lineJoin,Je=JSON.parse(JSON.stringify(this.path)),ut=JSON.parse(JSON.stringify(this.path)),Ne=[],oe=0;oe<ut.length;oe++)if(ut[oe].x!==void 0)for(var Ft=w.call(this,ut[oe]),et=0;et<Ft.length;et+=1)Ne.indexOf(Ft[et])===-1&&Ne.push(Ft[et]);for(var bt=0;bt<Ne.length;bt++)for(;this.pdf.internal.getNumberOfPages()<Ne[bt];)E.call(this);if(D(Ne),this.autoPaging)for(var rt=Ne[0],yt=Ne[Ne.length-1],mt=rt;mt<yt+1;mt++){this.pdf.setPage(mt),this.fillStyle=Q,this.strokeStyle=fe,this.lineCap=ye,this.lineWidth=ge,this.lineJoin=Xe;var Jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Nt=mt===1?this.posY+this.margin[0]:this.margin[0],ri=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Gt=mt===1?0:ri+(mt-2)*qt;if(this.ctx.clip_path.length!==0){var Ci=this.path;P=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(P,this.posX+this.margin[3],-Gt+Nt+this.ctx.prevPageLastElemOffset),z.call(this,k,!0),this.path=Ci}if(O=JSON.parse(JSON.stringify(Je)),this.path=A(O,this.posX+this.margin[3],-Gt+Nt+this.ctx.prevPageLastElemOffset),B===!1||mt===0){var jt=(mt>rt||mt<yt)&&_.call(this);jt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Jt,qt,null).clip().discardPath()),z.call(this,k,B),jt&&this.pdf.restoreGraphicsState()}this.lineWidth=pe}else this.lineWidth=ge,z.call(this,k,B),this.lineWidth=pe;this.path=Je},z=function(k,B){if((k!=="stroke"||B||!b.call(this))&&(k==="stroke"||B||!d.call(this))){for(var P,O,Q=[],fe=this.path,ye=0;ye<fe.length;ye++){var pe=fe[ye];switch(pe.type){case"begin":Q.push({begin:!0});break;case"close":Q.push({close:!0});break;case"mt":Q.push({start:pe,deltas:[],abs:[]});break;case"lt":var ge=Q.length;if(fe[ye-1]&&!isNaN(fe[ye-1].x)&&(P=[pe.x-fe[ye-1].x,pe.y-fe[ye-1].y],ge>0)){for(;ge>=0;ge--)if(Q[ge-1].close!==!0&&Q[ge-1].begin!==!0){Q[ge-1].deltas.push(P),Q[ge-1].abs.push(pe);break}}break;case"bct":P=[pe.x1-fe[ye-1].x,pe.y1-fe[ye-1].y,pe.x2-fe[ye-1].x,pe.y2-fe[ye-1].y,pe.x-fe[ye-1].x,pe.y-fe[ye-1].y],Q[Q.length-1].deltas.push(P);break;case"qct":var Xe=fe[ye-1].x+2/3*(pe.x1-fe[ye-1].x),Je=fe[ye-1].y+2/3*(pe.y1-fe[ye-1].y),ut=pe.x+2/3*(pe.x1-pe.x),Ne=pe.y+2/3*(pe.y1-pe.y),oe=pe.x,Ft=pe.y;P=[Xe-fe[ye-1].x,Je-fe[ye-1].y,ut-fe[ye-1].x,Ne-fe[ye-1].y,oe-fe[ye-1].x,Ft-fe[ye-1].y],Q[Q.length-1].deltas.push(P);break;case"arc":Q.push({deltas:[],abs:[],arc:!0}),Array.isArray(Q[Q.length-1].abs)&&Q[Q.length-1].abs.push(pe)}}O=B?null:k==="stroke"?"stroke":"fill";for(var et=!1,bt=0;bt<Q.length;bt++)if(Q[bt].arc)for(var rt=Q[bt].abs,yt=0;yt<rt.length;yt++){var mt=rt[yt];mt.type==="arc"?U.call(this,mt.x,mt.y,mt.radius,mt.startAngle,mt.endAngle,mt.counterclockwise,void 0,B,!et):ee.call(this,mt.x,mt.y),et=!0}else if(Q[bt].close===!0)this.pdf.internal.out("h"),et=!1;else if(Q[bt].begin!==!0){var Jt=Q[bt].start.x,Nt=Q[bt].start.y;le.call(this,Q[bt].deltas,Jt,Nt),et=!0}O&&M.call(this,O),B&&X.call(this)}},J=function(k){var B=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,P=B*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return k-P;case"top":return k+B-P;case"hanging":return k+B-2*P;case"middle":return k+B/2-P;default:return k}},W=function(k){return k+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var k=function(){};return k.colorStops=[],k.addColorStop=function(B,P){this.colorStops.push([B,P])},k.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},k.isCanvasGradient=!0,k},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var U=function(k,B,P,O,Q,fe,ye,pe,ge){for(var Xe=ke.call(this,P,O,Q,fe),Je=0;Je<Xe.length;Je++){var ut=Xe[Je];Je===0&&(ge?F.call(this,ut.x1+k,ut.y1+B):ee.call(this,ut.x1+k,ut.y1+B)),de.call(this,k,B,ut.x2,ut.y2,ut.x3,ut.y3,ut.x4,ut.y4)}pe?X.call(this):M.call(this,ye)},M=function(k){switch(k){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},X=function(){this.pdf.clip(),this.pdf.discardPath()},F=function(k,B){this.pdf.internal.out(e(k)+" "+n(B)+" m")},I=function(k){var B;switch(k.align){case"right":case"end":B="right";break;case"center":B="center";break;default:B="left"}var P=this.pdf.getTextDimensions(k.text),O=J.call(this,k.y),Q=W.call(this,O)-P.h,fe=this.ctx.transform.applyToPoint(new s(k.x,O)),ye=this.ctx.transform.decompose(),pe=new l;pe=(pe=(pe=pe.multiply(ye.translate)).multiply(ye.skew)).multiply(ye.scale);for(var ge,Xe,Je,ut=this.ctx.transform.applyToRectangle(new o(k.x,O,P.w,P.h)),Ne=pe.applyToRectangle(new o(k.x,Q,P.w,P.h)),oe=w.call(this,Ne),Ft=[],et=0;et<oe.length;et+=1)Ft.indexOf(oe[et])===-1&&Ft.push(oe[et]);if(D(Ft),this.autoPaging)for(var bt=Ft[0],rt=Ft[Ft.length-1],yt=bt;yt<rt+1;yt++){this.pdf.setPage(yt);var mt=yt===1?this.posY+this.margin[0]:this.margin[0],Jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Nt=this.pdf.internal.pageSize.height-this.margin[2],ri=Nt-this.margin[0],qt=this.pdf.internal.pageSize.width-this.margin[1],Gt=qt-this.margin[3],Ci=yt===1?0:Jt+(yt-2)*ri;if(this.ctx.clip_path.length!==0){var jt=this.path;ge=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=A(ge,this.posX+this.margin[3],-1*Ci+mt),z.call(this,"fill",!0),this.path=jt}var Lt=A([JSON.parse(JSON.stringify(Ne))],this.posX+this.margin[3],-Ci+mt+this.ctx.prevPageLastElemOffset)[0];k.scale>=.01&&(Xe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Xe*k.scale),Je=this.lineWidth,this.lineWidth=Je*k.scale);var Vt=this.autoPaging!=="text";if(Vt||Lt.y+Lt.h<=Nt){if(Vt||Lt.y>=mt&&Lt.x<=qt){var Pt=Vt?k.text:this.pdf.splitTextToSize(k.text,k.maxWidth||qt-Lt.x)[0],Ri=A([JSON.parse(JSON.stringify(ut))],this.posX+this.margin[3],-Ci+mt+this.ctx.prevPageLastElemOffset)[0],vi=Vt&&(yt>bt||yt<rt)&&_.call(this);vi&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Gt,ri,null).clip().discardPath()),this.pdf.text(Pt,Ri.x,Ri.y,{angle:k.angle,align:B,renderingMode:k.renderingMode}),vi&&this.pdf.restoreGraphicsState()}}else Lt.y<Nt&&(this.ctx.prevPageLastElemOffset+=Nt-Lt.y);k.scale>=.01&&(this.pdf.setFontSize(Xe),this.lineWidth=Je)}else k.scale>=.01&&(Xe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Xe*k.scale),Je=this.lineWidth,this.lineWidth=Je*k.scale),this.pdf.text(k.text,fe.x+this.posX,fe.y+this.posY,{angle:k.angle,align:B,renderingMode:k.renderingMode,maxWidth:k.maxWidth}),k.scale>=.01&&(this.pdf.setFontSize(Xe),this.lineWidth=Je)},ee=function(k,B,P,O){P=P||0,O=O||0,this.pdf.internal.out(e(k+P)+" "+n(B+O)+" l")},le=function(k,B,P){return this.pdf.lines(k,B,P,null,null)},de=function(k,B,P,O,Q,fe,ye,pe){this.pdf.internal.out([t(r(P+k)),t(a(O+B)),t(r(Q+k)),t(a(fe+B)),t(r(ye+k)),t(a(pe+B)),"c"].join(" "))},ke=function(k,B,P,O){for(var Q=2*Math.PI,fe=Math.PI/2;B>P;)B-=Q;var ye=Math.abs(P-B);ye<Q&&O&&(ye=Q-ye);for(var pe=[],ge=O?-1:1,Xe=B;ye>1e-5;){var Je=Xe+ge*Math.min(ye,fe);pe.push(Fe.call(this,k,Xe,Je)),ye-=Math.abs(Je-Xe),Xe=Je}return pe},Fe=function(k,B,P){var O=(P-B)/2,Q=k*Math.cos(O),fe=k*Math.sin(O),ye=Q,pe=-fe,ge=ye*ye+pe*pe,Xe=ge+ye*Q+pe*fe,Je=4/3*(Math.sqrt(2*ge*Xe)-Xe)/(ye*fe-pe*Q),ut=ye-Je*pe,Ne=pe+Je*ye,oe=ut,Ft=-Ne,et=O+B,bt=Math.cos(et),rt=Math.sin(et);return{x1:k*Math.cos(B),y1:k*Math.sin(B),x2:ut*bt-Ne*rt,y2:ut*rt+Ne*bt,x3:oe*bt-Ft*rt,y3:oe*rt+Ft*bt,x4:k*Math.cos(P),y4:k*Math.sin(P)}},Se=function(k){return 180*k/Math.PI},Oe=function(k,B,P,O,Q,fe){var ye=k+.5*(P-k),pe=B+.5*(O-B),ge=Q+.5*(P-Q),Xe=fe+.5*(O-fe),Je=Math.min(k,Q,ye,ge),ut=Math.max(k,Q,ye,ge),Ne=Math.min(B,fe,pe,Xe),oe=Math.max(B,fe,pe,Xe);return new o(Je,Ne,ut-Je,oe-Ne)},Ze=function(k,B,P,O,Q,fe,ye,pe){var ge,Xe,Je,ut,Ne,oe,Ft,et,bt,rt,yt,mt,Jt,Nt,ri=P-k,qt=O-B,Gt=Q-P,Ci=fe-O,jt=ye-Q,Lt=pe-fe;for(Xe=0;Xe<41;Xe++)bt=(Ft=(Je=k+(ge=Xe/40)*ri)+ge*((Ne=P+ge*Gt)-Je))+ge*(Ne+ge*(Q+ge*jt-Ne)-Ft),rt=(et=(ut=B+ge*qt)+ge*((oe=O+ge*Ci)-ut))+ge*(oe+ge*(fe+ge*Lt-oe)-et),Xe==0?(yt=bt,mt=rt,Jt=bt,Nt=rt):(yt=Math.min(yt,bt),mt=Math.min(mt,rt),Jt=Math.max(Jt,bt),Nt=Math.max(Nt,rt));return new o(Math.round(yt),Math.round(mt),Math.round(Jt-yt),Math.round(Nt-mt))},qe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var k,B,P=(k=this.ctx.lineDash,B=this.ctx.lineDashOffset,JSON.stringify({lineDash:k,lineDashOffset:B}));this.prevLineDash!==P&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=P)}}})(_t.API),(function(i){var t=function(s){var o,l,c,u,h,g,d,b,_,w;for(/[^\x00-\xFF]/.test(s),l=[],c=0,u=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;u>c;c+=4)(h=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(g=(h=((h=((h=((h=(h-(w=h%85))/85)-(_=h%85))/85)-(b=h%85))/85)-(d=h%85))/85)%85,l.push(g+33,d+33,b+33,_+33,w+33)):l.push(122);return(function(E,A){for(var D=A;D>0;D--)E.pop()})(l,o.length),String.fromCharCode.apply(String,l)+"~>"},e=function(s){var o,l,c,u,h,g=String,d="length",b=255,_="charCodeAt",w="slice",E="replace";for(s[w](-2),s=s[w](0,-2)[E](/\s/g,"")[E]("z","!!!!!"),c=[],u=0,h=(s+=o="uuuuu"[w](s[d]%5||5))[d];h>u;u+=5)l=52200625*(s[_](u)-33)+614125*(s[_](u+1)-33)+7225*(s[_](u+2)-33)+85*(s[_](u+3)-33)+(s[_](u+4)-33),c.push(b&l>>24,b&l>>16,b&l>>8,b&l);return(function(A,D){for(var N=D;N>0;N--)A.pop()})(c,o[d]),g.fromCharCode.apply(g,c)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},r=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var l="",c=0;c<s.length;c+=2)l+=String.fromCharCode("0x"+(s[c]+s[c+1]));return l},a=function(s){for(var o=new Uint8Array(s.length),l=s.length;l--;)o[l]=s.charCodeAt(l);return(o=P1(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};i.processDataByFilters=function(s,o){var l=0,c=s||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=e(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=r(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}})(_t.API),(function(i){i.loadFile=function(t,e,n){return(function(r,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=(function(l,c,u){var h=new XMLHttpRequest,g=0,d=function(b){var _=b.length,w=[],E=String.fromCharCode;for(g=0;g<_;g+=1)w.push(E(255&b.charCodeAt(g)));return w.join("")};if(h.open("GET",l,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?u(d(this.responseText)):u(void 0)}),h.send(null),c&&h.status===200)return d(h.responseText)})(r,a,s)}catch{}return o})(t,e,n)},i.loadImageFile=i.loadFile})(_t.API),(function(i){function t(){return(Xt.html2canvas?Promise.resolve(Xt.html2canvas):import("./chunk-5HO6KX74.js")).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function e(){return(Xt.DOMPurify?Promise.resolve(Xt.DOMPurify):import("./chunk-2QAN353G.js")).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=Gi(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},r=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},a=function o(l,c){for(var u=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),h=l.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(o(h,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(u.width=l.width,u.height=l.height,u.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(u.value=l.value),u.addEventListener("load",function(){u.scrollTop=l.scrollTop,u.scrollLeft=l.scrollLeft},!0)),u},s=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return(u=u.setProgress(1,o,1,[o])).set(l)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,l){return o.__proto__=l||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,l){return this.then(function(){switch(l=l||(function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(o),l){case"string":return this.then(e).then(function(c){return this.set({src:r("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=r("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=r("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(r("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var d=0;d<u.length;++d){var b=u[d],_=b.src.find(function(w){return w.format==="truetype"});_&&c.addFont(_.url,b.ref.name,b.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,c.context2d.save(!0),l(this.prop.container,g)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},s.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},s.prototype.get=function(o,l){return this.then(function(){var c=o in s.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||_t.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(g){return c.updateProgress(null,u),g}).then(u,h).then(function(g){return c.updateProgress(1),g})})},s.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),l&&(l=l.bind(u));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:s.convert(Object.assign({},u),Promise.prototype),g=c.call(h,o,l);return s.convert(g,u.__proto__)},s.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},s.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},s.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return s.convert(l,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,_t.getPageSize=function(o,l,c){if(Gi(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var h,g=(""+c).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var b,_=0,w=0;if(d.hasOwnProperty(g))_=d[g][1]/h,w=d[g][0]/h;else try{_=c[1],w=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",w>_&&(b=w,w=_,_=b);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",_>w&&(b=w,w=_,_=b)}return{width:w,height:_,unit:l,k:h,orientation:o}},i.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(cx):null;var c=new s(l);return l.worker?c:c.from(o).doCallback()}})(_t.API),_t.API.addJS=function(i){return hS=i,this.internal.events.subscribe("postPutResources",function(){ip=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ip+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),fS=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+hS+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ip!==void 0&&fS!==void 0&&this.internal.out("/Names <</JavaScript "+ip+" 0 R>>")}),this},(function(i){var t;i.events.push(["postPutResources",function(){var e=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var r=e.outline.render().split(/\r\n/),a=0;a<r.length;a++){var s=r[a],o=n.exec(s);if(o!=null){var l=o[1];e.internal.newObjectDeferredBegin(l,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(a=0;a<c;a++){var h=e.internal.newObject();u.push(h);var g=e.internal.getPageInfo(a+1);e.internal.write("<< /D["+g.objId+" 0 R /XYZ null null null]>> endobj")}var d=e.internal.newObject();for(e.internal.write("<< /Names [ "),a=0;a<u.length;a++)e.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+d+" 0 R"),e.internal.write(">>","endobj")}}]),i.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),i.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(n,r,a){var s={title:r,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(n){n.id=e.internal.newObjectDeferred();for(var r=0;r<n.children.length;r++)this.genIds_r(n.children[r])},e.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},e.outline.renderItems=function(n){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=e.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},e.outline.line=function(n){this.ctx.val+=n+`\r
`},e.outline.makeRef=function(n){return n.id+" 0 R"},e.outline.makeString=function(n){return"("+e.internal.pdfEscape(n)+")"},e.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},e.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},e.outline.count_r=function(n,r){for(var a=0;a<r.children.length;a++)n.count++,this.count_r(n,r.children[a]);return n.count}}])})(_t.API),(function(i){var t=[192,193,194,195,196,197,198,199];i.processJPEG=function(e,n,r,a,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof e=="string"||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,l=(function(h){for(var g,d=256*h.charCodeAt(4)+h.charCodeAt(5),b=h.length,_={width:0,height:0,numcomponents:1},w=4;w<b;w+=2){if(w+=d,t.indexOf(h.charCodeAt(w+1))!==-1){g=256*h.charCodeAt(w+5)+h.charCodeAt(w+6),_={width:256*h.charCodeAt(w+7)+h.charCodeAt(w+8),height:g,numcomponents:h.charCodeAt(w+9)};break}d=256*h.charCodeAt(w+2)+h.charCodeAt(w+3)}return _})(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:e,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:r}}return u}})(_t.API),_t.API.processPNG=function(i,t,e,n){if(this.__addimage__.isArrayBuffer(i)&&(i=new Uint8Array(i)),this.__addimage__.isArrayBufferView(i)){var r,a=tS(i,{checkCrc:!0}),s=a.width,o=a.height,l=a.channels,c=a.palette,u=a.depth;r=c&&l===1?(function(U){for(var M=U.width,X=U.height,F=U.data,I=U.palette,ee=U.depth,le=!1,de=[],ke=[],Fe=void 0,Se=!1,Oe=0,Ze=0;Ze<I.length;Ze++){var qe=w2(I[Ze],4),k=qe[0],B=qe[1],P=qe[2],O=qe[3];de.push(k,B,P),O!=null&&(O===0?(Oe++,ke.length<1&&ke.push(Ze)):O<255&&(Se=!0))}if(Se||Oe>1){le=!0,ke=void 0;var Q=M*X;Fe=new Uint8Array(Q);for(var fe=new DataView(F.buffer),ye=0;ye<Q;ye++){var pe=dx(fe,ye,ee),ge=w2(I[pe],4)[3];Fe[ye]=ge}}else Oe===0&&(ke=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:le?8:void 0,colorBytes:F,alphaBytes:Fe,needSMask:le,palette:de,mask:ke}})(a):l===2||l===4?(function(U){for(var M=U.data,X=U.width,F=U.height,I=U.channels,ee=U.depth,le=I===2?"DeviceGray":"DeviceRGB",de=I-1,ke=X*F,Fe=de,Se=ke*Fe,Oe=1*ke,Ze=Math.ceil(Se*ee/8),qe=Math.ceil(Oe*ee/8),k=new Uint8Array(Ze),B=new Uint8Array(qe),P=new DataView(M.buffer),O=new DataView(k.buffer),Q=new DataView(B.buffer),fe=!1,ye=0;ye<ke;ye++){for(var pe=ye*I,ge=0;ge<Fe;ge++)yS(O,dx(P,pe+ge,ee),ye*Fe+ge,ee);var Xe=dx(P,pe+Fe,ee);Xe<(1<<ee)-1&&(fe=!0),yS(Q,Xe,1*ye,ee)}return{colorSpace:le,colorsPerPixel:de,sMaskBitsPerComponent:fe?ee:void 0,colorBytes:k,alphaBytes:B,needSMask:fe}})(a):(function(U){var M=U.data,X=U.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:X,colorsPerPixel:X==="DeviceGray"?1:3,colorBytes:M instanceof Uint16Array?(function(F){for(var I=F.length,ee=new Uint8Array(2*I),le=new DataView(ee.buffer,ee.byteOffset,ee.byteLength),de=0;de<I;de++)le.setUint16(2*de,F[de],!1);return ee})(M):M,needSMask:!1}})(a);var h,g,d,b=r,_=b.colorSpace,w=b.colorsPerPixel,E=b.sMaskBitsPerComponent,A=b.colorBytes,D=b.alphaBytes,N=b.needSMask,z=b.palette,J=b.mask,W=null;return n!==_t.API.image_compression.NONE&&typeof P1=="function"?(W=(function(U){var M;switch(U){case _t.API.image_compression.FAST:M=11;break;case _t.API.image_compression.MEDIUM:M=13;break;case _t.API.image_compression.SLOW:M=14;break;default:M=12}return M})(n),h=this.decode.FLATE_DECODE,g="/Predictor ".concat(W," /Colors ").concat(w," /BitsPerComponent ").concat(u," /Columns ").concat(s),i=xS(A,Math.ceil(s*w*u/8),w,u,n),N&&(d=xS(D,Math.ceil(s*E/8),1,E,n))):(h=void 0,g=void 0,i=A,N&&(d=D)),(this.__addimage__.isArrayBuffer(i)||this.__addimage__.isArrayBufferView(i))&&(i=this.__addimage__.arrayBufferToBinaryString(i)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:e,data:i,index:t,filter:h,decodeParameters:g,transparency:J,palette:z,sMask:d,predictor:W,width:s,height:o,bitsPerComponent:u,sMaskBitsPerComponent:E,colorSpace:_}}},(function(i){i.processGIF89A=function(t,e,n,r){var a=new oz(t),s=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new fx(100).encode(c,100);return i.processJPEG.call(this,u,e,n,r)},i.processGIF87A=i.processGIF89A})(_t.API),bs.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var i=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(i);for(var t=0;t<i;t++){var e=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:r,green:n,blue:e,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},bs.prototype.parseBGR=function(){this.pos=this.offset;try{var i="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[i]()}catch(e){Qi.log("bit decode error:"+e)}},bs.prototype.bit1=function(){var i,t=Math.ceil(this.width/8),e=t%4;for(i=this.height-1;i>=0;i--){for(var n=this.bottom_up?i:this.height-1-i,r=0;r<t;r++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*r*4,o=0;o<8&&8*r+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}e!==0&&(this.pos+=4-e)}},bs.prototype.bit4=function(){for(var i=Math.ceil(this.width/2),t=i%4,e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<i;r++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*r*4,o=a>>4,l=15&a,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*r+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},bs.prototype.bit8=function(){for(var i=this.width%4,t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*n;if(r<this.palette.length){var s=this.palette[r];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}i!==0&&(this.pos+=4-i)}},bs.prototype.bit15=function(){for(var i=this.width%3,t=parseInt("11111",2),e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,l=(a>>10&t)/t*255|0,c=a>>15?255:0,u=n*this.width*4+4*r;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=i}},bs.prototype.bit16=function(){for(var i=this.width%3,t=parseInt("11111",2),e=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&e)/e*255|0,c=(s>>11)/t*255|0,u=r*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=i}},bs.prototype.bit24=function(){for(var i=this.height-1;i>=0;i--){for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*e;this.data[s]=a,this.data[s+1]=r,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},bs.prototype.bit32=function(){for(var i=this.height-1;i>=0;i--)for(var t=this.bottom_up?i:this.height-1-i,e=0;e<this.width;e++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*e;this.data[o]=a,this.data[o+1]=r,this.data[o+2]=n,this.data[o+3]=s}},bs.prototype.getData=function(){return this.data},(function(i){i.processBMP=function(t,e,n,r){var a=new bs(t,!1),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},c=new fx(100).encode(l,100);return i.processJPEG.call(this,c,e,n,r)}})(_t.API),CS.prototype.getData=function(){return this.data},(function(i){i.processWEBP=function(t,e,n,r){var a=new CS(t),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},c=new fx(100).encode(l,100);return i.processJPEG.call(this,c,e,n,r)}})(_t.API),_t.API.processRGBA=function(i,t,e){for(var n=i.data,r=n.length,a=new Uint8Array(r/4*3),s=new Uint8Array(r/4),o=0,l=0,c=0;c<r;c+=4){var u=n[c],h=n[c+1],g=n[c+2],d=n[c+3];a[o++]=u,a[o++]=h,a[o++]=g,s[l++]=d}var b=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:b,index:t,alias:e,colorSpace:"DeviceRGB",bitsPerComponent:8,width:i.width,height:i.height}},_t.API.setLanguage=function(i){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[i]!==void 0&&(this.internal.languageSettings.languageCode=i,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ic=_t.API,np=Ic.getCharWidthsArray=function(i,t){var e,n,r=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:r.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:r.metadata.Unicode.kerning,u=c.fof?c.fof:1,h=t.doKerning!==!1,g=0,d=i.length,b=0,_=o[0]||l,w=[];for(e=0;e<d;e++)n=i.charCodeAt(e),typeof r.metadata.widthOfString=="function"?w.push((r.metadata.widthOfGlyph(r.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(g=h&&Gi(c[n])==="object"&&!isNaN(parseInt(c[n][b],10))?c[n][b]/u:0,w.push((o[n]||_)/l+g)),b=n;return w},pS=Ic.getStringUnitWidth=function(i,t){var e=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),r=t.charSpace||this.internal.getCharSpace();return Ic.processArabic&&(i=Ic.processArabic(i)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(i,e,r)/e:np.apply(this,arguments).reduce(function(a,s){return a+s},0)},mS=function(i,t,e,n){for(var r=[],a=0,s=i.length,o=0;a!==s&&o+t[a]<e;)o+=t[a],a++;r.push(i.slice(0,a));var l=a;for(o=0;a!==s;)o+t[a]>n&&(r.push(i.slice(l,a)),o=0,l=a),o+=t[a],a++;return l!==a&&r.push(i.slice(l,a)),r},gS=function(i,t,e){e||(e={});var n,r,a,s,o,l,c,u=[],h=[u],g=e.textIndent||0,d=0,b=0,_=i.split(" "),w=np.apply(this,[" ",e])[0];if(l=e.lineIndent===-1?_[0].length+2:e.lineIndent||0){var E=Array(l).join(" "),A=[];_.map(function(N){(N=N.split(/\s*\n/)).length>1?A=A.concat(N.map(function(z,J){return(J&&z.length?`
`:"")+z})):A.push(N[0])}),_=A,l=pS.apply(this,[E,e])}for(a=0,s=_.length;a<s;a++){var D=0;if(n=_[a],l&&n[0]==`
`&&(n=n.substr(1),D=1),g+d+(b=(r=np.apply(this,[n,e])).reduce(function(N,z){return N+z},0))>t||D){if(b>t){for(o=mS.apply(this,[n,r,t-(g+d),t]),u.push(o.shift()),u=[o.pop()];o.length;)h.push([o.shift()]);b=r.slice(n.length-(u[0]?u[0].length:0)).reduce(function(N,z){return N+z},0)}else u=[n];h.push(u),g=b+l,d=w}else u.push(n),g+=d+b,d=w}return c=l?function(N,z){return(z?E:"")+N.join(" ")}:function(N){return N.join(" ")},h.map(c)},Ic.splitTextToSize=function(i,t,e){var n,r=(e=e||{}).fontSize||this.internal.getFontSize(),a=function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle),g="Unicode";return h.metadata[g]?{widths:h.metadata[g].widths||{0:1},kerning:h.metadata[g].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,e);n=Array.isArray(i)?i:String(i).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/r;a.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/r:0,a.lineIndent=e.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(gS.apply(this,[n[o],s,a]));return c},(function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var t="0123456789abcdef",e="klmnopqrstuvwxyz",n={},r={},a=0;a<16;a++)n[e[a]]=t[a],r[t[a]]=e[a];var s=function(g){return"0x"+parseInt(g,10).toString(16)},o=i.__fontmetrics__.compress=function(g){var d,b,_,w,E=["{"];for(var A in g){if(d=g[A],isNaN(parseInt(A,10))?b="'"+A+"'":(A=parseInt(A,10),b=(b=s(A).slice(2)).slice(0,-1)+r[b.slice(-1)]),typeof d=="number")d<0?(_=s(d).slice(3),w="-"):(_=s(d).slice(2),w=""),_=w+_.slice(0,-1)+r[_.slice(-1)];else{if(Gi(d)!=="object")throw new Error("Don't know what to do with value type "+Gi(d)+".");_=o(d)}E.push(b+_)}return E.push("}"),E.join("")},l=i.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,b,_,w,E={},A=1,D=E,N=[],z="",J="",W=g.length-1,U=1;U<W;U+=1)(w=g[U])=="'"?d?(_=d.join(""),d=void 0):d=[]:d?d.push(w):w=="{"?(N.push([D,_]),D={},_=void 0):w=="}"?((b=N.pop())[0][b[1]]=D,_=void 0,D=b[0]):w=="-"?A=-1:_===void 0?n.hasOwnProperty(w)?(z+=n[w],_=parseInt(z,16)*A,A=1,z=""):z+=w:n.hasOwnProperty(w)?(J+=n[w],D[_]=parseInt(J,16)*A,A=1,_=void 0,J=""):J+=w;return E},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(g){var d=g.font,b=h.Unicode[d.postScriptName];b&&(d.metadata.Unicode={},d.metadata.Unicode.widths=b.widths,d.metadata.Unicode.kerning=b.kerning);var _=u.Unicode[d.postScriptName];_&&(d.metadata.Unicode.encoding=_,d.encoding=_.codePages[0])}])})(_t.API),(function(i){var t=function(e){for(var n=e.length,r=new Uint8Array(n),a=0;a<n;a++)r[a]=e.charCodeAt(a);return r};i.API.events.push(["addFont",function(e){var n=void 0,r=e.font,a=e.instance;if(!r.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");if(typeof(n=a.existsFileInVFS(r.postScriptName)===!1?a.loadFile(r.postScriptName):a.getFileFromVFS(r.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+r.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(rp(o)),s.metadata=i.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(r,n)}}])})(_t),_t.API.addSvgAsImage=function(i,t,e,n,r,a,s,o){if(isNaN(t)||isNaN(e))throw Qi.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(r))throw Qi.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=r;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Xt.canvg?Promise.resolve(Xt.canvg):import("./chunk-2O2WWNZS.js")).catch(function(g){return Promise.reject(new Error("Could not load canvg: "+g))}).then(function(g){return g.default?g.default:g}).then(function(g){return g.fromString(c,i,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(u)}).then(function(){h.addImage(l.toDataURL("image/jpeg",1),t,e,n,r,s,o)})},_t.API.putTotalPages=function(i){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(i,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var r=0;r<this.internal.pages[n].length;r++)this.internal.pages[n][r]=this.internal.pages[n][r].replace(t,e);return this},_t.API.viewerPreferences=function(i,t){var e;i=i||{},t=t||!1;var n,r,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,h=0;function g(b,_){var w,E=!1;for(w=0;w<b.length;w+=1)b[w]===_&&(E=!0);return E}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,i==="reset"||t===!0){var d=o.length;for(h=0;h<d;h+=1)e[o[h]].value=e[o[h]].defaultValue,e[o[h]].explicitSet=!1}if(Gi(i)==="object"){for(r in i)if(a=i[r],g(o,r)&&a!==void 0){if(e[r].type==="boolean"&&typeof a=="boolean")e[r].value=a;else if(e[r].type==="name"&&g(e[r].valueSet,a))e[r].value=a;else if(e[r].type==="integer"&&Number.isInteger(a))e[r].value=a;else if(e[r].type==="array"){for(c=0;c<a.length;c+=1)if(n=!0,a[c].length===1&&typeof a[c][0]=="number")l.push(String(a[c]-1));else if(a[c].length>1){for(u=0;u<a[c].length;u+=1)typeof a[c][u]!="number"&&(n=!1);n===!0&&l.push([a[c][0]-1,a[c][1]-1].join(" "))}e[r].value="["+l.join(" ")+"]"}else e[r].value=e[r].defaultValue;e[r].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,_=[];for(b in e)e[b].explicitSet===!0&&(e[b].type==="name"?_.push("/"+b+" /"+e[b].value):_.push("/"+b+" "+e[b].value));_.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+_.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=e,this},(function(i){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',r=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=a.length+s.length+o.length+r.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(r+a+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},e=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};i.addMetadata=function(n,r){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:r||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",e),this.internal.events.subscribe("postPutResources",t)),this}})(_t.API),(function(i){var t=i.API,e=t.pdfEscape16=function(a,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],h=0,g=a.length;h<g;++h){if(o=s.metadata.characterToGlyph(a.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(a){var s,o,l,c,u,h,g;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,g=(o=Object.keys(a).sort(function(d,b){return d-b})).length;h<g;h++)s=o[h],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(c=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof i.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,g=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",b=0;b<g.length;b++)d+=String.fromCharCode(g[b]);var _=c();u({data:d,addLength1:!0,objectId:_}),l("endobj");var w=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var E=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Oc(o.fontName)),l("/FontFile2 "+_+" 0 R"),l("/FontBBox "+i.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var A=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Oc(o.fontName)),l("/FontDescriptor "+E+" 0 R"),l("/W "+i.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+w+" 0 R"),l("/BaseFont /"+Oc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+A+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof i.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,g="",d=0;d<h.length;d++)g+=String.fromCharCode(h[d]);var b=c();u({data:g,addLength1:!0,objectId:b}),l("endobj");var _=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:_}),l("endobj");var w=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+b+" 0 R"),l("/Flags 96"),l("/FontBBox "+i.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Oc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var E=0;E<o.metadata.hmtx.widths.length;E++)o.metadata.hmtx.widths[E]=parseInt(o.metadata.hmtx.widths[E]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+_+" 0 R/BaseFont/"+Oc(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+i.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var r=function(a){var s,o=a.text||"",l=a.x,c=a.y,u=a.options||{},h=a.mutex||{},g=h.pdfEscape,d=h.activeFontKey,b=h.fonts,_=d,w="",E=0,A="",D=b[_].encoding;if(b[_].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:h};for(A=o,_=d,Array.isArray(o)&&(A=o[0]),E=0;E<A.length;E+=1)b[_].metadata.hasOwnProperty("cmap")&&(s=b[_].metadata.cmap.unicode.codeMap[A[E].charCodeAt(0)]),s||A[E].charCodeAt(0)<256&&b[_].metadata.hasOwnProperty("Unicode")?w+=A[E]:w+="";var N="";return parseInt(_.slice(1))<14||D==="WinAnsiEncoding"?N=g(w,_).split("").map(function(z){return z.charCodeAt(0).toString(16)}).join(""):D==="Identity-H"&&(N=e(w,b[_])),h.isHex=!0,{text:N,x:l,y:c,options:u,mutex:h}};t.events.push(["postProcessText",function(a){var s=a.text||"",o=[],l={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([r(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(r(Object.assign({},l,{text:s[c]})).text);a.text=o}else a.text=r(Object.assign({},l,{text:s})).text}])})(_t),(function(i){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};i.existsFileInVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0},i.addFileToVFS=function(e,n){return t.call(this),this.internal.vFS[e]=n,this},i.getFileFromVFS=function(e){return t.call(this),this.internal.vFS[e]!==void 0?this.internal.vFS[e]:null}})(_t.API),(function(i){i.__bidiEngine__=i.prototype.__bidiEngine__=function(n){var r,a,s,o,l,c,u,h=t,g=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},_={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","\xAB","\xBB","\xAB","\u2039","\u203A","\u2039","\u2045","\u2046","\u2045","\u207D","\u207E","\u207D","\u208D","\u208E","\u208D","\u2264","\u2265","\u2264","\u2329","\u232A","\u2329","\uFE59","\uFE5A","\uFE59","\uFE5B","\uFE5C","\uFE5B","\uFE5D","\uFE5E","\uFE5D","\uFE64","\uFE65","\uFE64"],E=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),A=!1,D=0;this.__bidiEngine__={};var N=function(F){var I=F.charCodeAt(),ee=I>>8,le=_[ee];return le!==void 0?h[256*le+(255&I)]:ee===252||ee===253?"AL":E.test(ee)?"L":ee===8?"R":"N"},z=function(F){for(var I,ee=0;ee<F.length;ee++){if((I=N(F.charAt(ee)))==="L")return!1;if(I==="R")return!0}return!1},J=function(F,I,ee,le){var de,ke,Fe,Se,Oe=I[le];switch(Oe){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":A=!1;break;case"N":case"AN":break;case"EN":A&&(Oe="AN");break;case"AL":A=!0,Oe="R";break;case"WS":case"BN":Oe="N";break;case"CS":le<1||le+1>=I.length||(de=ee[le-1])!=="EN"&&de!=="AN"||(ke=I[le+1])!=="EN"&&ke!=="AN"?Oe="N":A&&(ke="AN"),Oe=ke===de?ke:"N";break;case"ES":Oe=(de=le>0?ee[le-1]:"B")==="EN"&&le+1<I.length&&I[le+1]==="EN"?"EN":"N";break;case"ET":if(le>0&&ee[le-1]==="EN"){Oe="EN";break}if(A){Oe="N";break}for(Fe=le+1,Se=I.length;Fe<Se&&I[Fe]==="ET";)Fe++;Oe=Fe<Se&&I[Fe]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(Se=I.length,Fe=le+1;Fe<Se&&I[Fe]==="NSM";)Fe++;if(Fe<Se){var Ze=F[le],qe=Ze>=1425&&Ze<=2303||Ze===64286;if(de=I[Fe],qe&&(de==="R"||de==="AL")){Oe="R";break}}}Oe=le<1||(de=I[le-1])==="B"?"N":ee[le-1];break;case"B":A=!1,r=!0,Oe=D;break;case"S":a=!0,Oe="N"}return Oe},W=function(F,I,ee){var le=F.split("");return ee&&U(le,ee,{hiLevel:D}),le.reverse(),I&&I.reverse(),le.join("")},U=function(F,I,ee){var le,de,ke,Fe,Se,Oe=-1,Ze=F.length,qe=0,k=[],B=D?d:g,P=[];for(A=!1,r=!1,a=!1,de=0;de<Ze;de++)P[de]=N(F[de]);for(ke=0;ke<Ze;ke++){if(Se=qe,k[ke]=J(F,P,k,ke),le=240&(qe=B[Se][b[k[ke]]]),qe&=15,I[ke]=Fe=B[qe][5],le>0)if(le===16){for(de=Oe;de<ke;de++)I[de]=1;Oe=-1}else Oe=-1;if(B[qe][6])Oe===-1&&(Oe=ke);else if(Oe>-1){for(de=Oe;de<ke;de++)I[de]=Fe;Oe=-1}P[ke]==="B"&&(I[ke]=0),ee.hiLevel|=Fe}a&&(function(O,Q,fe){for(var ye=0;ye<fe;ye++)if(O[ye]==="S"){Q[ye]=D;for(var pe=ye-1;pe>=0&&O[pe]==="WS";pe--)Q[pe]=D}})(P,I,Ze)},M=function(F,I,ee,le,de){if(!(de.hiLevel<F)){if(F===1&&D===1&&!r)return I.reverse(),void(ee&&ee.reverse());for(var ke,Fe,Se,Oe,Ze=I.length,qe=0;qe<Ze;){if(le[qe]>=F){for(Se=qe+1;Se<Ze&&le[Se]>=F;)Se++;for(Oe=qe,Fe=Se-1;Oe<Fe;Oe++,Fe--)ke=I[Oe],I[Oe]=I[Fe],I[Fe]=ke,ee&&(ke=ee[Oe],ee[Oe]=ee[Fe],ee[Fe]=ke);qe=Se}qe++}}},X=function(F,I,ee){var le=F.split(""),de={hiLevel:D};return ee||(ee=[]),U(le,ee,de),(function(ke,Fe,Se){if(Se.hiLevel!==0&&u)for(var Oe,Ze=0;Ze<ke.length;Ze++)Fe[Ze]===1&&(Oe=w.indexOf(ke[Ze]))>=0&&(ke[Ze]=w[Oe+1])})(le,ee,de),M(2,le,I,ee,de),M(1,le,I,ee,de),le.join("")};return this.__bidiEngine__.doBidiReorder=function(F,I,ee){if((function(de,ke){if(ke)for(var Fe=0;Fe<de.length;Fe++)ke[Fe]=Fe;o===void 0&&(o=z(de)),c===void 0&&(c=z(de))})(F,I),s||!l||c)if(s&&l&&o^c)D=o?1:0,F=W(F,I,ee);else if(!s&&l&&c)D=o?1:0,F=X(F,I,ee),F=W(F,I);else if(!s||o||l||c){if(s&&!l&&o^c)F=W(F,I),o?(D=0,F=X(F,I,ee)):(D=1,F=X(F,I,ee),F=W(F,I));else if(s&&o&&!l&&c)D=1,F=X(F,I,ee),F=W(F,I);else if(!s&&!l&&o^c){var le=u;o?(D=1,F=X(F,I,ee),D=0,u=!1,F=X(F,I,ee),u=le):(D=0,F=X(F,I,ee),F=W(F,I),D=1,u=!1,F=X(F,I,ee),u=le,F=W(F,I))}}else D=0,F=X(F,I,ee);else D=o?1:0,F=X(F,I,ee);return F},this.__bidiEngine__.setOptions=function(F){F&&(s=F.isInputVisual,l=F.isOutputVisual,o=F.isInputRtl,c=F.isOutputRtl,u=F.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],e=new i.__bidiEngine__({isInputVisual:!0});i.API.events.push(["postProcessText",function(n){var r=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,e.setOptions(a),Object.prototype.toString.call(r)==="[object Array]"){var o=0;for(s=[],o=0;o<r.length;o+=1)Object.prototype.toString.call(r[o])==="[object Array]"?s.push([e.doBidiReorder(r[o][0]),r[o][1],r[o][2]]):s.push([e.doBidiReorder(r[o])]);n.text=s}else n.text=e.doBidiReorder(r);e.setOptions({isInputVisual:!0})}])})(_t),_t.API.TTFFont=(function(){function i(t){var e;if(this.rawData=t,e=this.contents=new Dl(t),this.contents.pos=4,e.readString(4)==="ttcf")throw new Error("TTCF not supported.");e.pos=0,this.parse(),this.subset=new yz(this),this.registerTTF()}return i.open=function(t){return new i(t)},i.prototype.parse=function(){return this.directory=new lz(this.contents),this.head=new uz(this),this.name=new mz(this),this.cmap=new OS(this),this.toUnicode={},this.hhea=new dz(this),this.maxp=new gz(this),this.hmtx=new xz(this),this.post=new hz(this),this.os2=new fz(this),this.loca=new wz(this),this.glyf=new vz(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},i.prototype.registerTTF=function(){var t,e,n,r,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}.call(this),this.stemV=0,this.post.exists?(n=255&(r=this.post.italic_angle),32768&(e=r>>16)&&(e=-(1+(65535^e))),this.italicAngle=+(e+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},i.prototype.characterToGlyph=function(t){var e;return((e=this.cmap.unicode)!=null?e.codeMap[t]:void 0)||0},i.prototype.widthOfGlyph=function(t){var e;return e=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*e},i.prototype.widthOfString=function(t,e,n){var r,a,s,o;for(s=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)r=t.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(r))+n*(1e3/e)||0;return s*(e/1e3)},i.prototype.lineHeight=function(t,e){var n;return e==null&&(e=!1),n=e?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},i})();var ys,Dl=(function(){function i(t){this.data=t??[],this.pos=0,this.length=this.data.length}return i.prototype.readByte=function(){return this.data[this.pos++]},i.prototype.writeByte=function(t){return this.data[this.pos++]=t},i.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},i.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},i.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},i.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},i.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},i.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},i.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},i.prototype.readString=function(t){var e,n;for(n=[],e=0;0<=t?e<t:e>t;e=0<=t?++e:--e)n[e]=String.fromCharCode(this.readByte());return n.join("")},i.prototype.writeString=function(t){var e,n,r;for(r=[],e=0,n=t.length;0<=n?e<n:e>n;e=0<=n?++e:--e)r.push(this.writeByte(t.charCodeAt(e)));return r},i.prototype.readShort=function(){return this.readInt16()},i.prototype.writeShort=function(t){return this.writeInt16(t)},i.prototype.readLongLong=function(){var t,e,n,r,a,s,o,l;return t=this.readByte(),e=this.readByte(),n=this.readByte(),r=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^e)+1099511627776*(255^n)+4294967296*(255^r)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*e+1099511627776*n+4294967296*r+16777216*a+65536*s+256*o+l},i.prototype.writeLongLong=function(t){var e,n;return e=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},i.prototype.readInt=function(){return this.readInt32()},i.prototype.writeInt=function(t){return this.writeInt32(t)},i.prototype.read=function(t){var e,n;for(e=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)e.push(this.readByte());return e},i.prototype.write=function(t){var e,n,r,a;for(a=[],n=0,r=t.length;n<r;n++)e=t[n],a.push(this.writeByte(e));return a},i})(),lz=(function(){var i;function t(e){var n,r,a;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,a=this.tableCount;0<=a?r<a:r>a;r=0<=a?++r:--r)n={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(e){var n,r,a,s,o,l,c,u,h,g,d,b,_;for(_ in d=Object.keys(e).length,l=Math.log(2),h=16*Math.floor(Math.log(d)/l),s=Math.floor(h/l),u=16*d-h,(r=new Dl).writeInt(this.scalarType),r.writeShort(d),r.writeShort(h),r.writeShort(s),r.writeShort(u),a=16*d,c=r.pos+a,o=null,b=[],e)for(g=e[_],r.writeString(_),r.writeInt(i(g)),r.writeInt(c),r.writeInt(g.length),b=b.concat(g),_==="head"&&(o=c),c+=g.length;c%4;)b.push(0),c++;return r.write(b),n=2981146554-i(r.data),r.pos=o+8,r.writeUInt32(n),r.data},i=function(e){var n,r,a,s;for(e=BS.call(e);e.length%4;)e.push(0);for(a=new Dl(e),r=0,n=0,s=e.length;n<s;n=n+=4)r+=a.readUInt32();return 4294967295&r},t})(),cz={}.hasOwnProperty,Zs=function(i,t){for(var e in t)cz.call(t,e)&&(i[e]=t[e]);function n(){this.constructor=i}return n.prototype=t.prototype,i.prototype=new n,i.__super__=t.prototype,i};ys=(function(){function i(t){var e;this.file=t,e=this.file.directory.tables[this.tag],this.exists=!!e,e&&(this.offset=e.offset,this.length=e.length,this.parse(this.file.contents))}return i.prototype.parse=function(){},i.prototype.encode=function(){},i.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},i})();var uz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="head",i.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},i.prototype.encode=function(t){var e;return(e=new Dl).writeInt(this.version),e.writeInt(this.revision),e.writeInt(this.checkSumAdjustment),e.writeInt(this.magicNumber),e.writeShort(this.flags),e.writeShort(this.unitsPerEm),e.writeLongLong(this.created),e.writeLongLong(this.modified),e.writeShort(this.xMin),e.writeShort(this.yMin),e.writeShort(this.xMax),e.writeShort(this.yMax),e.writeShort(this.macStyle),e.writeShort(this.lowestRecPPEM),e.writeShort(this.fontDirectionHint),e.writeShort(t),e.writeShort(this.glyphDataFormat),e.data},i})(),ES=(function(){function i(t,e){var n,r,a,s,o,l,c,u,h,g,d,b,_,w,E,A,D;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=e+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),g=d/2,t.pos+=6,a=(function(){var N,z;for(z=[],l=N=0;0<=g?N<g:N>g;l=0<=g?++N:--N)z.push(t.readUInt16());return z})(),t.pos+=2,_=(function(){var N,z;for(z=[],l=N=0;0<=g?N<g:N>g;l=0<=g?++N:--N)z.push(t.readUInt16());return z})(),c=(function(){var N,z;for(z=[],l=N=0;0<=g?N<g:N>g;l=0<=g?++N:--N)z.push(t.readUInt16());return z})(),u=(function(){var N,z;for(z=[],l=N=0;0<=g?N<g:N>g;l=0<=g?++N:--N)z.push(t.readUInt16());return z})(),r=(this.length-t.pos+this.offset)/2,o=(function(){var N,z;for(z=[],l=N=0;0<=r?N<r:N>r;l=0<=r?++N:--N)z.push(t.readUInt16());return z})(),l=E=0,D=a.length;E<D;l=++E)for(w=a[l],n=A=b=_[l];b<=w?A<=w:A>=w;n=b<=w?++A:--A)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-b)-(g-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=h}return i.encode=function(t,e){var n,r,a,s,o,l,c,u,h,g,d,b,_,w,E,A,D,N,z,J,W,U,M,X,F,I,ee,le,de,ke,Fe,Se,Oe,Ze,qe,k,B,P,O,Q,fe,ye,pe,ge,Xe,Je;switch(le=new Dl,s=Object.keys(t).sort(function(ut,Ne){return ut-Ne}),e){case"macroman":for(_=0,w=(function(){var ut=[];for(b=0;b<256;++b)ut.push(0);return ut})(),A={0:0},a={},de=0,Oe=s.length;de<Oe;de++)A[pe=t[r=s[de]]]==null&&(A[pe]=++_),a[r]={old:t[r],new:A[t[r]]},w[r]=A[t[r]];return le.writeUInt16(1),le.writeUInt16(0),le.writeUInt32(12),le.writeUInt16(0),le.writeUInt16(262),le.writeUInt16(0),le.write(w),{charMap:a,subtable:le.data,maxGlyphID:_+1};case"unicode":for(I=[],h=[],D=0,A={},n={},E=c=null,ke=0,Ze=s.length;ke<Ze;ke++)A[z=t[r=s[ke]]]==null&&(A[z]=++D),n[r]={old:z,new:A[z]},o=A[z]-r,E!=null&&o===c||(E&&h.push(E),I.push(r),c=o),E=r;for(E&&h.push(E),h.push(65535),I.push(65535),X=2*(M=I.length),U=2*Math.pow(Math.log(M)/Math.LN2,2),g=Math.log(U/2)/Math.LN2,W=2*M-U,l=[],J=[],d=[],b=Fe=0,qe=I.length;Fe<qe;b=++Fe){if(F=I[b],u=h[b],F===65535){l.push(0),J.push(0);break}if(F-(ee=n[F].new)>=32768)for(l.push(0),J.push(2*(d.length+M-b)),r=Se=F;F<=u?Se<=u:Se>=u;r=F<=u?++Se:--Se)d.push(n[r].new);else l.push(ee-F),J.push(0)}for(le.writeUInt16(3),le.writeUInt16(1),le.writeUInt32(12),le.writeUInt16(4),le.writeUInt16(16+8*M+2*d.length),le.writeUInt16(0),le.writeUInt16(X),le.writeUInt16(U),le.writeUInt16(g),le.writeUInt16(W),fe=0,k=h.length;fe<k;fe++)r=h[fe],le.writeUInt16(r);for(le.writeUInt16(0),ye=0,B=I.length;ye<B;ye++)r=I[ye],le.writeUInt16(r);for(ge=0,P=l.length;ge<P;ge++)o=l[ge],le.writeUInt16(o);for(Xe=0,O=J.length;Xe<O;Xe++)N=J[Xe],le.writeUInt16(N);for(Je=0,Q=d.length;Je<Q;Je++)_=d[Je],le.writeUInt16(_);return{charMap:n,subtable:le.data,maxGlyphID:D+1}}},i})(),OS=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="cmap",i.prototype.parse=function(t){var e,n,r;for(t.pos=this.offset,this.version=t.readUInt16(),r=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)e=new ES(t,this.offset),this.tables.push(e),e.isUnicode&&this.unicode==null&&(this.unicode=e);return!0},i.encode=function(t,e){var n,r;return e==null&&(e="macroman"),n=ES.encode(t,e),(r=new Dl).writeUInt16(0),r.writeUInt16(1),n.table=r.data.concat(n.subtable),n},i})(),dz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="hhea",i.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},i})(),fz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="OS/2",i.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var e,n;for(n=[],e=0;e<10;++e)n.push(t.readByte());return n})(),this.charRange=(function(){var e,n;for(n=[],e=0;e<4;++e)n.push(t.readInt());return n})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var e,n;for(n=[],e=0;e<2;e=++e)n.push(t.readInt());return n})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},i})(),hz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="post",i.prototype.parse=function(t){var e,n,r;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],r=[];t.pos<this.offset+this.length;)e=t.readByte(),r.push(this.names.push(t.readString(e)));return r;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var s,o,l;for(l=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)l.push(t.readUInt32());return l}.call(this)}},i})(),pz=function(i,t){this.raw=i,this.length=i.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},mz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="name",i.prototype.parse=function(t){var e,n,r,a,s,o,l,c,u,h,g;for(t.pos=this.offset,t.readShort(),e=t.readShort(),o=t.readShort(),n=[],a=0;0<=e?a<e:a>e;a=0<=e?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(l={},a=u=0,h=n.length;u<h;a=++u)r=n[a],t.pos=r.offset,c=t.readString(r.length),s=new pz(c,r),l[g=r.nameID]==null&&(l[g]=[]),l[r.nameID].push(s);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},i})(),gz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="maxp",i.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},i})(),xz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="hmtx",i.prototype.parse=function(t){var e,n,r,a,s,o,l;for(t.pos=this.offset,this.metrics=[],e=0,o=this.file.hhea.numberOfMetrics;0<=o?e<o:e>o;e=0<=o?++e:--e)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(r=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var c,u;for(u=[],e=c=0;0<=r?c<r:c>r;e=0<=r?++c:--c)u.push(t.readInt16());return u})(),this.widths=function(){var c,u,h,g;for(g=[],c=0,u=(h=this.metrics).length;c<u;c++)a=h[c],g.push(a.advance);return g}.call(this),n=this.widths[this.widths.length-1],l=[],e=s=0;0<=r?s<r:s>r;e=0<=r?++s:--s)l.push(this.widths.push(n));return l},i.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},i})(),BS=[].slice,vz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="glyf",i.prototype.parse=function(){return this.cache={}},i.prototype.glyphFor=function(t){var e,n,r,a,s,o,l,c,u,h;return t in this.cache?this.cache[t]:(a=this.file.loca,e=this.file.contents,n=a.indexOf(t),(r=a.lengthOf(t))===0?this.cache[t]=null:(e.pos=this.offset+n,s=(o=new Dl(e.read(r))).readShort(),c=o.readShort(),h=o.readShort(),l=o.readShort(),u=o.readShort(),this.cache[t]=s===-1?new bz(o,c,h,l,u):new _z(o,s,c,h,l,u),this.cache[t]))},i.prototype.encode=function(t,e,n){var r,a,s,o,l;for(s=[],a=[],o=0,l=e.length;o<l;o++)r=t[e[o]],a.push(s.length),r&&(s=s.concat(r.encode(n)));return a.push(s.length),{table:s,offsets:a}},i})(),_z=(function(){function i(t,e,n,r,a,s){this.raw=t,this.numberOfContours=e,this.xMin=n,this.yMin=r,this.xMax=a,this.yMax=s,this.compound=!1}return i.prototype.encode=function(){return this.raw.data},i})(),bz=(function(){function i(t,e,n,r,a){var s,o;for(this.raw=t,this.xMin=e,this.yMin=n,this.xMax=r,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return i.prototype.encode=function(){var t,e,n;for(e=new Dl(BS.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)e.pos=this.glyphOffsets[t];return e.data},i})(),wz=(function(){function i(){return i.__super__.constructor.apply(this,arguments)}return Zs(i,ys),i.prototype.tag="loca",i.prototype.parse=function(t){var e,n;return t.pos=this.offset,e=this.file.head.indexToLocFormat,this.offsets=e===0?function(){var r,a;for(a=[],n=0,r=this.length;n<r;n+=2)a.push(2*t.readUInt16());return a}.call(this):function(){var r,a;for(a=[],n=0,r=this.length;n<r;n+=4)a.push(t.readUInt32());return a}.call(this)},i.prototype.indexOf=function(t){return this.offsets[t]},i.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},i.prototype.encode=function(t,e){for(var n=new Uint32Array(this.offsets.length),r=0,a=0,s=0;s<n.length;++s)if(n[s]=r,a<e.length&&e[a]==s){++a,n[s]=r;var o=this.offsets[s],l=this.offsets[s+1]-o;l>0&&(r+=l)}for(var c=new Array(4*n.length),u=0;u<n.length;++u)c[4*u+3]=255&n[u],c[4*u+2]=(65280&n[u])>>8,c[4*u+1]=(16711680&n[u])>>16,c[4*u]=(4278190080&n[u])>>24;return c},i})(),yz=(function(){function i(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return i.prototype.generateCmap=function(){var t,e,n,r,a;for(e in r=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[e],t[e]=r[n];return t},i.prototype.glyphsFor=function(t){var e,n,r,a,s,o,l;for(r={},s=0,o=t.length;s<o;s++)r[a=t[s]]=this.font.glyf.glyphFor(a);for(a in e=[],r)(n=r[a])!=null&&n.compound&&e.push.apply(e,n.glyphIDs);if(e.length>0)for(a in l=this.glyphsFor(e))n=l[a],r[a]=n;return r},i.prototype.encode=function(t,e){var n,r,a,s,o,l,c,u,h,g,d,b,_,w,E;for(r in n=OS.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),d={0:0},E=n.charMap)d[(l=E[r]).old]=l.new;for(b in g=n.maxGlyphID,s)b in d||(d[b]=g++);return u=(function(A){var D,N;for(D in N={},A)N[A[D]]=D;return N})(d),h=Object.keys(u).sort(function(A,D){return A-D}),_=(function(){var A,D,N;for(N=[],A=0,D=h.length;A<D;A++)o=h[A],N.push(u[o]);return N})(),a=this.font.glyf.encode(s,_,d),c=this.font.loca.encode(a.offsets,_),w={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(e)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},i})();_t.API.PDFObject=(function(){var i;function t(){}return i=function(e,n){return(Array(n+1).join("0")+e).slice(-n)},t.convert=function(e){var n,r,a,s;if(Array.isArray(e))return"["+(function(){var o,l,c;for(c=[],o=0,l=e.length;o<l;o++)n=e[o],c.push(t.convert(n));return c})().join(" ")+"]";if(typeof e=="string")return"/"+e;if(e?.isString)return"("+e+")";if(e instanceof Date)return"(D:"+i(e.getUTCFullYear(),4)+i(e.getUTCMonth(),2)+i(e.getUTCDate(),2)+i(e.getUTCHours(),2)+i(e.getUTCMinutes(),2)+i(e.getUTCSeconds(),2)+"Z)";if({}.toString.call(e)==="[object Object]"){for(r in a=["<<"],e)s=e[r],a.push("/"+r+" "+t.convert(s));return a.push(">>"),a.join(`
`)}return""+e},t})();function WS(i,t,e,n,r){n=n||{};var a=1.15,s=r.internal.scaleFactor,o=r.internal.getFontSize()/s,l=r.getLineHeightFactor?r.getLineHeightFactor():a,c=o*l,u=/\r\n|\r|\n/g,h="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof i=="string"?i.split(u):i,g=h.length||1),e+=o*(2-a),n.valign==="middle"?e-=g/2*c:n.valign==="bottom"&&(e-=g*c),n.halign==="center"||n.halign==="right"){var d=o;if(n.halign==="center"&&(d*=.5),h&&g>=1){for(var b=0;b<h.length;b++)r.text(h[b],t-r.getStringUnitWidth(h[b])*d,e),e+=c;return r}t-=r.getStringUnitWidth(i)*d}return n.halign==="justify"?r.text(i,t,e,{maxWidth:n.maxWidth||100,align:"justify"}):r.text(i,t,e),r}var jS={},Hc=(function(){function i(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return i.setDefaults=function(t,e){e===void 0&&(e=null),e?e.__autoTableDocumentDefaults=t:jS=t},i.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},i.prototype.applyStyles=function(t,e){var n,r,a;e===void 0&&(e=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),o=s.fontStyle,l=s.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[l];c&&c.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!e){var u=i.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=i.unifyColor(t.textColor),u&&(r=this.jsPDFDocument).setTextColor.apply(r,u),u=i.unifyColor(t.lineColor),u&&(a=this.jsPDFDocument).setDrawColor.apply(a,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},i.prototype.splitTextToSize=function(t,e,n){return this.jsPDFDocument.splitTextToSize(t,e,n)},i.prototype.rect=function(t,e,n,r,a){return this.jsPDFDocument.rect(t,e,n,r,a)},i.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},i.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},i.prototype.getDocument=function(){return this.jsPDFDocument},i.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},i.prototype.addPage=function(){return this.jsPDFDocument.addPage()},i.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},i.prototype.getGlobalOptions=function(){return jS||{}},i.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},i.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},i.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},i.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},i.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},i.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},i})(),Cx=function(i,t){return Cx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])},Cx(i,t)};function qS(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Cx(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var GS=(function(i){qS(t,i);function t(e){var n=i.call(this)||this;return n._element=e,n}return t})(Array);function Sz(i){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/i,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Cz(i){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[i]}function fp(i,t,e){e.applyStyles(t,!0);var n=Array.isArray(i)?i:[i],r=n.map(function(a){return e.getTextWidth(a)}).reduce(function(a,s){return Math.max(a,s)},0);return r}function $S(i,t,e,n){var r=t.settings.tableLineWidth,a=t.settings.tableLineColor;i.applyStyles({lineWidth:r,lineColor:a});var s=XS(r,!1);s&&i.rect(e.x,e.y,t.getWidth(i.pageSize().width),n.y-e.y,s)}function XS(i,t){var e=i>0,n=t||t===0;return e&&n?"DF":e?"S":n?"F":null}function pp(i,t){var e,n,r,a;if(i=i||t,Array.isArray(i)){if(i.length>=4)return{top:i[0],right:i[1],bottom:i[2],left:i[3]};if(i.length===3)return{top:i[0],right:i[1],bottom:i[2],left:i[1]};if(i.length===2)return{top:i[0],right:i[1],bottom:i[0],left:i[1]};i.length===1?i=i[0]:i=t}return typeof i=="object"?(typeof i.vertical=="number"&&(i.top=i.vertical,i.bottom=i.vertical),typeof i.horizontal=="number"&&(i.right=i.horizontal,i.left=i.horizontal),{left:(e=i.left)!==null&&e!==void 0?e:t,top:(n=i.top)!==null&&n!==void 0?n:t,right:(r=i.right)!==null&&r!==void 0?r:t,bottom:(a=i.bottom)!==null&&a!==void 0?a:t}):(typeof i!="number"&&(i=t),{top:i,right:i,bottom:i,left:i})}function YS(i,t){var e=pp(t.settings.margin,0);return i.pageSize().width-(e.left+e.right)}function Ez(i,t,e,n,r){var a={},s=1.3333333333333333,o=vx(t,function(D){return r.getComputedStyle(D).backgroundColor});o!=null&&(a.fillColor=o);var l=vx(t,function(D){return r.getComputedStyle(D).color});l!=null&&(a.textColor=l);var c=Tz(n,e);c&&(a.cellPadding=c);var u="borderTopColor",h=s*e,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var d=(parseFloat(g)||0)/h;d&&(a.lineWidth=d)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},a.lineWidth.top||(a.lineWidth.right?u="borderRightColor":a.lineWidth.bottom?u="borderBottomColor":a.lineWidth.left&&(u="borderLeftColor"));var b=vx(t,function(D){return r.getComputedStyle(D)[u]});b!=null&&(a.lineColor=b);var _=["left","right","center","justify"];_.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),_=["middle","bottom","top"],_.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(a.fontSize=w/s);var E=kz(n);E&&(a.fontStyle=E);var A=(n.fontFamily||"").toLowerCase();return i.indexOf(A)!==-1&&(a.font=A),a}function kz(i){var t="";return(i.fontWeight==="bold"||i.fontWeight==="bolder"||parseInt(i.fontWeight)>=700)&&(t="bold"),(i.fontStyle==="italic"||i.fontStyle==="oblique")&&(t+="italic"),t}function vx(i,t){var e=KS(i,t);if(!e)return null;var n=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function KS(i,t){var e=t(i);return e==="rgba(0, 0, 0, 0)"||e==="transparent"||e==="initial"||e==="inherit"?i.parentElement==null?null:KS(i.parentElement,t):e}function Tz(i,t){var e=[i.paddingTop,i.paddingRight,i.paddingBottom,i.paddingLeft],n=96/(72/t),r=(parseInt(i.lineHeight)-parseInt(i.fontSize))/t/2,a=e.map(function(o){return parseInt(o||"0")/n}),s=pp(a,0);return r>s.top&&(s.top=r),r>s.bottom&&(s.bottom=r),s}function ZS(i,t,e,n,r){var a,s;n===void 0&&(n=!1),r===void 0&&(r=!1);var o;typeof t=="string"?o=e.document.querySelector(t):o=t;var l=Object.keys(i.getFontList()),c=i.scaleFactor(),u=[],h=[],g=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:u,body:h,foot:g};for(var d=0;d<o.rows.length;d++){var b=o.rows[d],_=(s=(a=b?.parentElement)===null||a===void 0?void 0:a.tagName)===null||s===void 0?void 0:s.toLowerCase(),w=Az(l,c,e,b,n,r);w&&(_==="thead"?u.push(w):_==="tfoot"?g.push(w):h.push(w))}return{head:u,body:h,foot:g}}function Az(i,t,e,n,r,a){for(var s=new GS(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=e.getComputedStyle(l);if(r||c.display!=="none"){var u=void 0;a&&(u=Ez(i,l,t,c,e)),s.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:u,_element:l,content:Fz(l)})}}var h=e.getComputedStyle(n);if(s.length>0&&(r||h.display!=="none"))return s}function Fz(i){var t=i.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(e){return e.trim()}).join(`
`),t.innerText||t.textContent||""}function Dz(i,t,e){for(var n=0,r=[i,t,e];n<r.length;n++){var a=r[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function Lo(i,t,e,n,r){if(i==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(i),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])}return a}function JS(i,t){var e=new Hc(i),n=e.getDocumentOptions(),r=e.getGlobalOptions();Dz(r,n,t);var a=Lo({},r,n,t),s;typeof window<"u"&&(s=window);var o=Nz(r,n,t),l=Pz(r,n,t),c=Mz(e,a),u=Iz(e,a,s);return{id:t.tableId,content:u,hooks:l,styles:o,settings:c}}function Nz(i,t,e){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(l){if(l==="columnStyles"){var c=i[l],u=t[l],h=e[l];n.columnStyles=Lo({},c,u,h)}else{var g=[i,t,e],d=g.map(function(b){return b[l]||{}});n[l]=Lo({},d[0],d[1],d[2])}},a=0,s=Object.keys(n);a<s.length;a++){var o=s[a];r(o)}return n}function Pz(i,t,e){for(var n=[i,t,e],r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,s=n;a<s.length;a++){var o=s[a];o.didParseCell&&r.didParseCell.push(o.didParseCell),o.willDrawCell&&r.willDrawCell.push(o.willDrawCell),o.didDrawCell&&r.didDrawCell.push(o.didDrawCell),o.willDrawPage&&r.willDrawPage.push(o.willDrawPage),o.didDrawPage&&r.didDrawPage.push(o.didDrawPage)}return r}function Mz(i,t){var e,n,r,a,s,o,l,c,u,h,g,d,b=pp(t.margin,40/i.scaleFactor()),_=(e=Lz(i,t.startY))!==null&&e!==void 0?e:b.top,w;t.showFoot===!0?w="everyPage":t.showFoot===!1?w="never":w=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var E;t.showHead===!0?E="everyPage":t.showHead===!1?E="never":E=(r=t.showHead)!==null&&r!==void 0?r:"everyPage";var A=(a=t.useCss)!==null&&a!==void 0?a:!1,D=t.theme||(A?"plain":"striped"),N=!!t.horizontalPageBreak,z=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:A,theme:D,startY:_,margin:b,pageBreak:(l=t.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(c=t.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:E,showFoot:w,tableLineWidth:(h=t.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(g=t.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:N,horizontalPageBreakRepeat:z,horizontalPageBreakBehaviour:(d=t.horizontalPageBreakBehaviour)!==null&&d!==void 0?d:"afterAllRows"}}function Lz(i,t){var e=i.getLastAutoTable(),n=i.scaleFactor(),r=i.pageNumber(),a=!1;if(e&&e.startPageNumber){var s=e.startPageNumber+e.pageNumber-1;a=s===r}return typeof t=="number"?t:(t==null||t===!1)&&a&&e?.finalY!=null?e.finalY+20/n:null}function Iz(i,t,e){var n=t.head||[],r=t.body||[],a=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(e){var o=ZS(i,t.html,e,s,t.useCss)||{};n=o.head||n,r=o.body||n,a=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||Rz(n,r,a);return{columns:l,head:n,body:r,foot:a}}function Rz(i,t,e){var n=i[0]||t[0]||e[0]||[],r=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var s=1,o;Array.isArray(n)?o=n[parseInt(a)]:o=n[a],typeof o=="object"&&!Array.isArray(o)&&(s=o?.colSpan||1);for(var l=0;l<s;l++){var c=void 0;Array.isArray(n)?c=r.length:c=a+(l>0?"_".concat(l):"");var u={dataKey:c};r.push(u)}}),r}var Ex=(function(){function i(t,e,n){this.table=e,this.pageNumber=e.pageNumber,this.settings=e.settings,this.cursor=n,this.doc=t.getDocument()}return i})(),Oz=(function(i){qS(t,i);function t(e,n,r,a,s,o){var l=i.call(this,e,n,o)||this;return l.cell=r,l.row=a,l.column=s,l.section=a.section,l}return t})(Ex),Bz=(function(){function i(t,e){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=e.columns,this.head=e.head,this.body=e.body,this.foot=e.foot}return i.prototype.getHeadHeight=function(t){return this.head.reduce(function(e,n){return e+n.getMaxCellHeight(t)},0)},i.prototype.getFootHeight=function(t){return this.foot.reduce(function(e,n){return e+n.getMaxCellHeight(t)},0)},i.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},i.prototype.callCellHooks=function(t,e,n,r,a,s){for(var o=0,l=e;o<l.length;o++){var c=l[o],u=new Oz(t,this,n,r,a,s),h=c(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},i.prototype.callEndPageHooks=function(t,e){t.applyStyles(t.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++){var a=r[n];a(new Ex(t,this,e))}},i.prototype.callWillDrawPageHooks=function(t,e){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++){var a=r[n];a(new Ex(t,this,e))}},i.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var e=this.columns.reduce(function(r,a){return r+a.wrappedWidth},0);return e}else{var n=this.settings.margin;return t-n.left-n.right}},i})(),QS=(function(){function i(t,e,n,r,a){a===void 0&&(a=!1),this.height=0,this.raw=t,t instanceof GS&&(this.raw=t._element,this.element=t._element),this.index=e,this.section=n,this.cells=r,this.spansMultiplePages=a}return i.prototype.getMaxCellHeight=function(t){var e=this;return t.reduce(function(n,r){var a;return Math.max(n,((a=e.cells[r.index])===null||a===void 0?void 0:a.height)||0)},0)},i.prototype.hasRowSpan=function(t){var e=this;return t.filter(function(n){var r=e.cells[n.index];return r?r.rowSpan>1:!1}).length>0},i.prototype.canEntireRowFit=function(t,e){return this.getMaxCellHeight(e)<=t},i.prototype.getMinimumRowHeight=function(t,e){var n=this;return t.reduce(function(r,a){var s=n.cells[a.index];if(!s)return 0;var o=e.getLineHeight(s.styles.fontSize),l=s.padding("vertical"),c=l+o;return c>r?c:r},0)},i})(),eC=(function(){function i(t,e,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=e,this.section=n,this.raw=t;var a=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,a=(r=t.content)!==null&&r!==void 0?r:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=a!=null?""+a:"",o=/\r\n|\r|\n/g;this.text=s.split(o)}return i.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var e=this.height-this.padding("vertical");t=this.y+e/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var r=this.width-this.padding("horizontal");n=this.x+r/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},i.prototype.getContentHeight=function(t,e){e===void 0&&(e=1.15);var n=Array.isArray(this.text)?this.text.length:1,r=this.styles.fontSize/t*e,a=n*r+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},i.prototype.padding=function(t){var e=pp(this.styles.cellPadding,0);return t==="vertical"?e.top+e.bottom:t==="horizontal"?e.left+e.right:e[t]},i})(),jz=(function(){function i(t,e,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=e,this.index=n}return i.prototype.getMaxCustomCellWidth=function(t){for(var e=0,n=0,r=t.allRows();n<r.length;n++){var a=r[n],s=a.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(e=Math.max(e,s.styles.cellWidth))}return e},i})();function Vz(i,t){Uz(i,t);var e=[],n=0;t.columns.forEach(function(a){var s=a.getMaxCustomCellWidth(t);s?a.width=s:(a.width=a.wrappedWidth,e.push(a)),n+=a.width});var r=t.getWidth(i.pageSize().width)-n;r&&(r=kx(e,r,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),r&&(r=kx(e,r,function(a){return a.minWidth})),r=Math.abs(r),!t.settings.horizontalPageBreak&&r>.1/i.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),Hz(t),Wz(t,i),zz(t)}function Uz(i,t){var e=i.scaleFactor(),n=t.settings.horizontalPageBreak,r=YS(i,t);t.allRows().forEach(function(a){for(var s=0,o=t.columns;s<o.length;s++){var l=o[s],c=a.cells[l.index];if(c){var u=t.hooks.didParseCell;t.callCellHooks(i,u,c,a,l,null);var h=c.padding("horizontal");c.contentWidth=fp(c.text,c.styles,i)+h;var g=fp(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,i);if(c.minReadableWidth=g+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||n===!0)c.contentWidth>r?(c.minWidth=r,c.wrappedWidth=r):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var d=10/e;c.minWidth=c.styles.minCellWidth||d,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(a){for(var s=0,o=t.columns;s<o.length;s++){var l=o[s],c=a.cells[l.index];if(c&&c.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,c.wrappedWidth),l.minWidth=Math.max(l.minWidth,c.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,c.minReadableWidth);else{var u=t.styles.columnStyles[l.dataKey]||t.styles.columnStyles[l.index]||{},h=u.cellWidth||u.minCellWidth;h&&typeof h=="number"&&(l.minWidth=h,l.wrappedWidth=h)}c&&(c.colSpan>1&&!l.minWidth&&(l.minWidth=c.minWidth),c.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=c.minWidth))}})}function kx(i,t,e){for(var n=t,r=i.reduce(function(d,b){return d+b.wrappedWidth},0),a=0;a<i.length;a++){var s=i[a],o=s.wrappedWidth/r,l=n*o,c=s.width+l,u=e(s),h=c<u?u:c;t-=h-s.width,s.width=h}if(t=Math.round(t*1e10)/1e10,t){var g=i.filter(function(d){return t<0?d.width>e(d):!0});g.length&&(t=kx(g,t,e))}return t}function zz(i){for(var t={},e=1,n=i.allRows(),r=0;r<n.length;r++)for(var a=n[r],s=0,o=i.columns;s<o.length;s++){var l=o[s],c=t[l.index];if(e>1)e--,delete a.cells[l.index];else if(c)c.cell.height+=a.height,e=c.cell.colSpan,delete a.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var u=a.cells[l.index];if(!u)continue;if(u.height=a.height,u.rowSpan>1){var h=n.length-r,g=u.rowSpan>h?h:u.rowSpan;t[l.index]={cell:u,left:g,row:a}}}}}function Hz(i){for(var t=i.allRows(),e=0;e<t.length;e++)for(var n=t[e],r=null,a=0,s=0,o=0;o<i.columns.length;o++){var l=i.columns[o];if(s-=1,s>1&&i.columns[o+1])a+=l.width,delete n.cells[l.index];else if(r){var c=r;delete n.cells[l.index],r=null,c.width=l.width+a}else{var c=n.cells[l.index];if(!c)continue;if(s=c.colSpan,a=0,c.colSpan>1){r=c,a+=l.width;continue}c.width=l.width+a}}}function Wz(i,t){for(var e={count:0,height:0},n=0,r=i.allRows();n<r.length;n++){for(var a=r[n],s=0,o=i.columns;s<o.length;s++){var l=o[s],c=a.cells[l.index];if(c){t.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=t.splitTextToSize(c.text,u+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=VS(c.text,u,c.styles,t,"...");else if(c.styles.overflow==="hidden")c.text=VS(c.text,u,c.styles,t,"");else if(typeof c.styles.overflow=="function"){var h=c.styles.overflow(c.text,u);typeof h=="string"?c.text=[h]:c.text=h}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var g=c.contentHeight/c.rowSpan;c.rowSpan>1&&e.count*e.height<g*c.rowSpan?e={height:g,count:c.rowSpan}:e&&e.count>0&&e.height>g&&(g=e.height),g>a.height&&(a.height=g)}}e.count--}}function VS(i,t,e,n,r){return i.map(function(a){return qz(a,t,e,n,r)})}function qz(i,t,e,n,r){var a=1e4*n.scaleFactor();if(t=Math.ceil(t*a)/a,t>=fp(i,e,n))return i;for(;t<fp(i+r,e,n)&&!(i.length<=1);)i=i.substring(0,i.length-1);return i.trim()+r}function tC(i,t){var e=new Hc(i),n=Gz(t,e.scaleFactor()),r=new Bz(t,n);return Vz(e,r),e.applyStyles(e.userStyles),r}function Gz(i,t){var e=i.content,n=Xz(e.columns);if(e.head.length===0){var r=US(n,"head");r&&e.head.push(r)}if(e.foot.length===0){var r=US(n,"foot");r&&e.foot.push(r)}var a=i.settings.theme,s=i.styles;return{columns:n,head:_x("head",e.head,n,s,a,t),body:_x("body",e.body,n,s,a,t),foot:_x("foot",e.foot,n,s,a,t)}}function _x(i,t,e,n,r,a){var s={},o=t.map(function(l,c){for(var u=0,h={},g=0,d=0,b=0,_=e;b<_.length;b++){var w=_[b];if(s[w.index]==null||s[w.index].left===0)if(d===0){var E=void 0;Array.isArray(l)?E=l[w.index-g-u]:E=l[w.dataKey];var A={};typeof E=="object"&&!Array.isArray(E)&&(A=E?.styles||{});var D=Yz(i,w,c,r,n,a,A),N=new eC(E,D,i);h[w.dataKey]=N,h[w.index]=N,d=N.colSpan-1,s[w.index]={left:N.rowSpan-1,times:d}}else d--,g++;else s[w.index].left--,d=s[w.index].times,u++}return new QS(l,c,i,h)});return o}function US(i,t){var e={};return i.forEach(function(n){if(n.raw!=null){var r=$z(t,n.raw);r!=null&&(e[n.dataKey]=r)}}),Object.keys(e).length>0?e:null}function $z(i,t){if(i==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(i==="foot"&&typeof t=="object")return t.footer;return null}function Xz(i){return i.map(function(t,e){var n,r;return typeof t=="object"?r=(n=t.dataKey)!==null&&n!==void 0?n:e:r=e,new jz(r,t,e)})}function Yz(i,t,e,n,r,a,s){var o=Cz(n),l;i==="head"?l=r.headStyles:i==="body"?l=r.bodyStyles:i==="foot"&&(l=r.footStyles);var c=Lo({},o.table,o[i],r.styles,l),u=r.columnStyles[t.dataKey]||r.columnStyles[t.index]||{},h=i==="body"?u:{},g=i==="body"&&e%2===0?Lo({},o.alternateRow,r.alternateRowStyles):{},d=Sz(a),b=Lo({},d,c,g,h);return Lo(b,s)}function Kz(i,t,e){var n;e===void 0&&(e={});var r=YS(i,t),a=new Map,s=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(g){var d=t.columns.find(function(b){return b.dataKey===g||b.index===g});d&&!a.has(d.index)&&(a.set(d.index,!0),s.push(d.index),o.push(t.columns[d.index]),r-=d.wrappedWidth)});for(var c=!0,u=(n=e?.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(a.has(u)){u++;continue}var h=t.columns[u].wrappedWidth;if(c||r>=h)c=!1,s.push(u),o.push(t.columns[u]),r-=h;else break;u++}return{colIndexes:s,columns:o,lastIndex:u-1}}function Zz(i,t){for(var e=[],n=0;n<t.columns.length;n++){var r=Kz(i,t,{start:n});r.columns.length&&(e.push(r),n=r.lastIndex)}return e}function iC(i,t){var e=t.settings,n=e.startY,r=e.margin,a={x:r.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+r.bottom+s;if(e.pageBreak==="avoid"){var l=t.body,c=l.reduce(function(g,d){return g+d.height},0);o+=c}var u=new Hc(i);(e.pageBreak==="always"||e.startY!=null&&o>u.pageSize().height)&&(rC(u),a.y=r.top),t.callWillDrawPageHooks(u,a);var h=Lo({},a);t.startPageNumber=u.pageNumber(),e.horizontalPageBreak?Jz(u,t,h,a):(u.applyStyles(u.userStyles),(e.showHead==="firstPage"||e.showHead==="everyPage")&&t.head.forEach(function(g){return Io(u,t,g,a,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(g,d){var b=d===t.body.length-1;hp(u,t,g,b,h,a,t.columns)}),u.applyStyles(u.userStyles),(e.showFoot==="lastPage"||e.showFoot==="everyPage")&&t.foot.forEach(function(g){return Io(u,t,g,a,t.columns)})),$S(u,t,h,a),t.callEndPageHooks(u,a),t.finalY=a.y,i.lastAutoTable=t,u.applyStyles(u.userStyles)}function Jz(i,t,e,n){var r=Zz(i,t),a=t.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")r.forEach(function(c,u){i.applyStyles(i.userStyles),u>0?Ud(i,t,e,n,c.columns,!0):zS(i,t,n,c.columns),Qz(i,t,e,n,c.columns),bx(i,t,n,c.columns)});else for(var s=-1,o=r[0],l=function(){var c=s;if(o){i.applyStyles(i.userStyles);var u=o.columns;s>=0?Ud(i,t,e,n,u,!0):zS(i,t,n,u),c=HS(i,t,s+1,n,u),bx(i,t,n,u)}var h=c-s;r.slice(1).forEach(function(g){i.applyStyles(i.userStyles),Ud(i,t,e,n,g.columns,!0),HS(i,t,s+1,n,g.columns,h),bx(i,t,n,g.columns)}),s=c};s<t.body.length-1;)l()}function zS(i,t,e,n){var r=t.settings;i.applyStyles(i.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(a){return Io(i,t,a,e,n)})}function Qz(i,t,e,n,r){i.applyStyles(i.userStyles),t.body.forEach(function(a,s){var o=s===t.body.length-1;hp(i,t,a,o,e,n,r)})}function HS(i,t,e,n,r,a){i.applyStyles(i.userStyles),a=a??t.body.length;var s=Math.min(e+a,t.body.length),o=-1;return t.body.slice(e,s).forEach(function(l,c){var u=e+c===t.body.length-1,h=nC(i,t,u,n);l.canEntireRowFit(h,r)&&(Io(i,t,l,n,r),o=e+c)}),o}function bx(i,t,e,n){var r=t.settings;i.applyStyles(i.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(a){return Io(i,t,a,e,n)})}function eH(i,t,e){var n=e.getLineHeight(i.styles.fontSize),r=i.padding("vertical"),a=Math.floor((t-r)/n);return Math.max(0,a)}function tH(i,t,e,n){var r={};i.spansMultiplePages=!0,i.height=0;for(var a=0,s=0,o=e.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var u=new eC(c.raw,c.styles,c.section);u=Lo(u,c),u.text=[];var h=eH(c,t,n);c.text.length>h&&(u.text=c.text.splice(h,c.text.length));var g=n.scaleFactor(),d=n.getLineHeightFactor();c.contentHeight=c.getContentHeight(g,d),c.contentHeight>=t&&(c.contentHeight=t,u.styles.minCellHeight-=t),c.contentHeight>i.height&&(i.height=c.contentHeight),u.contentHeight=u.getContentHeight(g,d),u.contentHeight>a&&(a=u.contentHeight),r[l.index]=u}}var b=new QS(i.raw,-1,i.section,r,!0);b.height=a;for(var _=0,w=e.columns;_<w.length;_++){var l=w[_],u=b.cells[l.index];u&&(u.height=b.height);var c=i.cells[l.index];c&&(c.height=i.height)}return b}function iH(i,t,e,n){var r=i.pageSize().height,a=n.settings.margin,s=a.top+a.bottom,o=r-s;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=t.getMinimumRowHeight(n.columns,i),c=l<e;if(l>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var u=t.hasRowSpan(n.columns),h=t.getMaxCellHeight(n.columns)>o;return h?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function hp(i,t,e,n,r,a,s){var o=nC(i,t,n,a);if(e.canEntireRowFit(o,s))Io(i,t,e,a,s);else if(iH(i,e,o,t)){var l=tH(e,o,t,i);Io(i,t,e,a,s),Ud(i,t,r,a,s),hp(i,t,l,n,r,a,s)}else Ud(i,t,r,a,s),hp(i,t,e,n,r,a,s)}function Io(i,t,e,n,r){n.x=t.settings.margin.left;for(var a=0,s=r;a<s.length;a++){var o=s[a],l=e.cells[o.index];if(!l){n.x+=o.width;continue}i.applyStyles(l.styles),l.x=n.x,l.y=n.y;var c=t.callCellHooks(i,t.hooks.willDrawCell,l,e,o,n);if(c===!1){n.x+=o.width;continue}nH(i,l,n);var u=l.getTextPos();WS(l.text,u.x,u.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},i.getDocument()),t.callCellHooks(i,t.hooks.didDrawCell,l,e,o,n),n.x+=o.width}n.y+=e.height}function nH(i,t,e){var n=t.styles;if(i.getDocument().setFillColor(i.getDocument().getFillColor()),typeof n.lineWidth=="number"){var r=XS(n.lineWidth,n.fillColor);r&&i.rect(t.x,e.y,t.width,t.height,r)}else typeof n.lineWidth=="object"&&(n.fillColor&&i.rect(t.x,e.y,t.width,t.height,"F"),rH(i,t,e,n.lineWidth))}function rH(i,t,e,n){var r,a,s,o;n.top&&(r=e.x,a=e.y,s=e.x+t.width,o=e.y,n.right&&(s+=.5*n.right),n.left&&(r-=.5*n.left),l(n.top,r,a,s,o)),n.bottom&&(r=e.x,a=e.y+t.height,s=e.x+t.width,o=e.y+t.height,n.right&&(s+=.5*n.right),n.left&&(r-=.5*n.left),l(n.bottom,r,a,s,o)),n.left&&(r=e.x,a=e.y,s=e.x,o=e.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,r,a,s,o)),n.right&&(r=e.x+t.width,a=e.y,s=e.x+t.width,o=e.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,r,a,s,o));function l(c,u,h,g,d){i.getDocument().setLineWidth(c),i.getDocument().line(u,h,g,d,"S")}}function nC(i,t,e,n){var r=t.settings.margin.bottom,a=t.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&e)&&(r+=t.getFootHeight(t.columns)),i.pageSize().height-n.y-r}function Ud(i,t,e,n,r,a){r===void 0&&(r=[]),a===void 0&&(a=!1),i.applyStyles(i.userStyles),t.settings.showFoot==="everyPage"&&!a&&t.foot.forEach(function(o){return Io(i,t,o,n,r)}),t.callEndPageHooks(i,n);var s=t.settings.margin;$S(i,t,e,n),rC(i),t.pageNumber++,n.x=s.left,n.y=s.top,e.y=s.top,t.callWillDrawPageHooks(i,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return Io(i,t,o,n,r)}),i.applyStyles(i.userStyles))}function rC(i){var t=i.pageNumber();i.setPage(t+1);var e=i.pageNumber();return e===t?(i.addPage(),!0):!1}function aH(i){i.API.autoTable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],r=JS(this,n),a=tC(this,r);return iC(this,a),this},i.API.lastAutoTable=!1,i.API.autoTableText=function(t,e,n,r){WS(t,e,n,r,this)},i.API.autoTableSetDefaults=function(t){return Hc.setDefaults(t,this),this},i.autoTableSetDefaults=function(t,e){Hc.setDefaults(t,e)},i.API.autoTableHtmlToJson=function(t,e){var n;if(e===void 0&&(e=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=new Hc(this),a=ZS(r,t,window,e,!1),s=a.head,o=a.body,l=((n=s[0])===null||n===void 0?void 0:n.map(function(c){return c.content}))||[];return{columns:l,rows:o,data:o}}}var wx;function Ss(i,t){var e=JS(i,t),n=tC(i,e);iC(i,n)}try{typeof window<"u"&&window&&(yx=window,Sx=yx.jsPDF||((wx=yx.jspdf)===null||wx===void 0?void 0:wx.jsPDF),Sx&&aH(Sx))}catch(i){console.error("Could not apply autoTable plugin",i)}var yx,Sx;var sH=["salesChart"],oH=(i,t)=>t._id;function lH(i,t){i&1&&(f(0,"div",41),ce(1,"div",42),p())}function cH(i,t){if(i&1&&(f(0,"span",59),x(1,"\u{1F4DA} Curso"),p(),f(2,"span",54),x(3),p()),i&2){let e=q().$implicit;S(3),Ve(e.course.title)}}function uH(i,t){if(i&1&&(f(0,"span",60),x(1,"\u{1F3AF} Proyecto"),p(),f(2,"span",54),x(3),p()),i&2){let e=q().$implicit;S(3),Ve(e.project.title)}}function dH(i,t){if(i&1&&(f(0,"tr",49)(1,"td",51),x(2),p(),f(3,"td",52)(4,"div",53),xe(5,cH,4,1)(6,uH,4,1),p()(),f(7,"td",52)(8,"div",54),x(9),p(),f(10,"div",55),x(11),p()(),f(12,"td",52)(13,"span",56),x(14),p()(),f(15,"td",57)(16,"span",58),x(17),p()()()),i&2){let e=t.$implicit,n=q(2);S(2),Re(" ",n.formatDate(e.dateCreated)," "),S(3),ve(e.course?5:e.project?6:-1),S(4),hi("",e.user.name," ",e.user.surname),S(2),Ve(e.user.email),S(3),Re(" ",e.paymentMethod||"N/A"," "),S(3),Ve(n.formatCurrency(e.salePrice))}}function fH(i,t){i&1&&(f(0,"tr")(1,"td",61)(2,"div",62)(3,"span",63),x(4,"\u{1F4ED}"),p(),f(5,"p",64),x(6,"No hay ventas en el per\xEDodo seleccionado"),p()()()())}function hH(i,t){if(i&1){let e=nt();f(0,"div",50)(1,"div",65),x(2),p(),f(3,"div",53)(4,"button",66),ue("click",function(){be(e);let r=q(2);return we(r.currentPage.set(r.currentPage()-1))}),x(5," Anterior "),p(),f(6,"span",67),x(7),p(),f(8,"button",66),ue("click",function(){be(e);let r=q(2);return we(r.currentPage.set(r.currentPage()+1))}),x(9," Siguiente "),p()()()}if(i&2){let e=q(2);S(2),Ha(" Mostrando ",(e.currentPage()-1)*e.itemsPerPage()+1," - ",e.Math.min(e.currentPage()*e.itemsPerPage(),e.filteredSales().length)," de ",e.filteredSales().length," "),S(2),Ce("disabled",e.currentPage()===1),S(3),hi(" ",e.currentPage()," / ",e.totalPages()," "),S(),Ce("disabled",e.currentPage()===e.totalPages())}}function pH(i,t){if(i&1&&(f(0,"div",43)(1,"table",44)(2,"thead",45)(3,"tr")(4,"th",46),x(5,"Fecha"),p(),f(6,"th",46),x(7,"Producto"),p(),f(8,"th",46),x(9,"Cliente"),p(),f(10,"th",46),x(11,"M\xE9todo"),p(),f(12,"th",47),x(13,"Monto"),p()()(),f(14,"tbody",48),zt(15,dH,18,7,"tr",49,oH,!1,fH,7,0,"tr"),p()()(),xe(18,hH,10,7,"div",50)),i&2){let e=q();S(15),Ht(e.paginatedSales()),S(3),ve(e.filteredSales().length>e.itemsPerPage()?18:-1)}}Kh.register(...Y5);var mp=class i{salesChartRef;reportsService=lt($a);chart=null;sales=Ae([]);isLoading=Ae(!1);startDate=Ae("");endDate=Ae("");productType=Ae("");paymentMethod=Ae("");currentPage=Ae(1);itemsPerPage=Ae(20);filteredSales=Ge(()=>{let t=this.sales(),e=this.startDate(),n=this.endDate(),r=this.productType(),a=this.paymentMethod();return e&&(t=t.filter(s=>new Date(s.dateCreated)>=new Date(e))),n&&(t=t.filter(s=>new Date(s.dateCreated)<=new Date(n))),r==="course"?t=t.filter(s=>s.course):r==="project"&&(t=t.filter(s=>s.project)),a&&(t=t.filter(s=>s.paymentMethod===a)),t});paginatedSales=Ge(()=>{let t=(this.currentPage()-1)*this.itemsPerPage(),e=t+this.itemsPerPage();return this.filteredSales().slice(t,e)});totalPages=Ge(()=>Math.ceil(this.filteredSales().length/this.itemsPerPage())||1);totalRevenue=Ge(()=>this.filteredSales().reduce((t,e)=>t+e.salePrice,0));averageTicket=Ge(()=>{let t=this.filteredSales().length;return t>0?this.totalRevenue()/t:0});coursesSales=Ge(()=>this.filteredSales().filter(t=>t.course));projectsSales=Ge(()=>this.filteredSales().filter(t=>t.project));Math=Math;ngOnInit(){this.loadSales()}ngAfterViewInit(){setTimeout(()=>this.renderChart(),100)}async loadSales(){this.isLoading.set(!0);try{let t=await this.reportsService.getSalesReport().toPromise();t&&t.sales&&(this.sales.set(t.sales),setTimeout(()=>this.renderChart(),200))}catch{}finally{this.isLoading.set(!1)}}applyFilters(){this.currentPage.set(1),setTimeout(()=>this.renderChart(),100)}clearFilters(){this.startDate.set(""),this.endDate.set(""),this.productType.set(""),this.paymentMethod.set(""),this.applyFilters()}renderChart(){if(!this.salesChartRef)return;let e=this.salesChartRef.nativeElement.getContext("2d");if(!e)return;this.chart&&this.chart.destroy();let n=this.filteredSales().reduce((s,o)=>{let l=new Date(o.dateCreated).toLocaleDateString("es-ES");return s[l]=(s[l]||0)+o.salePrice,s},{}),r=Object.keys(n).sort((s,o)=>new Date(s.split("/").reverse().join("-")).getTime()-new Date(o.split("/").reverse().join("-")).getTime()),a=r.map(s=>n[s]);this.chart=new Kh(e,{type:"line",data:{labels:r,datasets:[{label:"Ingresos (MXN)",data:a,borderColor:"rgb(132, 204, 22)",backgroundColor:"rgba(132, 204, 22, 0.1)",tension:.4,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:s=>`MXN ${s.parsed.y?.toFixed(2)||"0.00"}`}}},scales:{y:{beginAtZero:!0,ticks:{color:"rgb(148, 163, 184)"},grid:{color:"rgba(148, 163, 184, 0.1)"}},x:{ticks:{color:"rgb(148, 163, 184)"},grid:{color:"rgba(148, 163, 184, 0.1)"}}}}})}exportToExcel(){let t=this.filteredSales().map(r=>({Fecha:this.formatDate(r.dateCreated),Tipo:r.course?"Curso":"Proyecto",Producto:r.course?.title||r.project?.title,Cliente:`${r.user.name} ${r.user.surname}`,Email:r.user.email,M\u00E9todo:r.paymentMethod||"N/A","Monto (MXN)":r.salePrice})),e=Yn.json_to_sheet(t),n=Yn.book_new();Yn.book_append_sheet(n,e,"Ventas"),Ws(n,`ventas_${new Date().toISOString().split("T")[0]}.xlsx`)}exportToPDF(){let t=new _t;t.text("Reporte de Ventas",14,20),t.setFontSize(10),t.text(`Generado: ${new Date().toLocaleString("es-ES")}`,14,28),t.text(`Total: ${this.formatCurrency(this.totalRevenue())}`,14,34);let e=this.filteredSales().map(n=>[this.formatDate(n.dateCreated),n.course?.title||n.project?.title||"N/A",`${n.user.name} ${n.user.surname}`,this.formatCurrency(n.salePrice)]);Ss(t,{head:[["Fecha","Producto","Cliente","Monto"]],body:e,startY:40,styles:{fontSize:8}}),t.save(`ventas_${new Date().toISOString().split("T")[0]}.pdf`)}formatCurrency(t){return`MXN ${t.toFixed(2)}`}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-sales-report"]],viewQuery:function(e,n){if(e&1&&yf(sH,5),e&2){let r;Sf(r=Cf())&&(n.salesChartRef=r.first)}},decls:111,vars:11,consts:[["salesChart",""],[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-green-500/10","to-green-600/5","border","border-green-500/20","rounded-xl","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-green-400","font-medium"],[1,"text-3xl","font-bold","text-white","mt-2"],[1,"text-xs","text-slate-400","mt-1"],[1,"w-12","h-12","bg-green-500/20","rounded-lg","flex","items-center","justify-center"],[1,"text-2xl"],[1,"bg-gradient-to-br","from-blue-500/10","to-blue-600/5","border","border-blue-500/20","rounded-xl","p-6"],[1,"text-sm","text-blue-400","font-medium"],[1,"w-12","h-12","bg-blue-500/20","rounded-lg","flex","items-center","justify-center"],[1,"bg-gradient-to-br","from-purple-500/10","to-purple-600/5","border","border-purple-500/20","rounded-xl","p-6"],[1,"text-sm","text-purple-400","font-medium"],[1,"w-12","h-12","bg-purple-500/20","rounded-lg","flex","items-center","justify-center"],[1,"bg-gradient-to-br","from-orange-500/10","to-orange-600/5","border","border-orange-500/20","rounded-xl","p-6"],[1,"text-sm","text-orange-400","font-medium"],[1,"text-xl","font-bold","text-white","mt-2"],[1,"w-12","h-12","bg-orange-500/20","rounded-lg","flex","items-center","justify-center"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-white","mb-4","flex","items-center","gap-2"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","date",1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500","focus:border-transparent",3,"ngModelChange","ngModel"],["value",""],["value","course"],["value","project"],["value","paypal"],["value","wallet"],[1,"flex","items-center","gap-3","mt-4"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"relative",2,"height","400px"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","overflow-hidden"],[1,"p-6","border-b","border-white/10"],[1,"text-lg","font-semibold","text-white","flex","items-center","gap-2"],[1,"text-sm","font-normal","text-slate-400"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-900/50"],[1,"px-6","py-4","text-left","text-xs","font-semibold","text-slate-300","uppercase","tracking-wider"],[1,"px-6","py-4","text-right","text-xs","font-semibold","text-slate-300","uppercase","tracking-wider"],[1,"divide-y","divide-white/5"],[1,"hover:bg-white/5","transition-colors"],[1,"px-6","py-4","border-t","border-white/10","flex","items-center","justify-between"],[1,"px-6","py-4","text-sm","text-slate-300"],[1,"px-6","py-4"],[1,"flex","items-center","gap-2"],[1,"text-sm","text-white"],[1,"text-xs","text-slate-400"],[1,"px-2","py-1","bg-slate-700","text-slate-300","text-xs","rounded-full"],[1,"px-6","py-4","text-right"],[1,"text-sm","font-semibold","text-green-400"],[1,"px-2","py-1","bg-blue-500/20","text-blue-300","text-xs","rounded-full"],[1,"px-2","py-1","bg-purple-500/20","text-purple-300","text-xs","rounded-full"],["colspan","5",1,"px-6","py-12","text-center","text-slate-400"],[1,"flex","flex-col","items-center","gap-3"],[1,"text-4xl"],[1,"text-lg"],[1,"text-sm","text-slate-400"],[1,"px-3","py-1.5","bg-slate-700","hover:bg-slate-600","disabled:opacity-50","disabled:cursor-not-allowed","text-white","rounded-lg","text-sm","transition-colors",3,"click","disabled"],[1,"px-4","py-1.5","bg-slate-800","text-white","rounded-lg","text-sm"]],template:function(e,n){if(e&1){let r=nt();f(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div")(5,"p",5),x(6,"Ventas Totales"),p(),f(7,"p",6),x(8),p(),f(9,"p",7),x(10,"En el per\xEDodo seleccionado"),p()(),f(11,"div",8)(12,"span",9),x(13,"\u{1F6D2}"),p()()()(),f(14,"div",10)(15,"div",4)(16,"div")(17,"p",11),x(18,"Ingresos Brutos"),p(),f(19,"p",6),x(20),p(),f(21,"p",7),x(22,"Antes de comisiones"),p()(),f(23,"div",12)(24,"span",9),x(25,"\u{1F4B0}"),p()()()(),f(26,"div",13)(27,"div",4)(28,"div")(29,"p",14),x(30,"Ticket Promedio"),p(),f(31,"p",6),x(32),p(),f(33,"p",7),x(34,"Por transacci\xF3n"),p()(),f(35,"div",15)(36,"span",9),x(37,"\u{1F4C8}"),p()()()(),f(38,"div",16)(39,"div",4)(40,"div")(41,"p",17),x(42,"Cursos vs Proyectos"),p(),f(43,"p",18),x(44),p(),f(45,"p",7),x(46,"Distribuci\xF3n de ventas"),p()(),f(47,"div",19)(48,"span",9),x(49,"\u{1F4CA}"),p()()()()(),f(50,"div",20)(51,"h3",21)(52,"span"),x(53,"\u{1F50D}"),p(),x(54," Filtros Avanzados "),p(),f(55,"div",22)(56,"div")(57,"label",23),x(58,"Fecha Inicio"),p(),f(59,"input",24),ue("ngModelChange",function(s){return be(r),n.startDate.set(s),we(n.applyFilters())}),p()(),f(60,"div")(61,"label",23),x(62,"Fecha Fin"),p(),f(63,"input",24),ue("ngModelChange",function(s){return be(r),n.endDate.set(s),we(n.applyFilters())}),p()(),f(64,"div")(65,"label",23),x(66,"Tipo de Producto"),p(),f(67,"select",25),ue("ngModelChange",function(s){return be(r),n.productType.set(s),we(n.applyFilters())}),f(68,"option",26),x(69,"Todos"),p(),f(70,"option",27),x(71,"Cursos"),p(),f(72,"option",28),x(73,"Proyectos"),p()()(),f(74,"div")(75,"label",23),x(76,"M\xE9todo de Pago"),p(),f(77,"select",25),ue("ngModelChange",function(s){return be(r),n.paymentMethod.set(s),we(n.applyFilters())}),f(78,"option",26),x(79,"Todos"),p(),f(80,"option",29),x(81,"PayPal"),p(),f(82,"option",30),x(83,"Billetera"),p()()()(),f(84,"div",31)(85,"button",32),ue("click",function(){return be(r),we(n.clearFilters())}),x(86," \u{1F5D1}\uFE0F Limpiar Filtros "),p(),f(87,"button",33),ue("click",function(){return be(r),we(n.exportToExcel())}),f(88,"span"),x(89,"\u{1F4CA}"),p(),x(90," Exportar Excel "),p(),f(91,"button",34),ue("click",function(){return be(r),we(n.exportToPDF())}),f(92,"span"),x(93,"\u{1F4C4}"),p(),x(94," Exportar PDF "),p()()(),f(95,"div",20)(96,"h3",35),x(97,"\u{1F4C8} Tendencia de Ventas"),p(),f(98,"div",36),ce(99,"canvas",null,0),p()(),f(101,"div",37)(102,"div",38)(103,"h3",39)(104,"span"),x(105,"\u{1F4CB}"),p(),x(106," Detalle de Ventas "),f(107,"span",40),x(108),p()()(),xe(109,lH,2,0,"div",41)(110,pH,19,2),p()()}e&2&&(S(8),Ve(n.filteredSales().length),S(12),Ve(n.formatCurrency(n.totalRevenue())),S(12),Ve(n.formatCurrency(n.averageTicket())),S(12),hi(" ",n.coursesSales().length," / ",n.projectsSales().length," "),S(15),Ce("ngModel",n.startDate()),S(4),Ce("ngModel",n.endDate()),S(4),Ce("ngModel",n.productType()),S(10),Ce("ngModel",n.paymentMethod()),S(31),Re("(",n.filteredSales().length," registros)"),S(),ve(n.isLoading()?109:110))},dependencies:[mn,Hn,Wn,ki,hr,wi,zn],encapsulation:2})};var mH=(i,t)=>t._id;function gH(i,t){i&1&&(f(0,"div",31),ce(1,"div",32),p())}function xH(i,t){if(i&1&&(f(0,"tr",40)(1,"td",42)(2,"div",43),x(3),p(),f(4,"div",44),x(5),p()(),f(6,"td",42)(7,"div",43),x(8),p()(),f(9,"td",45),x(10),p(),f(11,"td",46)(12,"span",47),x(13),p()(),f(14,"td",48)(15,"span",49),x(16),p()(),f(17,"td",42)(18,"div",50),x(19),p(),f(20,"div",51),x(21),p()()()),i&2){let e=t.$implicit,n=q(2);S(3),hi("",e.user.name," ",e.user.surname),S(2),Ve(e.user.email),S(3),Re(" ",(e.course==null?null:e.course.title)||(e.project==null?null:e.project.title)||"N/A"," "),S(2),Re(" ",n.formatDate(e.requestedAt)," "),S(3),Ve(n.formatCurrency(e.refundAmount)),S(2),Ce("ngClass",n.getStatusClass(e.status)),S(),Re(" ",n.getStatusText(e.status)," "),S(3),Ve(e.reason.type),S(2),Ve(e.reason.description)}}function vH(i,t){i&1&&(f(0,"tr")(1,"td",52)(2,"div",53)(3,"span",54),x(4,"\u{1F4ED}"),p(),f(5,"p",55),x(6,"No hay reembolsos para mostrar"),p()()()())}function _H(i,t){if(i&1){let e=nt();f(0,"div",41)(1,"div",56),x(2),p(),f(3,"div",57)(4,"button",58),ue("click",function(){be(e);let r=q(2);return we(r.currentPage.set(r.currentPage()-1))}),x(5," Anterior "),p(),f(6,"span",59),x(7),p(),f(8,"button",58),ue("click",function(){be(e);let r=q(2);return we(r.currentPage.set(r.currentPage()+1))}),x(9," Siguiente "),p()()()}if(i&2){let e=q(2);S(2),Ha(" Mostrando ",(e.currentPage()-1)*e.itemsPerPage()+1," - ",e.Math.min(e.currentPage()*e.itemsPerPage(),e.filteredRefunds().length)," de ",e.filteredRefunds().length," "),S(2),Ce("disabled",e.currentPage()===1),S(3),hi(" ",e.currentPage()," / ",e.totalPages()," "),S(),Ce("disabled",e.currentPage()===e.totalPages())}}function bH(i,t){if(i&1&&(f(0,"div",33)(1,"table",34)(2,"thead",35)(3,"tr")(4,"th",36),x(5,"Usuario"),p(),f(6,"th",36),x(7,"Producto"),p(),f(8,"th",36),x(9,"Fecha"),p(),f(10,"th",37),x(11,"Monto"),p(),f(12,"th",38),x(13,"Estado"),p(),f(14,"th",36),x(15,"Motivo"),p()()(),f(16,"tbody",39),zt(17,xH,22,10,"tr",40,mH,!1,vH,7,0,"tr"),p()()(),xe(20,_H,10,7,"div",41)),i&2){let e=q();S(17),Ht(e.paginatedRefunds()),S(3),ve(e.filteredRefunds().length>e.itemsPerPage()?20:-1)}}var gp=class i{reportsService=lt($a);refunds=Ae([]);isLoading=Ae(!1);startDate="";endDate="";statusFilter="";currentPage=Ae(1);itemsPerPage=Ae(20);filteredRefunds=Ge(()=>{let t=this.refunds();return this.startDate&&(t=t.filter(e=>new Date(e.requestedAt)>=new Date(this.startDate))),this.endDate&&(t=t.filter(e=>new Date(e.requestedAt)<=new Date(this.endDate))),this.statusFilter&&(t=t.filter(e=>e.status===this.statusFilter)),t});paginatedRefunds=Ge(()=>{let t=(this.currentPage()-1)*this.itemsPerPage();return this.filteredRefunds().slice(t,t+this.itemsPerPage())});totalPages=Ge(()=>Math.ceil(this.filteredRefunds().length/this.itemsPerPage())||1);totalAmount=Ge(()=>this.filteredRefunds().reduce((t,e)=>t+e.refundAmount,0));pendingRefunds=Ge(()=>this.filteredRefunds().filter(t=>t.status==="pending"));completedRefunds=Ge(()=>this.filteredRefunds().filter(t=>t.status==="completed"));Math=Math;ngOnInit(){this.loadRefunds()}async loadRefunds(){this.isLoading.set(!0);try{let t=await this.reportsService.getRefundsReport().toPromise();t&&t.refunds&&this.refunds.set(t.refunds)}catch{}finally{this.isLoading.set(!1)}}applyFilters(){this.currentPage.set(1)}clearFilters(){this.startDate="",this.endDate="",this.statusFilter="",this.applyFilters()}exportToExcel(){let t=this.filteredRefunds().map(r=>({Usuario:`${r.user.name} ${r.user.surname}`,Email:r.user.email,Producto:r.course?.title||r.project?.title||"N/A","Fecha Solicitud":this.formatDate(r.requestedAt),"Monto Original (MXN)":r.originalAmount,"Monto Reembolsado (MXN)":r.refundAmount,Estado:this.getStatusText(r.status),Motivo:r.reason.type,Descripci\u00F3n:r.reason.description})),e=Yn.json_to_sheet(t),n=Yn.book_new();Yn.book_append_sheet(n,e,"Reembolsos"),Ws(n,`reembolsos_${new Date().toISOString().split("T")[0]}.xlsx`)}exportToPDF(){let t=new _t;t.text("Reporte de Reembolsos",14,20),t.setFontSize(10),t.text(`Generado: ${new Date().toLocaleString("es-ES")}`,14,28);let e=[`Total Reembolsos: ${this.filteredRefunds().length}`,`Monto Total: ${this.formatCurrency(this.totalAmount())}`,`Pendientes: ${this.pendingRefunds().length}`];t.text(e,14,34);let n=this.filteredRefunds().map(r=>[`${r.user.name} ${r.user.surname}`,r.course?.title||r.project?.title||"N/A",this.formatDate(r.requestedAt),this.formatCurrency(r.refundAmount),this.getStatusText(r.status),r.reason.type]);Ss(t,{head:[["Usuario","Producto","Fecha","Monto","Estado","Motivo"]],body:n,startY:45,styles:{fontSize:8},headStyles:{fillColor:[132,204,22]}}),t.save(`reembolsos_${new Date().toISOString().split("T")[0]}.pdf`)}getStatusClass(t){return{pending:"bg-yellow-500/20 text-yellow-300",approved:"bg-blue-500/20 text-blue-300",completed:"bg-green-500/20 text-green-300",rejected:"bg-red-500/20 text-red-300"}[t]||"bg-slate-500/20 text-slate-300"}getStatusText(t){return{pending:"Pendiente",approved:"Aprobado",completed:"Completado",rejected:"Rechazado"}[t]||t}formatCurrency(t){return`MXN ${t.toFixed(2)}`}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-refunds-report"]],decls:81,vars:9,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-red-500/10","to-red-600/5","border","border-red-500/20","rounded-xl","p-6"],[1,"text-sm","text-red-400","font-medium"],[1,"text-3xl","font-bold","text-white","mt-2"],[1,"text-xs","text-slate-400","mt-1"],[1,"bg-gradient-to-br","from-orange-500/10","to-orange-600/5","border","border-orange-500/20","rounded-xl","p-6"],[1,"text-sm","text-orange-400","font-medium"],[1,"bg-gradient-to-br","from-yellow-500/10","to-yellow-600/5","border","border-yellow-500/20","rounded-xl","p-6"],[1,"text-sm","text-yellow-400","font-medium"],[1,"bg-gradient-to-br","from-green-500/10","to-green-600/5","border","border-green-500/20","rounded-xl","p-6"],[1,"text-sm","text-green-400","font-medium"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-white","mb-4","flex","items-center","gap-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","date",1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500",3,"ngModelChange","change","ngModel"],[1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500",3,"ngModelChange","change","ngModel"],["value",""],["value","pending"],["value","approved"],["value","completed"],["value","rejected"],[1,"flex","items-center","gap-3","mt-4"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","overflow-hidden"],[1,"p-6","border-b","border-white/10"],[1,"text-lg","font-semibold","text-white","flex","items-center","gap-2"],[1,"text-sm","font-normal","text-slate-400"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-900/50"],[1,"px-6","py-4","text-left","text-xs","font-semibold","text-slate-300","uppercase"],[1,"px-6","py-4","text-right","text-xs","font-semibold","text-slate-300","uppercase"],[1,"px-6","py-4","text-center","text-xs","font-semibold","text-slate-300","uppercase"],[1,"divide-y","divide-white/5"],[1,"hover:bg-white/5","transition-colors"],[1,"px-6","py-4","border-t","border-white/10","flex","items-center","justify-between"],[1,"px-6","py-4"],[1,"text-sm","text-white"],[1,"text-xs","text-slate-400"],[1,"px-6","py-4","text-sm","text-slate-300"],[1,"px-6","py-4","text-right"],[1,"text-sm","font-semibold","text-red-400"],[1,"px-6","py-4","text-center"],[1,"px-2","py-1","text-xs","rounded-full",3,"ngClass"],[1,"text-sm","text-slate-300"],[1,"text-xs","text-slate-500","truncate","max-w-xs"],["colspan","6",1,"px-6","py-12","text-center","text-slate-400"],[1,"flex","flex-col","items-center","gap-3"],[1,"text-4xl"],[1,"text-lg"],[1,"text-sm","text-slate-400"],[1,"flex","items-center","gap-2"],[1,"px-3","py-1.5","bg-slate-700","hover:bg-slate-600","disabled:opacity-50","text-white","rounded-lg","text-sm",3,"click","disabled"],[1,"px-4","py-1.5","bg-slate-800","text-white","rounded-lg","text-sm"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"p",3),x(5,"Total Reembolsos"),p(),f(6,"p",4),x(7),p(),f(8,"p",5),x(9,"Solicitudes totales"),p()()(),f(10,"div",6)(11,"div")(12,"p",7),x(13,"Monto Total"),p(),f(14,"p",4),x(15),p(),f(16,"p",5),x(17,"Dinero reembolsado"),p()()(),f(18,"div",8)(19,"div")(20,"p",9),x(21,"Pendientes"),p(),f(22,"p",4),x(23),p(),f(24,"p",5),x(25,"Por revisar"),p()()(),f(26,"div",10)(27,"div")(28,"p",11),x(29,"Completados"),p(),f(30,"p",4),x(31),p(),f(32,"p",5),x(33,"Finalizados"),p()()()(),f(34,"div",12)(35,"h3",13)(36,"span"),x(37,"\u{1F50D}"),p(),x(38," Filtros "),p(),f(39,"div",14)(40,"div")(41,"label",15),x(42,"Fecha Inicio"),p(),f(43,"input",16),nr("ngModelChange",function(a){return ir(n.startDate,a)||(n.startDate=a),a}),ue("change",function(){return n.applyFilters()}),p()(),f(44,"div")(45,"label",15),x(46,"Fecha Fin"),p(),f(47,"input",16),nr("ngModelChange",function(a){return ir(n.endDate,a)||(n.endDate=a),a}),ue("change",function(){return n.applyFilters()}),p()(),f(48,"div")(49,"label",15),x(50,"Estado"),p(),f(51,"select",17),nr("ngModelChange",function(a){return ir(n.statusFilter,a)||(n.statusFilter=a),a}),ue("change",function(){return n.applyFilters()}),f(52,"option",18),x(53,"Todos"),p(),f(54,"option",19),x(55,"Pendiente"),p(),f(56,"option",20),x(57,"Aprobado"),p(),f(58,"option",21),x(59,"Completado"),p(),f(60,"option",22),x(61,"Rechazado"),p()()()(),f(62,"div",23)(63,"button",24),ue("click",function(){return n.clearFilters()}),x(64," \u{1F5D1}\uFE0F Limpiar Filtros "),p(),f(65,"button",25),ue("click",function(){return n.exportToExcel()}),x(66," \u{1F4CA} Exportar Excel "),p(),f(67,"button",26),ue("click",function(){return n.exportToPDF()}),f(68,"span"),x(69,"\u{1F4C4}"),p(),x(70," Exportar PDF "),p()()(),f(71,"div",27)(72,"div",28)(73,"h3",29)(74,"span"),x(75,"\u{1F4CB}"),p(),x(76," Solicitudes de Reembolso "),f(77,"span",30),x(78),p()()(),xe(79,gH,2,0,"div",31)(80,bH,21,2),p()()),e&2&&(S(7),Ve(n.filteredRefunds().length),S(8),Ve(n.formatCurrency(n.totalAmount())),S(8),Ve(n.pendingRefunds().length),S(8),Ve(n.completedRefunds().length),S(12),tr("ngModel",n.startDate),S(4),tr("ngModel",n.endDate),S(4),tr("ngModel",n.statusFilter),S(27),Re("(",n.filteredRefunds().length," registros)"),S(),ve(n.isLoading()?79:80))},dependencies:[yn,Ds,mn,Hn,Wn,ki,hr,wi,zn],encapsulation:2})};var wH=(i,t)=>t._id;function yH(i,t){i&1&&(f(0,"div",32),ce(1,"div",33),p())}function SH(i,t){if(i&1&&(f(0,"tr",41)(1,"td",43)(2,"div",44),x(3),p(),f(4,"div",45),x(5),p()(),f(6,"td",46),x(7),p(),f(8,"td",47)(9,"span",48),x(10),p()(),f(11,"td",47)(12,"span",49),x(13),p()(),f(14,"td",47)(15,"span",50),x(16),p()(),f(17,"td",51)(18,"span",52),x(19),p()()()),i&2){let e=t.$implicit,n=q(2);S(3),hi("",e.name," ",e.surname),S(2),Ve(e.email),S(2),Re(" ",n.formatDate(e.registrationDate)," "),S(3),Re(" ",e.totalPurchases," "),S(3),Re(" ",e.coursesEnrolled||0," "),S(3),Re(" ",e.projectsEnrolled||0," "),S(3),Re(" ",n.formatCurrency(e.totalSpent)," ")}}function CH(i,t){i&1&&(f(0,"tr")(1,"td",53)(2,"div",54)(3,"span",55),x(4,"\u{1F4ED}"),p(),f(5,"p",56),x(6,"No se encontraron estudiantes"),p()()()())}function EH(i,t){if(i&1){let e=nt();f(0,"div",42)(1,"div",57),x(2),p(),f(3,"div",58)(4,"button",59),ue("click",function(){be(e);let r=q(2);return we(r.currentPage.set(r.currentPage()-1))}),x(5," Anterior "),p(),f(6,"span",60),x(7),p(),f(8,"button",59),ue("click",function(){be(e);let r=q(2);return we(r.currentPage.set(r.currentPage()+1))}),x(9," Siguiente "),p()()()}if(i&2){let e=q(2);S(2),Ha(" Mostrando ",(e.currentPage()-1)*e.itemsPerPage()+1," - ",e.Math.min(e.currentPage()*e.itemsPerPage(),e.filteredStudents().length)," de ",e.filteredStudents().length," "),S(2),Ce("disabled",e.currentPage()===1),S(3),hi(" ",e.currentPage()," / ",e.totalPages()," "),S(),Ce("disabled",e.currentPage()===e.totalPages())}}function kH(i,t){if(i&1&&(f(0,"div",34)(1,"table",35)(2,"thead",36)(3,"tr")(4,"th",37),x(5,"Estudiante"),p(),f(6,"th",37),x(7,"Fecha Registro"),p(),f(8,"th",38),x(9,"Compras"),p(),f(10,"th",38),x(11,"Cursos"),p(),f(12,"th",38),x(13,"Proyectos"),p(),f(14,"th",39),x(15,"Total Gastado"),p()()(),f(16,"tbody",40),zt(17,SH,20,8,"tr",41,wH,!1,CH,7,0,"tr"),p()()(),xe(20,EH,10,7,"div",42)),i&2){let e=q();S(17),Ht(e.paginatedStudents()),S(3),ve(e.filteredStudents().length>e.itemsPerPage()?20:-1)}}var xp=class i{reportsService=lt($a);students=Ae([]);isLoading=Ae(!1);startDate="";endDate="";searchTerm="";currentPage=Ae(1);itemsPerPage=Ae(20);filteredStudents=Ge(()=>{let t=this.students();if(this.startDate&&(t=t.filter(e=>new Date(e.registrationDate)>=new Date(this.startDate))),this.endDate&&(t=t.filter(e=>new Date(e.registrationDate)<=new Date(this.endDate))),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(n=>n.name.toLowerCase().includes(e)||n.surname.toLowerCase().includes(e)||n.email.toLowerCase().includes(e))}return t});paginatedStudents=Ge(()=>{let t=(this.currentPage()-1)*this.itemsPerPage();return this.filteredStudents().slice(t,t+this.itemsPerPage())});totalPages=Ge(()=>Math.ceil(this.filteredStudents().length/this.itemsPerPage())||1);totalSpent=Ge(()=>this.filteredStudents().reduce((t,e)=>t+e.totalSpent,0));totalPurchases=Ge(()=>this.filteredStudents().reduce((t,e)=>t+e.totalPurchases,0));averageSpent=Ge(()=>{let t=this.filteredStudents().length;return t>0?this.totalSpent()/t:0});Math=Math;ngOnInit(){this.loadStudents()}async loadStudents(){this.isLoading.set(!0);try{let t=await this.reportsService.getStudentsReport().toPromise();t&&t.students&&this.students.set(t.students)}catch{}finally{this.isLoading.set(!1)}}applyFilters(){this.currentPage.set(1)}clearFilters(){this.startDate="",this.endDate="",this.searchTerm="",this.applyFilters()}exportToExcel(){let t=this.filteredStudents().map(r=>({Nombre:`${r.name} ${r.surname}`,Email:r.email,"Fecha Registro":this.formatDate(r.registrationDate),Compras:r.totalPurchases,Cursos:r.coursesEnrolled||0,Proyectos:r.projectsEnrolled||0,"Total Gastado (MXN)":r.totalSpent})),e=Yn.json_to_sheet(t),n=Yn.book_new();Yn.book_append_sheet(n,e,"Estudiantes"),Ws(n,`estudiantes_${new Date().toISOString().split("T")[0]}.xlsx`)}exportToPDF(){let t=new _t;t.text("Reporte de Estudiantes",14,20),t.setFontSize(10),t.text(`Generado: ${new Date().toLocaleString("es-ES")}`,14,28);let e=[`Total Estudiantes: ${this.filteredStudents().length}`,`Gasto Total: ${this.formatCurrency(this.totalSpent())}`,`Compras Totales: ${this.totalPurchases()}`];t.text(e,14,34);let n=this.filteredStudents().map(r=>[`${r.name} ${r.surname}`,r.email,this.formatDate(r.registrationDate),r.totalPurchases,r.coursesEnrolled||0,r.projectsEnrolled||0,this.formatCurrency(r.totalSpent)]);Ss(t,{head:[["Estudiante","Email","Registro","Compras","Cursos","Proyectos","Gasto"]],body:n,startY:45,styles:{fontSize:8},headStyles:{fillColor:[132,204,22]}}),t.save(`estudiantes_${new Date().toISOString().split("T")[0]}.pdf`)}formatCurrency(t){return`MXN ${t.toFixed(2)}`}formatDate(t){return new Date(t).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-students-report"]],decls:87,vars:9,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-blue-500/10","to-blue-600/5","border","border-blue-500/20","rounded-xl","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-blue-400","font-medium"],[1,"text-3xl","font-bold","text-white","mt-2"],[1,"text-xs","text-slate-400","mt-1"],[1,"w-12","h-12","bg-blue-500/20","rounded-lg","flex","items-center","justify-center"],[1,"text-2xl"],[1,"bg-gradient-to-br","from-green-500/10","to-green-600/5","border","border-green-500/20","rounded-xl","p-6"],[1,"text-sm","text-green-400","font-medium"],[1,"w-12","h-12","bg-green-500/20","rounded-lg","flex","items-center","justify-center"],[1,"bg-gradient-to-br","from-purple-500/10","to-purple-600/5","border","border-purple-500/20","rounded-xl","p-6"],[1,"text-sm","text-purple-400","font-medium"],[1,"w-12","h-12","bg-purple-500/20","rounded-lg","flex","items-center","justify-center"],[1,"bg-gradient-to-br","from-orange-500/10","to-orange-600/5","border","border-orange-500/20","rounded-xl","p-6"],[1,"text-sm","text-orange-400","font-medium"],[1,"w-12","h-12","bg-orange-500/20","rounded-lg","flex","items-center","justify-center"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-white","mb-4","flex","items-center","gap-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","date",1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500",3,"ngModelChange","change","ngModel"],["type","text","placeholder","Nombre o email...",1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","gap-3","mt-4"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","overflow-hidden"],[1,"p-6","border-b","border-white/10"],[1,"text-lg","font-semibold","text-white","flex","items-center","gap-2"],[1,"text-sm","font-normal","text-slate-400"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-900/50"],[1,"px-6","py-4","text-left","text-xs","font-semibold","text-slate-300","uppercase"],[1,"px-6","py-4","text-center","text-xs","font-semibold","text-slate-300","uppercase"],[1,"px-6","py-4","text-right","text-xs","font-semibold","text-slate-300","uppercase"],[1,"divide-y","divide-white/5"],[1,"hover:bg-white/5","transition-colors"],[1,"px-6","py-4","border-t","border-white/10","flex","items-center","justify-between"],[1,"px-6","py-4"],[1,"text-sm","text-white"],[1,"text-xs","text-slate-400"],[1,"px-6","py-4","text-sm","text-slate-300"],[1,"px-6","py-4","text-center"],[1,"px-2","py-1","bg-blue-500/20","text-blue-300","text-xs","rounded-full"],[1,"px-2","py-1","bg-purple-500/20","text-purple-300","text-xs","rounded-full"],[1,"px-2","py-1","bg-orange-500/20","text-orange-300","text-xs","rounded-full"],[1,"px-6","py-4","text-right"],[1,"text-sm","font-semibold","text-green-400"],["colspan","6",1,"px-6","py-12","text-center","text-slate-400"],[1,"flex","flex-col","items-center","gap-3"],[1,"text-4xl"],[1,"text-lg"],[1,"text-sm","text-slate-400"],[1,"flex","items-center","gap-2"],[1,"px-3","py-1.5","bg-slate-700","hover:bg-slate-600","disabled:opacity-50","text-white","rounded-lg","text-sm",3,"click","disabled"],[1,"px-4","py-1.5","bg-slate-800","text-white","rounded-lg","text-sm"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"p",4),x(6,"Total Estudiantes"),p(),f(7,"p",5),x(8),p(),f(9,"p",6),x(10,"Registrados"),p()(),f(11,"div",7)(12,"span",8),x(13,"\u{1F393}"),p()()()(),f(14,"div",9)(15,"div",3)(16,"div")(17,"p",10),x(18,"Gasto Total"),p(),f(19,"p",5),x(20),p(),f(21,"p",6),x(22,"Por estudiantes"),p()(),f(23,"div",11)(24,"span",8),x(25,"\u{1F4B0}"),p()()()(),f(26,"div",12)(27,"div",3)(28,"div")(29,"p",13),x(30,"Compras Totales"),p(),f(31,"p",5),x(32),p(),f(33,"p",6),x(34,"Transacciones"),p()(),f(35,"div",14)(36,"span",8),x(37,"\u{1F6D2}"),p()()()(),f(38,"div",15)(39,"div",3)(40,"div")(41,"p",16),x(42,"Promedio por Estudiante"),p(),f(43,"p",5),x(44),p(),f(45,"p",6),x(46,"Gasto medio"),p()(),f(47,"div",17)(48,"span",8),x(49,"\u{1F4CA}"),p()()()()(),f(50,"div",18)(51,"h3",19)(52,"span"),x(53,"\u{1F50D}"),p(),x(54," Filtros "),p(),f(55,"div",20)(56,"div")(57,"label",21),x(58,"Fecha Inicio"),p(),f(59,"input",22),nr("ngModelChange",function(a){return ir(n.startDate,a)||(n.startDate=a),a}),ue("change",function(){return n.applyFilters()}),p()(),f(60,"div")(61,"label",21),x(62,"Fecha Fin"),p(),f(63,"input",22),nr("ngModelChange",function(a){return ir(n.endDate,a)||(n.endDate=a),a}),ue("change",function(){return n.applyFilters()}),p()(),f(64,"div")(65,"label",21),x(66,"Buscar"),p(),f(67,"input",23),nr("ngModelChange",function(a){return ir(n.searchTerm,a)||(n.searchTerm=a),a}),ue("ngModelChange",function(){return n.applyFilters()}),p()()(),f(68,"div",24)(69,"button",25),ue("click",function(){return n.clearFilters()}),x(70," \u{1F5D1}\uFE0F Limpiar Filtros "),p(),f(71,"button",26),ue("click",function(){return n.exportToExcel()}),x(72," \u{1F4CA} Exportar Excel "),p(),f(73,"button",27),ue("click",function(){return n.exportToPDF()}),f(74,"span"),x(75,"\u{1F4C4}"),p(),x(76," Exportar PDF "),p()()(),f(77,"div",28)(78,"div",29)(79,"h3",30)(80,"span"),x(81,"\u{1F4CB}"),p(),x(82," Listado de Estudiantes "),f(83,"span",31),x(84),p()()(),xe(85,yH,2,0,"div",32)(86,kH,21,2),p()()),e&2&&(S(8),Ve(n.filteredStudents().length),S(12),Ve(n.formatCurrency(n.totalSpent())),S(12),Ve(n.totalPurchases()),S(12),Ve(n.formatCurrency(n.averageSpent())),S(15),tr("ngModel",n.startDate),S(4),tr("ngModel",n.endDate),S(4),tr("ngModel",n.searchTerm),S(17),Re("(",n.filteredStudents().length," registros)"),S(),ve(n.isLoading()?85:86))},dependencies:[mn,ki,wi,zn],encapsulation:2})};var TH=(i,t)=>({"bg-blue-500/20 text-blue-300":i,"bg-purple-500/20 text-purple-300":t}),AH=(i,t)=>t._id;function FH(i,t){if(i&1&&(f(0,"tr",38)(1,"td",39)(2,"span",40),x(3),p()(),f(4,"td",41),x(5),p(),f(6,"td",42),x(7),p(),f(8,"td",43),x(9),p(),f(10,"td",44),x(11),p(),f(12,"td",45)(13,"div",46)(14,"span",47),x(15,"\u2B50"),p(),f(16,"span",48),x(17),p()()()()),i&2){let e=t.$implicit;S(2),Ce("ngClass",Fs(7,TH,e.type==="course",e.type==="project")),S(),Re(" ",e.type==="course"?"\u{1F4DA} Curso":"\u{1F3AF} Proyecto"," "),S(2),Ve(e.title),S(2),Ve(e.instructor),S(2),Ve(e.totalSales),S(2),Re(" $",e.totalRevenue.toFixed(2)," "),S(6),Ve((e.averageRating||0).toFixed(1))}}function DH(i,t){i&1&&(f(0,"tr")(1,"td",49),x(2," \u{1F4ED} No hay productos "),p()())}var vp=class i{reportsService=lt($a);products=Ae([]);isLoading=Ae(!1);productType="";sortBy="revenue";searchTerm="";currentPage=Ae(1);itemsPerPage=Ae(20);filteredProducts=Ge(()=>{let t=this.products();if(this.productType&&(t=t.filter(e=>e.type===this.productType)),this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(n=>n.title.toLowerCase().includes(e)||n.category.toLowerCase().includes(e)||n.instructor.toLowerCase().includes(e))}return this.sortBy==="revenue"?t=t.sort((e,n)=>n.totalRevenue-e.totalRevenue):this.sortBy==="sales"?t=t.sort((e,n)=>n.totalSales-e.totalSales):this.sortBy==="rating"?t=t.sort((e,n)=>(n.averageRating||0)-(e.averageRating||0)):this.sortBy==="recent"&&(t=t.sort((e,n)=>new Date(n.createdAt).getTime()-new Date(e.createdAt).getTime())),t});paginatedProducts=Ge(()=>{let t=(this.currentPage()-1)*this.itemsPerPage();return this.filteredProducts().slice(t,t+this.itemsPerPage())});totalPages=Ge(()=>Math.ceil(this.filteredProducts().length/this.itemsPerPage())||1);totalRevenue=Ge(()=>this.filteredProducts().reduce((t,e)=>t+e.totalRevenue,0));totalSales=Ge(()=>this.filteredProducts().reduce((t,e)=>t+e.totalSales,0));averageRating=Ge(()=>{let t=this.filteredProducts().filter(e=>e.averageRating>0);return t.length===0?0:t.reduce((e,n)=>e+n.averageRating,0)/t.length});courses=Ge(()=>this.filteredProducts().filter(t=>t.type==="course"));projects=Ge(()=>this.filteredProducts().filter(t=>t.type==="project"));Math=Math;ngOnInit(){this.loadProducts()}async loadProducts(){this.isLoading.set(!0);try{let t=await this.reportsService.getProductsReport().toPromise();t&&t.products&&this.products.set(t.products)}catch{}finally{this.isLoading.set(!1)}}applyFilters(){this.currentPage.set(1)}clearFilters(){this.productType="",this.sortBy="revenue",this.searchTerm="",this.applyFilters()}exportToExcel(){let t=this.filteredProducts().map(r=>({Tipo:r.type==="course"?"Curso":"Proyecto",T\u00EDtulo:r.title,Categor\u00EDa:r.category,Instructor:r.instructor,Ventas:r.totalSales,"Ingresos (MXN)":r.totalRevenue,Rating:r.averageRating||"N/A",Rese\u00F1as:r.totalReviews||0})),e=Yn.json_to_sheet(t),n=Yn.book_new();Yn.book_append_sheet(n,e,"Productos"),Ws(n,`productos_${new Date().toISOString().split("T")[0]}.xlsx`)}exportToPDF(){let t=new _t;t.text("Reporte de Productos",14,20),t.setFontSize(10),t.text(`Generado: ${new Date().toLocaleString("es-ES")}`,14,28);let e=[`Total Productos: ${this.filteredProducts().length}`,`Ingresos Totales: ${this.formatCurrency(this.totalRevenue())}`,`Ventas Totales: ${this.totalSales()}`];t.text(e,14,34);let n=this.filteredProducts().map(r=>[r.type==="course"?"Curso":"Proyecto",r.title,r.category,r.totalSales,this.formatCurrency(r.totalRevenue),r.averageRating?r.averageRating.toFixed(1):"N/A"]);Ss(t,{head:[["Tipo","T\xEDtulo","Categor\xEDa","Ventas","Ingresos","Rating"]],body:n,startY:45,styles:{fontSize:8},headStyles:{fillColor:[132,204,22]}}),t.save(`productos_${new Date().toISOString().split("T")[0]}.pdf`)}formatCurrency(t){return`MXN ${t.toFixed(2)}`}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-products-report"]],decls:97,vars:8,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-blue-500/10","to-blue-600/5","border","border-blue-500/20","rounded-xl","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","text-blue-400","font-medium"],[1,"text-3xl","font-bold","text-white","mt-2"],[1,"text-2xl"],[1,"bg-gradient-to-br","from-purple-500/10","to-purple-600/5","border","border-purple-500/20","rounded-xl","p-6"],[1,"text-sm","text-purple-400","font-medium"],[1,"bg-gradient-to-br","from-green-500/10","to-green-600/5","border","border-green-500/20","rounded-xl","p-6"],[1,"text-sm","text-green-400","font-medium"],[1,"bg-gradient-to-br","from-yellow-500/10","to-yellow-600/5","border","border-yellow-500/20","rounded-xl","p-6"],[1,"text-sm","text-yellow-400","font-medium"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-white","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],[1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white",3,"ngModelChange","change","ngModel"],["value",""],["value","course"],["value","project"],["value","sales"],["value","rating"],["value","revenue"],[1,"flex","gap-3","mt-4"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg",3,"click"],[1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-lg",3,"click"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg",3,"click"],["id","topProductsChart"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","overflow-hidden"],[1,"p-6","border-b","border-white/10"],[1,"text-lg","font-semibold","text-white"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-900/50"],[1,"px-6","py-4","text-left","text-xs","font-semibold","text-slate-300","uppercase"],[1,"px-6","py-4","text-right","text-xs","font-semibold","text-slate-300","uppercase"],[1,"divide-y","divide-white/5"],[1,"hover:bg-white/5"],[1,"px-6","py-4"],[1,"px-2","py-1","text-xs","rounded-full",3,"ngClass"],[1,"px-6","py-4","text-sm","text-white"],[1,"px-6","py-4","text-sm","text-slate-300"],[1,"px-6","py-4","text-right","text-sm","text-slate-300"],[1,"px-6","py-4","text-right","text-sm","font-semibold","text-green-400"],[1,"px-6","py-4","text-right"],[1,"flex","items-center","justify-end","gap-1"],[1,"text-yellow-400"],[1,"text-sm","font-semibold","text-white"],["colspan","6",1,"px-6","py-12","text-center","text-slate-400"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"p",4),x(6,"Total Cursos"),p(),f(7,"p",5),x(8),p()(),f(9,"span",6),x(10,"\u{1F4DA}"),p()()(),f(11,"div",7)(12,"div",3)(13,"div")(14,"p",8),x(15,"Total Proyectos"),p(),f(16,"p",5),x(17),p()(),f(18,"span",6),x(19,"\u{1F3AF}"),p()()(),f(20,"div",9)(21,"div",3)(22,"div")(23,"p",10),x(24,"Ventas Totales"),p(),f(25,"p",5),x(26),p()(),f(27,"span",6),x(28,"\u{1F6D2}"),p()()(),f(29,"div",11)(30,"div",3)(31,"div")(32,"p",12),x(33,"Rating Promedio"),p(),f(34,"p",5),x(35),p()(),f(36,"span",6),x(37,"\u2B50"),p()()()(),f(38,"div",13)(39,"h3",14),x(40,"\u{1F50D} Filtros"),p(),f(41,"div",15)(42,"div")(43,"label",16),x(44,"Tipo"),p(),f(45,"select",17),nr("ngModelChange",function(a){return ir(n.productType,a)||(n.productType=a),a}),ue("change",function(){return n.applyFilters()}),f(46,"option",18),x(47,"Todos"),p(),f(48,"option",19),x(49,"Cursos"),p(),f(50,"option",20),x(51,"Proyectos"),p()()(),f(52,"div")(53,"label",16),x(54,"Ordenar por"),p(),f(55,"select",17),nr("ngModelChange",function(a){return ir(n.sortBy,a)||(n.sortBy=a),a}),ue("change",function(){return n.applyFilters()}),f(56,"option",21),x(57,"M\xE1s vendidos"),p(),f(58,"option",22),x(59,"Mejor rating"),p(),f(60,"option",23),x(61,"Mayor ingreso"),p()()()(),f(62,"div",24)(63,"button",25),ue("click",function(){return n.clearFilters()}),x(64," \u{1F5D1}\uFE0F Limpiar "),p(),f(65,"button",26),ue("click",function(){return n.exportToExcel()}),x(66," \u{1F4CA} Excel "),p(),f(67,"button",27),ue("click",function(){return n.exportToPDF()}),x(68," \u{1F4C4} PDF "),p()()(),f(69,"div",13)(70,"h3",14),x(71,"\u{1F4C8} Top 10 Productos"),p(),ce(72,"canvas",28),p(),f(73,"div",29)(74,"div",30)(75,"h3",31),x(76),p()(),f(77,"div",32)(78,"table",33)(79,"thead",34)(80,"tr")(81,"th",35),x(82,"Tipo"),p(),f(83,"th",35),x(84,"T\xEDtulo"),p(),f(85,"th",35),x(86,"Instructor"),p(),f(87,"th",36),x(88,"Ventas"),p(),f(89,"th",36),x(90,"Ingresos"),p(),f(91,"th",36),x(92,"Rating"),p()()(),f(93,"tbody",37),zt(94,FH,18,10,"tr",38,AH,!1,DH,3,0,"tr"),p()()()()()),e&2&&(S(8),Ve(n.courses().length),S(9),Ve(n.projects().length),S(9),Ve(n.totalSales()),S(9),Ve(n.averageRating()),S(10),tr("ngModel",n.productType),S(10),tr("ngModel",n.sortBy),S(21),Re(" \u{1F4CB} Lista de Productos (",n.filteredProducts().length,") "),S(18),Ht(n.paginatedProducts()))},dependencies:[yn,Ds,mn,Hn,Wn,hr,wi,zn],encapsulation:2})};function NH(i,t){if(i&1&&(f(0,"div",12)(1,"h3",13)(2,"span"),x(3,"\u{1F4BC}"),p(),x(4," Resumen Fiscal "),p(),f(5,"div",28)(6,"div",29)(7,"p",30),x(8,"IVA"),p(),f(9,"p",31),x(10),p()(),f(11,"div",29)(12,"p",30),x(13,"Retenci\xF3n IVA"),p(),f(14,"p",31),x(15),p()(),f(16,"div",29)(17,"p",30),x(18,"ISR"),p(),f(19,"p",31),x(20),p()(),f(21,"div",29)(22,"p",30),x(23,"Total Impuestos"),p(),f(24,"p",32),x(25),p()()()()),i&2){let e=q();S(10),Ve(e.formatCurrency(e.summary().fiscal.iva)),S(5),Ve(e.formatCurrency(e.summary().fiscal.retencion_iva)),S(5),Ve(e.formatCurrency(e.summary().fiscal.isr)),S(5),Ve(e.formatCurrency(e.summary().fiscal.total))}}function PH(i,t){i&1&&(f(0,"div",26),ce(1,"div",33),p())}function MH(i,t){i&1&&(f(0,"div",27)(1,"span",34),x(2,"\u{1F512}"),p(),f(3,"p",35),x(4,"No tienes permisos para ver comisiones"),p(),f(5,"p",36),x(6,"Solo los administradores pueden acceder a este reporte"),p()())}var _p=class i{reportsService=lt($a);summary=Ae(null);isLoading=Ae(!1);startDate="";endDate="";period="month";ngOnInit(){this.loadData()}async loadData(){this.isLoading.set(!0);try{let t=await this.reportsService.getCommissionsSummary(this.period,this.startDate||void 0,this.endDate||void 0).toPromise();t&&this.summary.set(t)}catch(t){t.status}finally{this.isLoading.set(!1)}}clearFilters(){this.startDate="",this.endDate="",this.period="month",this.loadData()}exportToExcel(){let t=this.summary();if(!t)return;let e=[{"Ventas Brutas":t.summary.total_ventas_bruto,"Comisiones Plataforma":t.summary.total_comisiones_plataforma,"Pago Instructores":t.summary.total_pago_instructores,Impuestos:t.summary.total_impuestos,"Neto Plataforma":t.summary.neto_plataforma,IVA:t.fiscal.iva,"Retenci\xF3n IVA":t.fiscal.retencion_iva,ISR:t.fiscal.isr,"Total Impuestos":t.fiscal.total}],n=Yn.json_to_sheet(e),r=Yn.book_new();Yn.book_append_sheet(r,n,"Comisiones"),Ws(r,`comisiones_${new Date().toISOString().split("T")[0]}.xlsx`)}exportToPDF(){let t=this.summary();if(!t)return;let e=new _t;e.text("Reporte de Comisiones",14,20),e.setFontSize(10),e.text(`Generado: ${new Date().toLocaleString("es-ES")}`,14,28);let n=[`Per\xEDodo: ${t.period}`,`Ventas Brutas: ${this.formatCurrency(t.summary.total_ventas_bruto)}`,`Neto Plataforma: ${this.formatCurrency(t.summary.neto_plataforma)}`];e.text(n,14,34);let r=[[this.formatCurrency(t.summary.total_ventas_bruto),this.formatCurrency(t.summary.total_comisiones_plataforma),this.formatCurrency(t.summary.total_pago_instructores),this.formatCurrency(t.summary.total_impuestos),this.formatCurrency(t.summary.neto_plataforma)]];Ss(e,{head:[["Ventas Brutas","Comisiones","Pago Instr.","Impuestos","Neto"]],body:r,startY:50,styles:{fontSize:8},headStyles:{fillColor:[132,204,22]}}),e.text("Desglose de Impuestos",14,e.lastAutoTable.finalY+15);let a=[[this.formatCurrency(t.fiscal.iva),this.formatCurrency(t.fiscal.retencion_iva),this.formatCurrency(t.fiscal.isr),this.formatCurrency(t.fiscal.total)]];Ss(e,{head:[["IVA","Retenci\xF3n IVA","ISR","Total Impuestos"]],body:a,startY:e.lastAutoTable.finalY+20,styles:{fontSize:8},headStyles:{fillColor:[132,204,22]}}),e.save(`comisiones_${new Date().toISOString().split("T")[0]}.pdf`)}formatCurrency(t){return`MXN ${t.toFixed(2)}`}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-commissions-report"]],decls:72,vars:12,consts:[[1,"space-y-6"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4"],[1,"bg-gradient-to-br","from-blue-500/10","to-blue-600/5","border","border-blue-500/20","rounded-xl","p-6"],[1,"text-sm","text-blue-400","font-medium"],[1,"text-3xl","font-bold","text-white","mt-2"],[1,"text-xs","text-slate-400","mt-1"],[1,"bg-gradient-to-br","from-green-500/10","to-green-600/5","border","border-green-500/20","rounded-xl","p-6"],[1,"text-sm","text-green-400","font-medium"],[1,"bg-gradient-to-br","from-purple-500/10","to-purple-600/5","border","border-purple-500/20","rounded-xl","p-6"],[1,"text-sm","text-purple-400","font-medium"],[1,"bg-gradient-to-br","from-orange-500/10","to-orange-600/5","border","border-orange-500/20","rounded-xl","p-6"],[1,"text-sm","text-orange-400","font-medium"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-6"],[1,"text-lg","font-semibold","text-white","mb-4","flex","items-center","gap-2"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],["type","date",1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500",3,"ngModelChange","change","ngModel"],[1,"w-full","px-4","py-2.5","bg-slate-900/50","border","border-slate-700","rounded-lg","text-white","focus:ring-2","focus:ring-lime-500",3,"ngModelChange","change","ngModel"],["value","day"],["value","week"],["value","month"],["value","year"],[1,"flex","items-center","gap-3","mt-4"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-green-600","hover:bg-green-700","text-white","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-red-600","hover:bg-red-700","text-white","rounded-lg","transition-colors","flex","items-center","gap-2",3,"click"],[1,"flex","justify-center","items-center","py-12"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-12","text-center"],[1,"grid","grid-cols-2","md:grid-cols-4","gap-4"],[1,"bg-slate-700/30","rounded-lg","p-4"],[1,"text-xs","text-slate-400"],[1,"text-lg","font-semibold","text-white","mt-1"],[1,"text-lg","font-semibold","text-green-400","mt-1"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"text-4xl"],[1,"text-lg","text-slate-400","mt-4"],[1,"text-sm","text-slate-500","mt-2"]],template:function(e,n){if(e&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"p",3),x(5,"Ventas Brutas"),p(),f(6,"p",4),x(7),p(),f(8,"p",5),x(9),p()()(),f(10,"div",6)(11,"div")(12,"p",7),x(13,"Comisiones Plataforma"),p(),f(14,"p",4),x(15),p(),f(16,"p",5),x(17),p()()(),f(18,"div",8)(19,"div")(20,"p",9),x(21,"Pago Instructores"),p(),f(22,"p",4),x(23),p(),f(24,"p",5),x(25),p()()(),f(26,"div",10)(27,"div")(28,"p",11),x(29,"Neto Plataforma"),p(),f(30,"p",4),x(31),p(),f(32,"p",5),x(33,"Despu\xE9s de impuestos"),p()()()(),f(34,"div",12)(35,"h3",13)(36,"span"),x(37,"\u{1F50D}"),p(),x(38," Filtros "),p(),f(39,"div",14)(40,"div")(41,"label",15),x(42,"Fecha Inicio"),p(),f(43,"input",16),nr("ngModelChange",function(a){return ir(n.startDate,a)||(n.startDate=a),a}),ue("change",function(){return n.loadData()}),p()(),f(44,"div")(45,"label",15),x(46,"Fecha Fin"),p(),f(47,"input",16),nr("ngModelChange",function(a){return ir(n.endDate,a)||(n.endDate=a),a}),ue("change",function(){return n.loadData()}),p()(),f(48,"div")(49,"label",15),x(50,"Per\xEDodo"),p(),f(51,"select",17),nr("ngModelChange",function(a){return ir(n.period,a)||(n.period=a),a}),ue("change",function(){return n.loadData()}),f(52,"option",18),x(53,"Diario"),p(),f(54,"option",19),x(55,"Semanal"),p(),f(56,"option",20),x(57,"Mensual"),p(),f(58,"option",21),x(59,"Anual"),p()()()(),f(60,"div",22)(61,"button",23),ue("click",function(){return n.clearFilters()}),x(62," \u{1F5D1}\uFE0F Limpiar Filtros "),p(),f(63,"button",24),ue("click",function(){return n.exportToExcel()}),x(64," \u{1F4CA} Exportar Excel "),p(),f(65,"button",25),ue("click",function(){return n.exportToPDF()}),f(66,"span"),x(67,"\u{1F4C4}"),p(),x(68," Exportar PDF "),p()()(),xe(69,NH,26,4,"div",12),xe(70,PH,2,0,"div",26)(71,MH,7,0,"div",27),p()),e&2){let r,a,s,o,l,c,u;S(7),Ve(n.formatCurrency(((r=n.summary())==null||r.summary==null?null:r.summary.total_ventas_bruto)||0)),S(2),Re("",((a=n.summary())==null||a.summary==null?null:a.summary.total_ventas_count)||0," ventas"),S(6),Ve(n.formatCurrency(((s=n.summary())==null||s.summary==null?null:s.summary.total_comisiones_plataforma)||0)),S(2),Ve(((o=n.summary())==null||o.summary==null?null:o.summary.porcentaje_comision)||"0%"),S(6),Ve(n.formatCurrency(((l=n.summary())==null||l.summary==null?null:l.summary.total_pago_instructores)||0)),S(2),Ve(((c=n.summary())==null||c.summary==null?null:c.summary.porcentaje_instructores)||"0%"),S(6),Ve(n.formatCurrency(((u=n.summary())==null||u.summary==null?null:u.summary.neto_plataforma)||0)),S(12),tr("ngModel",n.startDate),S(4),tr("ngModel",n.endDate),S(4),tr("ngModel",n.period),S(18),ve(n.summary()?69:-1),S(),ve(n.isLoading()?70:n.summary()?-1:71)}},dependencies:[mn,Hn,Wn,ki,hr,wi,zn],encapsulation:2})};var zd=(i,t)=>({"bg-lime-500 text-slate-900":i,"bg-slate-700/50 text-slate-300 hover:bg-slate-700":t});function LH(i,t){if(i&1){let e=nt();f(0,"button",11),ue("click",function(){be(e);let r=q();return we(r.activeTab.set("commissions"))}),f(1,"span",12),x(2,"\u{1F4B5}"),p(),x(3," Comisiones "),p()}if(i&2){let e=q();Ce("ngClass",Fs(1,zd,e.activeTab()==="commissions",e.activeTab()!=="commissions"))}}function IH(i,t){i&1&&ce(0,"app-sales-report")}function RH(i,t){i&1&&ce(0,"app-students-report")}function OH(i,t){i&1&&ce(0,"app-products-report")}function BH(i,t){i&1&&ce(0,"app-commissions-report")}function jH(i,t){i&1&&ce(0,"app-refunds-report")}var bp=class i{authService=lt(pn);activeTab=Ae("sales");currentDate=Ae(new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}));isAdmin(){return this.authService.user()?.rol==="admin"}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-reports"]],decls:40,vars:19,consts:[[1,"min-h-screen","bg-gradient-to-br","from-slate-900","via-slate-800","to-slate-900","p-6"],[1,"max-w-[1800px]","mx-auto","space-y-6"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-white","flex","items-center","gap-3"],[1,"text-4xl"],[1,"text-slate-400","mt-1"],[1,"flex","items-center","gap-3"],[1,"px-4","py-2","bg-lime-500/20","text-lime-300","rounded-lg","text-sm","font-medium"],[1,"text-sm","text-slate-400"],[1,"bg-slate-800/50","border","border-white/10","rounded-xl","p-2"],[1,"flex","flex-wrap","gap-2"],[1,"px-6","py-3","rounded-lg","font-semibold","transition-all","flex","items-center","gap-2",3,"click","ngClass"],[1,"text-lg"],[1,"px-6","py-3","rounded-lg","font-semibold","transition-all","flex","items-center","gap-2",3,"ngClass"],[1,"animate-fadeIn"]],template:function(e,n){if(e&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3)(5,"span",4),x(6,"\u{1F4CA}"),p(),x(7," Reportes y An\xE1lisis "),p(),f(8,"p",5),x(9,"An\xE1lisis detallado de tu plataforma"),p()(),f(10,"div",6)(11,"span",7),x(12," \u{1F534} En vivo "),p(),f(13,"span",8),x(14),p()()(),f(15,"div",9)(16,"div",10)(17,"button",11),ue("click",function(){return n.activeTab.set("sales")}),f(18,"span",12),x(19,"\u{1F4B0}"),p(),x(20," Ventas "),p(),f(21,"button",11),ue("click",function(){return n.activeTab.set("students")}),f(22,"span",12),x(23,"\u{1F393}"),p(),x(24," Estudiantes "),p(),f(25,"button",11),ue("click",function(){return n.activeTab.set("products")}),f(26,"span",12),x(27,"\u{1F4E6}"),p(),x(28," Productos "),p(),xe(29,LH,4,4,"button",13),f(30,"button",11),ue("click",function(){return n.activeTab.set("refunds")}),f(31,"span",12),x(32,"\u21A9\uFE0F"),p(),x(33," Reembolsos "),p()()(),f(34,"div",14),xe(35,IH,1,0,"app-sales-report")(36,RH,1,0,"app-students-report")(37,OH,1,0,"app-products-report")(38,BH,1,0,"app-commissions-report")(39,jH,1,0,"app-refunds-report"),p()()()),e&2){let r;S(14),Re(" ",n.currentDate()," "),S(3),Ce("ngClass",Fs(7,zd,n.activeTab()==="sales",n.activeTab()!=="sales")),S(4),Ce("ngClass",Fs(10,zd,n.activeTab()==="students",n.activeTab()!=="students")),S(4),Ce("ngClass",Fs(13,zd,n.activeTab()==="products",n.activeTab()!=="products")),S(4),ve(n.isAdmin()?29:-1),S(),Ce("ngClass",Fs(16,zd,n.activeTab()==="refunds",n.activeTab()!=="refunds")),S(5),ve((r=n.activeTab())==="sales"?35:r==="students"?36:r==="products"?37:r==="commissions"?38:r==="refunds"?39:-1)}},dependencies:[yn,Ds,mp,gp,xp,vp,_p],styles:["@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.animate-fadeIn[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"]})};var Tx=(i,t)=>t._id;function VH(i,t){i&1&&(f(0,"div",12)(1,"div",16),ce(2,"div",17)(3,"div",18),p(),f(4,"p",19),x(5,"Cargando tus cupones..."),p()())}function UH(i,t){if(i&1){let e=nt();f(0,"div",13),ce(1,"div",20),f(2,"div",21)(3,"div",22),st(),f(4,"svg",23),ce(5,"path",24),p()(),xt(),f(6,"h3",25),x(7,"Tu primera campa\xF1a te espera"),p(),f(8,"p",26),x(9," A\xFAn no has creado cupones. Empieza a promocionar tus cursos y proyectos para maximizar tus ingresos hoy mismo. "),p(),f(10,"button",27),ue("click",function(){be(e);let r=q();return we(r.showCreateModal.set(!0))}),x(11," Crear mi primer cup\xF3n "),st(),f(12,"svg",28),ce(13,"path",29),p()()()()}}function zH(i,t){if(i&1){let e=nt();f(0,"div",30)(1,"div",31)(2,"div",32)(3,"div",33)(4,"div",34)(5,"div",35),st(),f(6,"svg",36),ce(7,"path",37),p()(),xt(),f(8,"div")(9,"p",38),x(10,"Proyecto Destino"),p(),f(11,"h4",39),x(12),p()()(),f(13,"span",40),x(14),p()(),f(15,"div",41)(16,"div",42),x(17),p(),f(18,"span",43),x(19),p()(),f(20,"div",44),st(),f(21,"svg",45),ce(22,"path",46),p(),x(23," Expira el "),xt(),f(24,"span",47),x(25),Jr(26,"date"),p()()(),f(27,"div",48)(28,"div",49)(29,"span",50),x(30,"Tu Comisi\xF3n"),p(),f(31,"span",51),x(32,"80%"),p()(),f(33,"button",52),ue("click",function(){let r=be(e).$implicit,a=q(2);return we(a.copyLink(r))}),st(),f(34,"svg",45),ce(35,"path",53),p(),xt(),f(36,"span"),x(37,"Copiar Link"),p()()()()()}if(i&2){let e=t.$implicit;S(12),Re(" ",(e.projects[0]==null?null:e.projects[0].title)||"Proyecto Desconocido"," "),S(),Li(e.active?"bg-green-500/10 text-green-400 border-green-500/20":"bg-red-500/10 text-red-400 border-red-500/20"),S(),Re(" ",e.active?"Activo":"Inactivo"," "),S(3),Re(" ",e.code," "),S(),Li(e.active?"bg-green-500/10 text-green-400 border-green-500/20":"bg-red-500/10 text-red-400 border-red-500/20"),S(),Re(" ",e.active?"Activo":"Inactivo"," "),S(6),Ve(us(26,9,e.expires_at,"mediumDate"))}}function HH(i,t){if(i&1&&(f(0,"div",14),zt(1,zH,38,12,"div",30,Tx),p()),i&2){let e=q();S(),Ht(e.coupons())}}function WH(i,t){if(i&1&&(f(0,"option",68),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),Re("",e.title," (Proyecto)")}}function qH(i,t){if(i&1&&(f(0,"option",68),x(1),p()),i&2){let e=t.$implicit;Ce("value",e._id),S(),Re("",e.title," (Curso)")}}function GH(i,t){if(i&1){let e=nt();f(0,"div",15)(1,"div",54),ue("click",function(){be(e);let r=q();return we(r.showCreateModal.set(!1))}),p(),f(2,"div",55)(3,"div",56)(4,"div",57)(5,"button",58),ue("click",function(){be(e);let r=q();return we(r.showCreateModal.set(!1))}),st(),f(6,"svg",36),ce(7,"path",59),p()()(),xt(),f(8,"h3",60),x(9,"Nuevo Cup\xF3n de Referido"),p(),f(10,"p",61),x(11,"Gana 80% de comisi\xF3n por cada venta exitosa."),p()(),f(12,"form",62),ue("ngSubmit",function(){be(e);let r=q();return we(r.createCoupon())}),f(13,"div",63)(14,"label",64),x(15,"Selecciona el Proyecto"),p(),f(16,"div",65)(17,"select",66)(18,"option",67),x(19,"Selecciona un proyecto..."),p(),zt(20,WH,2,2,"option",68,Tx),zt(22,qH,2,2,"option",68,Tx),p(),f(24,"div",69),st(),f(25,"svg",28),ce(26,"path",70),p()()()(),xt(),f(27,"div",71)(28,"label",64),x(29,"Duraci\xF3n del Enlace"),p(),f(30,"div",72)(31,"label",73),ce(32,"input",74),f(33,"div",75)(34,"span",76),x(35,"3 D\xEDas"),p(),f(36,"span",77),x(37,"Disponible"),p()()(),f(38,"label",73),ce(39,"input",74),f(40,"div",75)(41,"span",76),x(42,"5 D\xEDas"),p(),f(43,"span",77),x(44,"Popular"),p()()()()(),f(45,"div",78)(46,"button",79),ue("click",function(){be(e);let r=q();return we(r.showCreateModal.set(!1))}),x(47," Cancelar "),p(),f(48,"button",80),x(49),p()()()()()}if(i&2){let e,n,r,a,s,o,l,c,u,h,g,d,b,_,w,E,A,D,N,z,J=q();S(12),Ce("formGroup",J.createForm),S(8),Ht(J.projects()),S(2),Ht(J.courses()),S(10),Ce("value",3),S(),oi("bg-primary-600/10",((e=J.createForm.get("days_duration"))==null?null:e.value)===3)("border-primary-500",((n=J.createForm.get("days_duration"))==null?null:n.value)===3)("shadow-lg",((r=J.createForm.get("days_duration"))==null?null:r.value)===3)("shadow-primary-500/10",((a=J.createForm.get("days_duration"))==null?null:a.value)===3)("bg-slate-800",((s=J.createForm.get("days_duration"))==null?null:s.value)!==3)("border-slate-700",((o=J.createForm.get("days_duration"))==null?null:o.value)!==3),S(),oi("text-primary-400",((l=J.createForm.get("days_duration"))==null?null:l.value)===3)("text-white",((c=J.createForm.get("days_duration"))==null?null:c.value)!==3),S(2),oi("text-primary-300",((u=J.createForm.get("days_duration"))==null?null:u.value)===3)("text-slate-500",((h=J.createForm.get("days_duration"))==null?null:h.value)!==3),S(3),Ce("value",5),S(),oi("bg-primary-600/10",((g=J.createForm.get("days_duration"))==null?null:g.value)===5)("border-primary-500",((d=J.createForm.get("days_duration"))==null?null:d.value)===5)("shadow-lg",((b=J.createForm.get("days_duration"))==null?null:b.value)===5)("shadow-primary-500/10",((_=J.createForm.get("days_duration"))==null?null:_.value)===5)("bg-slate-800",((w=J.createForm.get("days_duration"))==null?null:w.value)!==5)("border-slate-700",((E=J.createForm.get("days_duration"))==null?null:E.value)!==5),S(),oi("text-primary-400",((A=J.createForm.get("days_duration"))==null?null:A.value)===5)("text-white",((D=J.createForm.get("days_duration"))==null?null:D.value)!==5),S(2),oi("text-primary-300",((N=J.createForm.get("days_duration"))==null?null:N.value)===5)("text-slate-500",((z=J.createForm.get("days_duration"))==null?null:z.value)!==5),S(5),Ce("disabled",J.createForm.invalid||J.creating()),S(),Re(" ",J.creating()?"Procesando...":"Generar Link"," ")}}var wp=class i{couponService=lt(Xv);projectService=lt(z0);courseService=lt(tl);authService=lt(pn);toastService=lt(ua);fb=lt(Lf);coupons=Ae([]);projects=Ae([]);courses=Ae([]);loading=Ae(!0);creating=Ae(!1);showCreateModal=Ae(!1);createForm=this.fb.group({project_id:["",bi.required],days_duration:[3,bi.required]});ngOnInit(){this.loadData()}loadData(){this.loading.set(!0),this.couponService.getCoupons().subscribe({next:e=>{this.coupons.set(e.coupons),this.loading.set(!1)},error:()=>this.loading.set(!1)});let t=this.authService.user();t&&(this.projectService.getProjectsByInstructor(t._id).subscribe({next:e=>{this.projects.set(e.projects||e.data||[])}}),this.courseService.listCoursesInstructor().subscribe({next:e=>{this.courses.set(e.courses||[])}}))}createCoupon(){if(this.createForm.invalid)return;this.creating.set(!0);let{project_id:t,days_duration:e}=this.createForm.value,n="project";this.courses().some(r=>r._id===t)&&(n="course"),this.couponService.createCoupon({project_id:t,product_type:n,days_duration:e}).subscribe({next:r=>{this.toastService.success("Cup\xF3n Creado","Tu enlace de referido est\xE1 listo."),this.coupons.update(a=>[r.coupon,...a]),this.showCreateModal.set(!1),this.createForm.reset({days_duration:3,project_id:""}),this.loadData()},error:r=>{this.toastService.error("Error",r.error?.message||"No se pudo crear el cup\xF3n")},complete:()=>this.creating.set(!1)})}copyLink(t){let e=t.projects[0];if(!e)return;let n=e._id,a=`${window.location.origin}/#/project-detail/${n}?coupon=${t.code}`;navigator.clipboard.writeText(a).then(()=>{this.toastService.success("Enlace Copiado","Comp\xE1rtelo para ganar 80% de comisi\xF3n")})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=Bt({type:i,selectors:[["app-coupons"]],decls:21,vars:2,consts:[[1,"space-y-8"],[1,"relative","overflow-hidden","rounded-2xl","bg-gradient-to-br","from-slate-900","to-slate-800","border","border-slate-700/50","p-6","sm:p-10"],[1,"absolute","top-0","right-0","-mt-10","-mr-10","w-40","h-40","bg-primary-500/10","rounded-full","blur-3xl"],[1,"absolute","bottom-0","left-0","-mb-10","-ml-10","w-40","h-40","bg-purple-500/10","rounded-full","blur-3xl"],[1,"relative","flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","gap-6"],[1,"space-y-2","max-w-2xl"],[1,"text-3xl","font-extrabold","text-white","tracking-tight"],[1,"text-transparent","bg-clip-text","bg-gradient-to-r","from-primary-400","to-purple-400"],[1,"text-slate-400","text-lg","leading-relaxed"],[1,"group","relative","inline-flex","items-center","gap-2","px-6","py-3","bg-primary-600","hover:bg-primary-500","text-white","font-semibold","rounded-xl","transition-all","shadow-lg","shadow-primary-500/20","hover:shadow-primary-500/40","hover:-translate-y-0.5",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","transition-transform","group-hover:rotate-90"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"flex","flex-col","items-center","justify-center","py-20"],[1,"bg-slate-900/50","rounded-2xl","border","border-slate-700/50","p-12","text-center","relative","overflow-hidden","group","hover:border-slate-600","transition-colors"],[1,"grid","grid-cols-1","xl:grid-cols-2","gap-6"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4"],[1,"relative","w-16","h-16"],[1,"absolute","top-0","left-0","w-full","h-full","border-4","border-primary-500/20","rounded-full"],[1,"absolute","top-0","left-0","w-full","h-full","border-4","border-primary-500","rounded-full","border-t-transparent","animate-spin"],[1,"mt-4","text-slate-400","font-medium","animate-pulse"],[1,"absolute","inset-0","bg-gradient-to-b","from-transparent","to-slate-900/50"],[1,"relative","z-10","max-w-md","mx-auto"],[1,"w-20","h-20","bg-slate-800","rounded-2xl","flex","items-center","justify-center","mx-auto","mb-6","shadow-xl","border","border-slate-700","group-hover:scale-110","transition-transform","duration-300"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-10","h-10","text-primary-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"],[1,"text-2xl","font-bold","text-white","mb-3"],[1,"text-slate-400","mb-8","leading-relaxed"],[1,"inline-flex","items-center","gap-2","text-primary-400","hover:text-primary-300","font-bold","hover:underline","transition-all",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M17 8l4 4m0 0l-4 4m4-4H3"],[1,"group","relative","bg-slate-900","rounded-2xl","border","border-slate-800","p-6","transition-all","hover:-translate-y-1","hover:shadow-xl","hover:shadow-primary-900/10","hover:border-primary-500/30"],[1,"flex","flex-col","sm:flex-row","gap-5","justify-between"],[1,"flex-1","space-y-4"],[1,"flex","items-start","justify-between","sm:justify-start","gap-4"],[1,"flex","items-center","gap-3"],[1,"p-2","bg-slate-800","rounded-lg","text-primary-400","border","border-slate-700"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","1.5","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"text-xs","text-slate-500","uppercase","font-bold","tracking-wider"],[1,"text-base","font-semibold","text-white","line-clamp-1","group-hover:text-primary-400","transition-colors"],[1,"sm:hidden","px-2.5","py-1","rounded-full","text-xs","font-medium","border"],[1,"flex","flex-wrap","items-center","gap-3"],[1,"px-4","py-1.5","bg-slate-800","rounded-lg","text-white","font-mono","text-sm","tracking-wider","border","border-slate-700","select-all"],[1,"hidden","sm:inline-flex","px-2.5","py-1","rounded-full","text-xs","font-medium","border"],[1,"flex","items-center","gap-2","text-sm","text-slate-400"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-slate-300","font-medium"],[1,"flex","sm:flex-col","items-center","sm:items-end","justify-between","sm:justify-center","gap-4","sm:border-l","sm:border-slate-800","sm:pl-6"],[1,"flex","flex-col","items-start","sm:items-end"],[1,"text-xs","text-slate-500","font-bold","uppercase","tracking-wider"],[1,"text-xl","font-bold","text-green-400"],[1,"flex","items-center","gap-2","px-4","py-2","bg-white","text-slate-900","hover:bg-slate-200","rounded-lg","font-semibold","text-sm","transition-colors","shadow-lg","shadow-white/5","active:scale-95",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"],[1,"absolute","inset-0","bg-slate-900/80","backdrop-blur-md","transition-opacity",3,"click"],[1,"relative","w-full","max-w-lg","bg-slate-900","rounded-2xl","shadow-2xl","border","border-slate-700","overflow-hidden","transform","transition-all","scale-100","animate-in","fade-in","zoom-in-95","duration-200"],[1,"relative","bg-gradient-to-r","from-slate-900","to-slate-800","p-6","border-b","border-slate-700"],[1,"absolute","top-0","right-0","p-4"],[1,"text-slate-400","hover:text-white","transition-colors",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"text-xl","font-bold","text-white","mb-1"],[1,"text-slate-400","text-sm"],[1,"p-6","space-y-6",3,"ngSubmit","formGroup"],[1,"space-y-2"],[1,"block","text-sm","font-semibold","text-slate-300"],[1,"relative"],["formControlName","project_id",1,"w-full","appearance-none","bg-slate-800","border","border-slate-700","rounded-xl","px-4","py-3.5","text-white","focus:ring-2","focus:ring-primary-500","focus:border-primary-500","outline-none","transition-all","pr-10","hover:border-slate-600"],["value","","disabled","",1,"text-slate-500"],[1,"py-2",3,"value"],[1,"absolute","inset-y-0","right-0","flex","items-center","px-4","pointer-events-none","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 9l-7 7-7-7"],[1,"space-y-3"],[1,"grid","grid-cols-2","gap-4"],[1,"cursor-pointer","group"],["type","radio","formControlName","days_duration",1,"sr-only",3,"value"],[1,"relative","overflow-hidden","text-center","py-4","rounded-xl","border-2","transition-all","group-hover:border-primary-500/50"],[1,"block","text-2xl","font-bold","mb-1"],[1,"text-xs","font-medium","uppercase","tracking-wide"],[1,"pt-4","flex","items-center","justify-end","gap-3"],["type","button",1,"px-5","py-2.5","bg-transparent","text-slate-400","hover:text-white","font-medium","transition-colors",3,"click"],["type","submit",1,"px-8","py-2.5","bg-gradient-to-r","from-primary-600","to-primary-500","hover:from-primary-500","hover:to-primary-400","text-white","rounded-xl","shadow-lg","shadow-primary-600/20","disabled:opacity-50","disabled:cursor-not-allowed","transition-all","transform","active:scale-95","font-semibold",3,"disabled"]],template:function(e,n){e&1&&(f(0,"div",0)(1,"div",1),ce(2,"div",2)(3,"div",3),f(4,"div",4)(5,"div",5)(6,"h2",6),x(7," Mis Cupones de "),f(8,"span",7),x(9,"Referido"),p()(),f(10,"p",8),x(11," Genera enlaces \xFAnicos para tus proyectos. "),p()(),f(12,"button",9),ue("click",function(){return n.showCreateModal.set(!0)}),st(),f(13,"svg",10),ce(14,"path",11),p(),xt(),f(15,"span"),x(16,"Crear Nuevo Cup\xF3n"),p()()()(),xe(17,VH,6,0,"div",12)(18,UH,14,0,"div",13)(19,HH,3,0,"div",14),p(),xe(20,GH,50,45,"div",15)),e&2&&(S(17),ve(n.loading()?17:n.coupons().length===0?18:19),S(3),ve(n.showCreateModal()?20:-1))},dependencies:[yn,mn,Wa,Hn,Wn,ki,hr,Bv,wi,dr,pr,fr,Ur,U0],encapsulation:2})};function $H(i,t){if(i&1){let e=nt();f(0,"img",22),ue("error",function(r){return be(e),we(r.target.style.display="none")}),p()}if(i&2){let e,n,r=q();Ce("src","https://api.devhubsharks.com/api/system-config/logo/"+((e=r.systemConfigService.config())==null?null:e.logo),Ui)("alt",(((n=r.systemConfigService.config())==null?null:n.siteName)||"Dev-Sharks")+" logo")}}function XH(i,t){if(i&1&&(f(0,"div",6),x(1),p()),i&2){let e,n=q();S(),Re(" ",(((e=n.systemConfigService.config())==null?null:e.siteName)||"Dev-Sharks").charAt(0).toUpperCase()," ")}}function YH(i,t){if(i&1&&(f(0,"div",7)(1,"p",23),x(2),p(),f(3,"p",24),x(4),p()()),i&2){let e,n,r=q();S(2),Re(" ",(e=r.authService.user())==null?null:e.name," "),S(2),Re(" ",(n=r.authService.user())==null?null:n.rol," ")}}function KH(i,t){i&1&&(f(0,"div",25),ce(1,"div",26),p())}function ZH(i,t){i&1&&(f(0,"span",39),x(1," \u2713 Solo datos reales "),p())}function JH(i,t){if(i&1&&(f(0,"div",66),x(1),p()),i&2){let e=q();S(),Re(" ",e.refunds.pending," pendientes ")}}function QH(i,t){i&1&&(f(0,"p",72),x(1,"\u2713 Datos de prueba excluidos"),p())}function eW(i,t){i&1&&(f(0,"p",73),x(1,"\u26A0\uFE0F Incluye compras de prueba"),p())}function tW(i,t){if(i&1&&(f(0,"div",115)(1,"span",116),x(2),p(),f(3,"div",117)(4,"p",118),x(5),p()(),f(6,"span",56),x(7),p()()),i&2){let e=t.$implicit,n=q(4);Ce("ngClass",n.getAlertClass(e.type)),S(2),Ve(n.getAlertIcon(e.type)),S(3),Ve(e.message),S(),Ce("ngClass",n.getPriorityBadgeClass(e.priority)),S(),Re(" ",e.priority==="high"?"Alta":e.priority==="medium"?"Media":"Baja"," ")}}function iW(i,t){if(i&1&&(f(0,"div",109)(1,"div",110),st(),f(2,"svg",111),ce(3,"path",112),p(),xt(),f(4,"h3",113),x(5,"Alertas del Sistema"),p()(),f(6,"div",114),zt(7,tW,8,5,"div",115,Zl),p()()),i&2){let e=q();S(7),Ht(e.alerts)}}function nW(i,t){if(i&1){let e=nt();f(0,"div",27)(1,"div",28)(2,"div",29),st(),f(3,"svg",30),ce(4,"path",31),p()(),xt(),f(5,"div")(6,"h1",32),x(7,"Dashboard Ejecutivo"),p(),f(8,"p",33),x(9,"M\xE9tricas financieras y operativas completas"),p()()()(),f(10,"div",34)(11,"h2",35),x(12,"M\xE9tricas Ejecutivas"),p(),f(13,"label",36)(14,"input",37),ue("change",function(){be(e);let r=q(2);return we(r.dashboardService.toggleTestDataFilter())}),p(),f(15,"span",38),x(16,"Excluir datos de prueba"),p(),xe(17,ZH,2,0,"span",39),p()(),f(18,"div",40)(19,"div",41),ce(20,"div",42),f(21,"div",43)(22,"div",44)(23,"div",45),st(),f(24,"svg",46),ce(25,"path",47),p()()(),xt(),f(26,"p",48),x(27),p(),f(28,"p",49),x(29),p(),f(30,"p",9),x(31),p(),f(32,"div",50)(33,"p",51),x(34),p()()()(),f(35,"div",52),ce(36,"div",53),f(37,"div",43)(38,"div",44)(39,"div",54),st(),f(40,"svg",46),ce(41,"path",55),p()(),xt(),f(42,"div",56),x(43),p()(),f(44,"p",57),x(45),p(),f(46,"p",58),x(47),p(),f(48,"p",9),x(49),p(),f(50,"div",59)(51,"p",60),x(52),p(),f(53,"p",61),x(54),p()()()(),f(55,"div",62),ce(56,"div",63),f(57,"div",43)(58,"div",44)(59,"div",64),st(),f(60,"svg",46),ce(61,"path",65),p()(),xe(62,JH,2,1,"div",66),p(),xt(),f(63,"p",67),x(64),p(),f(65,"p",68),x(66),p(),f(67,"p",9),x(68),p(),f(69,"div",69)(70,"p",70),x(71),p(),f(72,"p",61),x(73),p()(),f(74,"div",71),xe(75,QH,2,0,"p",72)(76,eW,2,0,"p",73),p()()(),f(77,"div",74),ce(78,"div",75),f(79,"div",43)(80,"div",44)(81,"div",76),st(),f(82,"svg",46),ce(83,"path",77),p()()(),xt(),f(84,"p",78),x(85),p(),f(86,"p",79),x(87),p(),f(88,"p",9),x(89),p(),f(90,"div",80)(91,"p",81),x(92),p()()()()(),f(93,"div",82)(94,"h3",83),x(95,"An\xE1lisis de M\xE1rgenes"),p(),f(96,"div",84)(97,"div",85)(98,"div",86)(99,"div",87)(100,"div",88)(101,"div",89)(102,"div",90)(103,"span",91),x(104),p()()(),f(105,"span",92),x(106,"Ingresos Brutos"),p()(),f(107,"div",88)(108,"div",93)(109,"div",90)(110,"span",91),x(111),p()()(),f(112,"span",94),x(113,"Ingresos Netos"),p()()()()(),f(114,"div",95)(115,"div",86)(116,"p",96),x(117),p(),f(118,"p",97),x(119),p(),f(120,"p",98),x(121),p(),f(122,"div",99)(123,"p",100),x(124,"Composici\xF3n:"),p(),f(125,"div",101)(126,"div",102)(127,"span",103),x(128,"Comisiones"),p(),f(129,"span",104),x(130),p()(),f(131,"div",102)(132,"span",103),x(133,"Reembolsos"),p(),f(134,"span",105),x(135),p()()()()()()()(),f(136,"div",106)(137,"div",107)(138,"p",108),x(139),p(),f(140,"p",9),x(141,"Estudiantes"),p()(),f(142,"div",107)(143,"p",108),x(144),p(),f(145,"p",9),x(146,"Instructores"),p()(),f(147,"div",107)(148,"p",108),x(149),p(),f(150,"p",9),x(151,"Cursos Activos"),p()(),f(152,"div",107)(153,"p",108),x(154),p(),f(155,"p",9),x(156,"Proyectos Activos"),p()(),f(157,"div",107)(158,"p",108),x(159),p(),f(160,"p",9),x(161,"Ventas Totales"),p()(),f(162,"div",107)(163,"p",108),x(164),p(),f(165,"p",9),x(166,"Ventas Activas"),p()()(),xe(167,iW,9,0,"div",109)}if(i&2){let e=t,n=q(2);S(14),Ce("checked",n.dashboardService.excludeTestData()),S(3),ve(n.dashboardService.excludeTestData()?17:-1),S(10),Ve(e.income.gross.label),S(2),Ve(n.formatCurrency(e.income.gross.total)),S(2),Ve(e.income.gross.description),S(3),Re("Mes actual: ",n.formatCurrency(e.income.gross.currentMonth)," "),S(8),Ce("ngClass",e.income.net.delta>=0?"bg-lime-500/10 text-lime-400 ring-1 ring-lime-500/20":"bg-red-500/10 text-red-400 ring-1 ring-red-500/20"),S(),hi(" ",e.income.net.delta>=0?"\u2191":"\u2193"," ",e.income.net.delta,"% "),S(2),Ve(e.income.net.label),S(2),Ve(n.formatCurrency(e.income.net.total)),S(2),Ve(e.income.net.description),S(3),Re("Mes actual: ",n.formatCurrency(e.income.net.currentMonth)," "),S(2),Re("A\xF1o: ",n.formatCurrency(e.income.net.currentYear)),S(8),ve(e.refunds.pending>0?62:-1),S(2),Ve(e.refunds.label),S(2),Ve(n.formatCurrency(e.refunds.totalAmount)),S(2),Ve(e.refunds.description),S(3),Re("Total solicitudes: ",e.refunds.total),S(2),Re("Tasa: ",e.refunds.rate,"%"),S(2),ve(e.refunds.testDataExcluded?75:76),S(10),Ve(e.commissions.platform.label),S(2),Ve(n.formatCurrency(e.commissions.platform.amount)),S(2),Ve(e.commissions.platform.description),S(3),Re("Tasa: ",e.commissions.platform.rate,"%"),S(9),uo("height","90%"),S(3),Ve(n.formatCurrency(e.income.gross.total)),S(4),uo("height",e.income.net.total/e.income.gross.total*90+"%"),S(3),Ve(n.formatCurrency(e.income.net.total)),S(6),Ve(e.income.difference.label),S(2),Ve(n.formatCurrency(e.income.difference.amount)),S(2),Re("",e.income.difference.percentage," del total"),S(9),Ve(n.formatCurrency(e.commissions.platform.amount+e.commissions.instructors.amount)),S(5),Ve(n.formatCurrency(e.refunds.totalAmount)),S(4),Ve(e.counters.students),S(5),Ve(e.counters.instructors),S(5),Ve(e.counters.activeCourses),S(5),Ve(e.counters.activeProjects),S(5),Ve(e.counters.totalSales),S(5),Ve(e.counters.activeSales),S(3),ve(e.alerts.length>0?167:-1)}}function rW(i,t){if(i&1&&xe(0,KH,2,0,"div",25)(1,nW,168,43),i&2){let e,n=q();ve(n.dashboardService.isLoadingExecutiveMetrics()?0:(e=n.dashboardService.executiveMetrics())?1:-1,e)}}function aW(i,t){i&1&&ce(0,"app-users")}function sW(i,t){i&1&&ce(0,"app-carousel-dashboard")}function oW(i,t){i&1&&ce(0,"app-categories")}function lW(i,t){i&1&&ce(0,"app-courses")}function cW(i,t){i&1&&ce(0,"app-discounts")}function uW(i,t){i&1&&ce(0,"app-sales")}function dW(i,t){i&1&&ce(0,"app-projects")}function fW(i,t){i&1&&ce(0,"app-students")}function hW(i,t){i&1&&ce(0,"app-reports")}function pW(i,t){i&1&&ce(0,"app-settings")}function mW(i,t){i&1&&ce(0,"app-appearance")}function gW(i,t){i&1&&ce(0,"app-instructor-earnings")}function xW(i,t){i&1&&ce(0,"app-instructor-payment-history")}function vW(i,t){i&1&&ce(0,"app-instructor-payment-config")}function _W(i,t){i&1&&ce(0,"app-admin-instructor-payments")}function bW(i,t){i&1&&ce(0,"app-admin-payment-history")}function wW(i,t){i&1&&ce(0,"app-admin-commission-settings")}function yW(i,t){i&1&&ce(0,"app-system-settings")}function SW(i,t){i&1&&ce(0,"app-refunds")}function CW(i,t){i&1&&ce(0,"app-admin-wallets")}function EW(i,t){i&1&&ce(0,"app-review-notifications")}function kW(i,t){i&1&&ce(0,"app-admin-tax-breakdown")}function TW(i,t){i&1&&ce(0,"app-coupons")}var aC=class i{constructor(t){this.renderer=t;gu(()=>{this.isMobile()&&this.isSidebarOpen()?this.renderer.addClass(document.body,"overflow-hidden"):this.renderer.removeClass(document.body,"overflow-hidden")})}animate=lt(Df);dashboardService=lt(If);authService=lt(pn);systemConfigService=lt(Ns);route=lt(Fv);router=lt(el);drawer=null;resizeListener=null;Math=Math;isSidebarOpen=Ae(!1);isSidebarCollapsed=Ae(!1);screenWidth=Ae(typeof window<"u"?window.innerWidth:1024);isMobile=Ge(()=>this.screenWidth()<1024);onResize(t){let e=t.target.innerWidth;this.screenWidth.set(e),e>=1024?(this.isSidebarOpen.set(!0),this.drawer&&this.drawer.hide()):this.isSidebarOpen()||this.drawer?.hide()}toggleSidebar(){if(this.isMobile()){if(!this.drawer){this.initializeDrawer();return}this.isSidebarOpen()?(this.drawer.hide(),this.isSidebarOpen.set(!1)):(this.drawer.show(),this.isSidebarOpen.set(!0))}else this.isSidebarCollapsed.update(t=>!t)}toggleCollapse(){this.isSidebarCollapsed.update(t=>!t)}getUserInitial(){let t=this.authService.user()?.name;return t?t.charAt(0).toUpperCase():"?"}active="executive-dashboard";setActive(t){if(!this.isSectionAllowed(t)){let e=this.authService.user()?.rol==="admin"?"executive-dashboard":"instructor-earnings";this.setActive(e);return}this.active=t,this.router.navigate([],{relativeTo:this.route,queryParams:{section:t},queryParamsHandling:"merge"}),t==="executive-dashboard"&&this.authService.user()?.rol==="admin"&&setTimeout(()=>{this.dashboardService.loadExecutiveMetrics()},100),this.isMobile()&&this.closeMobileSidebar()}isSectionAllowed(t){return t==="courses"?this.systemConfigService.config()?.modules?.courses??!0:!0}closeMobileSidebar(){if(!this.drawer||!this.isMobile())return;let t=document.getElementById("dashboard-drawer");if(t){let e=t.querySelector(":focus");e&&e.blur()}this.isSidebarOpen.set(!1),this.drawer.hide(),setTimeout(()=>{let e=document.querySelector("main");e&&e.focus()},100)}allItems=[{id:"executive-dashboard",label:"Dashboard Ejecutivo",icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",adminOnly:!0},{id:"review-notifications",label:"Notificaciones",icon:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9",adminOnly:!0},{id:"users",label:"Usuarios",icon:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z",adminOnly:!0},{id:"categories",label:"Categor\xEDas",icon:"M4 6h16M4 12h16M4 18h16",adminOnly:!0},{id:"courses",label:"Cursos",icon:"M4 6h16M4 12h16M4 18h16"},{id:"discounts",label:"Descuentos",icon:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z",adminOnly:!0},{id:"sales",label:"Ventas",icon:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"},{id:"projects",label:"Proyectos",icon:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"},{id:"students",label:"Estudiantes",icon:"M15 11a3 3 0 1 0-6 0m10 10a7 7 0 0 0-14 0"},{id:"carousel-dashboard",label:"Carrusel",icon:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z",adminOnly:!0},{id:"reports",label:"Reportes",icon:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",adminOnly:!0},{id:"appearance",label:"Apariencia",icon:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z",adminOnly:!0},{id:"settings",label:"Destacados",icon:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z",adminOnly:!0},{id:"system-settings",label:"Configuraci\xF3n",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.608 3.292 0z M12 12a3 3 0 100-6 3 3 0 000 6z",adminOnly:!0},{id:"admin-instructor-payments",label:"Pagos a Instructores",icon:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z",adminOnly:!0},{id:"admin-payment-history",label:"Historial de Pagos",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",adminOnly:!0},{id:"admin-commission-settings",label:"Comisiones",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",adminOnly:!0},{id:"admin-tax-breakdown",label:"Desglose Fiscal",icon:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z",adminOnly:!0},{id:"instructor-earnings",label:"Mis Ganancias",icon:"M13 10V3L4 14h7v7l9-11h-7z"},{id:"instructor-payment-history",label:"Mis Pagos",icon:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},{id:"instructor-payment-config",label:"Config. de Pago",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.608 3.292 0z M12 12a3 3 0 100-6 3 3 0 000 6z"},{id:"coupons",label:"Cupones de Referido",icon:"M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"},{id:"refunds",label:"Solicitudes de Reembolso",icon:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6",adminOnly:!0},{id:"wallets",label:"Billeteras de Usuarios",icon:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z",adminOnly:!0}];items=Ge(()=>{let t=this.authService.user(),e=t?.rol,n=this.systemConfigService.config()?.modules?.courses??!0,r=this.allItems;return n||(r=this.allItems.filter(a=>a.id!=="courses")),!t||!e?[]:e==="admin"?r.sort((a,s)=>a.id==="executive-dashboard"?-1:s.id==="executive-dashboard"?1:0):e==="instructor"?r.filter(a=>!("adminOnly"in a&&a.adminOnly||a.id.startsWith("admin-"))):[]});ngOnInit(){this.systemConfigService.getConfig(),this.screenWidth.set(window.innerWidth),window.innerWidth>=1024&&this.isSidebarOpen.set(!0);let t=this.authService.user();t&&(t.rol==="admin"?this.active="executive-dashboard":t.rol==="instructor"&&(this.active="instructor-earnings")),this.route.queryParams.subscribe(e=>{if(e.section){let n=e.section;if(this.isSectionAllowed(n))this.active=n;else{let r=t?.rol==="admin"?"executive-dashboard":"instructor-earnings";this.active=r,this.router.navigate([],{relativeTo:this.route,queryParams:{section:r},queryParamsHandling:"merge"})}}else{let n=t?.rol==="admin"?"executive-dashboard":"instructor-earnings";this.router.navigate([],{relativeTo:this.route,queryParams:{section:n},queryParamsHandling:"merge"})}}),this.dashboardService.reloadKpis(),this.dashboardService.loadMonthlyIncome(),this.dashboardService.loadRecentActivity(),this.authService.user()?.rol==="admin"&&(this.dashboardService.loadExecutiveMetrics(),setTimeout(()=>{let e=this.dashboardService.executiveMetrics()},2e3))}formatCurrency(t){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN"}).format(t)}getAlertClass(t){return{warning:"bg-yellow-500/10 border-yellow-500/30 text-yellow-300",danger:"bg-red-500/10 border-red-500/30 text-red-300",info:"bg-blue-500/10 border-blue-500/30 text-blue-300"}[t]}getAlertIcon(t){return{warning:"\u26A0\uFE0F",danger:"\u{1F6D1}",info:"\u2139\uFE0F"}[t]}getPriorityBadgeClass(t){return{high:"bg-red-500/20 text-red-300",medium:"bg-yellow-500/20 text-yellow-300",low:"bg-blue-500/20 text-blue-300"}[t]}navigateToSection(t){this.active=t,this.router.navigate([],{relativeTo:this.route,queryParams:{section:t},queryParamsHandling:"merge"})}ngAfterViewInit(){setTimeout(()=>{this.initializeDrawer()},100)}initializeDrawer(){let t=document.getElementById("dashboard-drawer");if(!t)return;let e={placement:"left",backdrop:!0,bodyScrolling:!1,edge:!1,edgeOffset:"",backdropClasses:"bg-slate-900/80 backdrop-blur-sm fixed inset-0 z-30 lg:hidden",onHide:()=>{this.isSidebarOpen.set(!1)},onShow:()=>{this.isSidebarOpen.set(!0)}};try{this.drawer=new Iv(t,e),setTimeout(()=>{let n=document.querySelector('[data-drawer-backdrop="dashboard-drawer"]');n&&n.addEventListener("click",()=>{this.isMobile()&&this.closeMobileSidebar()})},200),Rv()}catch{}}ngOnDestroy(){this.renderer.removeClass(document.body,"overflow-hidden"),this.drawer&&(this.drawer.hide(),this.drawer=null)}static \u0275fac=function(e){return new(e||i)(_f(bv))};static \u0275cmp=Bt({type:i,selectors:[["app-dashboard"]],hostBindings:function(e,n){e&1&&ue("resize",function(a){return n.onResize(a)},vv)},decls:50,vars:30,consts:[[1,"bg-slate-950","text-white","h-screen","flex","flex-col","lg:flex-row","overflow-hidden"],["id","dashboard-drawer","tabindex","-1","aria-labelledby","drawer-label",1,"fixed","top-0","left-0","z-40","h-full","transition-all","duration-300","-translate-x-full","lg:translate-x-0","lg:relative","lg:flex-shrink-0","bg-slate-900/95","backdrop-blur-xl","border-r","border-white/5","shadow-2xl","shadow-black/50"],[1,"h-full","flex","flex-col","overflow-hidden"],[1,"flex-shrink-0","border-b","border-white/5"],["routerLink","/",1,"flex","items-center","gap-3","px-5","py-6","hover:bg-white/5","transition-colors","duration-200"],[1,"h-10","w-10","rounded-xl","object-cover","shrink-0","ring-2","ring-white/10",3,"src","alt"],[1,"h-10","w-10","rounded-xl","bg-gradient-to-br","from-lime-400","via-emerald-400","to-cyan-400","grid","place-items-center","text-slate-900","font-black","shrink-0","shadow-lg","shadow-lime-500/30"],[1,"flex-1","min-w-0"],[1,"text-lg","font-bold","text-white","truncate"],[1,"text-xs","text-slate-400"],[1,"hidden","lg:flex","justify-end","px-3","pb-3"],["type","button",1,"p-2","rounded-lg","bg-white/5","hover:bg-white/10","text-slate-400","hover:text-white","transition-all","duration-200",3,"click","title"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","transition-transform","duration-200"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 19l-7-7 7-7m8 14l-7-7 7-7"],[1,"flex-1","min-h-0",3,"navigate","selected","items","isCollapsed"],[1,"flex-shrink-0","border-t","border-white/5","p-4"],[1,"flex","items-center","gap-3"],[1,"w-10","h-10","rounded-full","bg-gradient-to-br","from-lime-400","to-emerald-400","grid","place-items-center","text-slate-900","font-bold","shrink-0","ring-2","ring-white/10"],["data-drawer-backdrop","dashboard-drawer",1,"bg-slate-950/80","backdrop-blur-sm","fixed","inset-0","z-30","lg:hidden","hidden","transition-opacity","duration-300"],["tabindex","-1",1,"flex-1","relative","h-full","overflow-y-auto","touch-pan-y","overscroll-contain"],[3,"toggleSidebar","isSidebarCollapsed"],[1,"p-4","md:p-6","lg:p-8","space-y-8"],[1,"h-10","w-10","rounded-xl","object-cover","shrink-0","ring-2","ring-white/10",3,"error","src","alt"],[1,"text-sm","font-medium","text-white","truncate"],[1,"text-xs","text-slate-400","capitalize","truncate"],[1,"flex","justify-center","items-center","py-20"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"mb-8"],[1,"flex","items-center","gap-3","mb-2"],[1,"w-12","h-12","rounded-xl","bg-gradient-to-br","from-lime-400","via-emerald-400","to-cyan-400","grid","place-items-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-7","h-7","text-slate-900"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"],[1,"text-3xl","md:text-4xl","font-bold","text-white"],[1,"text-slate-400"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-slate-200"],[1,"flex","items-center","gap-2","cursor-pointer"],["type","checkbox",1,"w-4","h-4","rounded","border-slate-600","bg-slate-800","text-blue-500",3,"change","checked"],[1,"text-sm","text-slate-400"],[1,"px-2","py-1","text-xs","font-medium","bg-blue-500/10","text-blue-400","rounded"],[1,"grid","md:grid-cols-2","xl:grid-cols-4","gap-6","mb-8"],[1,"group","relative","overflow-hidden","rounded-2xl","border","border-white/10","bg-gradient-to-br","from-lime-900/20","to-lime-800/10","p-6","backdrop-blur-xl","hover:scale-105","transition-all","duration-300"],[1,"absolute","inset-0","bg-gradient-to-br","from-lime-500/10","to-transparent","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"relative","z-10"],[1,"flex","items-center","justify-between","mb-4"],[1,"w-12","h-12","rounded-xl","bg-lime-500/10","text-lime-400","flex","items-center","justify-center","ring-1","ring-lime-500/20"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","font-medium","text-lime-400/80","mb-2"],[1,"text-3xl","font-extrabold","text-lime-300","mb-1"],[1,"mt-3","pt-3","border-t","border-lime-500/10"],[1,"text-xs","text-lime-400/60"],[1,"group","relative","overflow-hidden","rounded-2xl","border","border-white/10","bg-gradient-to-br","from-emerald-900/20","to-emerald-800/10","p-6","backdrop-blur-xl","hover:scale-105","transition-all","duration-300"],[1,"absolute","inset-0","bg-gradient-to-br","from-emerald-500/10","to-transparent","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"w-12","h-12","rounded-xl","bg-emerald-500/10","text-emerald-400","flex","items-center","justify-center","ring-1","ring-emerald-500/20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"px-2","py-1","rounded-full","text-xs","font-bold",3,"ngClass"],[1,"text-sm","font-medium","text-emerald-400/80","mb-2"],[1,"text-3xl","font-extrabold","text-emerald-300","mb-1"],[1,"mt-3","pt-3","border-t","border-emerald-500/10","space-y-1"],[1,"text-xs","text-emerald-400/60"],[1,"text-xs","text-slate-500"],[1,"group","relative","overflow-hidden","rounded-2xl","border","border-white/10","bg-gradient-to-br","from-red-900/20","to-red-800/10","p-6","backdrop-blur-xl","hover:scale-105","transition-all","duration-300"],[1,"absolute","inset-0","bg-gradient-to-br","from-red-500/10","to-transparent","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"w-12","h-12","rounded-xl","bg-red-500/10","text-red-400","flex","items-center","justify-center","ring-1","ring-red-500/20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"],[1,"px-2","py-1","rounded-full","bg-orange-500/10","text-orange-400","text-xs","font-bold","ring-1","ring-orange-500/20"],[1,"text-sm","font-medium","text-red-400/80","mb-2"],[1,"text-3xl","font-extrabold","text-red-300","mb-1"],[1,"mt-3","pt-3","border-t","border-red-500/10","space-y-1"],[1,"text-xs","text-red-400/60"],[1,"border-t","border-red-500/10","pt-3","mt-3"],[1,"text-xs","text-green-400"],[1,"text-xs","text-orange-400"],[1,"group","relative","overflow-hidden","rounded-2xl","border","border-white/10","bg-gradient-to-br","from-cyan-900/20","to-cyan-800/10","p-6","backdrop-blur-xl","hover:scale-105","transition-all","duration-300"],[1,"absolute","inset-0","bg-gradient-to-br","from-cyan-500/10","to-transparent","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"w-12","h-12","rounded-xl","bg-cyan-500/10","text-cyan-400","flex","items-center","justify-center","ring-1","ring-cyan-500/20"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"text-sm","font-medium","text-cyan-400/80","mb-2"],[1,"text-3xl","font-extrabold","text-cyan-300","mb-1"],[1,"mt-3","pt-3","border-t","border-cyan-500/10"],[1,"text-xs","text-cyan-400/60"],[1,"rounded-2xl","border","border-white/10","bg-gradient-to-br","from-slate-900/90","to-slate-800/50","p-6","backdrop-blur-xl","mb-8"],[1,"text-xl","font-bold","text-white","mb-4"],[1,"grid","md:grid-cols-3","gap-6"],[1,"md:col-span-2"],[1,"bg-white/5","rounded-xl","p-6"],[1,"flex","items-end","justify-between","h-48"],[1,"flex-1","flex","flex-col","justify-end","items-center","gap-2"],[1,"w-full","bg-gradient-to-t","from-lime-500","to-lime-300","rounded-t-lg"],[1,"h-full","flex","items-start","justify-center","pt-3"],[1,"text-xs","font-bold","text-slate-900"],[1,"text-sm","text-lime-400","font-medium"],[1,"w-full","bg-gradient-to-t","from-emerald-500","to-emerald-300","rounded-t-lg"],[1,"text-sm","text-emerald-400","font-medium"],[1,"flex","flex-col","justify-center"],[1,"text-sm","text-slate-400","mb-2"],[1,"text-4xl","font-extrabold","text-orange-400","mb-1"],[1,"text-sm","text-slate-500"],[1,"mt-4","pt-4","border-t","border-white/10"],[1,"text-xs","text-slate-400","mb-2"],[1,"space-y-2"],[1,"flex","justify-between","text-xs"],[1,"text-slate-500"],[1,"text-white","font-medium"],[1,"text-red-400","font-medium"],[1,"grid","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-6","gap-4","mb-8"],[1,"rounded-xl","bg-white/5","p-4","text-center"],[1,"text-2xl","font-bold","text-white"],[1,"rounded-2xl","border","border-white/10","bg-gradient-to-br","from-slate-900/90","to-slate-800/50","p-6","backdrop-blur-xl"],[1,"flex","items-center","gap-2","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-orange-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"text-xl","font-bold","text-white"],[1,"space-y-3"],[1,"flex","items-start","gap-3","p-4","rounded-xl","border",3,"ngClass"],[1,"text-2xl"],[1,"flex-1"],[1,"text-sm","font-medium"]],template:function(e,n){if(e&1&&(f(0,"div",0)(1,"aside",1),bf(function(a){return n.animate.animateFadeInDashboard(a)}),f(2,"div",2)(3,"div",3)(4,"a",4),xe(5,$H,1,2,"img",5)(6,XH,2,1,"div",6),f(7,"div",7)(8,"h1",8),x(9),p(),f(10,"p",9),x(11,"Dashboard"),p()()(),f(12,"div",10)(13,"button",11),ue("click",function(){return n.toggleCollapse()}),st(),f(14,"svg",12),ce(15,"path",13),p()()()(),xt(),f(16,"app-sidebar",14),ue("navigate",function(a){return n.setActive(a)}),p(),f(17,"div",15)(18,"div",16)(19,"div",17),x(20),p(),xe(21,YH,5,2,"div",7),p()()()(),ce(22,"div",18),f(23,"main",19)(24,"app-topbar",20),ue("toggleSidebar",function(){return n.toggleSidebar()}),p(),f(25,"div",21),xe(26,rW,2,1)(27,aW,1,0,"app-users")(28,sW,1,0,"app-carousel-dashboard")(29,oW,1,0,"app-categories")(30,lW,1,0,"app-courses")(31,cW,1,0,"app-discounts")(32,uW,1,0,"app-sales")(33,dW,1,0,"app-projects")(34,fW,1,0,"app-students")(35,hW,1,0,"app-reports")(36,pW,1,0,"app-settings")(37,mW,1,0,"app-appearance")(38,gW,1,0,"app-instructor-earnings")(39,xW,1,0,"app-instructor-payment-history")(40,vW,1,0,"app-instructor-payment-config")(41,_W,1,0,"app-admin-instructor-payments")(42,bW,1,0,"app-admin-payment-history")(43,wW,1,0,"app-admin-commission-settings")(44,yW,1,0,"app-system-settings")(45,SW,1,0,"app-refunds")(46,CW,1,0,"app-admin-wallets")(47,EW,1,0,"app-review-notifications")(48,kW,1,0,"app-admin-tax-breakdown")(49,TW,1,0,"app-coupons"),p()()()),e&2){let r,a,s;S(),oi("w-72",!n.isSidebarCollapsed())("w-20",n.isSidebarCollapsed())("lg:w-72",!n.isSidebarCollapsed())("lg:w-20",n.isSidebarCollapsed()),S(3),oi("justify-center",n.isSidebarCollapsed()),S(),ve((r=n.systemConfigService.config())!=null&&r.logo?5:6),S(2),oi("lg:hidden",n.isSidebarCollapsed()),S(2),Re(" ",((a=n.systemConfigService.config())==null?null:a.siteName)||"Dev-Sharks"," "),S(3),oi("justify-center",n.isSidebarCollapsed()),S(),Ce("title",n.isSidebarCollapsed()?"Expandir sidebar":"Colapsar sidebar"),S(),oi("rotate-180",n.isSidebarCollapsed()),S(2),Ce("selected",n.active)("items",n.items())("isCollapsed",n.isSidebarCollapsed()),S(),oi("px-2",n.isSidebarCollapsed()),S(),oi("justify-center",n.isSidebarCollapsed()),S(2),Re(" ",n.getUserInitial()," "),S(),ve(n.isSidebarCollapsed()?-1:21),S(3),Ce("isSidebarCollapsed",n.isSidebarCollapsed()),S(2),ve((s=n.active)==="executive-dashboard"?26:s==="users"?27:s==="carousel-dashboard"?28:s==="categories"?29:s==="courses"?30:s==="discounts"?31:s==="sales"?32:s==="projects"?33:s==="students"?34:s==="reports"?35:s==="settings"?36:s==="appearance"?37:s==="instructor-earnings"?38:s==="instructor-payment-history"?39:s==="instructor-payment-config"?40:s==="admin-instructor-payments"?41:s==="admin-payment-history"?42:s==="admin-commission-settings"?43:s==="system-settings"?44:s==="refunds"?45:s==="wallets"?46:s==="review-notifications"?47:s==="admin-tax-breakdown"?48:s==="coupons"?49:-1)}},dependencies:[yn,Ds,Yf,Kf,Zf,Jf,th,eh,bp,Yv,Kv,nh,ah,Zv,Jv,Qv,zv,Wv,Hv,e_,t_,ph,ch,i_,uh,Gv,wp],encapsulation:2})};export{aC as DashboardComponent};
