import{a as se}from"./chunk-U4KQPHEN.js";import{a as R,b as O,c as D,d as $,e as Q,f as X,h as E,i as Y,j as J,k as U,n as q,o as K,p as ee,q as te,r as ie,t as ne,w as oe,x as re}from"./chunk-SDJWNAN2.js";import{a as z}from"./chunk-J56UX4WA.js";import{$ as v,Ac as A,Eb as N,Fb as P,Gb as r,Ha as V,Hb as C,Ib as b,Jb as j,Ma as a,T as G,Ub as W,Xa as H,Y as g,Z as _,_ as x,_b as L,ac as Z,ec as k,hb as f,ib as h,ja as S,lb as M,mb as T,nb as w,ob as i,pb as o,qb as p,ub as y,wb as u,wc as B,yb as c}from"./chunk-6JS7X5LE.js";var de=()=>({standalone:!0}),F=(l,t)=>t._id;function ce(l,t){l&1&&(i(0,"div",43)(1,"div",46),x(),i(2,"svg",47),p(3,"circle",48)(4,"path",49),o(),v(),i(5,"p",5),r(6,"Cargando descuentos..."),o()()())}function me(l,t){if(l&1&&r(0),l&2){let e=c().$implicit;b(" ",(e.courses==null?null:e.courses.length)||0," cursos ")}}function ue(l,t){if(l&1&&r(0),l&2){let e=c().$implicit;b(" ",(e.categories==null?null:e.categories.length)||0," categor\xEDas ")}}function pe(l,t){if(l&1&&r(0),l&2){let e=c().$implicit;b(" ",(e.projects==null?null:e.projects.length)||0," proyectos ")}}function ge(l,t){if(l&1){let e=y();i(0,"tr",56)(1,"td",57)(2,"div",58)(3,"div",59),x(),i(4,"svg",60),p(5,"path",61),o()(),v(),i(6,"div")(7,"p",62),r(8),o(),i(9,"p",63),r(10),o()()()(),i(11,"td",57)(12,"span"),r(13),o()(),i(14,"td",57)(15,"p",64),r(16),o(),i(17,"p",63),f(18,me,1,1)(19,ue,1,1)(20,pe,1,1),o()(),i(21,"td",57)(22,"div",65)(23,"p",66),r(24),L(25,"date"),o(),i(26,"p",5),r(27),L(28,"date"),o()()(),i(29,"td",57)(30,"span"),r(31),o()(),i(32,"td",57)(33,"div",67)(34,"button",68),u("click",function(){let s=g(e).$implicit,d=c(2);return _(d.openEditModal(s))}),x(),i(35,"svg",7),p(36,"path",69),o()(),v(),i(37,"button",70),u("click",function(){let s=g(e).$implicit,d=c(2);return _(d.confirmDelete(s))}),x(),i(38,"svg",7),p(39,"path",71),o()()()()()}if(l&2){let e=t.$implicit,n=c(2);a(8),j(" ",e.discount,"",e.type_discount===1?"%":" MXN"," "),a(2),C(n.getDiscountTypeLabel(e.type_discount)),a(2),P("px-3 py-1 rounded-full text-xs font-medium "+n.getCampaignBadge(e.type_campaign)),a(),b(" ",n.getCampaignLabel(e.type_campaign)," "),a(3),C(n.getSegmentLabel(e.type_segment)),a(2),h(e.type_segment===1?18:e.type_segment===2?19:20),a(6),C(Z(25,13,e.start_date,"dd/MM/yyyy")),a(3),C(Z(28,16,e.end_date,"dd/MM/yyyy")),a(3),P("px-3 py-1 rounded-full text-xs font-medium "+n.getStatusBadge(e)),a(),b(" ",n.getStatusText(e)," ")}}function _e(l,t){l&1&&(i(0,"tr")(1,"td",72)(2,"div",73),x(),i(3,"svg",74),p(4,"path",14),o(),v(),i(5,"p",75),r(6,"No se encontraron descuentos"),o(),i(7,"p",76),r(8,"Crea un nuevo descuento para empezar"),o()()()())}function xe(l,t){if(l&1&&(i(0,"div",44)(1,"div",50)(2,"table",51)(3,"thead",52)(4,"tr")(5,"th",53),r(6,"Descuento"),o(),i(7,"th",53),r(8,"Campa\xF1a"),o(),i(9,"th",53),r(10,"Segmento"),o(),i(11,"th",53),r(12,"Vigencia"),o(),i(13,"th",53),r(14,"Estado"),o(),i(15,"th",54),r(16,"Acciones"),o()()(),i(17,"tbody",55),M(18,ge,40,19,"tr",56,F,!1,_e,9,0,"tr"),o()()()()),l&2){let e=c();a(18),T(e.filteredDiscounts())}}function be(l,t){if(l&1&&r(0),l&2){let e,n=c(2);j(" ",n.selectedCourses().length," / ",((e=n.config())==null||e.courses==null?null:e.courses.length)||0," seleccionados ")}}function ve(l,t){if(l&1&&r(0),l&2){let e,n=c(2);j(" ",n.selectedCategories().length," / ",((e=n.config())==null||e.categories==null?null:e.categories.length)||0," seleccionados ")}}function fe(l,t){if(l&1&&r(0),l&2){let e,n=c(2);j(" ",n.selectedProjects().length," / ",((e=n.config())==null||e.projects==null?null:e.projects.length)||0," seleccionados ")}}function he(l,t){if(l&1){let e=y();i(0,"label",108)(1,"div",109)(2,"img",110),u("error",function(s){return g(e),_(s.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzFhMjMzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5NGEzYjgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pjwvc3ZnPg==")}),o(),i(3,"div",111)(4,"input",112),u("change",function(){let s=g(e).$implicit,d=c(3);return _(d.toggleCourse(s._id))}),o()(),i(5,"div",113)(6,"span",114),r(7),o()()(),i(8,"div",115)(9,"p",116),r(10),o(),i(11,"div",3)(12,"span",117),r(13),o(),i(14,"span",118),r(15,"Curso"),o()()()()}if(l&2){let e=t.$implicit,n=c(3);N("border-lime-500",n.selectedCourses().includes(e._id))("border-slate-700",!n.selectedCourses().includes(e._id)),a(2),w("src",n.getImageUrl(e.imagen,"course"),V)("alt",e.title),a(2),w("checked",n.selectedCourses().includes(e._id)),a(3),b(" ",e.categorie.title," "),a(3),C(e.title),a(3),b("$",e.price_mxn," (MXN)")}}function Ce(l,t){l&1&&(i(0,"div",107)(1,"p",5),r(2,"No se encontraron cursos"),o()())}function Se(l,t){if(l&1&&(i(0,"div",105),M(1,he,16,10,"label",106,F),o(),f(3,Ce,3,0,"div",107)),l&2){let e=c(2);a(),T(e.filteredCourses()),a(2),h(e.filteredCourses().length===0?3:-1)}}function we(l,t){if(l&1){let e=y();i(0,"label",108)(1,"div",109)(2,"img",110),u("error",function(s){return g(e),_(s.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzFhMjMzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5NGEzYjgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pjwvc3ZnPg==")}),o(),i(3,"div",111)(4,"input",112),u("change",function(){let s=g(e).$implicit,d=c(3);return _(d.toggleCategory(s._id))}),o()()(),i(5,"div",115)(6,"p",120),r(7),o()()()}if(l&2){let e=t.$implicit,n=c(3);N("border-lime-500",n.selectedCategories().includes(e._id))("border-slate-700",!n.selectedCategories().includes(e._id)),a(2),w("src",n.getImageUrl(e.imagen,"category"),V)("alt",e.title),a(2),w("checked",n.selectedCategories().includes(e._id)),a(3),C(e.title)}}function De(l,t){l&1&&(i(0,"div",107)(1,"p",5),r(2,"No se encontraron categor\xEDas"),o()())}function Ee(l,t){if(l&1&&(i(0,"div",119),M(1,we,8,8,"label",106,F),o(),f(3,De,3,0,"div",107)),l&2){let e=c(2);a(),T(e.filteredCategories()),a(2),h(e.filteredCategories().length===0?3:-1)}}function ye(l,t){if(l&1){let e=y();i(0,"label",108)(1,"div",109)(2,"img",110),u("error",function(s){return g(e),_(s.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzFhMjMzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5NGEzYjgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pjwvc3ZnPg==")}),o(),i(3,"div",111)(4,"input",112),u("change",function(){let s=g(e).$implicit,d=c(3);return _(d.toggleProject(s._id))}),o()(),i(5,"div",113)(6,"span",114),r(7),o()()(),i(8,"div",115)(9,"p",116),r(10),o(),i(11,"div",3)(12,"span",117),r(13),o(),i(14,"span",118),r(15,"Proyecto"),o()()()()}if(l&2){let e=t.$implicit,n=c(3);N("border-lime-500",n.selectedProjects().includes(e._id))("border-slate-700",!n.selectedProjects().includes(e._id)),a(2),w("src",n.getImageUrl(e.imagen,"project"),V)("alt",e.title),a(2),w("checked",n.selectedProjects().includes(e._id)),a(3),b(" ",e.categorie.title," "),a(3),C(e.title),a(3),b("$",e.price_mxn," (MXN)")}}function Ie(l,t){l&1&&(i(0,"div",107)(1,"p",5),r(2,"No se encontraron proyectos"),o()())}function Me(l,t){if(l&1&&(i(0,"div",105),M(1,ye,16,10,"label",106,F),o(),f(3,Ie,3,0,"div",107)),l&2){let e=c(2);a(),T(e.filteredProjects()),a(2),h(e.filteredProjects().length===0?3:-1)}}function Te(l,t){if(l&1){let e=y();i(0,"div",77),u("click",function(){g(e);let s=c();return _(s.isCreateModalOpen()?s.closeCreateModal():s.closeEditModal())}),i(1,"div",78),p(2,"div",79),i(3,"div",80),u("click",function(s){return g(e),_(s.stopPropagation())}),i(4,"div",81)(5,"h3",16),r(6),o(),i(7,"p",82),r(8,"Complete la informaci\xF3n del descuento"),o()(),i(9,"form",83),u("ngSubmit",function(){g(e);let s=c();return _(s.isCreateModalOpen()?s.saveCreate():s.saveEdit())}),i(10,"div",84)(11,"div")(12,"label",28),r(13,"Tipo de Campa\xF1a"),o(),i(14,"select",85)(15,"option",36),r(16,"Normal"),o(),i(17,"option",37),r(18,"Flash"),o(),i(19,"option",38),r(20,"Banner"),o()()(),i(21,"div")(22,"label",28),r(23,"Tipo de Descuento"),o(),i(24,"select",86)(25,"option",36),r(26,"Porcentaje (%)"),o(),i(27,"option",37),r(28,"Monto Fijo (MXN)"),o()()(),i(29,"div")(30,"label",28),r(31," Valor del Descuento "),i(32,"span",87),r(33,"*"),o()(),p(34,"input",88),o(),i(35,"div")(36,"label",28),r(37,"Aplicar a"),o(),i(38,"select",89),u("change",function(){g(e);let s=c();return _(s.onSegmentChange())}),i(39,"option",36),r(40,"Cursos"),o(),i(41,"option",37),r(42,"Categor\xEDas"),o(),i(43,"option",38),r(44,"Proyectos"),o()()(),i(45,"div")(46,"label",28),r(47," Fecha de Inicio "),i(48,"span",87),r(49,"*"),o()(),p(50,"input",90),o(),i(51,"div")(52,"label",28),r(53," Fecha de Fin "),i(54,"span",87),r(55,"*"),o()(),p(56,"input",91),o()(),i(57,"div",81)(58,"label",92),p(59,"input",93),i(60,"span",94),r(61,"Descuento activo"),o()()(),i(62,"div",81)(63,"div",95)(64,"h4",96),r(65),o(),i(66,"div",11)(67,"span",15),f(68,be,1,2)(69,ve,1,2)(70,fe,1,2),o(),i(71,"button",97),u("click",function(){g(e);let s=c();return _(s.selectAllItems())}),r(72," Seleccionar todo "),o(),i(73,"button",98),u("click",function(){g(e);let s=c();return _(s.clearAllItems())}),r(74," Limpiar "),o()()(),i(75,"div",99)(76,"div",29)(77,"div",30),x(),i(78,"svg",31),p(79,"path",32),o()(),v(),i(80,"input",100),u("ngModelChange",function(s){g(e);let d=c();return _(d.itemSearchTerm.set(s))}),o()()(),i(81,"div",101),f(82,Se,4,1),f(83,Ee,4,1),f(84,Me,4,1),o()(),i(85,"div",102)(86,"button",103),u("click",function(){g(e);let s=c();return _(s.isCreateModalOpen()?s.closeCreateModal():s.closeEditModal())}),r(87," Cancelar "),o(),i(88,"button",104),r(89),o()()()()()()}if(l&2){let e=c();a(6),b(" ",e.isCreateModalOpen()?"Crear Nuevo Descuento":"Editar Descuento"," "),a(3),w("formGroup",e.discountForm),a(56),b(" Seleccionar ",e.discountForm.value.type_segment==1?"Cursos":e.discountForm.value.type_segment==2?"Categor\xEDas":"Proyectos"," "),a(3),h(e.discountForm.value.type_segment==1?68:e.discountForm.value.type_segment==2?69:70),a(12),w("ngModel",e.itemSearchTerm())("ngModelOptions",W(11,de)),a(2),h(e.discountForm.value.type_segment==1&&e.config()?82:-1),a(),h(e.discountForm.value.type_segment==2&&e.config()?83:-1),a(),h(e.discountForm.value.type_segment==3&&e.config()?84:-1),a(4),w("disabled",e.discountForm.invalid),a(),b(" ",e.isCreateModalOpen()?"Crear Descuento":"Guardar Cambios"," ")}}var le=class l{discountService=G(se);discounts=this.discountService.discounts;config=this.discountService.config;isLoading=this.discountService.isLoading;stats=this.discountService.stats;searchTerm=S("");campaignFilter=S("");statusFilter=S("");filteredDiscounts=k(()=>{let t=this.discounts(),e=this.searchTerm().toLowerCase(),n=this.campaignFilter(),s=this.statusFilter(),d=Date.now();return e&&(t=t.filter(m=>m.discount.toString().includes(e))),n&&(t=t.filter(m=>m.type_campaign.toString()===n)),s==="active"?t=t.filter(m=>m.state&&m.end_date_num>=d&&m.start_date_num<=d):s==="expired"?t=t.filter(m=>m.end_date_num<d):s==="upcoming"?t=t.filter(m=>m.start_date_num>d):s==="inactive"&&(t=t.filter(m=>!m.state)),t});isCreateModalOpen=S(!1);isEditModalOpen=S(!1);currentDiscount=S(null);selectedCourses=S([]);selectedProjects=S([]);selectedCategories=S([]);itemSearchTerm=S("");filteredCourses=k(()=>{let t=this.config()?.courses;if(!t)return[];let e=this.itemSearchTerm().toLowerCase();return e?t.filter(n=>n.title.toLowerCase().includes(e)||n.categorie.title.toLowerCase().includes(e)):t});filteredProjects=k(()=>{let t=this.config()?.projects;if(!t)return[];let e=this.itemSearchTerm().toLowerCase();return e?t.filter(n=>n.title.toLowerCase().includes(e)||n.categorie.title.toLowerCase().includes(e)):t});filteredCategories=k(()=>{let t=this.config()?.categories;if(!t)return[];let e=this.itemSearchTerm().toLowerCase();return e?t.filter(n=>n.title.toLowerCase().includes(e)):t});discountForm=new X({type_campaign:new E(1,[D.required]),type_discount:new E(1,[D.required]),discount:new E(0,[D.required,D.min(0)]),start_date:new E("",[D.required]),end_date:new E("",[D.required]),type_segment:new E(1,[D.required]),state:new E(!0)});ngOnInit(){this.discountService.loadConfig().subscribe()}onSearch(t){this.searchTerm.set(t.target.value)}onCampaignFilter(t){this.campaignFilter.set(t.target.value)}onStatusFilter(t){this.statusFilter.set(t.target.value)}openCreateModal(){let t=new Date,e=this.toDatetimeLocalString(t),n=new Date(t.getTime()+10080*60*1e3),s=this.toDatetimeLocalString(n);this.discountForm.reset({type_campaign:1,type_discount:1,discount:0,type_segment:1,state:!0,start_date:e,end_date:s}),this.selectedCourses.set([]),this.selectedProjects.set([]),this.selectedCategories.set([]),this.itemSearchTerm.set(""),this.isCreateModalOpen.set(!0)}closeCreateModal(){this.isCreateModalOpen.set(!1)}saveCreate(){if(this.discountForm.invalid){Object.keys(this.discountForm.controls).forEach(I=>{this.discountForm.get(I)?.markAsTouched()}),alert("Por favor completa todos los campos requeridos");return}let t=this.discountForm.getRawValue(),e=Number(t.type_segment);if(e===1&&this.selectedCourses().length===0){alert("Debes seleccionar al menos un curso");return}if(e===2&&this.selectedCategories().length===0){alert("Debes seleccionar al menos una categor\xEDa");return}if(e===3&&this.selectedProjects().length===0){alert("Debes seleccionar al menos un proyecto");return}let n=new Date(t.start_date),s=new Date(t.end_date);if(isNaN(n.getTime())||isNaN(s.getTime())){alert("Las fechas proporcionadas no son v\xE1lidas");return}if(s<=n){alert("La fecha de fin debe ser posterior a la fecha de inicio");return}let d=e===1?this.selectedCourses():e===2?this.selectedCategories():this.selectedProjects(),m={type_campaign:Number(t.type_campaign),type_discount:Number(t.type_discount),discount:Number(t.discount),start_date:n.toISOString(),end_date:s.toISOString(),start_date_num:n.getTime(),end_date_num:s.getTime(),type_segment:e,state:!!t.state,courses:e===1?d:[],projects:e===3?d:[],categories:e===2?d:[],courses_s:e===1?d:[],projects_s:e===3?d:[],categories_s:e===2?d:[]};this.discountService.createDiscount(m).subscribe({next:()=>{alert("\u2705 Descuento creado exitosamente"),this.closeCreateModal()},error:I=>{alert(I.error?.message_text||"Error al crear descuento")}})}openEditModal(t){this.currentDiscount.set(t);let e=new Date(t.start_date),n=new Date(t.end_date),s=this.toDatetimeLocalString(e),d=this.toDatetimeLocalString(n);this.discountForm.patchValue({type_campaign:t.type_campaign,type_discount:t.type_discount,discount:t.discount,start_date:s,end_date:d,type_segment:t.type_segment,state:t.state}),this.selectedCourses.set(t.courses||[]),this.selectedProjects.set(t.projects||[]),this.selectedCategories.set(t.categories||[]),this.itemSearchTerm.set(""),this.isEditModalOpen.set(!0)}closeEditModal(){this.isEditModalOpen.set(!1),this.currentDiscount.set(null)}saveEdit(){if(this.discountForm.invalid){alert("Por favor completa todos los campos requeridos");return}let t=this.currentDiscount();if(!t)return;let e=this.discountForm.getRawValue(),n=Number(e.type_segment),s=new Date(e.start_date),d=new Date(e.end_date),m=n===1?this.selectedCourses():n===2?this.selectedCategories():this.selectedProjects(),I={_id:t._id,type_campaign:Number(e.type_campaign),type_discount:Number(e.type_discount),discount:Number(e.discount),start_date:s.toISOString(),end_date:d.toISOString(),start_date_num:s.getTime(),end_date_num:d.getTime(),type_segment:n,state:!!e.state,courses:n===1?m:[],projects:n===3?m:[],categories:n===2?m:[],courses_s:n===1?m:[],projects_s:n===3?m:[],categories_s:n===2?m:[]};this.discountService.updateDiscount(I).subscribe({next:()=>{alert("\u2705 Descuento actualizado exitosamente"),this.closeEditModal()},error:ae=>{alert(ae.error?.message_text||"Error al actualizar descuento")}})}confirmDelete(t){window.confirm(`\xBFEst\xE1s seguro de eliminar este descuento de ${t.discount}${t.type_discount===1?"%":" MXN"}?`)&&this.discountService.deleteDiscount(t._id).subscribe({next:()=>{alert("\u2705 Descuento eliminado exitosamente")},error:()=>{alert("\u274C Error al eliminar descuento")}})}toggleCourse(t){let e=this.selectedCourses();e.includes(t)?this.selectedCourses.set(e.filter(n=>n!==t)):this.selectedCourses.set([...e,t])}toggleProject(t){let e=this.selectedProjects();e.includes(t)?this.selectedProjects.set(e.filter(n=>n!==t)):this.selectedProjects.set([...e,t])}toggleCategory(t){let e=this.selectedCategories();e.includes(t)?this.selectedCategories.set(e.filter(n=>n!==t)):this.selectedCategories.set([...e,t])}getCampaignLabel(t){return{1:"Normal",2:"Flash",3:"Banner"}[t]||"Desconocido"}getDiscountTypeLabel(t){return t===1?"Porcentaje":"Monto Fijo"}getSegmentLabel(t){return{1:"Cursos",2:"Categor\xEDas",3:"Proyectos"}[t]||"Desconocido"}getDiscountStatus(t){let e=Date.now();return t.state?t.start_date_num>e?"upcoming":t.end_date_num<e?"expired":"active":"inactive"}getStatusBadge(t){let e=this.getDiscountStatus(t);return{active:"bg-green-500/20 text-green-400 border border-green-500/30",expired:"bg-red-500/20 text-red-400 border border-red-500/30",upcoming:"bg-blue-500/20 text-blue-400 border border-blue-500/30",inactive:"bg-slate-500/20 text-slate-400 border border-slate-500/30"}[e]}getStatusText(t){let e=this.getDiscountStatus(t);return{active:"Activo",expired:"Expirado",upcoming:"Pr\xF3ximo",inactive:"Inactivo"}[e]}getCampaignBadge(t){return{1:"bg-blue-500/20 text-blue-400 border border-blue-500/30",2:"bg-orange-500/20 text-orange-400 border border-orange-500/30",3:"bg-purple-500/20 text-purple-400 border border-purple-500/30"}[t]||"bg-slate-500/20 text-slate-400 border border-slate-500/30"}getImageUrl(t,e){if(!t)return"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iNDAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iIzFhMjMzYSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5NGEzYjgiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5TaW4gSW1hZ2VuPC90ZXh0Pjwvc3ZnPg==";let n={course:"courses/imagen-course",project:"projects/imagen-project",category:"categories/imagen-categorie"};return`${z.url}${n[e]}/${t}`}toDatetimeLocalString(t){let e=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),d=String(t.getHours()).padStart(2,"0"),m=String(t.getMinutes()).padStart(2,"0");return`${e}-${n}-${s}T${d}:${m}`}onSegmentChange(){this.itemSearchTerm.set(""),this.selectedCourses.set([]),this.selectedProjects.set([]),this.selectedCategories.set([])}selectAllItems(){let t=this.discountForm.value.type_segment;if(t===1&&this.config()?.courses){let n=this.filteredCourses().map(s=>s._id);this.selectedCourses.set([...new Set([...this.selectedCourses(),...n])])}else if(t===2&&this.config()?.categories){let n=this.filteredCategories().map(s=>s._id);this.selectedCategories.set([...new Set([...this.selectedCategories(),...n])])}else if(t===3&&this.config()?.projects){let n=this.filteredProjects().map(s=>s._id);this.selectedProjects.set([...new Set([...this.selectedProjects(),...n])])}}clearAllItems(){let t=this.discountForm.value.type_segment;t===1?this.selectedCourses.set([]):t===2?this.selectedCategories.set([]):t===3&&this.selectedProjects.set([])}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=H({type:l,selectors:[["app-discounts"]],decls:93,vars:7,consts:[[1,"min-h-screen","bg-slate-950","p-6"],[1,"max-w-7xl","mx-auto"],[1,"mb-8"],[1,"flex","items-center","justify-between"],[1,"text-3xl","font-bold","text-white","mb-2"],[1,"text-slate-400"],[1,"flex","items-center","gap-2","px-4","py-2","bg-lime-400","text-slate-900","font-semibold","rounded-lg","hover:bg-lime-300","transition",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-4","mb-6"],[1,"bg-slate-800/50","backdrop-blur-lg","border","border-white/10","rounded-xl","p-4"],[1,"flex","items-center","gap-3"],[1,"w-12","h-12","rounded-full","bg-purple-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-purple-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"text-slate-400","text-sm"],[1,"text-2xl","font-bold","text-white"],[1,"w-12","h-12","rounded-full","bg-green-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"w-12","h-12","rounded-full","bg-blue-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"w-12","h-12","rounded-full","bg-red-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"bg-slate-800/50","backdrop-blur-lg","border","border-white/10","rounded-xl","p-6","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],[1,"relative"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-5","w-5","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"],["type","text","placeholder","Valor del descuento...",1,"w-full","pl-10","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5",3,"input"],[1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5",3,"change"],["value",""],["value","1"],["value","2"],["value","3"],["value","active"],["value","upcoming"],["value","expired"],["value","inactive"],[1,"bg-slate-800/50","backdrop-blur-lg","border","border-white/10","rounded-xl","p-12","text-center"],[1,"bg-slate-800/50","backdrop-blur-lg","border","border-white/10","rounded-xl","overflow-hidden"],[1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"flex","flex-col","items-center","gap-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-12","w-12","text-lime-400"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-900/70","border-b","border-white/10"],[1,"px-6","py-4","text-left","text-xs","font-medium","text-slate-300","uppercase","tracking-wider"],[1,"px-6","py-4","text-right","text-xs","font-medium","text-slate-300","uppercase","tracking-wider"],[1,"divide-y","divide-white/10"],[1,"hover:bg-slate-700/30","transition"],[1,"px-6","py-4"],[1,"flex","items-center","gap-2"],[1,"w-10","h-10","rounded-lg","bg-lime-500/20","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-white","font-bold","text-lg"],[1,"text-slate-400","text-xs"],[1,"text-white","text-sm"],[1,"text-sm"],[1,"text-white"],[1,"flex","items-center","justify-end","gap-2"],["title","Editar descuento",1,"p-2","text-lime-400","hover:bg-lime-500/20","rounded-lg","transition",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"],["title","Eliminar descuento",1,"p-2","text-red-400","hover:bg-red-500/20","rounded-lg","transition",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"],["colspan","6",1,"px-6","py-12","text-center"],[1,"flex","flex-col","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","text-slate-600"],[1,"text-slate-400","text-lg"],[1,"text-slate-500","text-sm"],[1,"fixed","inset-0","z-50","overflow-y-auto",3,"click"],[1,"flex","items-center","justify-center","min-h-screen","px-4","py-8"],[1,"fixed","inset-0","bg-black/70","backdrop-blur-sm"],[1,"relative","bg-slate-800","rounded-2xl","p-6","w-full","max-w-4xl","border","border-white/10","shadow-2xl","max-h-[90vh]","overflow-y-auto",3,"click"],[1,"mb-6"],[1,"text-slate-400","mt-2"],[3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],["formControlName","type_campaign",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5"],["formControlName","type_discount",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5"],[1,"text-red-400"],["type","number","formControlName","discount","min","0","placeholder","20",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5"],["formControlName","type_segment",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5",3,"change"],["type","datetime-local","formControlName","start_date",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5"],["type","datetime-local","formControlName","end_date",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5"],[1,"flex","items-center","gap-2","cursor-pointer"],["type","checkbox","formControlName","state",1,"w-4","h-4","text-lime-400","bg-slate-900","border-slate-700","rounded","focus:ring-lime-500"],[1,"text-slate-300","text-sm"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-white"],["type","button",1,"px-3","py-1","text-xs","bg-lime-500/20","text-lime-400","border","border-lime-500/30","rounded-lg","hover:bg-lime-500/30","transition",3,"click"],["type","button",1,"px-3","py-1","text-xs","bg-red-500/20","text-red-400","border","border-red-500/30","rounded-lg","hover:bg-red-500/30","transition",3,"click"],[1,"mb-4"],["type","text","placeholder","Buscar por t\xEDtulo...",1,"w-full","pl-10","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","p-2.5",3,"ngModelChange","ngModel","ngModelOptions"],[1,"max-h-[400px]","overflow-y-auto","p-4","bg-slate-900/30","rounded-lg","border","border-slate-700"],[1,"flex","gap-3"],["type","button",1,"flex-1","px-4","py-2","bg-slate-700","text-white","font-medium","rounded-lg","hover:bg-slate-600","transition",3,"click"],["type","submit",1,"flex-1","px-4","py-2","bg-lime-400","text-slate-900","font-semibold","rounded-lg","hover:bg-lime-300","transition","disabled:bg-slate-600","disabled:cursor-not-allowed",3,"disabled"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-3"],[1,"group","relative","flex","flex-col","bg-slate-800","rounded-lg","border-2","cursor-pointer","hover:border-lime-500/50","transition","overflow-hidden","has-[:checked]:border-lime-500","has-[:checked]:bg-lime-500/5",3,"border-lime-500","border-slate-700"],[1,"text-center","py-8"],[1,"group","relative","flex","flex-col","bg-slate-800","rounded-lg","border-2","cursor-pointer","hover:border-lime-500/50","transition","overflow-hidden","has-[:checked]:border-lime-500","has-[:checked]:bg-lime-500/5"],[1,"relative","w-full","h-32","bg-slate-900","overflow-hidden"],[1,"w-full","h-full","object-cover",3,"error","src","alt"],[1,"absolute","top-2","right-2"],["type","checkbox",1,"w-5","h-5","text-lime-400","bg-slate-900","border-2","border-slate-600","rounded","focus:ring-lime-500","cursor-pointer",3,"change","checked"],[1,"absolute","bottom-2","left-2"],[1,"px-2","py-1","text-xs","bg-slate-900/80","text-slate-300","rounded","backdrop-blur-sm"],[1,"p-3"],[1,"text-white","text-sm","font-medium","line-clamp-2","mb-2"],[1,"text-lime-400","font-bold"],[1,"text-xs","text-slate-400"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-3"],[1,"text-white","text-sm","font-medium","line-clamp-2","text-center"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"h1",4),r(6,"Gesti\xF3n de Descuentos"),o(),i(7,"p",5),r(8,"Administra descuentos para cursos, proyectos y categor\xEDas"),o()(),i(9,"button",6),u("click",function(){return n.openCreateModal()}),x(),i(10,"svg",7),p(11,"path",8),o(),r(12," Nuevo Descuento "),o()()(),v(),i(13,"div",9)(14,"div",10)(15,"div",11)(16,"div",12),x(),i(17,"svg",13),p(18,"path",14),o()(),v(),i(19,"div")(20,"p",15),r(21,"Total Descuentos"),o(),i(22,"p",16),r(23),o()()()(),i(24,"div",10)(25,"div",11)(26,"div",17),x(),i(27,"svg",18),p(28,"path",19),o()(),v(),i(29,"div")(30,"p",15),r(31,"Activos"),o(),i(32,"p",16),r(33),o()()()(),i(34,"div",10)(35,"div",11)(36,"div",20),x(),i(37,"svg",21),p(38,"path",22),o()(),v(),i(39,"div")(40,"p",15),r(41,"Pr\xF3ximos"),o(),i(42,"p",16),r(43),o()()()(),i(44,"div",10)(45,"div",11)(46,"div",23),x(),i(47,"svg",24),p(48,"path",25),o()(),v(),i(49,"div")(50,"p",15),r(51,"Expirados"),o(),i(52,"p",16),r(53),o()()()()(),i(54,"div",26)(55,"div",27)(56,"div")(57,"label",28),r(58,"Buscar"),o(),i(59,"div",29)(60,"div",30),x(),i(61,"svg",31),p(62,"path",32),o()(),v(),i(63,"input",33),u("input",function(d){return n.onSearch(d)}),o()()(),i(64,"div")(65,"label",28),r(66,"Tipo de Campa\xF1a"),o(),i(67,"select",34),u("change",function(d){return n.onCampaignFilter(d)}),i(68,"option",35),r(69,"Todas las campa\xF1as"),o(),i(70,"option",36),r(71,"Normal"),o(),i(72,"option",37),r(73,"Flash"),o(),i(74,"option",38),r(75,"Banner"),o()()(),i(76,"div")(77,"label",28),r(78,"Estado"),o(),i(79,"select",34),u("change",function(d){return n.onStatusFilter(d)}),i(80,"option",35),r(81,"Todos los estados"),o(),i(82,"option",39),r(83,"Activos"),o(),i(84,"option",40),r(85,"Pr\xF3ximos"),o(),i(86,"option",41),r(87,"Expirados"),o(),i(88,"option",42),r(89,"Inactivos"),o()()()()(),f(90,ce,7,0,"div",43),f(91,xe,21,1,"div",44),o()(),f(92,Te,90,12,"div",45)),e&2&&(a(23),C(n.stats().total),a(10),C(n.stats().active),a(10),C(n.stats().upcoming),a(10),C(n.stats().expired),a(37),h(n.isLoading()?90:-1),a(),h(n.isLoading()?-1:91),a(),h(n.isCreateModalOpen()||n.isEditModalOpen()?92:-1))},dependencies:[A,re,J,te,ie,O,U,R,ee,$,Q,ne,K,q,oe,Y,B],encapsulation:2})};export{le as a};
