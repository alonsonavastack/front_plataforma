import{b as S}from"./chunk-VTEZJ5OF.js";import{a as v}from"./chunk-XM5I3GUE.js";import{Jc as m,K as l,O as f,T as d,ec as h,k as n,z as p}from"./chunk-6JS7X5LE.js";import{a}from"./chunk-I4MTPUBM.js";var w=class u{http=d(m);authService=d(S);base=v.url;profile=h(()=>this.authService.user());constructor(){}update(s){let r=this.authService.user(),t="";return r?.rol==="admin"?t="profile-admin/update":r?.rol==="instructor"?t="profile-instructor/update":r?.rol==="cliente"?t="profile-student/update":t="users/update",this.http.put(`${this.base}${t}`,s).pipe(l(e=>{let c=e.profile||e.user||e;if(c){let i=this.authService.user(),o=a(a({},i),c);this.authService.user.set(o),typeof window<"u"&&window.localStorage&&localStorage.setItem("user",JSON.stringify(o))}}),p(e=>n(()=>e)))}updateAvatar(s){let r=new FormData;r.append("avatar",s);let t=this.authService.user(),e="";if(t?.rol==="admin")e="profile-admin/update-avatar";else if(t?.rol==="instructor")e="profile-instructor/update-avatar";else if(t?.rol==="cliente")e="profile-student/update-avatar";else return n(()=>new Error("Rol de usuario no reconocido para actualizar avatar."));return(t?.rol==="admin"||t?.rol==="instructor"?this.http.post(`${this.base}${e}`,r):this.http.put(`${this.base}${e}`,r)).pipe(l(i=>{let o=i.user||i;if(o){let y=this.authService.user(),b=a(a({},y),o);this.authService.user.set(b)}}),p(i=>n(()=>i)))}static \u0275fac=function(r){return new(r||u)};static \u0275prov=f({token:u,factory:u.\u0275fac,providedIn:"root"})};export{w as a};
