import{b as u}from"./chunk-K46CHI56.js";import{a as g}from"./chunk-TCGJFX72.js";import{a as d}from"./chunk-B6BL5WF6.js";import{Jc as c,K as n,O as s,T as a,ec as e,ja as r,ka as o}from"./chunk-6JS7X5LE.js";var h=class i{baseUrl=d.url+"wallet";http=a(c);toastService=a(g);authService=a(u);walletData=r(null);isLoading=r(!1);errorState=r(null);balance=e(()=>this.walletData()?.balance??0);currency=e(()=>this.walletData()?.currency??"USD");transactions=e(()=>this.walletData()?.transactions??[]);loading=e(()=>this.isLoading());error=e(()=>this.errorState());hasError=e(()=>this.errorState()!==null&&!this.isLoading());currentBalance=this.balance;constructor(){o(()=>{this.authService.token()?this.loadWallet():(this.walletData.set(null),this.errorState.set(null))})}loadWallet(){if(!this.authService.token()){this.walletData.set(null);return}this.isLoading.set(!0),this.errorState.set(null),this.http.get(`${this.baseUrl}/my-wallet`).subscribe({next:t=>{this.walletData.set(t),this.isLoading.set(!1)},error:t=>{this.errorState.set(t),this.isLoading.set(!1)}})}reloadWallet(){this.loadWallet()}getMyWallet(){return this.http.get(`${this.baseUrl}/my-wallet`)}getBalance(){return this.http.get(`${this.baseUrl}/balance`)}addCredit(t,l,m){return this.http.post(`${this.baseUrl}/add-credit`,{userId:t,amount:l,description:m}).pipe(n(()=>this.loadWallet()))}getAllWallets(){return this.http.get(`${this.baseUrl}/admin/all-wallets`)}getUserWallet(t){return this.http.get(`${this.baseUrl}/admin/user-wallet/${t}`)}static \u0275fac=function(l){return new(l||i)};static \u0275prov=s({token:i,factory:i.\u0275fac,providedIn:"root"})};export{h as a};
