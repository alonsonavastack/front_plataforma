import{a as ye,b as we}from"./chunk-CNCB3HL6.js";import{a as ke}from"./chunk-4L5V7RJ5.js";import{a as me}from"./chunk-KIAZO4GX.js";import{a as be}from"./chunk-6H6VCWMF.js";import{a as de}from"./chunk-5PWF2E7V.js";import{a as ce}from"./chunk-2KDY6PAZ.js";import{a as re}from"./chunk-S67E2VSL.js";import{a as le}from"./chunk-FK5OC4YK.js";import{b as se}from"./chunk-C4QL5PZB.js";import{a as Se}from"./chunk-NOVASSOE.js";import{g as oe,h as ae}from"./chunk-VM3MHBTU.js";import"./chunk-TCGJFX72.js";import{a as ue,b as pe,c as F,d as xe,e as he,f as ge,h as j,j as fe,o as ve,p as _e,y as Ce}from"./chunk-QA5A7GBQ.js";import{a as q}from"./chunk-ZGVWU7EJ.js";import{$ as g,$b as w,Ac as ne,Eb as U,Fb as Z,Gb as r,Ha as O,Hb as y,Ib as x,Jb as W,Kb as ee,Ma as l,O as K,T,Xa as Q,Y as M,Z as E,_ as m,_b as S,ac as H,ec as h,hb as u,ib as p,ja as b,ka as A,lb as $,mb as G,nb as N,ob as t,pb as i,qb as d,ub as B,wb as D,xc as te,yb as c,yc as ie}from"./chunk-6JS7X5LE.js";import{a as X,b as R}from"./chunk-I4MTPUBM.js";var z=class o{cartItems=b([]);cart=h(()=>this.cartItems());total=h(()=>this.cartItems().reduce((n,e)=>n+e.price_mxn,0));count=h(()=>this.cartItems().length);constructor(){let n=localStorage.getItem("cart");if(n)try{let e=JSON.parse(n);e.some(s=>s.price_usd!==void 0||s.price_mxn===void 0)?(console.warn("\u{1F9F9} Clearing legacy cart data (USD -> MXN migration)"),this.cartItems.set([]),localStorage.removeItem("cart")):this.cartItems.set(e)}catch(e){console.error("Error parsing cart from localStorage",e),this.cartItems.set([])}A(()=>{localStorage.setItem("cart",JSON.stringify(this.cartItems()))})}addToCart(n){return this.cartItems().some(a=>a._id===n._id&&a.type===n.type)?!1:(this.cartItems.update(a=>[...a,n]),!0)}removeFromCart(n,e){this.cartItems.update(a=>a.filter(s=>!(s._id===n&&s.type===e)))}clearCart(){this.cartItems.set([])}isInCart(n,e){return this.cartItems().some(a=>a._id===n&&a.type===e)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=K({token:o,factory:o.\u0275fac,providedIn:"root"})};var Ee=(o,n)=>n._id,Te=(o,n)=>n.id;function De(o,n){o&1&&(t(0,"p",73),r(1),i()),o&2&&(l(),x(" \xA1Hola ",n.name,"! \u{1F44B} "))}function Ie(o,n){if(o&1){let e=B();t(0,"div",8)(1,"div",64),D("click",function(){M(e);let s=c();return E(s.closeSuccessModalAndRedirect())}),i(),t(2,"div",65)(3,"div",66),D("click",function(s){return M(e),E(s.stopPropagation())}),t(4,"div",67)(5,"div",68),m(),t(6,"svg",69),d(7,"path",70),i()(),g(),t(8,"div",71)(9,"h3",72),r(10," \xA1Compra Completada! \u{1F389} "),i(),u(11,De,2,1,"p",73),t(12,"div",74)(13,"p"),r(14," Gracias por tu compra. Hemos enviado los detalles de tu pedido a tu correo electr\xF3nico. "),i(),t(15,"div",75)(16,"p",76),m(),t(17,"svg",77),d(18,"path",78),i(),r(19," \xA1Acceso inmediato a tu contenido! \u{1F680} "),i(),g(),t(20,"p",79),r(21,' Ve a "Mis Cursos" para empezar a aprender '),i()()()(),t(22,"div",80)(23,"button",81),D("click",function(){M(e);let s=c();return E(s.closeSuccessModalAndRedirect())}),r(24," Ir a Mis Cursos "),i()()()()()()}if(o&2){let e,a=c();l(11),p((e=a.user())?11:-1,e)}}function Be(o,n){if(o&1&&(t(0,"div",9)(1,"div",82),m(),t(2,"svg",83),d(3,"path",84),i(),g(),t(4,"p",85),r(5),i()()()),o&2){let e=c();l(5),y(e.errorMessage())}}function Ne(o,n){if(o&1&&(t(0,"div",10)(1,"div",86)(2,"div",87),m(),t(3,"svg",88),d(4,"path",89),i()(),g(),t(5,"div",90)(6,"h3",91),r(7),i(),t(8,"p",92),r(9),i(),t(10,"div",93)(11,"a",94),m(),t(12,"svg",95),d(13,"path",96),i(),r(14," Ir a Mi Perfil "),i(),g(),t(15,"a",97),m(),t(16,"svg",95),d(17,"path",98),i(),r(18," Explorar M\xE1s Contenido "),i()()()()()),o&2){let e,a=c();l(7),x(" \u2705 Ya adquiriste este ",a.getProductTypeName(a.productType()||"course")," "),l(2),x(' Ya tienes acceso completo a "',(e=a.product())==null?null:e.title,'". Puedes acceder a todo el contenido desde tu perfil. ')}}function Ve(o,n){o&1&&(t(0,"div",13)(1,"div",99)(2,"div",100),d(3,"div",101),t(4,"p",61),r(5,"\u{1F504} Cargando tu billetera..."),i()()()())}function Ae(o,n){o&1&&(t(0,"span",107),d(1,"span",118),t(2,"span",119),m(),t(3,"svg",120),d(4,"path",121),i()()())}function Fe(o,n){o&1&&(t(0,"div",110),m(),t(1,"svg",122),d(2,"path",123),i(),g(),t(3,"span",124),r(4,"Suficiente para esta compra"),i()())}function je(o,n){o&1&&(t(0,"div",111),m(),t(1,"svg",125),d(2,"path",126),i(),g(),t(3,"span",127),r(4,"\xDAsalo para pago parcial"),i()())}function Le(o,n){o&1&&(t(0,"div",138)(1,"div",140)(2,"div",87),m(),t(3,"svg",141),d(4,"path",89),i()(),g(),t(5,"div",90)(6,"p",142),r(7," \u2728 Acceso Instant\xE1neo "),t(8,"span",143),r(9," NUEVO "),i()(),t(10,"p",144),r(11,"Tu saldo cubre el 100% de la compra. \xA1Acceso inmediato a tus cursos!"),i()(),t(12,"div",87),m(),t(13,"svg",145),d(14,"path",146),i()()()())}function $e(o,n){if(o&1&&(t(0,"div",139)(1,"div",140),m(),t(2,"svg",147),d(3,"path",148),i(),g(),t(4,"div",90)(5,"p",149),r(6,"\u{1F4B3} Pago Mixto"),i(),t(7,"p",150),r(8," Billetera: "),t(9,"span",151),r(10),S(11,"mxnCurrency"),i(),t(12,"span",152),r(13,"|"),i(),r(14," Otro m\xE9todo: "),t(15,"span",151),r(16),S(17,"mxnCurrency"),i()()()()()),o&2){let e=c(3);l(10),y(w(11,2,e.walletAmount())),l(6),y(w(17,4,e.remainingAmount()))}}function Ge(o,n){if(o&1&&(t(0,"div",116)(1,"div",128)(2,"span",129),m(),t(3,"svg",95),d(4,"path",130),i(),r(5," Total a pagar: "),i(),g(),t(6,"div",131)(7,"span",132),r(8),S(9,"mxnCurrency"),i()()(),t(10,"div",128)(11,"span",133),m(),t(12,"svg",95),d(13,"path",106),i(),r(14," Saldo de billetera: "),i(),g(),t(15,"div",131)(16,"span",134),r(17),S(18,"mxnCurrency"),i()()(),d(19,"div",135),t(20,"div",136)(21,"span",137),r(22,"Restante a pagar:"),i(),t(23,"div",131)(24,"span",109),r(25),S(26,"mxnCurrency"),i()()(),u(27,Le,15,0,"div",138)(28,$e,18,6,"div",139),i()),o&2){let e=c(2);l(8),x("",w(9,4,e.subtotal())," MXN"),l(9),x("-",w(18,6,e.walletAmount())," MXN"),l(8),x("",w(26,8,e.remainingAmount())," MXN"),l(2),p(e.isFullWalletPayment()?27:e.isMixedPayment()?28:-1)}}function We(o,n){if(o&1&&(t(0,"div",159)(1,"div",160)(2,"span",161),r(3),i(),t(4,"div",162)(5,"p",163),r(6),i(),t(7,"p",164),r(8),i()()(),t(9,"span"),r(10),S(11,"mxnCurrency"),i()()),o&2){let e=n.$implicit,a=c(3);l(3),y(a.getTransactionIcon(e.type)),l(3),y(e.description),l(2),y(a.formatDate(e.createdAt)),l(),Z("text-sm font-bold flex-shrink-0 "+a.getTransactionColor(e.type)),l(),W(" ",e.type==="credit"?"+":"-","",w(11,7,e.amount)," ")}}function He(o,n){if(o&1&&(t(0,"div",117)(1,"div",153)(2,"h4",154),m(),t(3,"svg",95),d(4,"path",62),i(),r(5," Actividad Reciente "),i(),g(),t(6,"a",155),r(7," Ver todo "),m(),t(8,"svg",156),d(9,"path",157),i()()(),g(),t(10,"div",158),$(11,We,12,9,"div",159,Ee),i()()),o&2){let e=c(2);l(11),G(e.recentTransactions())}}function ze(o,n){if(o&1){let e=B();t(0,"div",13)(1,"div",102)(2,"div",103)(3,"div",104),m(),t(4,"svg",105),d(5,"path",106),i(),u(6,Ae,5,0,"span",107),i(),g(),t(7,"div")(8,"h3",108),r(9,"Saldo Disponible en Billetera"),i(),t(10,"p",109),r(11),S(12,"mxnCurrency"),i(),u(13,Fe,5,0,"div",110)(14,je,5,0,"div",111),i()(),t(15,"label",112)(16,"input",113),D("change",function(){M(e);let s=c();return E(s.toggleWalletPayment())}),i(),d(17,"div",114),t(18,"span",115),r(19," Usar saldo "),i()()(),u(20,Ge,29,10,"div",116),u(21,He,13,0,"div",117),i()}if(o&2){let e=c();l(6),p(e.walletBalance()>=e.subtotal()?6:-1),l(5),x("",w(12,6,e.walletBalance())," MXN"),l(2),p(e.walletBalance()>=e.subtotal()?13:e.walletBalance()>0?14:-1),l(3),N("checked",e.useWalletBalance()),l(4),p(e.useWalletBalance()?20:-1),l(),p(e.recentTransactions().length>0&&e.useWalletBalance()?21:-1)}}function Xe(o,n){o&1&&(t(0,"div",15)(1,"div",103)(2,"div",87),m(),t(3,"svg",165),d(4,"path",106),i()(),g(),t(5,"div",90)(6,"h3",166),r(7,"\u{1F389} \xA1Producto GRATIS!"),i(),t(8,"p",167),r(9," Este producto no tiene costo. Solo necesitas usar tu "),t(10,"strong",48),r(11,"billetera digital"),i(),r(12," para obtenerlo. "),d(13,"br"),t(14,"span",168),r(15,"\u{1F4A1} Tip: Si no tienes saldo, cont\xE1ctanos para agregarlo."),i()()()()())}function Re(o,n){if(o&1&&(r(0),S(1,"mxnCurrency")),o&2){let e=c();x(" M\xE9todo de Pago Adicional (para ",w(1,1,e.remainingAmount()),") ")}}function Oe(o,n){o&1&&r(0," \u2705 Pago Completo con Billetera ")}function Ue(o,n){o&1&&r(0," M\xE9todo de Pago ")}function qe(o,n){if(o&1&&(t(0,"div",169)(1,"div"),r(2),S(3,"json"),i(),t(4,"div"),r(5),S(6,"json"),i(),t(7,"div"),r(8),S(9,"json"),i()()),o&2){let e=c(2);l(2),x("Debug - available methods: ",w(3,3,e.availableMethodIds())),l(3),x("Debug - allowed methods: ",w(6,5,e.allowedMethodIds())),l(3),x("Payment config: ",w(9,7,e.checkoutService.paymentConfig()))}}function Je(o,n){o&1&&(m(),t(0,"svg",179),d(1,"path",123),i())}function Ye(o,n){if(o&1){let e=B();t(0,"button",173),D("click",function(){M(e);let s=c(2).$implicit,f=c(2);return E(f.selectPaymentMethod(s.id))}),t(1,"div",174)(2,"span",175),r(3),i(),t(4,"div",176)(5,"p",177),r(6),i(),t(7,"p",178),r(8),S(9,"mxnCurrency"),i()()(),u(10,Je,2,0,":svg:svg",179),i()}if(o&2){let e=c(2).$implicit,a=c(2);U("border-lime-400",a.selectedPaymentMethod()===e.id)("bg-lime-400/10",a.selectedPaymentMethod()===e.id),l(3),y(e.icon),l(3),y(e.name),l(2),x("Saldo: ",w(9,8,a.walletBalance())),l(2),p(a.selectedPaymentMethod()===e.id?10:-1)}}function Ke(o,n){if(o&1&&(t(0,"div",172)(1,"div",174)(2,"span",180),r(3),i(),t(4,"div",176)(5,"p",181),r(6),i(),t(7,"p",29),r(8),S(9,"mxnCurrency"),S(10,"mxnCurrency"),i()()(),m(),t(11,"svg",182),d(12,"path",183),i()()),o&2){let e=c(2).$implicit,a=c(2);l(3),y(e.icon),l(3),y(e.name),l(2),W("\u274C Saldo insuficiente: ",w(9,4,a.walletBalance())," (necesitas ",w(10,6,a.subtotal()),")")}}function Qe(o,n){if(o&1&&u(0,Ye,11,10,"button",171)(1,Ke,13,8,"div",172),o&2){let e=c(3);p(e.walletBalance()>=e.subtotal()?0:1)}}function Ze(o,n){o&1&&(m(),t(0,"svg",179),d(1,"path",123),i())}function et(o,n){if(o&1){let e=B();t(0,"button",173),D("click",function(){M(e);let s=c().$implicit,f=c(2);return E(f.selectPaymentMethod(s.id))}),t(1,"div",174)(2,"span",175),r(3),i(),t(4,"div",176)(5,"p",177),r(6),i(),t(7,"p",164),r(8),i()()(),u(9,Ze,2,0,":svg:svg",179),i()}if(o&2){let e=c().$implicit,a=c(2);U("border-lime-400",a.selectedPaymentMethod()===e.id)("bg-lime-400/10",a.selectedPaymentMethod()===e.id),l(3),y(e.icon),l(3),y(e.name),l(2),y(e.description),l(),p(a.selectedPaymentMethod()===e.id?9:-1)}}function tt(o,n){if(o&1&&u(0,Qe,2,1)(1,et,10,8,"button",171),o&2){let e=n.$implicit;p(e.id==="wallet"?0:1)}}function it(o,n){if(o&1&&(u(0,qe,10,9,"div",169),t(1,"div",170),$(2,tt,2,1,null,null,Te),i()),o&2){let e=c();p(-1),l(2),G(e.allowedPaymentMethods())}}function nt(o,n){o&1&&(t(0,"div",17)(1,"div",140),m(),t(2,"svg",184),d(3,"path",89),i(),g(),t(4,"div")(5,"p",185),r(6,"\xA1Perfecto! Tu saldo cubre el 100% de la compra"),i(),t(7,"p",186),r(8,"No necesitas seleccionar ning\xFAn m\xE9todo de pago adicional."),i()()()())}function ot(o,n){o&1&&(t(0,"p",21),r(1,"El nombre es requerido"),i())}function at(o,n){o&1&&(t(0,"p",21),r(1,"Email v\xE1lido es requerido"),i())}function rt(o,n){o&1&&(t(0,"p",29),r(1,"Debes aceptar los t\xE9rminos y condiciones"),i())}function lt(o,n){if(o&1&&(t(0,"div",193),r(1),S(2,"number"),i(),t(3,"div",194),r(4),S(5,"number"),i(),t(6,"div",195),r(7),i()),o&2){let e,a=c(2);l(),x("$",H(2,4,a.subtotal(),"1.2-2")),l(3),x("$",H(5,7,a.originalPrice(),"1.2-2")),l(3),W(" -",(e=a.bestDiscount())==null?null:e.discount,"",((e=a.bestDiscount())==null?null:e.type_discount)===1?"%":""," ")}}function st(o,n){if(o&1&&(t(0,"div",193),r(1),S(2,"number"),i()),o&2){let e=c(2);l(),x("$",H(2,1,e.subtotal(),"1.2-2"))}}function ct(o,n){if(o&1&&(t(0,"div",36),d(1,"img",187),t(2,"div",162)(3,"div",188)(4,"div")(5,"div",189),r(6),i(),t(7,"h3",190),r(8),i(),t(9,"p",191),r(10),i()(),t(11,"div",192),u(12,lt,8,10)(13,st,3,4,"div",193),i()()()()),o&2){let e,a,s,f,C=c();l(),N("src",C.buildImageUrl((e=C.product())==null?null:e.imagen),O),l(5),x(" ",C.getProductTypeName(((a=C.product())==null?null:a.type)||"course")," "),l(2),y((s=C.product())==null?null:s.title),l(2),y((f=C.product())==null?null:f.subtitle),l(2),p(C.hasDiscount()?12:13)}}function dt(o,n){if(o&1){let e=B();t(0,"div",196),d(1,"img",187),t(2,"div",162)(3,"div",188)(4,"div")(5,"div",189),r(6),i(),t(7,"h3",190),r(8),i(),t(9,"p",191),r(10),i()(),t(11,"div",192)(12,"div",193),r(13),S(14,"mxnCurrency"),i()()()(),t(15,"button",197),D("click",function(){let s=M(e).$implicit,f=c(2);return E(f.removeFromCart(s._id,s.type))}),m(),t(16,"svg",77),d(17,"path",198),i()()()}if(o&2){let e=n.$implicit,a=c(2);l(),N("src",a.buildImageUrl(e.imagen,e.type),O),l(5),x(" ",a.getProductTypeName(e.type)," "),l(2),y(e.title),l(2),y(e.subtitle),l(3),y(w(14,5,e.price_mxn))}}function mt(o,n){if(o&1&&$(0,dt,18,7,"div",196,Ee),o&2){let e=c();G(e.cartItems())}}function ut(o,n){if(o&1&&(t(0,"p",202),r(1),i()),o&2){let e=c(2);l(),y(e.couponError())}}function pt(o,n){if(o&1){let e=B();t(0,"div",199)(1,"input",200),D("input",function(s){M(e);let f=c();return E(f.couponCode.set(s.target.value))})("keyup.enter",function(){M(e);let s=c();return E(s.checkCoupon())}),i(),t(2,"button",201),D("click",function(){M(e);let s=c();return E(s.checkCoupon())}),r(3),i()(),u(4,ut,2,1,"p",202)}if(o&2){let e=c();l(),N("value",e.couponCode()),l(),N("disabled",e.isCheckingCoupon()||!e.couponCode()),l(),x(" ",e.isCheckingCoupon()?"...":"Aplicar"," "),l(),p(e.couponError()?4:-1)}}function xt(o,n){if(o&1&&(t(0,"p",207),r(1),i()),o&2){let e=c(2);l(),x("-",e.appliedCoupon().discount_percentage,"% descuento")}}function ht(o,n){o&1&&(t(0,"p",207),r(1,"Referido aplicado"),i())}function gt(o,n){if(o&1){let e=B();t(0,"div",43)(1,"div",203),m(),t(2,"svg",204),d(3,"path",205),i(),g(),t(4,"div")(5,"p",206),r(6),i(),u(7,xt,2,1,"p",207)(8,ht,2,0,"p",207),i()(),t(9,"button",208),D("click",function(){M(e);let s=c();return E(s.removeCoupon())}),m(),t(10,"svg",209),d(11,"path",198),i()()()}if(o&2){let e=c();l(6),x("Cup\xF3n: ",e.appliedCoupon().code),l(),p(e.appliedCoupon().discount_percentage>0?7:8)}}function ft(o,n){if(o&1&&(t(0,"div",46)(1,"span"),r(2,"Descuento"),i(),t(3,"span"),r(4),i()()),o&2){let e=c();l(4),x("-$",e.formatPrice(n.savedAmount))}}function vt(o,n){o&1&&(t(0,"div",45)(1,"span"),r(2,"Descuentos"),i(),t(3,"span"),r(4,"$0.00"),i()())}function _t(o,n){o&1&&(t(0,"button",49),m(),t(1,"svg",210),d(2,"circle",211)(3,"path",212),i(),g(),t(4,"span"),r(5,"Procesando..."),i()())}function Ct(o,n){o&1&&(t(0,"span"),r(1,"\u2705 Confirmar Compra con Billetera"),i())}function bt(o,n){if(o&1&&(t(0,"span"),r(1),t(2,"small",216),r(3),i()()),o&2){let e=c(2);l(),x("\u{1F4B3} Pagar $",e.formatPrice(e.remainingAmount())," "),l(2),x("($",e.formatPrice(e.walletAmount())," con billetera)")}}function St(o,n){if(o&1){let e=B();t(0,"button",213),D("click",function(){M(e);let s=c();return E(s.processPayment())}),m(),t(1,"svg",214),d(2,"path",215),i(),u(3,Ct,2,0,"span")(4,bt,4,2,"span"),i()}if(o&2){let e=c();N("disabled",e.renderingPaypal()||e.showSuccess()||e.checkoutForm.invalid),l(3),p(e.remainingAmount()===0?3:4)}}function yt(o,n){if(o&1){let e=B();t(0,"button",213),D("click",function(){M(e);let s=c();return E(s.processPayment())}),m(),t(1,"svg",214),d(2,"path",215),i(),g(),t(3,"span"),r(4),i()()}if(o&2){let e=c();N("disabled",e.renderingPaypal()||e.showSuccess()||e.checkoutForm.invalid),l(4),x("\u{1F4B3} Pagar Ahora - $",e.formatPrice(e.subtotal()))}}function wt(o,n){o&1&&r(0," \u{1F389} Tu saldo cubre el 100% de la compra ")}function kt(o,n){if(o&1&&r(0),o&2){let e,a=c(2);ee(" \u{1F4A1} Se usar\xE1n $",a.formatPrice(a.walletAmount())," de tu billetera + $",a.formatPrice(a.remainingAmount())," con ",((e=a.getPaymentMethodInfo(a.selectedPaymentMethod()))==null?null:e.name)||"otro m\xE9todo"," ")}}function Mt(o,n){if(o&1&&(t(0,"p",51),u(1,wt,1,0)(2,kt,1,3),i()),o&2){let e=c();l(),p(e.remainingAmount()===0?1:2)}}var Me=class o{checkoutService=T(ye);authService=T(se);walletService=T(le);purchasesService=T(re);profileService=T(me);modalService=T(Se);discountService=T(be);cartService=T(z);currencyService=T(ce);couponService=T(ke);router=T(oe);profileStudentService=T(we);alreadyPurchased=h(()=>{let n=this.product();return n?this.purchasesService.isPurchased(n._id):!1});product=b(null);productType=b(null);cartItems=h(()=>this.cartService.cart());isDirectBuy=b(!0);selectedPaymentMethod=b("");isProcessing=b(!1);showSuccess=b(!1);showWarningModal=b(!1);errorMessage=b("");transactionNumber=b("");couponCode=b("");appliedCoupon=b(null);couponError=b("");isCheckingCoupon=b(!1);stripeLoading=b(!1);renderingPaypal=b(!1);countries=this.checkoutService.supportedCountries;selectedCountry=b("MX");selectedCountryData=h(()=>this.countries().find(n=>n.code===this.selectedCountry()));walletBalance=h(()=>this.walletService.balance());useWalletBalance=b(!1);walletAmount=b(0);discounts=h(()=>this.discountService.discounts());bestDiscount=h(()=>{if(!this.isDirectBuy())return null;let n=this.product(),e=this.productType(),a=this.discounts();if(!n||!e||!a.length)return null;let s=Date.now(),f=a.filter(v=>v.state&&v.start_date_num<=s&&v.end_date_num>=s),C=null,P=n.price_mxn;for(let v of f){let I=!1;if(v.type_segment===1&&e==="course")v.courses&&v.courses.some(_=>_._id===n._id||_===n._id)&&(I=!0);else if(v.type_segment===2){let _=n.categorie?._id||n.categorie;_&&v.categories&&v.categories.some(V=>V._id===_||V===_)&&(I=!0)}else v.type_segment===3&&e==="project"&&v.projects&&v.projects.some(_=>_._id===n._id||_===n._id)&&(I=!0);if(I){let _=P;v.type_discount===1?_=n.price_mxn-n.price_mxn*v.discount/100:_=n.price_mxn-v.discount,_<0&&(_=0),_<P&&(P=_,C=R(X({},v),{finalPrice:P,savedAmount:n.price_mxn-P}))}}return C});hasDiscount=h(()=>!!this.bestDiscount());subtotal=h(()=>{let n=0;if(this.isDirectBuy()){let a=this.bestDiscount();n=a?a.finalPrice:this.product()?.price_mxn||0}else n=this.cartService.total();let e=this.appliedCoupon();return e&&e.discount_percentage>0&&(n=n-n*(e.discount_percentage/100)),Math.max(0,n)});originalPrice=h(()=>this.isDirectBuy()?this.product()?.price_mxn||0:this.subtotal());subtotalMXN=h(()=>this.subtotal());originalPriceMXN=h(()=>this.originalPrice());remainingAmount=h(()=>{if(!this.useWalletBalance())return this.subtotal();let n=this.subtotal()-this.walletAmount();return Math.max(0,n)});isLoadingWallet=h(()=>this.walletService.loading());walletTransactions=h(()=>this.walletService.transactions());recentTransactions=h(()=>this.walletTransactions().slice(0,3));isFullWalletPayment=h(()=>this.useWalletBalance()&&this.walletAmount()>0&&this.remainingAmount()===0);isMixedPayment=h(()=>this.useWalletBalance()&&this.walletAmount()>0&&this.remainingAmount()>0);needsAdditionalPaymentMethod=h(()=>this.useWalletBalance()&&this.remainingAmount()>0&&!this.selectedPaymentMethod());isFreeProduct=h(()=>this.subtotal()===0);allowedPaymentMethods=h(()=>this.isFreeProduct()?this.paymentMethods().filter(n=>n.id==="wallet"):this.paymentMethods());user=h(()=>this.authService.user());paymentMethods=this.checkoutService.availablePaymentMethods;availableMethodIds=h(()=>this.paymentMethods().map(n=>n.id));allowedMethodIds=h(()=>this.allowedPaymentMethods().map(n=>n.id));checkoutForm=new ge({acceptTerms:new j(!1,[F.requiredTrue]),billingName:new j("",[F.required]),billingEmail:new j("",[F.required,F.email]),billingPhone:new j("",[])});constructor(){A(()=>{this.showSuccess()||this.showWarningModal()?document.body.style.overflow="hidden":document.body.style.overflow=""}),A(()=>{let n=this.product(),e=this.cartService.count();!n&&e===0&&!this.showSuccess()&&this.router.navigate(["/"])})}ngOnInit(){if(!this.authService.isLoggedIn()){this.router.navigate(["/login"]);return}let e=this.router.getCurrentNavigation()?.extras?.state||history.state;if(e&&e.product&&e.productType){let s=R(X({},e.product),{type:e.productType});this.product.set(s),this.productType.set(e.productType),this.isDirectBuy.set(!0),setTimeout(()=>{this.alreadyPurchased()&&this.modalService.alert({title:"\u2705 Ya adquiriste este producto",message:`Ya tienes acceso a "${s.title}". Puedes verlo en tu perfil.`,icon:"info"}).then(()=>{this.router.navigate(["/profile-student"])})},1e3)}else if(this.cartService.count()>0)this.isDirectBuy.set(!1);else{this.router.navigate(["/"]);return}this.walletService.loadWallet(),this.discountService.loadDiscounts().subscribe(),this.checkoutService.reloadConfig(),this.purchasesService.loadPurchasedProducts();let a=this.user();a&&this.checkoutForm.patchValue({billingName:`${a.name} ${a.surname}`,billingEmail:a.email||""}),setTimeout(()=>{this.isFreeProduct()&&this.selectPaymentMethod("wallet");let s=localStorage.getItem("pending_coupon");s&&(this.couponCode.set(s),this.checkCoupon(),localStorage.removeItem("pending_coupon"))},100)}ngOnDestroy(){document.body.style.overflow=""}formatPrice(n){return n.toFixed(2)}formatDate(n){return n?new Date(n).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric"}):""}buildImageUrl(n,e){return n?n.startsWith("http://")||n.startsWith("https://")?n:(e||(this.isDirectBuy()?this.productType():"course"))==="project"?`${q.images.project}${n}`:`${q.images.course}${n}`:"https://via.placeholder.com/400x300?text=Sin+Imagen"}getProductTypeName(n){return n==="course"?"Curso":"Proyecto"}getTransactionIcon(n){let e={credit:"\u{1F4B3}",refund:"\u21A9\uFE0F",withdrawal:"\u{1F4B8}",purchase:"\u{1F6D2}",bonus:"\u{1F381}",default:"\u{1F4B0}"};return e[n]||e.default}getTransactionColor(n){let e={credit:"text-green-400",refund:"text-lime-400",withdrawal:"text-red-400",purchase:"text-orange-400",bonus:"text-purple-400",default:"text-gray-400"};return e[n]||e.default}getPaymentMethodInfo(n){return this.paymentMethods().find(e=>e.id===n)}removeFromCart(n,e){this.cartService.removeFromCart(n,e)}selectPaymentMethod(n){if(n==="wallet"&&!this.useWalletBalance()){let e=this.walletBalance(),a=this.subtotal();if(e<a){this.errorMessage.set(`\u274C Saldo insuficiente. Tienes $${e.toFixed(2)} MXN pero el total es $${a.toFixed(2)} MXN. Activa el toggle "Usar saldo" para hacer un pago mixto.`);return}this.toggleWalletPayment(!0)}this.selectedPaymentMethod.set(n),this.errorMessage.set("")}toggleWalletPayment(n){let e=n!==void 0?n:!this.useWalletBalance();if(this.useWalletBalance.set(e),e){let a=this.subtotal(),s=this.walletBalance(),f=Math.min(s,a);this.walletAmount.set(f),f>=a?this.selectedPaymentMethod.set("wallet"):this.selectedPaymentMethod()==="wallet"&&this.selectedPaymentMethod.set("")}else this.walletAmount.set(0),this.selectedPaymentMethod()==="wallet"&&this.selectedPaymentMethod.set("")}async processPayment(){if(this.isProcessing()||this.showSuccess()||!await this.modalService.confirm({title:"Pol\xEDtica de Reembolsos",icon:"warning",message:`\u2713 Tienes 7 D\xCDAS para solicitar reembolso
\u2713 No puedes haber visto m\xE1s del 20% del contenido
\u2713 M\xE1ximo 1 reembolso por curso
\u2713 M\xE1ximo 3 reembolsos totales en 6 meses

\xBFDeseas continuar con la compra?`,confirmText:"Aceptar y Continuar",cancelText:"Cancelar"}))return;let e=this.product(),a=this.isDirectBuy(),s=this.cartItems();if(a&&!e){this.errorMessage.set("Error: No hay producto seleccionado");return}if(!a&&s.length===0){this.errorMessage.set("Error: El carrito est\xE1 vac\xEDo");return}if(this.useWalletBalance()&&this.walletAmount()>0){let k=this.walletBalance(),Y=this.walletAmount();if(k<Y){this.errorMessage.set(`\u274C Error cr\xEDtico: Saldo insuficiente. Tienes $${k.toFixed(2)} MXN pero intentas usar $${Y.toFixed(2)} MXN. Por favor, recarga la p\xE1gina.`);return}}if(this.checkoutForm.invalid){Object.keys(this.checkoutForm.controls).forEach(k=>{this.checkoutForm.get(k)?.markAsTouched()}),this.errorMessage.set("Por favor completa todos los campos requeridos");return}this.isProcessing.set(!0),this.errorMessage.set("");let f=this.useWalletBalance(),C=this.walletAmount(),P=this.remainingAmount(),v,I,_;if(f&&P===0&&C>0)v="wallet",I=C,_=0;else if(f&&C>0&&P>0){if(!this.selectedPaymentMethod()){this.errorMessage.set(`\u26A0\uFE0F Pago Mixto Requerido

Tu billetera cubre $${C.toFixed(2)} MXN de los $${this.subtotal().toFixed(2)} MXN totales.

Por favor, selecciona un m\xE9todo de pago para completar los $${P.toFixed(2)} MXN restantes.`),this.isProcessing.set(!1);return}v=this.selectedPaymentMethod(),I=C,_=P}else if(v=this.selectedPaymentMethod()||"",I=0,_=this.subtotal(),!v){this.errorMessage.set("Por favor selecciona un m\xE9todo de pago"),this.isProcessing.set(!1);return}let V=[];a&&e?V=[{product:e._id,product_type:this.productType(),title:e.title,price_unit:this.subtotal(),imagen:e.imagen}]:V=s.map(k=>({product:k._id,product_type:k.type,title:k.title,price_unit:k.price_mxn,imagen:k.imagen}));let J=this.checkoutService.generateTransactionNumber();this.transactionNumber.set(J);let L={n_transaccion:J,method_payment:v,subtotal_mxn:_,total:_,use_wallet:f,wallet_amount:I,remaining_amount:_,detail:V,billing:{name:this.checkoutForm.value.billingName||"",email:this.checkoutForm.value.billingEmail||"",phone:this.checkoutForm.value.billingPhone||""}};this.appliedCoupon()&&(L.coupon_code=this.appliedCoupon().code),this.pendingPaymentPayload=L;try{if(v==="wallet"){let k=await this.checkoutService.processWalletPayment(L).toPromise();this.showSuccess.set(!0),this.walletService.loadWallet(),setTimeout(()=>{this.profileStudentService.reloadProfile(),this.purchasesService.loadPurchasedProducts(),this.profileService.reloadProfile()},1500),a||this.cartService.clearCart()}else{let k=await this.checkoutService.processSale(L).toPromise();if(k&&k.session_url){window.location.href=k.session_url;return}this.showSuccess.set(!0),I>0&&this.walletService.loadWallet(),setTimeout(()=>{this.profileStudentService.reloadProfile(),this.purchasesService.loadPurchasedProducts(),this.profileService.reloadProfile()},1500),a||this.cartService.clearCart()}}catch(k){this.errorMessage.set(k?.error?.message||"Error al procesar el pago")}finally{this.isProcessing.set(!1)}}closeSuccessModalAndRedirect(){this.showSuccess.set(!1),this.router.navigate(["/profile-student"])}checkCoupon(){let n=this.couponCode().trim();if(!n)return;let e="";if(this.isDirectBuy()&&this.product())e=this.product()._id;else if(this.cartItems().length>0)e=this.cartItems()[0]._id;else return;this.isCheckingCoupon.set(!0),this.couponError.set(""),this.appliedCoupon.set(null),this.couponService.validateCoupon(n,e).subscribe({next:a=>{a.valid?this.appliedCoupon.set(a.coupon):this.couponError.set(a.message||"Cup\xF3n no v\xE1lido"),this.isCheckingCoupon.set(!1)},error:a=>{this.couponError.set(a.error?.message||"Error al validar cup\xF3n"),this.isCheckingCoupon.set(!1)}})}removeCoupon(){this.appliedCoupon.set(null),this.couponCode.set(""),this.couponError.set("")}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=Q({type:o,selectors:[["app-checkout"]],decls:125,vars:25,consts:[[1,"min-h-screen","max-h-screen","bg-gradient-to-b","from-slate-900","to-slate-800","py-8","px-4","overflow-y-auto"],[1,"max-w-7xl","mx-auto"],[1,"mb-8"],["routerLink","/",1,"inline-flex","items-center","text-gray-400","hover:text-white","transition-colors","mb-4"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"text-3xl","font-bold","text-white"],[1,"text-gray-400","mt-2"],["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"fixed","inset-0","z-50","overflow-y-auto"],[1,"mb-6","bg-red-500/10","border","border-red-500/50","rounded-lg","p-4"],[1,"mb-6","bg-blue-500/10","border","border-blue-500/50","rounded-lg","p-6"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2","space-y-6"],[1,"bg-gradient-to-r","from-lime-500/10","via-green-500/10","to-emerald-500/10","rounded-xl","p-6","border","border-lime-500/30","shadow-lg"],[1,"bg-slate-800/50","rounded-lg","border","border-white/10","p-6"],[1,"mb-6","p-5","bg-gradient-to-r","from-green-500/10","to-lime-500/10","border-2","border-lime-400/50","rounded-xl"],[1,"text-xl","font-semibold","text-white","mb-4"],[1,"p-4","bg-lime-500/10","border-2","border-lime-400/50","rounded-lg"],[1,"space-y-4",3,"formGroup"],[1,"block","text-sm","font-medium","text-gray-300","mb-2"],["type","text","formControlName","billingName","placeholder","Juan P\xE9rez",1,"w-full","px-4","py-2","bg-slate-700","border","border-slate-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"mt-1","text-xs","text-red-400"],["type","email","formControlName","billingEmail","placeholder","correo@ejemplo.com",1,"w-full","px-4","py-2","bg-slate-700","border","border-slate-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],["type","tel","formControlName","billingPhone","placeholder","+52 123 456 7890",1,"w-full","px-4","py-2","bg-slate-700","border","border-slate-600","rounded-lg","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-lime-400","focus:border-transparent"],[1,"flex","items-start"],["type","checkbox","formControlName","acceptTerms",1,"mt-1","h-4","w-4","text-lime-400","focus:ring-lime-400","border-gray-600","rounded","bg-slate-700"],[1,"ml-2","text-sm","text-gray-300"],["href","/terms-conditions","target","_blank",1,"text-lime-400","hover:text-lime-300","underline"],["href","/privacy-policy","target","_blank",1,"text-lime-400","hover:text-lime-300","underline"],[1,"text-xs","text-red-400"],[1,"lg:col-span-1"],[1,"bg-slate-800/50","rounded-lg","border","border-white/10","p-6","sticky","top-4"],[1,"rounded-2xl","border","border-white/10","bg-slate-900/50","overflow-hidden"],[1,"p-4","border-b","border-white/10","bg-white/5"],[1,"font-semibold","text-white"],[1,"divide-y","divide-white/10"],[1,"p-4","flex","gap-4"],[1,"p-4","bg-white/5","flex","flex-col","items-end","justify-center"],[1,"flex","items-center","justify-between","w-full"],[1,"text-white/60"],[1,"text-2xl","font-bold","text-white"],[1,"text-sm","text-lime-400","font-mono","mt-1"],[1,"p-4","bg-white/5","border-t","border-slate-700"],[1,"flex","items-center","justify-between","p-3","bg-lime-500/10","border","border-lime-500/30","rounded-lg"],[1,"border-t","border-slate-700","pt-4","space-y-2","mb-6"],[1,"flex","justify-between","text-gray-400"],[1,"flex","justify-between","text-lime-400"],[1,"flex","justify-between","text-xl","font-bold","text-white","pt-2","border-t","border-slate-700"],[1,"text-lime-400"],["type","button","disabled","",1,"w-full","bg-slate-700","text-slate-300","font-bold","py-3","px-6","rounded-lg","opacity-50","cursor-not-allowed","transition-all","flex","items-center","justify-center"],["type","button",1,"w-full","bg-lime-400","text-slate-900","font-bold","py-3","px-6","rounded-lg","hover:bg-lime-500","disabled:bg-slate-600","disabled:cursor-not-allowed","transition-all","flex","items-center","justify-center",3,"disabled"],[1,"text-sm","text-center","text-gray-400","mt-3"],[1,"mt-4","flex","items-center","justify-center","text-xs","text-gray-500"],["fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","mr-1","text-lime-400"],["fill-rule","evenodd","d","M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule","evenodd"],[1,"mt-8","bg-slate-800/30","rounded-lg","border","border-white/10","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"flex","items-start","space-x-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-lime-400","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"],[1,"font-semibold","text-white","mb-1"],[1,"text-sm","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"],[1,"fixed","inset-0","bg-black/75","transition-opacity",3,"click"],[1,"flex","min-h-full","items-center","justify-center","p-4"],[1,"relative","transform","overflow-hidden","rounded-lg","bg-slate-800","text-left","shadow-xl","transition-all","w-full","max-w-md","border","border-lime-400/50",3,"click"],[1,"bg-slate-800","px-6","py-6"],[1,"mx-auto","flex","h-12","w-12","items-center","justify-center","rounded-full","bg-lime-100"],["fill","none","viewBox","0 0 24 24","stroke-width","1.5","stroke","currentColor",1,"h-6","w-6","text-lime-600"],["stroke-linecap","round","stroke-linejoin","round","d","M4.5 12.75l6 6 9-13.5"],[1,"mt-4","text-center"],["id","modal-title",1,"text-xl","font-semibold","leading-6","text-white"],[1,"mt-2","text-lg","text-lime-300"],[1,"mt-4","text-sm","text-gray-300","space-y-3"],[1,"p-3","bg-lime-500/10","border","border-lime-400/30","rounded-lg"],[1,"text-lime-400","font-semibold","flex","items-center","justify-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 10V3L4 14h7v7l9-11h-7z"],[1,"text-xs","text-gray-400","mt-1"],[1,"mt-6"],["type","button",1,"w-full","inline-flex","justify-center","rounded-md","bg-lime-500","px-4","py-3","text-sm","font-semibold","text-slate-900","shadow-sm","hover:bg-lime-400","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-lime-500","focus:ring-offset-slate-800","transition-colors",3,"click"],[1,"flex","items-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5","text-red-500","mr-2"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule","evenodd"],[1,"text-red-400","text-sm"],[1,"flex","items-start","gap-4"],[1,"flex-shrink-0"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex-1"],[1,"text-lg","font-bold","text-blue-300","mb-2"],[1,"text-gray-300","mb-3"],[1,"flex","gap-3"],["routerLink","/profile-student",1,"inline-flex","items-center","gap-2","px-4","py-2","bg-blue-500","hover:bg-blue-600","text-white","rounded-lg","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],["routerLink","/",1,"inline-flex","items-center","gap-2","px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","transition-colors"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"],[1,"flex","items-center","justify-center","py-8"],[1,"text-center"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400","mx-auto","mb-3"],[1,"flex","items-center","justify-between","mb-6"],[1,"flex","items-center","gap-4"],[1,"relative"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"absolute","-top-1","-right-1","flex","h-4","w-4"],[1,"text-base","font-semibold","text-gray-300","mb-1"],[1,"text-3xl","font-black","text-lime-400"],[1,"inline-flex","items-center","gap-1.5","mt-2","px-3","py-1","bg-green-500/20","border","border-green-400/40","rounded-full"],[1,"inline-flex","items-center","gap-1.5","mt-2","px-3","py-1","bg-blue-500/20","border","border-blue-400/40","rounded-full"],[1,"relative","inline-flex","items-center","cursor-pointer","group"],["type","checkbox",1,"sr-only","peer",3,"change","checked"],[1,"w-16","h-8","bg-slate-700","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-lime-300/50","rounded-full","peer","peer-checked:after:translate-x-full","rtl:peer-checked:after:-translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-1","after:start-[4px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-6","after:w-6","after:transition-all","peer-checked:bg-lime-500","shadow-lg"],[1,"ms-3","text-sm","font-semibold","text-white","group-hover:text-lime-300","transition-colors"],[1,"bg-slate-900/50","backdrop-blur-sm","rounded-xl","p-5","space-y-3","border","border-white/5"],[1,"mt-5","pt-5","border-t","border-white/10"],[1,"animate-ping","absolute","inline-flex","h-full","w-full","rounded-full","bg-green-400","opacity-75"],[1,"relative","inline-flex","rounded-full","h-4","w-4","bg-green-500","items-center","justify-center"],["fill","currentColor","viewBox","0 0 20 20",1,"w-2.5","h-2.5","text-white"],["fill-rule","evenodd","d","M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule","evenodd"],["fill","currentColor","viewBox","0 0 20 20",1,"w-3.5","h-3.5","text-green-400"],["fill-rule","evenodd","d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule","evenodd"],[1,"text-xs","font-bold","text-green-300"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3.5","h-3.5","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-xs","font-bold","text-blue-300"],[1,"flex","justify-between","items-center","text-sm"],[1,"text-slate-300","flex","items-center","gap-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"],[1,"flex","flex-col","items-end"],[1,"text-white","font-bold"],[1,"text-lime-300","flex","items-center","gap-2","font-semibold"],[1,"text-lime-400","font-bold"],[1,"h-px","bg-gradient-to-r","from-transparent","via-white/20","to-transparent","my-3"],[1,"flex","justify-between","items-center"],[1,"text-white","font-bold","text-base"],[1,"mt-4","p-4","bg-gradient-to-r","from-green-500/20","to-emerald-500/20","border","border-green-500/50","rounded-lg","animate-pulse-slow"],[1,"mt-4","p-4","bg-gradient-to-r","from-blue-500/20","to-indigo-500/20","border","border-blue-500/50","rounded-lg"],[1,"flex","items-center","gap-3"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-10","h-10","text-green-400"],[1,"text-lg","font-bold","text-green-300","flex","items-center","gap-2"],[1,"inline-flex","items-center","px-2","py-0.5","rounded-full","text-xs","font-bold","bg-green-500","text-white","animate-bounce"],[1,"text-sm","text-green-200","mt-1"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-green-400","animate-pulse"],["d","M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-blue-400","flex-shrink-0"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"text-base","font-bold","text-blue-300"],[1,"text-sm","text-blue-200","mt-1"],[1,"font-bold"],[1,"text-blue-300","mx-2"],[1,"flex","items-center","justify-between","mb-3"],[1,"text-sm","font-semibold","text-gray-300","flex","items-center","gap-2"],["routerLink","/wallet",1,"text-xs","text-lime-400","hover:text-lime-300","font-semibold","flex","items-center","gap-1"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-3","h-3"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 5l7 7-7 7"],[1,"space-y-2"],[1,"flex","items-center","justify-between","p-2.5","bg-slate-800/50","rounded-lg","hover:bg-slate-800/70","transition-colors"],[1,"flex","items-center","gap-2.5","flex-1","min-w-0"],[1,"text-xl","flex-shrink-0"],[1,"flex-1","min-w-0"],[1,"text-xs","font-medium","text-white","truncate"],[1,"text-xs","text-gray-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-12","h-12","text-lime-400"],[1,"text-2xl","font-bold","text-lime-300","mb-2"],[1,"text-base","text-gray-300"],[1,"text-sm","text-gray-400","mt-1","block"],[1,"mb-3","text-xs","text-gray-400"],[1,"space-y-3"],["type","button",1,"w-full","flex","items-center","justify-between","p-4","border-2","border-slate-700","rounded-lg","hover:border-lime-400/50","transition-all",3,"border-lime-400","bg-lime-400/10"],[1,"w-full","flex","items-center","justify-between","p-4","border-2","border-red-900/50","rounded-lg","bg-red-900/10","opacity-50","cursor-not-allowed"],["type","button",1,"w-full","flex","items-center","justify-between","p-4","border-2","border-slate-700","rounded-lg","hover:border-lime-400/50","transition-all",3,"click"],[1,"flex","items-center","space-x-3"],[1,"text-2xl"],[1,"text-left"],[1,"font-medium","text-white"],[1,"text-xs","text-lime-400"],["fill","currentColor","viewBox","0 0 20 20",1,"w-6","h-6","text-lime-400"],[1,"text-2xl","opacity-50"],[1,"font-medium","text-gray-500"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-8","h-8","text-lime-400","flex-shrink-0"],[1,"text-lg","font-bold","text-lime-300"],[1,"text-sm","text-gray-300","mt-1"],["alt","Imagen del producto",1,"w-20","h-20","rounded-lg","object-cover","bg-slate-800",3,"src"],[1,"flex","items-start","justify-between","gap-4"],[1,"text-xs","text-lime-400","font-medium","mb-1"],[1,"text-white","font-medium","line-clamp-2"],[1,"text-sm","text-white/50","mt-1","line-clamp-1"],[1,"text-right"],[1,"text-lg","font-bold","text-white"],[1,"text-xs","text-white/40","line-through"],[1,"text-xs","text-lime-400","mt-1"],[1,"p-4","flex","gap-4","group","relative"],["title","Eliminar del carrito",1,"absolute","top-2","right-2","p-1","text-white/20","hover:text-red-400","transition","opacity-0","group-hover:opacity-100",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M6 18L18 6M6 6l12 12"],[1,"flex","gap-2"],["type","text","placeholder","C\xF3digo de cup\xF3n",1,"flex-1","bg-slate-700","border","border-slate-600","rounded-lg","px-3","py-2","text-sm","text-white","placeholder-gray-400","focus:outline-none","focus:ring-2","focus:ring-lime-500",3,"input","keyup.enter","value"],[1,"px-4","py-2","bg-slate-700","hover:bg-slate-600","text-white","rounded-lg","text-sm","font-medium","transition-colors","disabled:opacity-50",3,"click","disabled"],[1,"text-xs","text-red-400","mt-2"],[1,"flex","items-center","gap-2"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-5","h-5","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"],[1,"text-sm","font-bold","text-lime-400"],[1,"text-xs","text-lime-300/80"],[1,"text-slate-400","hover:text-white",3,"click"],["fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"w-4","h-4"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","mr-2"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["type","button",1,"w-full","bg-lime-400","text-slate-900","font-bold","py-3","px-6","rounded-lg","hover:bg-lime-500","disabled:bg-slate-600","disabled:cursor-not-allowed","transition-all","flex","items-center","justify-center",3,"click","disabled"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"],[1,"opacity-75","text-xs","ml-1"]],template:function(e,a){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),m(),t(4,"svg",4),d(5,"path",5),i(),r(6," Volver "),i(),g(),t(7,"h1",6),r(8,"Finalizar Compra"),i(),t(9,"p",7),r(10,"Completa tu pedido de forma segura"),i()(),u(11,Ie,25,1,"div",8),u(12,Be,6,1,"div",9),u(13,Ne,19,2,"div",10),t(14,"div",11)(15,"div",12),u(16,Ve,6,0,"div",13),u(17,ze,22,8,"div",13),t(18,"div",14),u(19,Xe,16,0,"div",15),t(20,"h2",16),u(21,Re,2,3)(22,Oe,1,0)(23,Ue,1,0),i(),u(24,it,4,1)(25,nt,9,0,"div",17),i(),t(26,"div",14)(27,"h2",16),r(28,"Datos Personales"),i(),t(29,"form",18)(30,"div")(31,"label",19),r(32,"Nombre Completo *"),i(),d(33,"input",20),u(34,ot,2,0,"p",21),i(),t(35,"div")(36,"label",19),r(37,"Email *"),i(),d(38,"input",22),u(39,at,2,0,"p",21),i(),t(40,"div")(41,"label",19),r(42,"Tel\xE9fono (Opcional)"),i(),d(43,"input",23),i(),t(44,"div",24),d(45,"input",25),t(46,"label",26),r(47," Acepto los "),t(48,"a",27),r(49,"t\xE9rminos y condiciones"),i(),r(50," y la "),t(51,"a",28),r(52,"pol\xEDtica de privacidad"),i()()(),u(53,rt,2,0,"p",29),i()()(),t(54,"div",30)(55,"div",31)(56,"h2",16),r(57,"Resumen del Pedido"),i(),t(58,"div",32)(59,"div",33)(60,"h2",34),r(61,"Resumen del pedido"),i()(),t(62,"div",35),u(63,ct,14,5,"div",36)(64,mt,2,0),i(),t(65,"div",37)(66,"div",38)(67,"span",39),r(68,"Total a pagar"),i(),t(69,"span",40),r(70),S(71,"mxnCurrency"),i()(),t(72,"span",41),r(73),S(74,"mxnCurrency"),i()(),t(75,"div",42),u(76,pt,5,4)(77,gt,12,2,"div",43),i(),t(78,"div",44)(79,"div",45)(80,"span"),r(81,"Subtotal"),i(),t(82,"span"),r(83),i()(),u(84,ft,5,1,"div",46)(85,vt,5,0,"div",45),t(86,"div",47)(87,"span"),r(88,"Total"),i(),t(89,"span",48),r(90),i()()(),u(91,_t,6,0,"button",49)(92,St,5,2,"button",50)(93,yt,5,2,"button",50),u(94,Mt,3,1,"p",51),t(95,"div",52),m(),t(96,"svg",53),d(97,"path",54),i(),r(98," Pago seguro y encriptado "),i()()()(),g(),t(99,"div",55)(100,"div",56)(101,"div",57),m(),t(102,"svg",58),d(103,"path",59),i(),g(),t(104,"div")(105,"h3",60),r(106,"Pago Seguro"),i(),t(107,"p",61),r(108,"Tus datos est\xE1n protegidos con encriptaci\xF3n SSL"),i()()(),t(109,"div",57),m(),t(110,"svg",58),d(111,"path",62),i(),g(),t(112,"div")(113,"h3",60),r(114,"Acceso Inmediato"),i(),t(115,"p",61),r(116,"Accede a tus cursos inmediatamente despu\xE9s del pago"),i()()(),t(117,"div",57),m(),t(118,"svg",58),d(119,"path",63),i(),g(),t(120,"div")(121,"h3",60),r(122,"Confirmaci\xF3n por Email"),i(),t(123,"p",61),r(124,"Recibir\xE1s un comprobante de tu compra"),i()()()()()()()()),e&2){let s,f,C,P;l(11),p(a.showSuccess()?11:-1),l(),p(a.errorMessage()?12:-1),l(),p(a.alreadyPurchased()&&a.isDirectBuy()?13:-1),l(3),p(a.isLoadingWallet()?16:-1),l(),p(a.walletBalance()>0&&!a.isLoadingWallet()?17:-1),l(2),p(a.isFreeProduct()?19:-1),l(2),p(a.useWalletBalance()&&a.remainingAmount()>0?21:a.useWalletBalance()&&a.remainingAmount()===0?22:23),l(3),p(a.remainingAmount()>0||!a.useWalletBalance()?24:25),l(5),N("formGroup",a.checkoutForm),l(5),p((s=a.checkoutForm.get("billingName"))!=null&&s.invalid&&((s=a.checkoutForm.get("billingName"))!=null&&s.touched)?34:-1),l(5),p((f=a.checkoutForm.get("billingEmail"))!=null&&f.invalid&&((f=a.checkoutForm.get("billingEmail"))!=null&&f.touched)?39:-1),l(14),p((C=a.checkoutForm.get("acceptTerms"))!=null&&C.invalid&&((C=a.checkoutForm.get("acceptTerms"))!=null&&C.touched)?53:-1),l(10),p(a.isDirectBuy()?63:64),l(7),x("",w(71,21,a.subtotal())," MXN"),l(3),x(" ",w(74,23,a.subtotal())," "),l(3),p(a.appliedCoupon()?77:76),l(7),x("$",a.formatPrice(a.originalPrice())),l(),p((P=a.bestDiscount())?84:85,P),l(6),x("$",a.formatPrice(a.subtotal())," MXN"),l(),p(a.isProcessing()?91:a.useWalletBalance()?92:93),l(3),p(a.useWalletBalance()?94:-1)}},dependencies:[ne,Ce,fe,pe,ue,xe,he,_e,ve,ae,te,ie,de],encapsulation:2})};export{Me as CheckoutComponent};
