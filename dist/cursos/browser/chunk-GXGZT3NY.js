import{a as J}from"./chunk-LLT3RGYM.js";import"./chunk-WKNAVW3U.js";import{b as I}from"./chunk-EBA73VGJ.js";import{a as q}from"./chunk-7N3D32XO.js";import{a as O}from"./chunk-5PWF2E7V.js";import"./chunk-2KDY6PAZ.js";import{a as X}from"./chunk-HXOKL4IY.js";import"./chunk-PPQNL6QW.js";import"./chunk-R5HHEV5R.js";import{a as Y}from"./chunk-EHX7DDP6.js";import"./chunk-TGT7B6YH.js";import"./chunk-QZCYETEH.js";import"./chunk-7MU4WVSP.js";import{b as $}from"./chunk-VF3RCM2S.js";import{d as H,e as N,g as A,h as B}from"./chunk-VM3MHBTU.js";import{a as G}from"./chunk-TCGJFX72.js";import"./chunk-QA5A7GBQ.js";import"./chunk-F4KIANN2.js";import{$ as w,$b as R,Ac as z,Gb as l,Ha as V,Hb as F,Ia as L,Ib as _,Ma as d,T as h,Xa as U,Y as g,Z as f,_ as u,_b as M,ec as b,hb as x,ib as v,ja as E,ka as P,lb as D,mb as T,nb as C,ob as i,pb as o,qb as p,ub as j,wb as S,yb as c}from"./chunk-6JS7X5LE.js";import"./chunk-I4MTPUBM.js";var Q=(n,t)=>t._id;function W(n,t){n&1&&(i(0,"div",8),p(1,"div",10),o())}function Z(n,t){n&1&&(i(0,"div",9)(1,"h2",11),l(2,"Proyecto no encontrado"),o(),i(3,"p",12),l(4,"El proyecto que buscas no existe o ha sido eliminado."),o(),i(5,"a",13),l(6," Volver al inicio "),o()())}function ee(n,t){if(n&1&&(i(0,"span",20),l(1),o()),n&2){let e,r=c(2);d(),_(" ",(e=r.project())==null||e.categorie==null?null:e.categorie.title," ")}}function te(n,t){n&1&&(i(0,"div",24),u(),i(1,"svg",41),p(2,"path",42),o(),w(),i(3,"span"),l(4,"Ya tienes este proyecto"),o()())}function ie(n,t){if(n&1){let e=j();i(0,"div",25)(1,"div",43)(2,"span",44),l(3),M(4,"mxnCurrency"),o()(),i(5,"button",45),S("click",function(){g(e);let a=c(2);return f(a.buyNow())}),u(),i(6,"svg",5),p(7,"path",46),o(),l(8," Comprar ahora "),o()()}if(n&2){let e,r=c(2);d(3),_(" ",R(4,1,(e=r.project())==null?null:e.price_mxn)," MXN ")}}function oe(n,t){n&1&&(u(),i(0,"svg",59),p(1,"circle",60)(2,"path",61),o())}function ne(n,t){if(n&1){let e=j();i(0,"div",51)(1,"div",52)(2,"div",53),u(),i(3,"svg",41),p(4,"path",54),o()(),w(),i(5,"div",55)(6,"p",56),l(7),o(),i(8,"p",57),l(9),o()()(),i(10,"button",58),S("click",function(){let a=g(e).$implicit,s=c(3);return f(s.downloadFile(a))}),x(11,oe,3,0,":svg:svg",59),l(12," Descargar "),o()()}if(n&2){let e=t.$implicit,r=c(3);d(7),_(" ",e.name),d(2),_("",(e.size/1024/1024).toFixed(2)," MB "),d(),C("disabled",r.downloadingFiles().has(e._id)),d(),v(r.downloadingFiles().has(e._id)?11:-1)}}function re(n,t){if(n&1&&(i(0,"div",29)(1,"h3",47),u(),i(2,"svg",48),p(3,"path",49),o(),l(4," Archivos Descargables "),o(),w(),i(5,"div",50),D(6,ne,13,4,"div",51,Q),o()()),n&2){let e,r=c(2);d(6),T((e=r.project())==null?null:e.files)}}function le(n,t){if(n&1){let e=j();i(0,"div",63)(1,"button",64),S("click",function(){g(e);let a=c(3);return f(a.toggleVideo())}),u(),i(2,"svg",65),p(3,"path",66),o()()(),w(),i(4,"div",67),u(),i(5,"svg",68),p(6,"path",69)(7,"path",70),o(),l(8," Ver intro "),o()}}function ae(n,t){if(n&1&&(p(0,"img",62),x(1,le,9,0)),n&2){let e,r,a=c(2);C("src",a.imageUrl,V)("alt",(e=a.project())==null?null:e.title),d(),v((r=a.project())!=null&&r.url_video?1:-1)}}function de(n,t){if(n&1&&p(0,"iframe",32),n&2){let e=c(2);C("src",e.videoUrl(),L)}}function se(n,t){n&1&&(i(0,"div",33)(1,"h3",71),l(2,"Creado por"),o(),i(3,"div",72)(4,"div",73),l(5," P "),o(),i(6,"div")(7,"p",74),l(8,"Instructor"),o(),i(9,"p",75),l(10,"Instructor Profesional"),o()()()())}function ce(n,t){if(n&1){let e=j();i(0,"div",79),S("click",function(){let a=g(e).$implicit,s=c(3);return f(s.navigateToProject(a._id))}),i(1,"div",80),p(2,"img",81),o(),i(3,"div",82)(4,"h3",83),l(5),o(),i(6,"p",84),l(7),M(8,"mxnCurrency"),o()()()}if(n&2){let e=t.$implicit,r=c(3);d(2),C("src",r.api.buildProjectImageUrl(e.imagen),V),d(3),_("",e.title," "),d(2),_("",R(8,3,e.price_mxn)," MXN")}}function pe(n,t){if(n&1&&(i(0,"div",40)(1,"h2",76),l(2,"Proyectos relacionados"),o(),i(3,"div",77),D(4,ce,9,5,"div",78,Q),o()()),n&2){let e=c(2);d(4),T(e.relatedProjects())}}function me(n,t){if(n&1){let e=j();i(0,"div",14)(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18)(5,"span",19),l(6," Proyecto "),o(),x(7,ee,2,1,"span",20),o(),i(8,"h1",21),l(9),o(),i(10,"p",22),l(11),o(),i(12,"div",23),x(13,te,5,0,"div",24)(14,ie,9,3,"div",25),o(),i(15,"div",26)(16,"h3",27),l(17,"Descripci\xF3n del proyecto"),o(),i(18,"p",28),l(19),o()(),x(20,re,8,0,"div",29),o(),i(21,"div",30)(22,"div",31),x(23,ae,2,3)(24,de,1,1,"iframe",32),o(),x(25,se,11,0,"div",33),o()()()(),i(26,"div",34)(27,"h2",35)(28,"span",36),u(),i(29,"svg",37),p(30,"path",38),o()(),l(31," Rese\xF1as del proyecto "),o(),w(),i(32,"app-course-reviews",39),S("reviewAdded",function(a){g(e);let s=c();return f(s.onReviewAdded(a))})("reviewUpdated",function(a){g(e);let s=c();return f(s.onReviewUpdated(a))}),o()(),x(33,pe,6,0,"div",40)}if(n&2){let e,r,a,s,y,k,m=c();d(7),v((e=m.project())!=null&&e.categorie?7:-1),d(2),_(" ",(r=m.project())==null?null:r.title," "),d(2),_(" ",(a=m.project())==null?null:a.subtitle," "),d(2),v(m.studentHasProject()?13:14),d(6),F((s=m.project())==null?null:s.description),d(),v(m.studentHasProject()&&(!((y=m.project())==null||y.files==null)&&y.files.length)?20:-1),d(3),v(!m.showVideoPreview()||!m.videoUrl()?23:24),d(2),v((k=m.project())!=null&&k.user?25:-1),d(7),C("productId",m.projectId())("productType","project")("showStatistics",!1)("enableRating",!1),d(),v(m.relatedProjects().length?33:-1)}}var K=class n{route=h(N);api=h(q);authService=h($);router=h(A);sanitizer=h(H);toast=h(G);seoService=h(Y);params=I(this.route.paramMap,{initialValue:null});errorToastShown=!1;projectId=b(()=>this.params()?.get("id")||"");detailRes=this.api.projectPublicResource(()=>this.projectId());isLoading=this.detailRes.isLoading;hasError=this.detailRes.hasError;error=this.detailRes.error;showVideoPreview=E(!1);project=b(()=>this.detailRes.value().project);reviews=b(()=>this.detailRes.value().reviews);relatedProjects=b(()=>this.detailRes.value().project_relateds);studentHasProject=b(()=>{let t=this.detailRes.value().student_have_project;return this.authService.isLoggedIn()?!!t:!1});videoUrl=b(()=>{let t=this.project();if(!t?.url_video)return null;let e=t.url_video;return e.includes("youtube.com/watch?v=")?e=`https://www.youtube.com/embed/${e.split("v=")[1].split("&")[0]}?autoplay=1`:e.includes("youtu.be/")?e=`https://www.youtube.com/embed/${e.split("youtu.be/")[1].split("?")[0]}?autoplay=1`:e.includes("vimeo.com/")&&(e=`https://player.vimeo.com/video/${e.split("vimeo.com/")[1].split("?")[0]}?autoplay=1`),this.sanitizer.bypassSecurityTrustResourceUrl(e)});queryParams=I(this.route.queryParamMap,{initialValue:null});constructor(){P(()=>{this.error()&&!this.errorToastShown&&(this.errorToastShown=!0,this.toast.error("Error al cargar","No se pudo cargar el proyecto."))}),P(()=>{let t=this.project();t&&this.seoService.setSeo({title:t.title,description:t.subtitle||t.description||"Proyecto pr\xE1ctico en Dev Hub Sharks",image:this.imageUrl,keywords:`proyecto, ${t.title}, react, angular, nodejs, desarrollo web`,type:"article"})}),P(()=>{let t=this.queryParams();if(t){let e=t.get("coupon");e&&(localStorage.setItem("pending_coupon",e),this.toast.success("Cup\xF3n detectado","Se aplicar\xE1 al finalizar la compra"))}}),P(()=>{let t=this.authService.isLoggedIn();this.projectId()&&this.detailRes.reload()})}get imageUrl(){let t=this.project();return t?this.api.buildProjectImageUrl(t.imagen):""}toggleVideo(){this.showVideoPreview.set(!0)}buyNow(){if(!this.authService.isLoggedIn()){this.router.navigate(["/login"]);return}let t=this.project();if(!(!t||!t._id)){if(this.studentHasProject()){this.toast.info("Ya tienes este proyecto",'Este proyecto ya est\xE1 en tu biblioteca. Ve a "Mis Proyectos" para acceder.'),setTimeout(()=>{this.router.navigate(["/profile-student"])},2e3);return}this.router.navigate(["/checkout"],{state:{product:t,productType:"project"}})}}navigateToProject(t){t&&(window.scrollTo(0,0),this.router.navigate(["/project-detail",t]))}onReviewAdded(t){this.toast.success("Rese\xF1a agregada","Gracias por tu opini\xF3n"),this.detailRes.reload()}onReviewUpdated(t){this.toast.success("Rese\xF1a actualizada","Tu opini\xF3n ha sido actualizada"),this.detailRes.reload()}downloadingFiles=E(new Set);downloadFile(t){let e=this.projectId();!e||!t||!t.filename||this.downloadingFiles().has(t._id)||(this.downloadingFiles.update(r=>{let a=new Set(r);return a.add(t._id),a}),this.api.downloadProjectFile(e,t.filename).subscribe({next:r=>{let a=window.URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=t.name||t.filename,s.click(),window.URL.revokeObjectURL(a),this.downloadingFiles.update(y=>{let k=new Set(y);return k.delete(t._id),k})},error:r=>{console.error("Download error",r),this.toast.error("Error de descarga","No se pudo descargar el archivo"),this.downloadingFiles.update(a=>{let s=new Set(a);return s.delete(t._id),s})}}))}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=U({type:n,selectors:[["app-project-detail"]],decls:13,vars:1,consts:[[1,"min-h-screen","bg-slate-950"],[1,"pb-20","pt-6"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","mb-6"],["routerLink","/",1,"inline-flex","items-center","text-slate-400","hover:text-white","transition-colors","gap-2","group"],[1,"p-2","rounded-lg","bg-white/5","border","border-white/10","group-hover:bg-white/10","transition-colors"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"font-medium"],[1,"flex","items-center","justify-center","min-h-[60vh]"],[1,"flex","flex-col","items-center","justify-center","min-h-[60vh]","text-center","px-4"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"text-2xl","font-bold","text-white","mb-2"],[1,"text-slate-400","mb-6"],["routerLink","/",1,"px-6","py-2","bg-lime-400","text-slate-900","rounded-lg","hover:bg-lime-500","font-bold","transition"],[1,"relative","bg-slate-900","border-b","border-white/5","pb-10","mb-10"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8","lg:gap-12","items-start","py-8"],[1,"space-y-6","order-2","lg:order-1"],[1,"flex","items-center","gap-2"],[1,"px-3","py-1","rounded-full","text-xs","font-medium","bg-lime-400/10","text-lime-400","border","border-lime-400/20"],[1,"px-3","py-1","rounded-full","text-xs","font-medium","bg-slate-800","text-slate-300","border","border-white/10"],[1,"text-3xl","md:text-4xl","lg:text-5xl","font-black","text-white","leading-tight"],[1,"text-lg","md:text-xl","text-slate-400","font-light","leading-relaxed"],[1,"flex","flex-col","sm:flex-row","gap-4","pt-6"],[1,"flex","items-center","gap-3","px-6","py-4","bg-emerald-500/10","border","border-emerald-500/30","rounded-xl","text-emerald-400","font-bold","w-full","sm:w-auto","justify-center"],[1,"flex","flex-col","gap-2","w-full","sm:w-auto"],[1,"prose","prose-invert","max-w-none","pt-8","border-t","border-white/10"],[1,"text-white","font-bold","text-lg","mb-4"],[1,"text-slate-300","whitespace-pre-line"],[1,"mt-8","bg-slate-800/50","rounded-xl","p-6","border","border-white/10"],[1,"space-y-6","order-1","lg:order-2","sticky","top-24"],[1,"aspect-video","rounded-2xl","overflow-hidden","border","border-white/10","shadow-2xl","relative","group","bg-black"],["frameborder","0","allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture","allowfullscreen","",1,"w-full","h-full",3,"src"],[1,"bg-slate-800/50","rounded-xl","p-6","border","border-white/5"],[1,"max-w-4xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12"],[1,"text-2xl","font-bold","text-white","mb-8","flex","items-center","gap-2"],[1,"w-8","h-8","rounded-lg","bg-lime-400/10","flex","items-center","justify-center","text-lime-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"],[3,"reviewAdded","reviewUpdated","productId","productType","showStatistics","enableRating"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-12","border-t","border-white/5"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 13l4 4L19 7"],[1,"flex","items-baseline","gap-2"],[1,"text-3xl","font-black","text-white"],[1,"px-8","py-4","bg-lime-400","text-slate-900","rounded-xl","font-bold","hover:bg-lime-500","hover:shadow-lg","hover:shadow-lime-500/20","transition-all","active:scale-95","flex","items-center","justify-center","gap-2","w-full","sm:w-auto",3,"click"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"],[1,"text-white","font-bold","text-lg","mb-4","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-5","h-5","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],[1,"space-y-3"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","justify-between","p-3","bg-slate-900","rounded-lg","border","border-white/5","hover:border-lime-400/30","transition","group","gap-3"],[1,"flex","items-center","gap-3","overflow-hidden"],[1,"w-10","h-10","rounded-lg","bg-slate-800","flex-shrink-0","flex","items-center","justify-center","text-slate-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"min-w-0"],[1,"text-white","font-medium","text-sm","group-hover:text-lime-400","transition","truncate"],[1,"text-slate-500","text-xs"],[1,"w-full","sm:w-auto","text-lime-400","hover:text-lime-300","text-sm","font-semibold","px-3","py-1","bg-lime-400/10","rounded-lg","transition","disabled:opacity-50","disabled:cursor-wait","flex","items-center","justify-center","gap-2","flex-shrink-0",3,"click","disabled"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","h-4","w-4"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],[1,"w-full","h-full","object-cover","opacity-80","group-hover:opacity-60","transition-opacity","duration-300",3,"src","alt"],[1,"absolute","inset-0","flex","items-center","justify-center"],[1,"w-20","h-20","bg-lime-400","rounded-full","flex","items-center","justify-center","text-slate-900","shadow-lg","shadow-lime-400/20","transform","group-hover:scale-110","transition-all","duration-300","animate-pulse","group-hover:animate-none",3,"click"],["fill","currentColor","viewBox","0 0 20 20",1,"w-8","h-8","ml-1"],["d","M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"],[1,"absolute","bottom-4","right-4","px-3","py-1","bg-black/60","backdrop-blur-sm","rounded-lg","text-white","text-xs","font-medium","flex","items-center","gap-2"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-4","h-4","text-lime-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"text-sm","font-bold","text-slate-400","uppercase","tracking-wider","mb-4"],[1,"flex","items-center","gap-4"],[1,"w-12","h-12","rounded-full","bg-slate-700","flex","items-center","justify-center","text-xl","font-bold","text-white"],[1,"text-white","font-bold","text-lg"],[1,"text-slate-400","text-sm"],[1,"text-2xl","font-bold","text-white","mb-8"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6"],[1,"group","cursor-pointer","bg-slate-900","border","border-white/5","rounded-xl","overflow-hidden","hover:border-lime-400/30","transition"],[1,"group","cursor-pointer","bg-slate-900","border","border-white/5","rounded-xl","overflow-hidden","hover:border-lime-400/30","transition",3,"click"],[1,"aspect-video","bg-slate-800","relative","overflow-hidden"],[1,"w-full","h-full","object-cover","group-hover:scale-105","transition","duration-500",3,"src"],[1,"p-4"],[1,"text-white","font-bold","line-clamp-2","group-hover:text-lime-400","transition"],[1,"text-slate-400","text-sm","mt-2"]],template:function(e,r){e&1&&(i(0,"div",0),p(1,"app-header"),i(2,"div",1)(3,"div",2)(4,"a",3)(5,"div",4),u(),i(6,"svg",5),p(7,"path",6),o()(),w(),i(8,"span",7),l(9,"Volver al inicio"),o()()(),x(10,W,2,0,"div",8)(11,Z,7,0,"div",9)(12,me,34,13),o()()),e&2&&(d(10),v(r.isLoading()?10:r.hasError()||!r.project()?11:12))},dependencies:[z,J,X,B,O],encapsulation:2})};export{K as ProjectDetailComponent};
