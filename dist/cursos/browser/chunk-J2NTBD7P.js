import{a as X}from"./chunk-NO3WFOJA.js";import{a as G}from"./chunk-RHIE2QCX.js";import{b as R,d as W,f as H,h as P,i as O,q as $,r as z,s as A,x as q,y as U}from"./chunk-QA5A7GBQ.js";import{$ as v,Ac as B,Eb as k,Gb as i,Ha as F,Ib as d,Jb as V,Lb as w,Ma as l,Mb as I,Nb as D,T,Ub as j,Xa as N,Y as b,Z as C,_ as f,ec as u,hb as p,ib as g,kb as M,lb as S,mb as E,nb as h,ob as t,pb as n,qb as x,ub as y,uc as L,wb as _,yb as m}from"./chunk-6JS7X5LE.js";var K=()=>[1,2,3,4,5],Q=(a,r)=>r._id;function Y(a,r){a&1&&(t(0,"div",22),x(1,"div",23)(2,"div",24),n())}function Z(a,r){a&1&&(t(0,"div",3),S(1,Y,3,0,"div",22,M),n()),a&2&&(l(),E(j(0,K)))}function ee(a,r){if(a&1&&(t(0,"div",3)(1,"div",25)(2,"div",26)(3,"div")(4,"p",27),i(5,"Disponible"),n(),t(6,"p",28),i(7),n(),t(8,"p",29),i(9),n()(),t(10,"div",30),f(),t(11,"svg",31),x(12,"path",32),n()()()(),v(),t(13,"div",33)(14,"div",26)(15,"div")(16,"p",34),i(17,"Pendiente"),n(),t(18,"p",35),i(19),n(),t(20,"p",29),i(21),n()(),t(22,"div",36),f(),t(23,"svg",37),x(24,"path",38),n()()()(),v(),t(25,"div",39)(26,"div",26)(27,"div")(28,"p",40),i(29,"Reembolsos"),n(),t(30,"p",41),i(31),n(),t(32,"p",29),i(33),n()(),t(34,"div",42),f(),t(35,"svg",43),x(36,"path",44),n()()()(),v(),t(37,"div",45)(38,"div",26)(39,"div")(40,"p",46),i(41,"Pagado"),n(),t(42,"p",47),i(43),n(),t(44,"p",29),i(45),n()(),t(46,"div",48),f(),t(47,"svg",49),x(48,"path",50),n()()()(),v(),t(49,"div",51)(50,"div",26)(51,"div")(52,"p",52),i(53,"Total Ganado"),n(),t(54,"p",53),i(55),n(),t(56,"p",29),i(57),n()(),t(58,"div",54),f(),t(59,"svg",55),x(60,"path",56),n()()()()()),a&2){let e=m();l(7),d(" ",e.formatCurrency(e.stats().available.total)," "),l(2),d(" ",e.stats().available.count," ventas "),l(10),d(" ",e.formatCurrency(e.stats().pending.total)," "),l(2),d(" ",e.stats().pending.count," ventas "),l(10),d(" -",e.formatCurrency(e.stats().refunds.total)," "),l(2),d(" ",e.stats().refunds.count," reembolsos "),l(10),d(" ",e.formatCurrency(e.stats().paid.total)," "),l(2),d(" ",e.stats().paid.count," pagos "),l(10),d(" ",e.formatCurrency(e.stats().total.total)," "),l(2),d(" ",e.stats().total.count," ventas totales ")}}function te(a,r){if(a&1){let e=y();t(0,"div",14)(1,"button",57),_("click",function(){b(e);let s=m();return C(s.clearFilters())}),i(2," Limpiar filtros "),n()()}}function ne(a,r){if(a&1&&(t(0,"div",15),i(1),n()),a&2){let e=m();l(),d(" ",e.error()," ")}}function ie(a,r){if(a&1&&(t(0,"span",19),i(1),n()),a&2){let e=m();l(),d(" (",e.totalItems()," registros) ")}}function ae(a,r){a&1&&(t(0,"div",20),x(1,"div",58),n())}function re(a,r){a&1&&(t(0,"div",21),f(),t(1,"svg",59),x(2,"path",60),n(),v(),t(3,"p",61),i(4,"No se encontraron ganancias"),n(),t(5,"p",62),i(6," Tus ganancias aparecer\xE1n aqu\xED cuando realices ventas "),n()())}function oe(a,r){if(a&1&&x(0,"img",75),a&2){let e=m().$implicit;h("src",e.course.image,F)("alt",e.course.title)}}function le(a,r){a&1&&(t(0,"span",77),i(1," \u{1F534} Reembolsado "),n())}function se(a,r){if(a&1&&(t(0,"p",80),i(1),n()),a&2){let e=m().$implicit,o=m(2);l(),d(" Disponible: ",o.formatDate(e.available_at)," ")}}function de(a,r){if(a&1&&(t(0,"div")(1,"p",87),i(2),n(),t(3,"p",88),i(4," $0.00 "),t(5,"span",89),i(6,"(-100%)"),n()()()),a&2){let e=m().$implicit,o=m(2);l(2),d(" ",o.formatCurrency(e.instructor_earning_original||0)," ")}}function me(a,r){if(a&1&&(t(0,"p",84),i(1),n()),a&2){let e=m().$implicit,o=m(2);l(),d(" ",o.formatCurrency(e.instructor_earning)," ")}}function ce(a,r){if(a&1&&(t(0,"tr",72)(1,"td",73)(2,"div",74),p(3,oe,1,2,"img",75),t(4,"div")(5,"p",76),i(6),n(),p(7,le,2,0,"span",77),n()()(),t(8,"td",78)(9,"p",79),i(10),n(),p(11,se,2,1,"p",80),n(),t(12,"td",81)(13,"p",76),i(14),n()(),t(15,"td",81)(16,"p",82),i(17),n(),t(18,"p",80),i(19," (7% + $4) "),n()(),t(20,"td",81)(21,"p",83),i(22),n(),t(23,"p",80),i(24),n()(),t(25,"td",81),p(26,de,7,1,"div")(27,me,2,1,"p",84),n(),t(28,"td",85)(29,"span",86),i(30),n()()()),a&2){let e=r.$implicit,o=m(2);k("opacity-60",e.isRefunded),l(3),g(e.course&&e.course.image?3:-1),l(3),d(" ",e.course?e.course.title:"Curso sin t\xEDtulo"," "),l(),g(e.isRefunded?7:-1),l(3),d(" ",o.formatDate(e.earned_at)," "),l(),g(e.status==="pending"&&e.available_at?11:-1),l(3),d(" ",o.formatCurrency(e.sale_price)," "),l(3),d(" -",o.formatCurrency(e.payment_fee_amount||e.sale_price*.07+4)," "),l(5),d(" -",o.formatCurrency(e.platform_commission_amount)," "),l(2),d(" (",e.platform_commission_rate*100,"%) "),l(2),g(e.isRefunded?26:27),l(3),h("ngClass",o.getStatusBadgeClass(e.isRefunded?"refunded":e.status)),l(),d(" ",o.getStatusText(e.isRefunded?"refunded":e.status)," ")}}function ue(a,r){a&1&&(t(0,"span",93),i(1,"..."),n())}function pe(a,r){if(a&1){let e=y();t(0,"button",95),_("click",function(){b(e);let s=m().$implicit,c=m(3);return C(c.onPageChange(s))}),i(1),n()}if(a&2){let e=m().$implicit,o=m(3);k("bg-lime-500",e===o.currentPage())("text-slate-900",e===o.currentPage())("bg-slate-700",e!==o.currentPage())("text-slate-300",e!==o.currentPage()),l(),d(" ",e," ")}}function ge(a,r){if(a&1&&p(0,ue,2,0,"span",93)(1,pe,2,9,"button",94),a&2){let e=r.$implicit;g(e===-1?0:1)}}function xe(a,r){if(a&1){let e=y();t(0,"div",71)(1,"div",90),i(2),n(),t(3,"div",91)(4,"button",92),_("click",function(){b(e);let s=m(2);return C(s.onPageChange(s.currentPage()-1))}),i(5," \u2190 Anterior "),n(),S(6,ge,2,1,null,null,M),t(8,"button",92),_("click",function(){b(e);let s=m(2);return C(s.onPageChange(s.currentPage()+1))}),i(9," Siguiente \u2192 "),n()()()}if(a&2){let e=m(2);l(2),V(" P\xE1gina ",e.currentPage()," de ",e.totalPages()," "),l(2),h("disabled",e.currentPage()===1),l(2),E(e.getPageNumbers()),l(2),h("disabled",e.currentPage()===e.totalPages())}}function _e(a,r){if(a&1&&(t(0,"div",63)(1,"table",64)(2,"thead",65)(3,"tr")(4,"th",66),i(5," Curso "),n(),t(6,"th",66),i(7," Fecha "),n(),t(8,"th",67),i(9," Precio Venta "),n(),t(10,"th",67),i(11," Comisi\xF3n Pasarela "),n(),t(12,"th",67),i(13," Comisi\xF3n Plat. "),n(),t(14,"th",67),i(15," Tu Ganancia "),n(),t(16,"th",68),i(17," Estado "),n()()(),t(18,"tbody",69),S(19,ce,31,14,"tr",70,Q),n()()(),p(21,xe,10,4,"div",71)),a&2){let e=m();l(19),E(e.earnings()),l(2),g(e.totalPages()>1?21:-1)}}var J=class a{instructorPaymentService=T(X);earnings=this.instructorPaymentService.earnings;stats=this.instructorPaymentService.earningsStats;isLoading=this.instructorPaymentService.isLoadingEarnings;isLoadingStats=this.instructorPaymentService.isLoadingStats;error=this.instructorPaymentService.earningsError;pagination=this.instructorPaymentService.earningsPagination;currentPage=u(()=>this.pagination()?.page||1);totalPages=u(()=>this.pagination()?.pages||1);totalItems=u(()=>this.pagination()?.total||0);limit=20;hasEarnings=u(()=>this.earnings().length>0);pendingTotal=u(()=>this.stats()?.pending.total||0);availableTotal=u(()=>this.stats()?.available.total||0);paidTotal=u(()=>this.stats()?.paid.total||0);refundsTotal=u(()=>this.stats()?.refunds.total||0);refundsCount=u(()=>this.stats()?.refunds.count||0);totalEarned=u(()=>this.stats()?.total_earned||0);totalSales=u(()=>this.stats()?.total_sales||0);averagePerSale=u(()=>this.stats()?.average_per_sale||0);Math=Math;filterForm=new H({status:new P("all"),startDate:new P(""),endDate:new P("")});selectedStatus="all";startDate="";endDate="";ngOnInit(){this.loadStats(),this.loadEarnings()}loadStats(){this.instructorPaymentService.reloadStats()}loadEarnings(r=1){let e={page:r,limit:this.limit};this.selectedStatus&&this.selectedStatus!=="all"&&(e.status=this.selectedStatus),this.startDate&&(e.startDate=this.startDate),this.endDate&&(e.endDate=this.endDate),this.instructorPaymentService.setEarningsFilters(e)}onFilterChange(){this.loadEarnings(1)}clearFilters(){this.selectedStatus="all",this.startDate="",this.endDate="",this.loadEarnings(1)}onPageChange(r){r<1||r>this.totalPages()||this.loadEarnings(r)}getStatusBadgeClass(r){return{pending:"bg-yellow-500/10 text-yellow-300 border-yellow-500/30",available:"bg-green-500/10 text-green-300 border-green-500/30",paid:"bg-blue-500/10 text-blue-300 border-blue-500/30",disputed:"bg-red-500/10 text-red-300 border-red-500/30",refunded:"bg-red-500/20 text-red-300 border-red-500/40"}[r]||"bg-slate-500/10 text-slate-300 border-slate-500/30"}getStatusText(r){return{pending:"Pendiente",available:"Disponible",paid:"Pagado",disputed:"En Disputa",refunded:"Reembolsado"}[r]||r}formatDate(r){return new Date(r).toLocaleDateString("es-MX",{year:"numeric",month:"short",day:"numeric"})}currencyService=T(G);formatCurrency(r){return this.currencyService.format(r)}getPageNumbers(){let r=[],e=this.totalPages(),o=this.currentPage();if(e<=7)for(let s=1;s<=e;s++)r.push(s);else if(o<=4){for(let s=1;s<=5;s++)r.push(s);r.push(-1),r.push(e)}else if(o>=e-3){r.push(1),r.push(-1);for(let s=e-4;s<=e;s++)r.push(s)}else{r.push(1),r.push(-1);for(let s=o-1;s<=o+1;s++)r.push(s);r.push(-1),r.push(e)}return r}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=N({type:a,selectors:[["app-instructor-earnings"]],decls:42,vars:8,consts:[[1,"space-y-6"],[1,"text-3xl","font-bold","text-slate-100"],[1,"mt-2","text-sm","text-slate-400"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-5","gap-4"],[1,"bg-slate-800/50","rounded-lg","p-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],[1,"block","text-sm","font-medium","text-slate-300","mb-2"],[1,"w-full","px-4","py-2","bg-slate-700","border","border-slate-600","rounded-lg","text-slate-200","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"ngModelChange","change","ngModel"],["value","all"],["value","pending"],["value","available"],["value","paid"],["value","disputed"],["type","date",1,"w-full","px-4","py-2","bg-slate-700","border","border-slate-600","rounded-lg","text-slate-200","focus:outline-none","focus:ring-2","focus:ring-lime-400",3,"ngModelChange","change","ngModel"],[1,"mt-4"],[1,"bg-red-500/10","border","border-red-500/50","text-red-400","px-4","py-3","rounded-lg"],[1,"bg-slate-800/50","rounded-lg","overflow-hidden"],[1,"px-6","py-4","border-b","border-slate-700"],[1,"text-lg","font-semibold","text-slate-200"],[1,"text-sm","text-slate-400","font-normal","ml-2"],[1,"flex","justify-center","items-center","py-12"],[1,"text-center","py-12"],[1,"bg-slate-800/50","rounded-lg","p-6","animate-pulse"],[1,"h-4","bg-slate-700","rounded","w-24","mb-4"],[1,"h-8","bg-slate-700","rounded","w-32"],[1,"bg-gradient-to-br","from-green-500/10","to-green-600/5","border","border-green-500/20","rounded-lg","p-6"],[1,"flex","items-center","justify-between"],[1,"text-sm","font-medium","text-green-300"],[1,"text-2xl","font-bold","text-green-400","mt-2"],[1,"text-xs","text-slate-400","mt-1"],[1,"w-12","h-12","bg-green-500/20","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-green-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-gradient-to-br","from-yellow-500/10","to-yellow-600/5","border","border-yellow-500/20","rounded-lg","p-6"],[1,"text-sm","font-medium","text-yellow-300"],[1,"text-2xl","font-bold","text-yellow-400","mt-2"],[1,"w-12","h-12","bg-yellow-500/20","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-yellow-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-gradient-to-br","from-red-500/10","to-red-600/5","border","border-red-500/20","rounded-lg","p-6"],[1,"text-sm","font-medium","text-red-300"],[1,"text-2xl","font-bold","text-red-400","mt-2"],[1,"w-12","h-12","bg-red-500/20","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-red-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"],[1,"bg-gradient-to-br","from-blue-500/10","to-blue-600/5","border","border-blue-500/20","rounded-lg","p-6"],[1,"text-sm","font-medium","text-blue-300"],[1,"text-2xl","font-bold","text-blue-400","mt-2"],[1,"w-12","h-12","bg-blue-500/20","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-blue-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"bg-gradient-to-br","from-purple-500/10","to-purple-600/5","border","border-purple-500/20","rounded-lg","p-6"],[1,"text-sm","font-medium","text-purple-300"],[1,"text-2xl","font-bold","text-purple-400","mt-2"],[1,"w-12","h-12","bg-purple-500/20","rounded-full","flex","items-center","justify-center"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-6","h-6","text-purple-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"],[1,"px-4","py-2","text-sm","text-slate-400","hover:text-slate-200","transition-colors",3,"click"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"w-16","h-16","mx-auto","text-slate-600","mb-4"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"],[1,"text-slate-400"],[1,"text-sm","text-slate-500","mt-1"],[1,"overflow-x-auto"],[1,"w-full"],[1,"bg-slate-700/50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-slate-300","uppercase","tracking-wider"],[1,"px-6","py-3","text-right","text-xs","font-medium","text-slate-300","uppercase","tracking-wider"],[1,"px-6","py-3","text-center","text-xs","font-medium","text-slate-300","uppercase","tracking-wider"],[1,"divide-y","divide-slate-700"],[1,"hover:bg-slate-700/30","transition-colors",3,"opacity-60"],[1,"px-6","py-4","border-t","border-slate-700","flex","items-center","justify-between"],[1,"hover:bg-slate-700/30","transition-colors"],[1,"px-6","py-4"],[1,"flex","items-center"],[1,"w-12","h-12","rounded","object-cover","mr-3",3,"src","alt"],[1,"text-sm","font-medium","text-slate-200"],[1,"inline-flex","items-center","px-2","py-0.5","rounded","text-xs","font-medium","bg-red-500/20","text-red-300","border","border-red-500/30","mt-1"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","text-slate-300"],[1,"text-xs","text-slate-500"],[1,"px-6","py-4","text-right","whitespace-nowrap"],[1,"text-sm","text-amber-400"],[1,"text-sm","text-red-400"],[1,"text-sm","font-semibold","text-lime-400"],[1,"px-6","py-4","text-center","whitespace-nowrap"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-xs","font-medium","border",3,"ngClass"],[1,"text-sm","line-through","text-slate-500"],[1,"text-sm","font-semibold","text-red-400"],[1,"text-xs"],[1,"text-sm","text-slate-400"],[1,"flex","gap-1"],[1,"px-3","py-1","rounded","bg-slate-700","text-slate-300","hover:bg-slate-600","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"px-3","py-1","text-slate-500"],[1,"px-3","py-1","rounded","hover:bg-slate-600","transition-colors",3,"bg-lime-500","text-slate-900","bg-slate-700","text-slate-300"],[1,"px-3","py-1","rounded","hover:bg-slate-600","transition-colors",3,"click"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div")(2,"h1",1),i(3,"Mis Ganancias"),n(),t(4,"p",2),i(5," Revisa el detalle de tus ingresos por las ventas de tus cursos "),n()(),p(6,Z,3,1,"div",3)(7,ee,61,10,"div",3),t(8,"div",4)(9,"div",5)(10,"div")(11,"label",6),i(12,"Estado"),n(),t(13,"select",7),D("ngModelChange",function(c){return I(o.selectedStatus,c)||(o.selectedStatus=c),c}),_("change",function(){return o.onFilterChange()}),t(14,"option",8),i(15,"Todos"),n(),t(16,"option",9),i(17,"Pendiente"),n(),t(18,"option",10),i(19,"Disponible"),n(),t(20,"option",11),i(21,"Pagado"),n(),t(22,"option",12),i(23,"En Disputa"),n()()(),t(24,"div")(25,"label",6),i(26,"Fecha Inicio"),n(),t(27,"input",13),D("ngModelChange",function(c){return I(o.startDate,c)||(o.startDate=c),c}),_("change",function(){return o.onFilterChange()}),n()(),t(28,"div")(29,"label",6),i(30,"Fecha Fin"),n(),t(31,"input",13),D("ngModelChange",function(c){return I(o.endDate,c)||(o.endDate=c),c}),_("change",function(){return o.onFilterChange()}),n()()(),p(32,te,3,0,"div",14),n(),p(33,ne,2,1,"div",15),t(34,"div",16)(35,"div",17)(36,"h2",18),i(37," Detalle de Ganancias "),p(38,ie,2,1,"span",19),n()(),p(39,ae,2,0,"div",20)(40,re,7,0,"div",21)(41,_e,22,1),n()()),e&2&&(l(6),g(o.isLoadingStats()?6:o.stats()?7:-1),l(7),w("ngModel",o.selectedStatus),l(14),w("ngModel",o.startDate),l(4),w("ngModel",o.endDate),l(),g(o.selectedStatus!=="all"||o.startDate||o.endDate?32:-1),l(),g(o.error()?33:-1),l(5),g(o.totalItems()>0?38:-1),l(),g(o.isLoading()?39:o.hasEarnings()?41:40))},dependencies:[B,L,U,z,A,R,$,W,q,O],encapsulation:2})};export{J as a};
