import{a as I}from"./chunk-X2TTQVNN.js";import{b as M,c as l,d as A,e as N,f as D,h as _,j as F,k as V,o as P,p as G,y as T}from"./chunk-QA5A7GBQ.js";import{Gb as a,Ib as b,Ma as m,T as x,Xa as h,Y as C,Z as v,_ as S,hb as d,ib as u,ja as g,ka as y,nb as f,ob as s,pb as n,qb as c,ub as w,wb as E,yb as p}from"./chunk-6JS7X5LE.js";function j(i,e){i&1&&(s(0,"div",4),c(1,"div",6),n())}function L(i,e){if(i&1&&(s(0,"div",9),a(1),n()),i&2){let t=p(2);m(),b(" ",t.successMessage()," ")}}function O(i,e){if(i&1&&(s(0,"div",10),a(1),n()),i&2){let t=p(2);m(),b(" ",t.error()," ")}}function q(i,e){i&1&&(s(0,"span",20),S(),s(1,"svg",21),c(2,"circle",22)(3,"path",23),n(),a(4," Guardando... "),n())}function z(i,e){i&1&&a(0," Guardar Cambios ")}function B(i,e){if(i&1){let t=w();s(0,"div",5)(1,"div")(2,"form",7),E("ngSubmit",function(){C(t);let r=p();return v(r.onSubmit())}),s(3,"h2",8),a(4,"Ajustes Globales"),n(),d(5,L,2,1,"div",9),d(6,O,2,1,"div",10),s(7,"div",11)(8,"div")(9,"label",12),a(10,"Comisi\xF3n por Defecto (%)"),n(),c(11,"input",13),n(),s(12,"div")(13,"label",14),a(14,"D\xEDas para Disponibilidad"),n(),c(15,"input",15),n(),s(16,"div")(17,"label",16),a(18,"Umbral M\xEDnimo de Pago (MXN)"),n(),c(19,"input",17),n()(),s(20,"div",18)(21,"button",19),d(22,q,5,0,"span",20)(23,z,1,0),n()()()()()}if(i&2){let t=p();m(2),f("formGroup",t.settingsForm),m(3),u(t.successMessage()?5:-1),m(),u(t.error()?6:-1),m(15),f("disabled",t.settingsForm.invalid||t.isSaving()),m(),u(t.isSaving()?22:23)}}var k=class i{adminPaymentService=x(I);settings=g(null);isLoading=this.adminPaymentService.isLoadingCommission;isSaving=g(!1);error=g(null);successMessage=g(null);settingsForm=new D({default_commission_rate:new _(null,[l.required,l.min(0),l.max(100)]),days_until_available:new _(null,[l.required,l.min(0)]),minimum_payment_threshold:new _(null,[l.required,l.min(0)]),exchange_rate_usd_to_mxn:new _(null,[l.min(0)])});constructor(){y(()=>{let e=this.adminPaymentService.commissionSettings();e&&(this.settings.set(e),this.settingsForm.patchValue({default_commission_rate:e.default_commission_rate,days_until_available:e.days_until_available,minimum_payment_threshold:e.minimum_payment_threshold,exchange_rate_usd_to_mxn:e.exchange_rate_usd_to_mxn}))})}ngOnInit(){this.loadSettings()}loadSettings(){this.error.set(null),this.adminPaymentService.reloadCommissionSettings()}onSubmit(){if(this.settingsForm.invalid)return;this.isSaving.set(!0),this.successMessage.set(null),this.error.set(null);let e=this.settingsForm.value,t={};Object.keys(e).forEach(o=>{let r=o;e[r]!==null&&e[r]!==void 0&&(t[r]=e[r])}),this.adminPaymentService.updateCommissionSettings(t).subscribe({next:o=>{this.settings.set(o.settings),this.successMessage.set(o.message||"Settings updated successfully!"),this.isSaving.set(!1),this.adminPaymentService.reloadCommissionSettings(),setTimeout(()=>this.successMessage.set(null),3e3)},error:o=>{this.error.set(o.error?.message||"An error occurred while updating settings."),this.isSaving.set(!1)}})}openCustomCommissionModal(e){}removeCustomCommission(e){}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=h({type:i,selectors:[["app-admin-commission-settings"]],decls:8,vars:2,consts:[[1,"space-y-8"],[1,"mb-6"],[1,"text-3xl","font-bold","text-slate-100"],[1,"mt-2","text-sm","text-slate-400"],[1,"flex","justify-center","items-center","py-12"],[1,"max-w-4xl","mx-auto"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-lime-400"],[1,"bg-slate-800/50","rounded-lg","shadow-md","p-6","space-y-6",3,"ngSubmit","formGroup"],[1,"text-xl","font-semibold","text-slate-200","border-b","border-slate-700","pb-3"],[1,"bg-lime-500/10","border","border-lime-500/20","text-lime-200","px-4","py-3","rounded-lg","text-sm"],[1,"bg-red-500/10","border","border-red-500/20","text-red-300","px-4","py-3","rounded-lg","text-sm"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["for","default_commission_rate",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["id","default_commission_rate","type","number","formControlName","default_commission_rate",1,"w-full","px-4","py-2","border","border-slate-600","bg-slate-700","text-white","rounded-lg","focus:ring-2","focus:ring-lime-400"],["for","days_until_available",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["id","days_until_available","type","number","formControlName","days_until_available",1,"w-full","px-4","py-2","border","border-slate-600","bg-slate-700","text-white","rounded-lg","focus:ring-2","focus:ring-lime-400"],["for","minimum_payment_threshold",1,"block","text-sm","font-medium","text-slate-300","mb-2"],["id","minimum_payment_threshold","type","number","formControlName","minimum_payment_threshold",1,"w-full","px-4","py-2","border","border-slate-600","bg-slate-700","text-white","rounded-lg","focus:ring-2","focus:ring-lime-400"],[1,"flex","justify-end"],["type","submit",1,"px-6","py-2","bg-lime-500","text-slate-900","rounded-lg","hover:bg-lime-600","font-medium","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],[1,"flex","items-center"],["fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-3","h-5","w-5","text-slate-800"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Configuraci\xF3n de Comisiones"),n(),s(4,"p",3),a(5,"Ajusta las comisiones globales de la plataforma y gestiona las tasas personalizadas para instructores."),n()(),d(6,j,2,0,"div",4),d(7,B,24,5,"div",5),n()),t&2&&(m(6),u(o.isLoading()?6:-1),m(),u(!o.isLoading()&&o.settings()?7:-1))},dependencies:[T,F,M,V,A,N,G,P],encapsulation:2})};export{k as a};
