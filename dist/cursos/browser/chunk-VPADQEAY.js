import{a as N}from"./chunk-QNOC7O3Z.js";import"./chunk-K7U6JFP2.js";import"./chunk-6Z75774O.js";import"./chunk-R5HHEV5R.js";import"./chunk-UD4Q7ATB.js";import"./chunk-PZTC22XT.js";import"./chunk-HSX4PLM4.js";import{a as M,b as F}from"./chunk-VTEZJ5OF.js";import{e as L,f as _}from"./chunk-UKUKXRH6.js";import{a as y}from"./chunk-TCGJFX72.js";import{b as k,c as d,d as D,e as q,f as T,h as x,j as V,n as I,o as G,u as R,x as B}from"./chunk-SDJWNAN2.js";import"./chunk-XM5I3GUE.js";import{$ as b,Ac as E,Gb as r,Ib as S,Ma as s,T as l,Xa as h,_ as v,hb as p,ib as g,ja as c,nb as f,ob as t,pb as i,qb as m,wb as w,yb as C}from"./chunk-6JS7X5LE.js";import"./chunk-I4MTPUBM.js";function H(o,a){if(o&1&&(t(0,"div",11),r(1),i()),o&2){let n=C();s(),S(" ",n.errorMessage()," ")}}function P(o,a){o&1&&(v(),t(0,"svg",18),m(1,"circle",19)(2,"path",20),i(),b(),t(3,"span"),r(4,"Cargando..."),i())}function j(o,a){o&1&&(t(0,"span"),r(1,"Ingresar"),i())}var A=class o{authService=l(F);router=l(L);logger=l(M);toast=l(y);errorMessage=c(null);isLoading=c(!1);loginForm=new T({email:new x("",[d.required,d.email]),password:new x("",[d.required])});onSubmit(){if(this.loginForm.invalid){this.toast.validationError("Por favor completa todos los campos correctamente");return}let{email:a,password:n}=this.loginForm.value;this.isLoading.set(!0),this.authService.login(a,n).subscribe({next:()=>{this.isLoading.set(!1)},error:e=>{if(this.isLoading.set(!1),e.status===403&&e.error.requiresVerification)this.toast.info("Verificaci\xF3n requerida",e.error.message_text||"Debes verificar tu cuenta antes de iniciar sesi\xF3n"),this.errorMessage.set(e.error.message_text||"Debes verificar tu cuenta"),setTimeout(()=>{this.router.navigate(["/verify-otp"],{queryParams:{userId:e.error.userId}})},2e3);else if(e.status===404)this.errorMessage.set(e.error.message_text||"No existe una cuenta con este correo");else if(e.status===401)this.errorMessage.set(e.error.message_text||"La contrase\xF1a es incorrecta");else if(e.status===0)this.toast.networkError(),this.errorMessage.set("No se pudo conectar con el servidor");else if(e.status>=500)this.toast.serverError(),this.errorMessage.set("Error del servidor. Intenta nuevamente m\xE1s tarde");else{let u=e.error?.message_text||e.error?.message||"Ocurri\xF3 un error al iniciar sesi\xF3n";this.toast.error("Error al iniciar sesi\xF3n",u),this.errorMessage.set(u)}}})}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=h({type:o,selectors:[["app-login"]],decls:32,vars:4,consts:[[1,"min-h-screen","bg-slate-950","py-8","sm:py-12","px-4"],[1,"w-full","max-w-md","mx-auto"],[1,"bg-slate-800/50","backdrop-blur-lg","border","border-white/10","rounded-2xl","p-6","md:p-8","shadow-2xl"],[1,"text-center","mb-6"],[1,"text-3xl","font-extrabold","text-white"],[1,"text-slate-400","mt-2"],[1,"space-y-4",3,"ngSubmit","formGroup"],["for","email",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["type","email","id","email","formControlName","email","placeholder","tu@correo.com","required","",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","block","p-2.5"],["for","password",1,"block","mb-2","text-sm","font-medium","text-slate-300"],["type","password","id","password","formControlName","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022","required","",1,"w-full","bg-slate-900/70","border","border-slate-700","text-white","text-sm","rounded-lg","focus:ring-lime-500","focus:border-lime-500","block","p-2.5"],[1,"bg-red-500/10","border","border-red-400/30","text-red-300","text-sm","rounded-lg","p-3","text-center"],["type","submit",1,"w-full","h-11","rounded-xl","bg-lime-400","text-slate-900","font-bold","hover:bg-lime-300","transition","disabled:bg-slate-600","disabled:cursor-not-allowed","flex","items-center","justify-center","gap-2",3,"disabled"],[1,"text-sm","text-center","text-slate-400"],["routerLink","/register",1,"font-medium","text-lime-400","hover:underline"],["routerLink","/forgot-password",1,"font-medium","text-blue-400","hover:underline"],[1,"text-center","mt-6"],["routerLink","/",1,"text-sm","text-slate-400","hover:text-lime-300","transition-colors","duration-300"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(n,e){n&1&&(m(0,"app-header"),t(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h1",4),r(6,"Iniciar Sesi\xF3n"),i(),t(7,"p",5),r(8,"Bienvenido de vuelta a Dev-Sharks"),i()(),t(9,"form",6),w("ngSubmit",function(){return e.onSubmit()}),t(10,"div")(11,"label",7),r(12,"Correo Electr\xF3nico"),i(),m(13,"input",8),i(),t(14,"div")(15,"label",9),r(16,"Contrase\xF1a"),i(),m(17,"input",10),i(),p(18,H,2,1,"div",11),t(19,"button",12),p(20,P,5,0)(21,j,2,0,"span"),i(),t(22,"div",13),r(23," \xBFNo tienes una cuenta? "),t(24,"a",14),r(25,"Reg\xEDstrate aqu\xED"),i()(),t(26,"div",13)(27,"a",15),r(28,"\xBFOlvidaste tu contrase\xF1a?"),i()()(),t(29,"div",16)(30,"a",17),r(31," \u2190 Regresar a la p\xE1gina de inicio "),i()()()()()),n&2&&(s(9),f("formGroup",e.loginForm),s(9),g(e.errorMessage()?18:-1),s(),f("disabled",e.loginForm.invalid||e.isLoading()),s(),g(e.isLoading()?20:21))},dependencies:[E,_,B,V,k,D,q,R,G,I,N],encapsulation:2})};export{A as LoginComponent};
