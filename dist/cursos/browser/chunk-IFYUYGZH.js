import{a as C}from"./chunk-6Z75774O.js";import{a as v}from"./chunk-R5HHEV5R.js";import{a as $}from"./chunk-ESTJS734.js";import{Hc as S,Jc as m,O as p,T as h,ec as i,ja as l,k as c,ka as b,z as g}from"./chunk-6JS7X5LE.js";import{a as r,b as a}from"./chunk-I4MTPUBM.js";var j=class o{http=h(m);url=`${$.url}projects`;list(e,s){let t=new S().set("search",e);return s&&(t=t.set("categorie",s)),this.http.get(`${this.url}/list`,{params:t})}getProjectsAdmin(e){let s=e;return e==="Borrador"&&(s=1),e==="Publico"&&(s=2),this.http.get(`${this.url}/list?state=${s}`)}getProjectsByInstructor(e){return this.http.get(`${this.url}/list`)}getById(e){return this.http.get(`${this.url}/show/${e}`)}getByIdAdmin(e){return this.http.get(`${this.url}/get-admin/${e}`)}register(e){return this.http.post(`${this.url}/register`,e)}update(e){return this.http.post(`${this.url}/update`,e)}delete(e){return this.http.delete(`${this.url}/remove/${e}`)}checkSales(e){return this.http.get(`${this.url}/check-sales/${e}`)}uploadFiles(e,s){return this.http.post(`${this.url}/upload-files/${e}`,s,{reportProgress:!0,observe:"events"})}deleteFile(e,s){return this.http.delete(`${this.url}/remove-file/${e}/${s}`)}getFileDownloadUrl(e,s){return`${this.url}/download-file/${e}/${s}`}downloadFile(e,s){return this.http.get(`${this.url}/download-file/${e}/${s}`,{responseType:"blob"})}listResource=(e,s)=>{let t=l({projects:null,isLoading:!1,error:null}),n=()=>{let u=e(),L=s();t.update(d=>a(r({},d),{isLoading:!0}));let f=new S().set("search",u);L&&(f=f.set("categorie",L)),this.http.get(`${this.url}/list`,{params:f}).subscribe({next:d=>t.set({projects:d.projects,isLoading:!1,error:null}),error:d=>t.set({projects:null,isLoading:!1,error:d})})};return b(()=>{n()}),{projects:i(()=>t().projects),isLoading:i(()=>t().isLoading),reload:n}};static \u0275fac=function(s){return new(s||o)};static \u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"})};function R(o){let e=Object.keys(o).filter(s=>o[s]!==void 0&&o[s]!==null).map(s=>{let t=o[s];return Array.isArray(t)?t.map(n=>`${encodeURIComponent(s)}=${encodeURIComponent(n)}`).join("&"):`${encodeURIComponent(s)}=${encodeURIComponent(t)}`}).filter(Boolean).join("&");return e?`?${e}`:""}var y=class o{http=h(m);base=C.url;filtro=l({});setFiltro(e){this.filtro.set(r(r({},this.filtro()),e)),this.reloadList()}listState=l({courses:[],isLoading:!1,error:null});courses=i(()=>this.listState().courses);isLoadingList=i(()=>this.listState().isLoading);reloadList(){let e=this.filtro(),s=`${this.base}courses/list${R(e)}`;this.listState.update(t=>a(r({},t),{isLoading:!0})),this.http.get(s).subscribe({next:t=>{this.listState.set({courses:t.courses||[],isLoading:!1,error:null})},error:t=>this.listState.set({courses:[],isLoading:!1,error:t})})}getCoursesAdmin(e){let s=e;return e==="Borrador"&&(s=1),e==="Publico"&&(s=2),this.http.get(`${this.base}courses/list?state=${s}`)}listCoursesInstructor(){return this.http.get(`${this.base}courses/list`)}showResource=e=>{let s=l({course:null,isLoading:!1,error:null}),t=()=>{let n=e();n&&(s.update(u=>a(r({},u),{isLoading:!0})),this.http.get(`${this.base}courses/show/${n}`).subscribe({next:u=>s.set({course:u.course,isLoading:!1,error:null}),error:u=>s.set({course:null,isLoading:!1,error:u})}))};return b(()=>{t()}),{course:i(()=>s().course),isLoading:i(()=>s().isLoading),reload:t}};configState=l({data:{categories:[],users:[]},isLoading:!1,error:null});config=i(()=>this.configState().data);isLoadingConfig=i(()=>this.configState().isLoading);reloadConfig(){this.configState.update(e=>a(r({},e),{isLoading:!0})),this.http.get(`${this.base}courses/config_all`).subscribe({next:e=>{e.categories.length>0,e.users.length>0,this.configState.set({data:e,isLoading:!1,error:null})},error:e=>{this.configState.set({data:{categories:[],users:[]},isLoading:!1,error:e})}})}register(e){return this.http.post(`${this.base}courses/register`,e).pipe(g(s=>c(()=>s)))}update(e){return this.http.post(`${this.base}courses/update`,e).pipe(g(s=>c(()=>s)))}remove(e){return this.http.delete(`${this.base}courses/remove/${e}`).pipe(g(s=>c(()=>s)))}checkSales(e){return this.http.get(`${this.base}courses/check-sales/${e}`).pipe(g(s=>c(()=>s)))}_currentCourseIdForSections=l(void 0);sectionsState=l({sections:[],isLoading:!1,error:null});sections=i(()=>this.sectionsState().sections);isLoadingSections=i(()=>this.sectionsState().isLoading);reloadSections(e){this._currentCourseIdForSections.set(e),this._currentCourseIdForSections()&&(this.sectionsState.update(s=>a(r({},s),{isLoading:!0})),this.http.get(`${this.base}course-sections/list?course_id=${e}`).subscribe({next:s=>this.sectionsState.set({sections:s.sections,isLoading:!1,error:null}),error:s=>this.sectionsState.set({sections:[],isLoading:!1,error:s})}))}createSection(e){return this.http.post(`${this.base}course-sections/register`,e)}updateSection(e,s){let t=r({_id:e},s);return this.http.put(`${this.base}course-sections/update`,t)}removeSection(e){return this.http.delete(`${this.base}course-sections/remove/${e}`).pipe(g(s=>c(()=>new Error(s.error.message||"Error al eliminar la secci\xF3n"))))}reorderSections(e){return this.http.put(`${this.base}course-sections/reorder`,{ids:e})}updateLocalSectionOrder(e,s){let t=[...this.sectionsState().sections];v(t,e,s),this.sectionsState.update(n=>a(r({},n),{sections:t}))}createClass(e){return this.http.post(`${this.base}course_clase/register`,e)}updateClass(e,s){return this.http.put(`${this.base}course_clase/update`,r({_id:e},s))}removeClass(e){return this.http.delete(`${this.base}course_clase/remove/${e}`)}reorderClasses(e){return this.http.put(`${this.base}course_clase/reorder`,{ids:e})}getVimeoData(e){return this.http.get(`${this.base}course_clase/vimeo-data?url=${encodeURIComponent(e)}`)}getYoutubeData(e){return this.http.get(`${this.base}course_clase/youtube-data?url=${encodeURIComponent(e)}`)}updateLocalClassOrder(e,s){let t=[...this.classesState().classes];v(t,e,s),this.classesState.update(n=>a(r({},n),{classes:t}))}classesState=l({classes:[],isLoading:!1,error:null});classes=i(()=>this.classesState().classes);isLoadingClasses=i(()=>this.classesState().isLoading);reloadClasses(e){e&&(this.classesState.update(s=>a(r({},s),{isLoading:!0})),this.http.get(`${this.base}course_clase/list?section_id=${e}`).subscribe({next:s=>{this.classesState.set({classes:s,isLoading:!1,error:null})},error:s=>this.classesState.set({classes:[],isLoading:!1,error:s})}))}static \u0275fac=function(s){return new(s||o)};static \u0275prov=p({token:o,factory:o.\u0275fac,providedIn:"root"})};export{R as a,y as b,j as c};
