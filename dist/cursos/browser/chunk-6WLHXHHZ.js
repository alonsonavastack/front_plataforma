import{a as w,b as A,d as F,e as D,j as T,m as L,n as R,o as G,p as V,q as j,r as U,v as $,x as O}from"./chunk-SDJWNAN2.js";import{a as I}from"./chunk-J56UX4WA.js";import{Ac as M,E as y,Gb as a,Ib as x,Jc as N,Ma as o,O as S,T as m,Xa as P,Y as h,Z as k,ab as c,ec as d,fc as v,ja as l,nb as s,o as f,ob as r,pb as e,qb as g,ub as C,vc as E,wb as _,yb as u}from"./chunk-6JS7X5LE.js";var p=class i{http=m(N);apiUrl=`${I.url}payment-settings`;reloadTrigger=l(0);adminSettingsResource=v({loader:()=>(this.reloadTrigger(),f(this.http.get(`${this.apiUrl}/admin`)))});adminSettings=d(()=>this.adminSettingsResource.value()?.settings??null);isLoadingAdminSettings=d(()=>this.adminSettingsResource.isLoading());adminSettingsError=d(()=>this.adminSettingsResource.error());publicReloadTrigger=l(0);publicSettingsResource=v({loader:()=>(this.publicReloadTrigger(),f(this.http.get(`${this.apiUrl}/public`)))});publicSettings=d(()=>this.publicSettingsResource.value()?.settings??null);isLoadingPublicSettings=d(()=>this.publicSettingsResource.isLoading());publicSettingsError=d(()=>this.publicSettingsResource.error());reloadAdminSettings(){this.reloadTrigger.update(t=>t+1)}reloadPublicSettings(){this.publicReloadTrigger.update(t=>t+1)}updateSettings(t){return this.http.put(`${this.apiUrl}/admin`,t)}getSettings(){return this.http.get(`${this.apiUrl}/admin`)}getPublicSettings(){return this.http.get(`${this.apiUrl}/public`)}static \u0275fac=function(n){return new(n||i)};static \u0275prov=S({token:i,factory:i.\u0275fac,providedIn:"root"})};function B(i,t){i&1&&(r(0,"div",6),g(1,"div",7),e())}function J(i,t){if(i&1&&(r(0,"div",28)(1,"span",29),a(2,"\xA1\xC9xito!"),e(),a(3),e()),i&2){let n=u(2);o(3),x(" ",n.successMessage()," ")}}function K(i,t){if(i&1&&(r(0,"div",30)(1,"span",29),a(2,"Error!"),e(),a(3),e()),i&2){let n=u(2);o(3),x(" ",n.errorMessage()," ")}}function Q(i,t){i&1&&(r(0,"span"),a(1,"Guardando..."),e())}function W(i,t){i&1&&(r(0,"span"),a(1,"Guardar Configuraci\xF3n"),e())}function X(i,t){if(i&1){let n=C();r(0,"form",8),_("ngSubmit",function(){h(n);let q=u();return k(q.saveSettings())}),r(1,"div",9)(2,"div",10)(3,"div")(4,"h3",11),a(5,"Activar PayPal"),e(),r(6,"p",12),a(7,"Habilita o deshabilita PayPal en el checkout"),e()(),r(8,"label",13),g(9,"input",14)(10,"div",15),e()(),r(11,"div",10)(12,"div")(13,"h3",11),a(14,"Pagos a Instructores"),e(),r(15,"p",12),a(16,"Permitir que los instructores registren cuentas de PayPal"),e()(),r(17,"label",13),g(18,"input",16)(19,"div",15),e()(),r(20,"div",17)(21,"div")(22,"label",18),a(23,"Client ID"),e(),g(24,"input",19),e(),r(25,"div")(26,"label",18),a(27,"Client Secret"),e(),g(28,"input",20),e(),r(29,"div")(30,"label",18),a(31,"Modo"),e(),r(32,"select",21)(33,"option",22),a(34,"Sandbox (Pruebas)"),e(),r(35,"option",23),a(36,"Live (Producci\xF3n)"),e()()()()(),c(37,J,4,1,"div",24)(38,K,4,1,"div",25),r(39,"button",26),c(40,Q,2,0,"span",27)(41,W,2,0,"span",27),e()()}if(i&2){let n=u();s("formGroup",n.settingsForm),o(37),s("ngIf",n.successMessage()),o(),s("ngIf",n.errorMessage()),o(),s("disabled",n.isSaving()),o(),s("ngIf",n.isSaving()),o(),s("ngIf",!n.isSaving())}}var H=class i{paymentSettingsService=m(p);fb=m($);settingsForm;isLoading=l(!1);isSaving=l(!1);successMessage=l("");errorMessage=l("");constructor(){this.settingsForm=this.fb.group({paypal:this.fb.group({clientId:[""],clientSecret:[""],mode:["sandbox"],active:[!1],instructorPayoutsActive:[!1]})})}ngOnInit(){this.loadSettings()}loadSettings(){this.isLoading.set(!0),this.paymentSettingsService.getSettings().pipe(y(()=>this.isLoading.set(!1))).subscribe({next:t=>{t.settings&&this.settingsForm.patchValue(t.settings)},error:t=>{console.error("Error loading settings",t),this.errorMessage.set("Error al cargar la configuraci\xF3n")}})}saveSettings(){this.settingsForm.invalid||(this.isSaving.set(!0),this.successMessage.set(""),this.errorMessage.set(""),this.paymentSettingsService.updateSettings(this.settingsForm.value).pipe(y(()=>this.isSaving.set(!1))).subscribe({next:t=>{this.successMessage.set("Configuraci\xF3n guardada correctamente"),setTimeout(()=>this.successMessage.set(""),3e3)},error:t=>{console.error("Error saving settings",t),this.errorMessage.set("Error al guardar la configuraci\xF3n")}}))}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=P({type:i,selectors:[["app-admin-payment-settings"]],decls:8,vars:2,consts:[[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-800","dark:text-white"],[1,"text-gray-600","dark:text-gray-400"],["class","flex justify-center py-10",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"flex","justify-center","py-10"],[1,"animate-spin","rounded-full","h-10","w-10","border-b-2","border-blue-600"],[3,"ngSubmit","formGroup"],["formGroupName","paypal",1,"space-y-6"],[1,"flex","items-center","justify-between","p-4","bg-gray-50","dark:bg-gray-800","rounded-lg"],[1,"text-lg","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"relative","inline-flex","items-center","cursor-pointer"],["type","checkbox","formControlName","active",1,"sr-only","peer"],[1,"w-11","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-blue-300","dark:peer-focus:ring-blue-800","rounded-full","peer","dark:bg-gray-700","peer-checked:after:translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:left-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","dark:border-gray-600","peer-checked:bg-blue-600"],["type","checkbox","formControlName","instructorPayoutsActive",1,"sr-only","peer"],[1,"grid","gap-6","mb-6","md:grid-cols-2"],[1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["type","text","formControlName","clientId",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["type","password","formControlName","clientSecret",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["formControlName","mode",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["value","sandbox"],["value","live"],["class","p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400","role","alert",4,"ngIf"],["class","p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400","role","alert",4,"ngIf"],["type","submit",1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800","disabled:opacity-50",3,"disabled"],[4,"ngIf"],["role","alert",1,"p-4","mb-4","text-sm","text-green-800","rounded-lg","bg-green-50","dark:bg-gray-800","dark:text-green-400"],[1,"font-medium"],["role","alert",1,"p-4","mb-4","text-sm","text-red-800","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400"]],template:function(n,b){n&1&&(r(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"Configuraci\xF3n de Pasarelas de Pago"),e(),r(4,"p",3),a(5,"Gestiona las credenciales y estado de PayPal y Mercado Pago"),e()(),c(6,B,2,0,"div",4)(7,X,42,6,"form",5),e()),n&2&&(o(6),s("ngIf",b.isLoading()),o(),s("ngIf",!b.isLoading()))},dependencies:[M,E,O,T,j,U,A,w,V,F,D,G,R,L],encapsulation:2})};export{H as a};
