import{a as A,b as D,d as F,e as T,j as G,m as L,n as R,o as V,p as j,q as U,r as $,v as O,x as H}from"./chunk-SDJWNAN2.js";import{a as w}from"./chunk-M2BUHLXO.js";import{Ac as M,E as v,Gb as a,Ib as x,Jc as N,Ma as o,O as h,T as c,Xa as P,Y as k,Z as _,ab as u,ec as m,fc as S,ja as d,nb as s,o as y,ob as r,pb as e,qb as g,ub as E,vc as I,wb as C,yb as b}from"./chunk-6JS7X5LE.js";var f=class i{http=c(N);apiUrl=`${w.url}payment-settings`;reloadTrigger=d(0);adminSettingsResource=S({loader:()=>(this.reloadTrigger(),y(this.http.get(`${this.apiUrl}/admin`)))});adminSettings=m(()=>this.adminSettingsResource.value()?.settings??null);isLoadingAdminSettings=m(()=>this.adminSettingsResource.isLoading());adminSettingsError=m(()=>this.adminSettingsResource.error());publicReloadTrigger=d(0);publicSettingsResource=S({loader:()=>(this.publicReloadTrigger(),y(this.http.get(`${this.apiUrl}/public`)))});publicSettings=m(()=>this.publicSettingsResource.value()?.settings??null);isLoadingPublicSettings=m(()=>this.publicSettingsResource.isLoading());publicSettingsError=m(()=>this.publicSettingsResource.error());reloadAdminSettings(){this.reloadTrigger.update(n=>n+1)}reloadPublicSettings(){this.publicReloadTrigger.update(n=>n+1)}updateSettings(n){return this.http.put(`${this.apiUrl}/admin`,n)}getSettings(){return this.http.get(`${this.apiUrl}/admin`)}getPublicSettings(){return this.http.get(`${this.apiUrl}/public`)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})};function B(i,n){i&1&&(r(0,"div",7),g(1,"div",8),e())}function J(i,n){i&1&&(r(0,"div",29)(1,"h4",30)(2,"span"),a(3,"\u{1F9EA}"),e(),a(4," Credenciales de Sandbox (Pruebas) "),e(),r(5,"div",31)(6,"div")(7,"label",19),a(8,"Sandbox Client ID"),e(),g(9,"input",32),e(),r(10,"div")(11,"label",19),a(12,"Sandbox Client Secret"),e(),g(13,"input",33),e()()())}function K(i,n){i&1&&(r(0,"div",34)(1,"h4",35)(2,"span"),a(3,"\u{1F680}"),e(),a(4," Credenciales Live (Producci\xF3n) "),e(),r(5,"div",31)(6,"div")(7,"label",19),a(8,"Live Client ID"),e(),g(9,"input",32),e(),r(10,"div")(11,"label",19),a(12,"Live Client Secret"),e(),g(13,"input",33),e()()())}function Q(i,n){if(i&1&&(r(0,"div",36)(1,"span",37),a(2,"\xA1\xC9xito!"),e(),a(3),e()),i&2){let t=b(2);o(3),x(" ",t.successMessage()," ")}}function W(i,n){if(i&1&&(r(0,"div",38)(1,"span",37),a(2,"Error!"),e(),a(3),e()),i&2){let t=b(2);o(3),x(" ",t.errorMessage()," ")}}function X(i,n){i&1&&(r(0,"span"),a(1,"Guardando..."),e())}function Y(i,n){i&1&&(r(0,"span"),a(1,"Guardar Configuraci\xF3n"),e())}function Z(i,n){if(i&1){let t=E();r(0,"form",9),C("ngSubmit",function(){k(t);let l=b();return _(l.saveSettings())}),r(1,"div",10)(2,"div",11)(3,"div")(4,"h3",12),a(5,"Activar PayPal"),e(),r(6,"p",13),a(7,"Habilita o deshabilita PayPal en el checkout"),e()(),r(8,"label",14),g(9,"input",15)(10,"div",16),e()(),r(11,"div",11)(12,"div")(13,"h3",12),a(14,"Pagos a Instructores"),e(),r(15,"p",13),a(16,"Permitir que los instructores registren cuentas de PayPal"),e()(),r(17,"label",14),g(18,"input",17)(19,"div",16),e()(),r(20,"div",18)(21,"div")(22,"label",19),a(23,"Modo"),e(),r(24,"select",20,0)(26,"option",21),a(27,"Sandbox (Pruebas)"),e(),r(28,"option",22),a(29,"Live (Producci\xF3n)"),e()()()(),u(30,J,14,0,"div",23)(31,K,14,0,"div",24),e(),u(32,Q,4,1,"div",25)(33,W,4,1,"div",26),r(34,"button",27),u(35,X,2,0,"span",28)(36,Y,2,0,"span",28),e()()}if(i&2){let t,p,l=b();s("formGroup",l.settingsForm),o(30),s("ngIf",((t=l.settingsForm.get("paypal.mode"))==null?null:t.value)==="sandbox"),o(),s("ngIf",((p=l.settingsForm.get("paypal.mode"))==null?null:p.value)==="live"),o(),s("ngIf",l.successMessage()),o(),s("ngIf",l.errorMessage()),o(),s("disabled",l.isSaving()),o(),s("ngIf",l.isSaving()),o(),s("ngIf",!l.isSaving())}}var q=class i{paymentSettingsService=c(f);fb=c(O);settingsForm;isLoading=d(!1);isSaving=d(!1);successMessage=d("");errorMessage=d("");constructor(){this.settingsForm=this.fb.group({paypal:this.fb.group({mode:["sandbox"],active:[!1],instructorPayoutsActive:[!1],sandbox:this.fb.group({clientId:[""],clientSecret:[""]}),live:this.fb.group({clientId:[""],clientSecret:[""]})})})}ngOnInit(){this.loadSettings()}loadSettings(){this.isLoading.set(!0),this.paymentSettingsService.getSettings().pipe(v(()=>this.isLoading.set(!1))).subscribe({next:n=>{if(n.settings){let t=n.settings;this.settingsForm.patchValue({paypal:{mode:t.paypal.mode||"sandbox",active:t.paypal.active||!1,instructorPayoutsActive:t.paypal.instructorPayoutsActive||!1}}),t.paypal.sandbox?this.settingsForm.get("paypal.sandbox")?.patchValue(t.paypal.sandbox):t.paypal.clientId&&t.paypal.mode==="sandbox"&&this.settingsForm.get("paypal.sandbox")?.patchValue({clientId:t.paypal.clientId,clientSecret:t.paypal.clientSecret}),t.paypal.live&&this.settingsForm.get("paypal.live")?.patchValue(t.paypal.live)}},error:n=>{console.error("Error loading settings",n),this.errorMessage.set("Error al cargar la configuraci\xF3n")}})}saveSettings(){this.settingsForm.invalid||(this.isSaving.set(!0),this.successMessage.set(""),this.errorMessage.set(""),this.paymentSettingsService.updateSettings(this.settingsForm.value).pipe(v(()=>this.isSaving.set(!1))).subscribe({next:n=>{this.successMessage.set("Configuraci\xF3n guardada correctamente"),setTimeout(()=>this.successMessage.set(""),3e3)},error:n=>{console.error("Error saving settings",n),this.errorMessage.set("Error al guardar la configuraci\xF3n")}}))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=P({type:i,selectors:[["app-admin-payment-settings"]],decls:8,vars:2,consts:[["modeSelect",""],[1,"p-6"],[1,"mb-6"],[1,"text-2xl","font-bold","text-gray-800","dark:text-white"],[1,"text-gray-600","dark:text-gray-400"],["class","flex justify-center py-10",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"flex","justify-center","py-10"],[1,"animate-spin","rounded-full","h-10","w-10","border-b-2","border-blue-600"],[3,"ngSubmit","formGroup"],["formGroupName","paypal",1,"space-y-6"],[1,"flex","items-center","justify-between","p-4","bg-gray-50","dark:bg-gray-800","rounded-lg"],[1,"text-lg","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"relative","inline-flex","items-center","cursor-pointer"],["type","checkbox","formControlName","active",1,"sr-only","peer"],[1,"w-11","h-6","bg-gray-200","peer-focus:outline-none","peer-focus:ring-4","peer-focus:ring-blue-300","dark:peer-focus:ring-blue-800","rounded-full","peer","dark:bg-gray-700","peer-checked:after:translate-x-full","peer-checked:after:border-white","after:content-['']","after:absolute","after:top-[2px]","after:left-[2px]","after:bg-white","after:border-gray-300","after:border","after:rounded-full","after:h-5","after:w-5","after:transition-all","dark:border-gray-600","peer-checked:bg-blue-600"],["type","checkbox","formControlName","instructorPayoutsActive",1,"sr-only","peer"],[1,"grid","gap-6","mb-6","md:grid-cols-2"],[1,"block","mb-2","text-sm","font-medium","text-gray-900","dark:text-white"],["formControlName","mode",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["value","sandbox"],["value","live"],["formGroupName","sandbox","class","p-4 border border-yellow-500/30 bg-yellow-500/5 rounded-lg mb-6",4,"ngIf"],["formGroupName","live","class","p-4 border border-red-500/30 bg-red-500/5 rounded-lg mb-6",4,"ngIf"],["class","p-4 mb-4 text-sm text-green-800 rounded-lg bg-green-50 dark:bg-gray-800 dark:text-green-400","role","alert",4,"ngIf"],["class","p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-gray-800 dark:text-red-400","role","alert",4,"ngIf"],["type","submit",1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800","disabled:opacity-50",3,"disabled"],[4,"ngIf"],["formGroupName","sandbox",1,"p-4","border","border-yellow-500/30","bg-yellow-500/5","rounded-lg","mb-6"],[1,"text-yellow-600","dark:text-yellow-400","font-bold","mb-4","flex","items-center","gap-2"],[1,"grid","gap-6","md:grid-cols-2"],["type","text","formControlName","clientId",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["type","password","formControlName","clientSecret",1,"bg-gray-50","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5","dark:bg-gray-700","dark:border-gray-600","dark:placeholder-gray-400","dark:text-white","dark:focus:ring-blue-500","dark:focus:border-blue-500"],["formGroupName","live",1,"p-4","border","border-red-500/30","bg-red-500/5","rounded-lg","mb-6"],[1,"text-red-600","dark:text-red-400","font-bold","mb-4","flex","items-center","gap-2"],["role","alert",1,"p-4","mb-4","text-sm","text-green-800","rounded-lg","bg-green-50","dark:bg-gray-800","dark:text-green-400"],[1,"font-medium"],["role","alert",1,"p-4","mb-4","text-sm","text-red-800","rounded-lg","bg-red-50","dark:bg-gray-800","dark:text-red-400"]],template:function(t,p){t&1&&(r(0,"div",1)(1,"div",2)(2,"h1",3),a(3,"Configuraci\xF3n de Pasarelas de Pago"),e(),r(4,"p",4),a(5,"Gestiona las credenciales y estado de PayPal y Mercado Pago"),e()(),u(6,B,2,0,"div",5)(7,Z,37,8,"form",6),e()),t&2&&(o(6),s("ngIf",p.isLoading()),o(),s("ngIf",!p.isLoading()))},dependencies:[M,I,H,G,U,$,D,A,j,F,T,V,R,L],encapsulation:2})};export{q as a};
