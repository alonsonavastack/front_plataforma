<header class="sticky top-0 z-20 w-full backdrop-blur supports-[backdrop-filter]:bg-slate-950/80 bg-slate-950/70 border-b border-white/10"
        (animate.enter)="animate.animateFadeInDashboard($event)">

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
    <!-- Branding + botón que abre el drawer lateral -->
    <div class="flex items-center">
      <!-- Botón que muestra el drawer de Flowbite (móvil) -->
      <button type="button"
              class="p-2.5 rounded-xl border border-white/10 hover:border-lime-400/50 hover:text-lime-300 transition lg:hidden"
              data-drawer-target="dashboard-drawer"
              data-drawer-show="dashboard-drawer"
              aria-controls="dashboard-drawer" aria-expanded="false">
        <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-width="2" d="M4 6h16M4 12h12M4 18h8"/>
        </svg>
        <span class="sr-only">Abrir menú lateral</span>
      </button>

      <!-- Botón para colapsar/expandir sidebar (solo desktop) -->
      <button (click)="toggleSidebar.emit()"
              class="hidden lg:flex items-center justify-center p-2.5 rounded-xl border border-transparent hover:border-lime-400/50 hover:text-lime-300 transition">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
        <span class="sr-only">Alternar menú lateral</span>
      </button>

      <!-- Logo (oculto en desktop cuando el sidebar está expandido) -->
      <a routerLink="/" class="inline-flex items-center gap-2 ml-2" [class.lg:hidden]="!isSidebarCollapsed()">
        <span class="h-9 w-9 rounded-xl bg-gradient-to-br from-lime-400 to-yellow-400 shadow-[0_0_20px_#a3e635] grid place-items-center text-slate-900 font-black">NC</span>
        <span class="font-semibold tracking-wide text-slate-200">NeoCourse</span>
      </a>
    </div>

    <!-- Lado derecho: usuario + dropdown (Ahora con lógica de Angular) -->
    <div class="relative">
      <button (click)="toggleProfileMenu()" class="flex items-center gap-3">
        <span class="text-sm font-medium hidden sm:inline text-slate-200">Hola, {{ authService.currentUser()?.name }}</span>
        <img class="w-9 h-9 rounded-full object-cover border-2 border-lime-400/50" [src]="authService.currentUserAvatar()" alt="Avatar">
      </button>
      @if (isProfileMenuOpen()) {
        <div class="absolute top-full right-0 mt-3 w-48 bg-slate-800/90 backdrop-blur rounded-md shadow-lg ring-1 ring-white/10 py-1 z-50"
             (clickOutside)="isProfileMenuOpen.set(false)">
          <div class="px-4 py-3 border-b border-white/10">
            <span class="block text-sm text-white">{{ authService.currentUser()?.name }} {{ authService.currentUser()?.surname }}</span>
            <span class="block text-xs text-white/60 truncate">{{ authService.currentUser()?.email }}</span>
          </div>
          <a [routerLink]="getProfileLink()" (click)="toggleProfileMenu()" class="block px-4 py-2 text-sm text-slate-300 hover:bg-slate-700/80 hover:text-lime-300">Mi Panel</a>
          <a routerLink="/" (click)="toggleProfileMenu()" class="block px-4 py-2 text-sm text-slate-300 hover:bg-slate-700/80 hover:text-lime-300">Ver Sitio</a>
          <div class="border-t border-white/10 my-1"></div>
          <button (click)="logout()" class="w-full text-left block px-4 py-2 text-sm text-red-400 font-medium hover:bg-slate-700/80">Cerrar Sesión</button>
        </div>
      }
    </div>
  </div>
</header>
