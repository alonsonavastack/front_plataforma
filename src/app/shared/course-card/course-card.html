<!-- src/app/shared/course-card/course-card.html -->
<div class="group relative h-full flex flex-col overflow-hidden rounded-2xl border border-white/10 bg-gradient-to-br from-slate-900/90 to-slate-800/90 backdrop-blur-sm transition-all duration-300 hover:border-lime-400/40 hover:shadow-xl hover:shadow-lime-500/10 hover:-translate-y-1">
  
  <!-- Badge de Ya Comprado -->
  @if (isPurchased()) {
    <div class="absolute top-3 left-3 z-20 px-3 py-1.5 rounded-xl text-xs font-bold
                bg-gradient-to-r from-emerald-500 to-teal-500 text-white shadow-lg 
                flex items-center gap-1.5 backdrop-blur-sm">
      <svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
      </svg>
      Comprado
    </div>
  }
  
  <!-- Imagen con efecto overlay -->
  <div class="relative overflow-hidden">
    <!-- Overlay gradient -->
    <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-slate-900/20 to-transparent opacity-60 z-10 group-hover:opacity-40 transition-opacity duration-300"></div>
    
    <!-- Imagen -->
    <div class="aspect-video overflow-hidden">
      <img
        [src]="coverUrl()"
        [alt]="title()"
        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
        [class.opacity-50]="isPurchased()"
        loading="lazy"
        decoding="async"
      />
    </div>
    
    <!-- Badge de descuento flotante -->
    @if (hasDiscount() && !isPurchased()) {
      <div class="absolute top-3 right-3 z-20">
        <div class="relative">
          <!-- C√≠rculo con animaci√≥n de pulso -->
          <div class="absolute inset-0 rounded-full bg-lime-400 animate-ping opacity-75"></div>
          <div class="relative px-3 py-1.5 rounded-full text-xs font-black
                      bg-gradient-to-br from-lime-400 to-yellow-400 text-slate-900 
                      shadow-lg flex items-center gap-1">
            <svg class="w-3 h-3" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z" clip-rule="evenodd"/>
            </svg>
            -{{ discountPct() }}%
          </div>
        </div>
      </div>
    }

    <!-- Categor√≠a flotante en la parte inferior -->
    @if (category()) {
      <div class="absolute bottom-3 left-3 z-20">
        <span class="inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg 
                     bg-slate-900/80 backdrop-blur-md border border-white/10
                     text-xs font-medium text-white/90">
          <svg class="w-3.5 h-3.5 text-lime-400" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2 6a2 2 0 012-2h5l2 2h5a2 2 0 012 2v6a2 2 0 01-2 2H4a2 2 0 01-2-2V6z"></path>
          </svg>
          {{ category() }}
        </span>
      </div>
    }
  </div>

  <!-- Contenido de la tarjeta -->
  <div class="flex-1 flex flex-col p-5 space-y-3">
    <!-- T√≠tulo del curso -->
    <a [routerLink]="['/courses', slug()]" class="block group/title">
      <h3 class="text-base font-bold text-white leading-tight line-clamp-2 
                 group-hover/title:text-lime-300 transition-colors duration-200">
        {{ title() }}
      </h3>
    </a>

    <!-- Instructor -->
    @if (instructor()) {
      <div class="flex items-center gap-2 text-xs text-white/60">
        <svg class="w-4 h-4 text-lime-400/60" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path>
        </svg>
        <span class="truncate">{{ instructor() }}</span>
      </div>
    }

    <!-- Rating con estrellas -->
    @if (rating()) {
      <div class="flex items-center gap-2">
        <div class="flex items-center gap-0.5">
          <!-- Estrellas simplificadas (mostramos 5 estrellas) -->
          @for (star of [1,2,3,4,5]; track star) {
            @if (star <= Math.floor(+rating())) {
              <!-- Estrella llena -->
              <svg class="w-4 h-4 text-amber-400" viewBox="0 0 20 20" fill="currentColor">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            } @else if (star === Math.ceil(+rating()) && +rating() % 1 !== 0) {
              <!-- Media estrella (versi√≥n simplificada con opacity) -->
              <div class="relative w-4 h-4">
                <!-- Estrella vac√≠a como fondo -->
                <svg class="absolute inset-0 w-4 h-4 text-slate-600" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
                <!-- Media estrella llena cortada con clip-path -->
                <svg class="absolute inset-0 w-4 h-4 text-amber-400" viewBox="0 0 20 20" fill="currentColor" style="clip-path: inset(0 50% 0 0);">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                </svg>
              </div>
            } @else {
              <!-- Estrella vac√≠a -->
              <svg class="w-4 h-4 text-slate-600" viewBox="0 0 20 20" fill="currentColor">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
            }
          }
        </div>
        <div class="flex items-center gap-1 text-xs">
          <span class="font-bold text-amber-400">{{ rating() }}</span>
          @if (reviews() > 0) {
            <span class="text-white/40">‚Ä¢</span>
            <span class="text-white/50">({{ reviews() }})</span>
          }
        </div>
      </div>
    }

    <!-- Spacer para empujar el precio y bot√≥n hacia abajo -->
    <div class="flex-1"></div>

    <!-- L√≠nea divisoria sutil -->
    <div class="h-px bg-gradient-to-r from-transparent via-white/10 to-transparent"></div>

    <!-- Precio con dise√±o destacado -->
    <div class="flex items-center justify-between">
      @if (course()['isFree'] || priceCurrent() === 0) {
        <!-- Mostrar badge de GRATUITO si isFree es true O si el precio es 0 -->
        <span class="inline-flex items-center px-3 py-1.5 text-sm font-bold text-green-400 bg-green-500/10 border border-green-500/30 rounded-lg">
          üéÅ GRATUITO
        </span>
      } @else {
        <!-- Mostrar precio normal -->
        <div class="flex items-baseline gap-2">
          <span class="text-2xl font-black text-transparent bg-clip-text bg-gradient-to-r from-lime-400 to-emerald-400">
            ${{ priceCurrent() | number:'1.0-2' }}
          </span>
          @if (hasDiscount()) {
            <span class="text-sm text-white/40 line-through font-medium">
              ${{ priceOriginal() | number:'1.0-2' }}
            </span>
          }
        </div>
        <span class="text-xs text-white/50 font-medium">USD</span>
      }
    </div>
    
    <!-- Bot√≥n de acci√≥n con estados -->
    <div class="pt-2">
      @if (isPurchased()) {
        <a 
          [routerLink]="['/courses', slug()]"
          class="group/btn relative block w-full text-center px-4 py-3 rounded-xl 
                 bg-gradient-to-r from-emerald-500/20 to-teal-500/20 
                 border border-emerald-500/40
                 text-emerald-400 font-bold text-sm
                 overflow-hidden
                 hover:from-emerald-500/30 hover:to-teal-500/30 
                 hover:border-emerald-400/60
                 transition-all duration-300">
          <span class="relative z-10 flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
              <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"></path>
            </svg>
            Ver Curso
          </span>
          <!-- Shine effect -->
          <div class="absolute inset-0 -translate-x-full group-hover/btn:translate-x-full 
                      bg-gradient-to-r from-transparent via-white/10 to-transparent 
                      transition-transform duration-700 ease-out"></div>
        </a>
      } @else {
        <button
          (click)="buyNow()"
          class="group/btn relative w-full px-4 py-3 rounded-xl font-bold text-sm
                 bg-gradient-to-r from-lime-400 to-emerald-400
                 text-slate-900
                 overflow-hidden
                 hover:from-lime-300 hover:to-emerald-300
                 hover:shadow-lg hover:shadow-lime-500/30
                 active:scale-95
                 transition-all duration-200
                 flex items-center justify-center gap-2">
          <svg class="w-5 h-5 relative z-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
          </svg>
          <span class="relative z-10">Comprar - ${{ price() }}</span>
          <!-- Shine effect on hover -->
          <div class="absolute inset-0 -translate-x-full group-hover/btn:translate-x-full 
                      bg-gradient-to-r from-transparent via-white/30 to-transparent 
                      transition-transform duration-500 ease-out"></div>
        </button>
      }
    </div>
  </div>

  <!-- Efecto de brillo en hover (borde superior) -->
  <div class="absolute inset-x-0 top-0 h-px bg-gradient-to-r from-transparent via-lime-400/0 to-transparent 
              group-hover:via-lime-400/60 transition-all duration-300"></div>
</div>
